!function(){function e(e){return e&&e.__esModule?e.default:e}var t="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{};function n(e,t,n,r){Object.defineProperty(e,t,{get:n,set:r,enumerable:!0,configurable:!0})}var r={},a={},o=t.parcelRequire1775;null==o&&((o=function(e){if(e in r)return r[e].exports;if(e in a){var t=a[e];delete a[e];var n={id:e,exports:{}};return r[e]=n,t.call(n.exports,n,n.exports),n.exports}var i=new Error("Cannot find module '"+e+"'");throw i.code="MODULE_NOT_FOUND",i}).register=function(e,t){a[e]=t},t.parcelRequire1775=o),o.register("hKHmD",(function(e,t){"use strict";Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.default=function(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n;return e}})),o.register("ds8z5",(function(e,t){"use strict";Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.default=function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}})),o.register("gD1JV",(function(e,t){"use strict";function n(e,t){return(n=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.default=function(e,t){return n(e,t)}})),o.register("8slrw",(function(e,t){"use strict";Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.default=function(e){if(Array.isArray(e))return e}})),o.register("7AJDX",(function(e,t){"use strict";Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.default=function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}})),o.register("ifqQW",(function(e,t){"use strict";Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.default=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}})),o.register("auk6i",(function(e,t){"use strict";Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.default=function(e,t){if(!e)return;if("string"==typeof e)return r.default(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return r.default(e,t)};var n,r=(n=o("8NIkP"))&&n.__esModule?n:{default:n}})),o.register("8NIkP",(function(e,t){"use strict";Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.default=function(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}})),o.register("kMC0W",(function(e,t){"use strict";Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.default=function(e){if(Array.isArray(e))return r.default(e)};var n,r=(n=o("8NIkP"))&&n.__esModule?n:{default:n}})),o.register("8CtQK",(function(e,t){"use strict";Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.default=function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}})),o.register("ge8co",(function(e,t){"use strict";Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.default=function(e,t,n){return a.apply(null,arguments)};var n,r=(n=o("gD1JV"))&&n.__esModule?n:{default:n};function i(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function a(e,t,n){return(a=i()?Reflect.construct:function(e,t,n){var i=[null];i.push.apply(i,t);var a=new(Function.bind.apply(e,i));return n&&r.default(a,n.prototype),a}).apply(null,arguments)}})),o.register("cZGw3",(function(e,t){"use strict";Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.default=function(e){return-1!==Function.toString.call(e).indexOf("[native code]")}})),o.register("fVNic",(function(e,t){"use strict";function n(e){return(n=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.default=function(e){return n(e)}})),o.register("aTHs7",(function(e,t){"use strict";Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.default=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}})),o.register("jmhxu",(function(e,t){"use strict";Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.default=function(e,t){return!t||"object"!==r.default(t)&&"function"!=typeof t?n.default(e):t};var n=i(o("ds8z5")),r=i(o("l5bVx"));function i(e){return e&&e.__esModule?e:{default:e}}})),o.register("l5bVx",(function(e,t){"use strict";Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.default=function(e){return e&&e.constructor===Symbol?"symbol":typeof e}})),o.register("2mz0K",(function(e,t){"use strict";Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.default=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=r.default(e)););return e};var n,r=(n=o("fVNic"))&&n.__esModule?n:{default:n}}));var u={apiKey:"AIzaSyAIIh3ETGj37RVMmyy1xyAEHcnvA4j1JJs",authDomain:"filmoteka-js52-team5.firebaseapp.com",projectId:"filmoteka-js52-team5",storageBucket:"filmoteka-js52-team5.appspot.com",messagingSenderId:"316870306630",appId:"1:316870306630:web:7920920738f7c0ebf59347",measurementId:"G-FJKM4M8NNT"},s={};Object.defineProperty(s,"__esModule",{value:!0}),s.default=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")};var c={};function l(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}Object.defineProperty(c,"__esModule",{value:!0}),c.default=function(e,t,n){t&&l(e.prototype,t);n&&l(e,n);return e};var h=o("hKHmD"),f=o("ds8z5"),d={};Object.defineProperty(d,"__esModule",{value:!0}),d.default=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p.default(e,t)};var v,p=(v=o("gD1JV"))&&v.__esModule?v:{default:v};var y={};Object.defineProperty(y,"__esModule",{value:!0}),y.default=function(e,t){return m.default(e)||g.default(e,t)||w.default(e,t)||k.default()};var m=b(o("8slrw")),g=b(o("7AJDX")),k=b(o("ifqQW")),w=b(o("auk6i"));function b(e){return e&&e.__esModule?e:{default:e}}var x={};Object.defineProperty(x,"__esModule",{value:!0}),x.default=function(e){return I.default(e)||_.default(e)||E.default(e)||T.default()};var I=S(o("kMC0W")),_=S(o("7AJDX")),T=S(o("8CtQK")),E=S(o("auk6i"));function S(e){return e&&e.__esModule?e:{default:e}}var A={};Object.defineProperty(A,"__esModule",{value:!0}),A.default=function(e){return P(e)};var C=O(o("ge8co")),N=O(o("cZGw3")),D=O(o("fVNic")),R=O(o("gD1JV"));function O(e){return e&&e.__esModule?e:{default:e}}function P(e){var t="function"==typeof Map?new Map:void 0;return P=function(e){if(null===e||!N.default(e))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,n)}function n(){return C.default(e,arguments,D.default(this).constructor)}return n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),R.default(n,e)},P(e)}var L={};Object.defineProperty(L,"__esModule",{value:!0}),L.default=function(e){var t=M.default();return function(){var n,r=F.default(e);if(t){var i=F.default(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return V.default(this,n)}};var M=U(o("aTHs7")),F=U(o("fVNic")),V=U(o("jmhxu"));function U(e){return e&&e.__esModule?e:{default:e}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var B=function(e){for(var t=[],n=0,r=0;r<e.length;r++){var i=e.charCodeAt(r);i<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=63&i|128):55296==(64512&i)&&r+1<e.length&&56320==(64512&e.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&e.charCodeAt(++r)),t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=63&i|128):(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=63&i|128)}return t},q={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray:function(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();for(var n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[],i=0;i<e.length;i+=3){var a=e[i],o=i+1<e.length,u=o?e[i+1]:0,s=i+2<e.length,c=s?e[i+2]:0,l=a>>2,h=(3&a)<<4|u>>4,f=(15&u)<<2|c>>6,d=63&c;s||(d=64,o||(f=64)),r.push(n[l],n[h],n[f],n[d])}return r.join("")},encodeString:function(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(B(e),t)},decodeString:function(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):function(e){for(var t=[],n=0,r=0;n<e.length;){var i=e[n++];if(i<128)t[r++]=String.fromCharCode(i);else if(i>191&&i<224){var a=e[n++];t[r++]=String.fromCharCode((31&i)<<6|63&a)}else if(i>239&&i<365){var o=((7&i)<<18|(63&e[n++])<<12|(63&e[n++])<<6|63&e[n++])-65536;t[r++]=String.fromCharCode(55296+(o>>10)),t[r++]=String.fromCharCode(56320+(1023&o))}else{var u=e[n++],s=e[n++];t[r++]=String.fromCharCode((15&i)<<12|(63&u)<<6|63&s)}}return t.join("")}(this.decodeStringToByteArray(e,t))},decodeStringToByteArray:function(e,t){this.init_();for(var n=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[],i=0;i<e.length;){var a=n[e.charAt(i++)],o=i<e.length?n[e.charAt(i)]:0,u=++i<e.length?n[e.charAt(i)]:64,s=++i<e.length?n[e.charAt(i)]:64;if(++i,null==a||null==o||null==u||null==s)throw Error();var c=a<<2|o>>4;if(r.push(c),64!==u){var l=o<<4&240|u>>2;if(r.push(l),64!==s){var h=u<<6&192|s;r.push(h)}}}return r},init_:function(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(var e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}},j=function(e){return function(e){var t=B(e);return q.encodeByteArray(t,!0)}(e).replace(/\./g,"")},G=function(e){try{return q.decodeString(e,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function K(e,t){if(!(t instanceof Object))return t;switch(t.constructor){case Date:return new Date(t.getTime());case Object:void 0===e&&(e={});break;case Array:e=[];break;default:return t}for(var n in t)t.hasOwnProperty(n)&&"__proto__"!==n&&(e[n]=K(e[n],t[n]));return e}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var z=function(){"use strict";function t(){var n=this;e(s)(this,t),this.reject=function(){},this.resolve=function(){},this.promise=new Promise((function(e,t){n.resolve=e,n.reject=t}))}return e(c)(t,[{key:"wrapCallback",value:function(e){var t=this;return function(n,r){n?t.reject(n):t.resolve(r),"function"==typeof e&&(t.promise.catch((function(){})),1===e.length?e(n):e(n,r))}}}]),t}();
/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function W(e,t){if(e.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');var n=t||"demo-project",r=e.iat||0,i=e.sub||e.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");var a=Object.assign({iss:"https://securetoken.google.com/".concat(n),aud:n,iat:r,exp:r+3600,auth_time:r,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},e);return[j(JSON.stringify({alg:"none",type:"JWT"})),j(JSON.stringify(a)),""].join(".")}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function H(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function Q(){try{return"[object process]"===Object.prototype.toString.call(t.process)}catch(e){return!1}}function Y(){var e="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof e&&void 0!==e.id}function J(){return"object"==typeof navigator&&"ReactNative"===navigator.product}function X(){var e=H();return e.indexOf("MSIE ")>=0||e.indexOf("Trident/")>=0}function Z(){return"object"==typeof indexedDB}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var $=function(t){"use strict";e(d)(r,t);var n=e(L)(r);function r(t,i,a){var o;return e(s)(this,r),(o=n.call(this,i)).code=t,o.customData=a,o.name="FirebaseError",Object.setPrototypeOf(e(f)(o),r.prototype),Error.captureStackTrace&&Error.captureStackTrace(e(f)(o),ee.prototype.create),o}return r}(e(A)(Error)),ee=function(){"use strict";function t(n,r,i){e(s)(this,t),this.service=n,this.serviceName=r,this.errors=i}return e(c)(t,[{key:"create",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var i=n[0]||{},a="".concat(this.service,"/").concat(e),o=this.errors[e],u=o?te(o,i):"Error",s="".concat(this.serviceName,": ").concat(u," (").concat(a,")."),c=new $(a,s,i);return c}}]),t}();function te(e,t){return e.replace(ne,(function(e,n){var r=t[n];return null!=r?String(r):"<".concat(n,"?>")}))}var ne=/\{\$([^}]+)}/g;
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function re(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function ie(e){for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}function ae(e,t){if(e===t)return!0;var n=Object.keys(e),r=Object.keys(t),i=!0,a=!1,o=void 0;try{for(var u,s=n[Symbol.iterator]();!(i=(u=s.next()).done);i=!0){var c=u.value;if(!r.includes(c))return!1;var l=e[c],h=t[c];if(oe(l)&&oe(h)){if(!ae(l,h))return!1}else if(l!==h)return!1}}catch(e){a=!0,o=e}finally{try{i||null==s.return||s.return()}finally{if(a)throw o}}var f=!0,d=!1,v=void 0;try{for(var p,y=r[Symbol.iterator]();!(f=(p=y.next()).done);f=!0){var m=p.value;if(!n.includes(m))return!1}}catch(e){d=!0,v=e}finally{try{f||null==y.return||y.return()}finally{if(d)throw v}}return!0}function oe(e){return null!==e&&"object"==typeof e}
/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function ue(t){var n=[],r=!0,i=!1,a=void 0;try{for(var o,u=function(t,r){var i=e(y)(r.value,2),a=i[0],o=i[1];Array.isArray(o)?o.forEach((function(e){n.push(encodeURIComponent(a)+"="+encodeURIComponent(e))})):n.push(encodeURIComponent(a)+"="+encodeURIComponent(o))},s=Object.entries(t)[Symbol.iterator]();!(r=(o=s.next()).done);r=!0)u(0,o)}catch(e){i=!0,a=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw a}}return n.length?"&"+n.join("&"):""}function se(t){var n={};return t.replace(/^\?/,"").split("&").forEach((function(t){if(t){var r=e(y)(t.split("="),2),i=r[0],a=r[1];n[decodeURIComponent(i)]=decodeURIComponent(a)}})),n}function ce(e){var t=e.indexOf("?");if(!t)return"";var n=e.indexOf("#",t);return e.substring(t,n>0?n:void 0)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function le(e,t){var n=new he(e,t);return n.subscribe.bind(n)}var he=function(){"use strict";function t(n,r){var i=this;e(s)(this,t),this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=r,this.task.then((function(){n(i)})).catch((function(e){i.error(e)}))}return e(c)(t,[{key:"next",value:function(e){this.forEachObserver((function(t){t.next(e)}))}},{key:"error",value:function(e){this.forEachObserver((function(t){t.error(e)})),this.close(e)}},{key:"complete",value:function(){this.forEachObserver((function(e){e.complete()})),this.close()}},{key:"subscribe",value:function(e,t,n){var r,i=this;if(void 0===e&&void 0===t&&void 0===n)throw new Error("Missing Observer.");r=function(e,t){if("object"!=typeof e||null===e)return!1;var n=!0,r=!1,i=void 0;try{for(var a,o=t[Symbol.iterator]();!(n=(a=o.next()).done);n=!0){var u=a.value;if(u in e&&"function"==typeof e[u])return!0}}catch(e){r=!0,i=e}finally{try{n||null==o.return||o.return()}finally{if(r)throw i}}return!1}(e,["next","error","complete"])?e:{next:e,error:t,complete:n},void 0===r.next&&(r.next=fe),void 0===r.error&&(r.error=fe),void 0===r.complete&&(r.complete=fe);var a=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then((function(){try{i.finalError?r.error(i.finalError):r.complete()}catch(e){}})),this.observers.push(r),a}},{key:"unsubscribeOne",value:function(e){void 0!==this.observers&&void 0!==this.observers[e]&&(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}},{key:"forEachObserver",value:function(e){if(!this.finalized)for(var t=0;t<this.observers.length;t++)this.sendOne(t,e)}},{key:"sendOne",value:function(e,t){var n=this;this.task.then((function(){if(void 0!==n.observers&&void 0!==n.observers[e])try{t(n.observers[e])}catch(e){"undefined"!=typeof console&&console.error&&console.error(e)}}))}},{key:"close",value:function(e){var t=this;this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then((function(){t.observers=void 0,t.onNoObservers=void 0})))}}]),t}();function fe(){}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function de(e){return e&&e._delegate?e._delegate:e}var ve={};function pe(e,t,n,r,i,a,o){try{var u=e[a](o),s=u.value}catch(e){return void n(e)}u.done?t(s):Promise.resolve(s).then(r,i)}Object.defineProperty(ve,"__esModule",{value:!0}),ve.default=function(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var a=e.apply(t,n);function o(e){pe(a,r,i,o,u,"next",e)}function u(e){pe(a,r,i,o,u,"throw",e)}o(void 0)}))}};var ye={},me=function(e){"use strict";var t,n=Object.prototype,r=n.hasOwnProperty,i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",o=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function s(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{s({},"")}catch(e){s=function(e,t,n){return e[t]=n}}function c(e,t,n,r){var i=t&&t.prototype instanceof y?t:y,a=Object.create(i.prototype),o=new A(r||[]);return a._invoke=function(e,t,n){var r=h;return function(i,a){if(r===d)throw new Error("Generator is already running");if(r===v){if("throw"===i)throw a;return N()}for(n.method=i,n.arg=a;;){var o=n.delegate;if(o){var u=T(o,n);if(u){if(u===p)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(r===h)throw r=v,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r=d;var s=l(e,t,n);if("normal"===s.type){if(r=n.done?v:f,s.arg===p)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(r=v,n.method="throw",n.arg=s.arg)}}}(e,n,o),a}function l(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=c;var h="suspendedStart",f="suspendedYield",d="executing",v="completed",p={};function y(){}function m(){}function g(){}var k={};s(k,a,(function(){return this}));var w=Object.getPrototypeOf,b=w&&w(w(C([])));b&&b!==n&&r.call(b,a)&&(k=b);var x=g.prototype=y.prototype=Object.create(k);function I(e){["next","throw","return"].forEach((function(t){s(e,t,(function(e){return this._invoke(t,e)}))}))}function _(e,t){function n(i,a,o,u){var s=l(e[i],e,a);if("throw"!==s.type){var c=s.arg,h=c.value;return h&&"object"==typeof h&&r.call(h,"__await")?t.resolve(h.__await).then((function(e){n("next",e,o,u)}),(function(e){n("throw",e,o,u)})):t.resolve(h).then((function(e){c.value=e,o(c)}),(function(e){return n("throw",e,o,u)}))}u(s.arg)}var i;this._invoke=function(e,r){function a(){return new t((function(t,i){n(e,r,t,i)}))}return i=i?i.then(a,a):a()}}function T(e,n){var r=e.iterator[n.method];if(r===t){if(n.delegate=null,"throw"===n.method){if(e.iterator.return&&(n.method="return",n.arg=t,T(e,n),"throw"===n.method))return p;n.method="throw",n.arg=new TypeError("The iterator does not provide a 'throw' method")}return p}var i=l(r,e.iterator,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,p;var a=i.arg;return a?a.done?(n[e.resultName]=a.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,p):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,p)}function E(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function S(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function A(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(E,this),this.reset(!0)}function C(e){if(e){var n=e[a];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,o=function n(){for(;++i<e.length;)if(r.call(e,i))return n.value=e[i],n.done=!1,n;return n.value=t,n.done=!0,n};return o.next=o}}return{next:N}}function N(){return{value:t,done:!0}}return m.prototype=g,s(x,"constructor",g),s(g,"constructor",m),m.displayName=s(g,u,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===m||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,g):(e.__proto__=g,s(e,u,"GeneratorFunction")),e.prototype=Object.create(x),e},e.awrap=function(e){return{__await:e}},I(_.prototype),s(_.prototype,o,(function(){return this})),e.AsyncIterator=_,e.async=function(t,n,r,i,a){void 0===a&&(a=Promise);var o=new _(c(t,n,r,i),a);return e.isGeneratorFunction(n)?o:o.next().then((function(e){return e.done?e.value:o.next()}))},I(x),s(x,u,"Generator"),s(x,a,(function(){return this})),s(x,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){for(;t.length;){var r=t.pop();if(r in e)return n.value=r,n.done=!1,n}return n.done=!0,n}},e.values=C,A.prototype={constructor:A,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(S),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function i(r,i){return u.type="throw",u.arg=e,n.next=r,i&&(n.method="next",n.arg=t),!!i}for(var a=this.tryEntries.length-1;a>=0;--a){var o=this.tryEntries[a],u=o.completion;if("root"===o.tryLoc)return i("end");if(o.tryLoc<=this.prev){var s=r.call(o,"catchLoc"),c=r.call(o,"finallyLoc");if(s&&c){if(this.prev<o.catchLoc)return i(o.catchLoc,!0);if(this.prev<o.finallyLoc)return i(o.finallyLoc)}else if(s){if(this.prev<o.catchLoc)return i(o.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return i(o.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var a=i;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var o=a?a.completion:{};return o.type=e,o.arg=t,a?(this.method="next",this.next=a.finallyLoc,p):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),p},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),S(n),p}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;S(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:C(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),p}},e}(ye);try{regeneratorRuntime=me}catch(e){"object"==typeof globalThis?globalThis.regeneratorRuntime=me:Function("r","regeneratorRuntime = r")(me)}var ge=function(){"use strict";function t(n,r,i){e(s)(this,t),this.name=n,this.instanceFactory=r,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}return e(c)(t,[{key:"setInstantiationMode",value:function(e){return this.instantiationMode=e,this}},{key:"setMultipleInstances",value:function(e){return this.multipleInstances=e,this}},{key:"setServiceProps",value:function(e){return this.serviceProps=e,this}},{key:"setInstanceCreatedCallback",value:function(e){return this.onInstanceCreated=e,this}}]),t}(),ke="[DEFAULT]",we=function(){"use strict";function t(n,r){e(s)(this,t),this.name=n,this.container=r,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}return e(c)(t,[{key:"get",value:function(e){var t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){var n=new z;if(this.instancesDeferred.set(t,n),this.isInitialized(t)||this.shouldAutoInitialize())try{var r=this.getOrInitializeService({instanceIdentifier:t});r&&n.resolve(r)}catch(e){}}return this.instancesDeferred.get(t).promise}},{key:"getImmediate",value:function(e){var t,n=this.normalizeInstanceIdentifier(null==e?void 0:e.identifier),r=null!==(t=null==e?void 0:e.optional)&&void 0!==t&&t;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(r)return null;throw Error("Service ".concat(this.name," is not available"))}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(e){if(r)return null;throw e}}},{key:"getComponent",value:function(){return this.component}},{key:"setComponent",value:function(t){if(t.name!==this.name)throw Error("Mismatching Component ".concat(t.name," for Provider ").concat(this.name,"."));if(this.component)throw Error("Component for ".concat(this.name," has already been provided"));if(this.component=t,this.shouldAutoInitialize()){if(function(e){return"EAGER"===e.instantiationMode}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(t))try{this.getOrInitializeService({instanceIdentifier:ke})}catch(e){}var n=!0,r=!1,i=void 0;try{for(var a,o=this.instancesDeferred.entries()[Symbol.iterator]();!(n=(a=o.next()).done);n=!0){var u=e(y)(a.value,2),s=u[0],c=u[1],l=this.normalizeInstanceIdentifier(s);try{var h=this.getOrInitializeService({instanceIdentifier:l});c.resolve(h)}catch(e){}}}catch(e){r=!0,i=e}finally{try{n||null==o.return||o.return()}finally{if(r)throw i}}}}},{key:"clearInstance",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ke;this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}},{key:"delete",value:function(){var t=this;return e(ve)(e(ye).mark((function n(){var r;return e(ye).wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=Array.from(t.instances.values()),n.next=3,Promise.all(e(x)(r.filter((function(e){return"INTERNAL"in e})).map((function(e){return e.INTERNAL.delete()}))).concat(e(x)(r.filter((function(e){return"_delete"in e})).map((function(e){return e._delete()})))));case 3:case"end":return n.stop()}}),n)})))()}},{key:"isComponentSet",value:function(){return null!=this.component}},{key:"isInitialized",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ke;return this.instances.has(e)}},{key:"getOptions",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ke;return this.instancesOptions.get(e)||{}}},{key:"initialize",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.options,r=void 0===n?{}:n,i=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(i))throw Error("".concat(this.name,"(").concat(i,") has already been initialized"));if(!this.isComponentSet())throw Error("Component ".concat(this.name," has not been registered yet"));var a=this.getOrInitializeService({instanceIdentifier:i,options:r}),o=!0,u=!1,s=void 0;try{for(var c,l=this.instancesDeferred.entries()[Symbol.iterator]();!(o=(c=l.next()).done);o=!0){var h=e(y)(c.value,2),f=h[0],d=h[1],v=this.normalizeInstanceIdentifier(f);i===v&&d.resolve(a)}}catch(e){u=!0,s=e}finally{try{o||null==l.return||l.return()}finally{if(u)throw s}}return a}},{key:"onInit",value:function(e,t){var n,r=this.normalizeInstanceIdentifier(t),i=null!==(n=this.onInitCallbacks.get(r))&&void 0!==n?n:new Set;i.add(e),this.onInitCallbacks.set(r,i);var a=this.instances.get(r);return a&&e(a,r),function(){i.delete(e)}}},{key:"invokeOnInitCallbacks",value:function(e,t){var n=this.onInitCallbacks.get(t);if(n){var r=!0,i=!1,a=void 0;try{for(var o,u=n[Symbol.iterator]();!(r=(o=u.next()).done);r=!0){var s=o.value;try{s(e,t)}catch(e){}}}catch(e){i=!0,a=e}finally{try{r||null==u.return||u.return()}finally{if(i)throw a}}}}},{key:"getOrInitializeService",value:function(e){var t,n=e.instanceIdentifier,r=e.options,i=void 0===r?{}:r,a=this.instances.get(n);if(!a&&this.component&&(a=this.component.instanceFactory(this.container,{instanceIdentifier:(t=n,t===ke?void 0:t),options:i}),this.instances.set(n,a),this.instancesOptions.set(n,i),this.invokeOnInitCallbacks(a,n),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,n,a)}catch(e){}return a||null}},{key:"normalizeInstanceIdentifier",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ke;return this.component?this.component.multipleInstances?e:ke:e}},{key:"shouldAutoInitialize",value:function(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}]),t}();
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var be=function(){"use strict";function t(n){e(s)(this,t),this.name=n,this.providers=new Map}return e(c)(t,[{key:"addComponent",value:function(e){var t=this.getProvider(e.name);if(t.isComponentSet())throw new Error("Component ".concat(e.name," has already been registered with ").concat(this.name));t.setComponent(e)}},{key:"addOrOverwriteComponent",value:function(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}},{key:"getProvider",value:function(e){if(this.providers.has(e))return this.providers.get(e);var t=new we(e,this);return this.providers.set(e,t),t}},{key:"getProviders",value:function(){return Array.from(this.providers.values())}}]),t}(),xe={};n(xe,"_DEFAULT_ENTRY_NAME",(function(){return it})),n(xe,"_apps",(function(){return ot})),n(xe,"_components",(function(){return ut})),n(xe,"_addComponent",(function(){return st})),n(xe,"_addOrOverwriteComponent",(function(){return ct})),n(xe,"_registerComponent",(function(){return lt})),n(xe,"_getProvider",(function(){return ht})),n(xe,"_removeServiceInstance",(function(){return ft})),n(xe,"_clearComponents",(function(){return dt})),n(xe,"SDK_VERSION",(function(){return mt})),n(xe,"initializeApp",(function(){return gt})),n(xe,"getApp",(function(){return kt})),n(xe,"getApps",(function(){return wt})),n(xe,"deleteApp",(function(){return bt})),n(xe,"registerVersion",(function(){return It})),n(xe,"onLog",(function(){return _t})),n(xe,"setLogLevel",(function(){return Tt})),n(xe,"FirebaseError",(function(){return $}));h=o("hKHmD"),h=o("hKHmD");var Ie,_e,Te=[];(_e=Ie||(Ie={}))[_e.DEBUG=0]="DEBUG",_e[_e.VERBOSE=1]="VERBOSE",_e[_e.INFO=2]="INFO",_e[_e.WARN=3]="WARN",_e[_e.ERROR=4]="ERROR",_e[_e.SILENT=5]="SILENT";var Ee,Se={debug:Ie.DEBUG,verbose:Ie.VERBOSE,info:Ie.INFO,warn:Ie.WARN,error:Ie.ERROR,silent:Ie.SILENT},Ae=Ie.INFO,Ce=(Ee={},e(h)(Ee,Ie.DEBUG,"log"),e(h)(Ee,Ie.VERBOSE,"log"),e(h)(Ee,Ie.INFO,"info"),e(h)(Ee,Ie.WARN,"warn"),e(h)(Ee,Ie.ERROR,"error"),Ee),Ne=function(t,n){for(var r=arguments.length,i=new Array(r>2?r-2:0),a=2;a<r;a++)i[a-2]=arguments[a];var o;if(!(n<t.logLevel)){var u=(new Date).toISOString(),s=Ce[n];if(!s)throw new Error("Attempted to log a message with an invalid logType (value: ".concat(n,")"));(o=console)[s].apply(o,["[".concat(u,"]  ").concat(t.name,":")].concat(e(x)(i)))}},De=function(){"use strict";function t(n){e(s)(this,t),this.name=n,this._logLevel=Ae,this._logHandler=Ne,this._userLogHandler=null,Te.push(this)}return e(c)(t,[{key:"logLevel",get:function(){return this._logLevel},set:function(e){if(!(e in Ie))throw new TypeError('Invalid value "'.concat(e,'" assigned to `logLevel`'));this._logLevel=e}},{key:"setLogLevel",value:function(e){this._logLevel="string"==typeof e?Se[e]:e}},{key:"logHandler",get:function(){return this._logHandler},set:function(e){if("function"!=typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}},{key:"userLogHandler",get:function(){return this._userLogHandler},set:function(e){this._userLogHandler=e}},{key:"debug",value:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];this._userLogHandler&&this._userLogHandler.apply(this,[this,Ie.DEBUG].concat(e(x)(n))),this._logHandler.apply(this,[this,Ie.DEBUG].concat(e(x)(n)))}},{key:"log",value:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];this._userLogHandler&&this._userLogHandler.apply(this,[this,Ie.VERBOSE].concat(e(x)(n))),this._logHandler.apply(this,[this,Ie.VERBOSE].concat(e(x)(n)))}},{key:"info",value:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];this._userLogHandler&&this._userLogHandler.apply(this,[this,Ie.INFO].concat(e(x)(n))),this._logHandler.apply(this,[this,Ie.INFO].concat(e(x)(n)))}},{key:"warn",value:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];this._userLogHandler&&this._userLogHandler.apply(this,[this,Ie.WARN].concat(e(x)(n))),this._logHandler.apply(this,[this,Ie.WARN].concat(e(x)(n)))}},{key:"error",value:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];this._userLogHandler&&this._userLogHandler.apply(this,[this,Ie.ERROR].concat(e(x)(n))),this._logHandler.apply(this,[this,Ie.ERROR].concat(e(x)(n)))}}]),t}();function Re(e,t){var n=!0,r=!1,i=void 0;try{for(var a,o=Te[Symbol.iterator]();!(n=(a=o.next()).done);n=!0){var u=a.value,s=null;t&&t.level&&(s=Se[t.level]),u.userLogHandler=null===e?null:function(t,n){for(var r=arguments.length,i=new Array(r>2?r-2:0),a=2;a<r;a++)i[a-2]=arguments[a];var o=i.map((function(e){if(null==e)return null;if("string"==typeof e)return e;if("number"==typeof e||"boolean"==typeof e)return e.toString();if(e instanceof Error)return e.message;try{return JSON.stringify(e)}catch(e){return null}})).filter((function(e){return e})).join(" ");n>=(null!=s?s:t.logLevel)&&e({level:Ie[n].toLowerCase(),message:o,args:i,type:t.name})}}}catch(e){r=!0,i=e}finally{try{n||null==o.return||o.return()}finally{if(r)throw i}}}var Oe={};Object.defineProperty(Oe,"__esModule",{value:!0}),Oe.default=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){Pe.default(e,t,n[t])}))}return e};var Pe=function(e){return e&&e.__esModule?e:{default:e}}(o("hKHmD"));var Le,Me;var Fe=new WeakMap,Ve=new WeakMap,Ue=new WeakMap,Be=new WeakMap,qe=new WeakMap;var je={get:function(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return Ve.get(e);if("objectStoreNames"===t)return e.objectStoreNames||Ue.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return ze(e[t])},set:function(e,t,n){return e[t]=n,!0},has:function(e,t){return e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e}};function Ge(t){return t!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(Me||(Me=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(t)?function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return t.apply(We(this),n),ze(Fe.get(this))}:function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return ze(t.apply(We(this),n))}:function(n){for(var r=arguments.length,i=new Array(r>1?r-1:0),a=1;a<r;a++)i[a-1]=arguments[a];var o,u=(o=t).call.apply(o,[We(this),n].concat(e(x)(i)));return Ue.set(u,n.sort?n.sort():[n]),ze(u)}}function Ke(e){return"function"==typeof e?Ge(e):(e instanceof IDBTransaction&&function(e){if(!Ve.has(e)){var t=new Promise((function(t,n){var r=function(){e.removeEventListener("complete",i),e.removeEventListener("error",a),e.removeEventListener("abort",a)},i=function(){t(),r()},a=function(){n(e.error||new DOMException("AbortError","AbortError")),r()};e.addEventListener("complete",i),e.addEventListener("error",a),e.addEventListener("abort",a)}));Ve.set(e,t)}}(e),t=e,(Le||(Le=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])).some((function(e){return t instanceof e}))?new Proxy(e,je):e);var t}function ze(e){if(e instanceof IDBRequest)return t=e,(n=new Promise((function(e,n){var r=function(){t.removeEventListener("success",i),t.removeEventListener("error",a)},i=function(){e(ze(t.result)),r()},a=function(){n(t.error),r()};t.addEventListener("success",i),t.addEventListener("error",a)}))).then((function(e){e instanceof IDBCursor&&Fe.set(e,t)})).catch((function(){})),qe.set(n,t),n;var t,n;if(Be.has(e))return Be.get(e);var r=Ke(e);return r!==e&&(Be.set(e,r),qe.set(r,e)),r}var We=function(e){return qe.get(e)};function He(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=n.blocked,i=n.upgrade,a=n.blocking,o=n.terminated,u=indexedDB.open(e,t),s=ze(u);return i&&u.addEventListener("upgradeneeded",(function(e){i(ze(u.result),e.oldVersion,e.newVersion,ze(u.transaction))})),r&&u.addEventListener("blocked",(function(){return r()})),s.then((function(e){o&&e.addEventListener("close",(function(){return o()})),a&&e.addEventListener("versionchange",(function(){return a()}))})).catch((function(){})),s}var Qe=["get","getKey","getAll","getAllKeys","count"],Ye=["put","add","delete","clear"],Je=new Map;function Xe(t,n){if(t instanceof IDBDatabase&&!(n in t)&&"string"==typeof n){if(Je.get(n))return Je.get(n);var r=n.replace(/FromIndex$/,""),i=n!==r,a=Ye.includes(r);if(r in(i?IDBIndex:IDBObjectStore).prototype&&(a||Qe.includes(r))){var o,u=(o=e(ve)(e(ye).mark((function t(n){var o,u,s,c,l,h,f=arguments;return e(ye).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:for(o=f.length,u=new Array(o>1?o-1:0),s=1;s<o;s++)u[s-1]=f[s];return l=this.transaction(n,a?"readwrite":"readonly"),h=l.store,i&&(h=h.index(u.shift())),t.next=7,Promise.all([(c=h)[r].apply(c,e(x)(u)),a&&l.done]);case 7:return t.abrupt("return",t.sent[0]);case 8:case"end":return t.stop()}}),t,this)}))),function(e){return o.apply(this,arguments)});return Je.set(n,u),u}}}je=function(t){return e(Oe)({},t,{get:function(e,n,r){return Xe(e,n)||t.get(e,n,r)},has:function(e,n){return!!Xe(e,n)||t.has(e,n)}})}(je);
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var Ze=function(){"use strict";function t(n){e(s)(this,t),this.container=n}return e(c)(t,[{key:"getPlatformInfoString",value:function(){return this.container.getProviders().map((function(e){if(function(e){var t=e.getComponent();return"VERSION"===(null==t?void 0:t.type)}(e)){var t=e.getImmediate();return"".concat(t.library,"/").concat(t.version)}return null})).filter((function(e){return e})).join(" ")}}]),t}();var $e,et,tt="@firebase/app",nt="0.7.33",rt=new De("@firebase/app"),it="[DEFAULT]",at=($e={},e(h)($e,tt,"fire-core"),e(h)($e,"@firebase/app-compat","fire-core-compat"),e(h)($e,"@firebase/analytics","fire-analytics"),e(h)($e,"@firebase/analytics-compat","fire-analytics-compat"),e(h)($e,"@firebase/app-check","fire-app-check"),e(h)($e,"@firebase/app-check-compat","fire-app-check-compat"),e(h)($e,"@firebase/auth","fire-auth"),e(h)($e,"@firebase/auth-compat","fire-auth-compat"),e(h)($e,"@firebase/database","fire-rtdb"),e(h)($e,"@firebase/database-compat","fire-rtdb-compat"),e(h)($e,"@firebase/functions","fire-fn"),e(h)($e,"@firebase/functions-compat","fire-fn-compat"),e(h)($e,"@firebase/installations","fire-iid"),e(h)($e,"@firebase/installations-compat","fire-iid-compat"),e(h)($e,"@firebase/messaging","fire-fcm"),e(h)($e,"@firebase/messaging-compat","fire-fcm-compat"),e(h)($e,"@firebase/performance","fire-perf"),e(h)($e,"@firebase/performance-compat","fire-perf-compat"),e(h)($e,"@firebase/remote-config","fire-rc"),e(h)($e,"@firebase/remote-config-compat","fire-rc-compat"),e(h)($e,"@firebase/storage","fire-gcs"),e(h)($e,"@firebase/storage-compat","fire-gcs-compat"),e(h)($e,"@firebase/firestore","fire-fst"),e(h)($e,"@firebase/firestore-compat","fire-fst-compat"),e(h)($e,"fire-js","fire-js"),e(h)($e,"firebase","fire-js-all"),$e),ot=new Map,ut=new Map;function st(e,t){try{e.container.addComponent(t)}catch(n){rt.debug("Component ".concat(t.name," failed to register with FirebaseApp ").concat(e.name),n)}}function ct(e,t){e.container.addOrOverwriteComponent(t)}function lt(e){var t=e.name;if(ut.has(t))return rt.debug("There were multiple attempts to register component ".concat(t,".")),!1;ut.set(t,e);var n=!0,r=!1,i=void 0;try{for(var a,o=ot.values()[Symbol.iterator]();!(n=(a=o.next()).done);n=!0){st(a.value,e)}}catch(e){r=!0,i=e}finally{try{n||null==o.return||o.return()}finally{if(r)throw i}}return!0}function ht(e,t){var n=e.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),e.container.getProvider(t)}function ft(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:it;ht(e,t).clearInstance(n)}function dt(){ut.clear()}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var vt=(et={},e(h)(et,"no-app","No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()"),e(h)(et,"bad-app-name","Illegal App name: '{$appName}"),e(h)(et,"duplicate-app","Firebase App named '{$appName}' already exists with different options or config"),e(h)(et,"app-deleted","Firebase App named '{$appName}' already deleted"),e(h)(et,"invalid-app-argument","firebase.{$appName}() takes either no argument or a Firebase App instance."),e(h)(et,"invalid-log-argument","First argument to `onLog` must be null or a function."),e(h)(et,"idb-open","Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}."),e(h)(et,"idb-get","Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}."),e(h)(et,"idb-set","Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}."),e(h)(et,"idb-delete","Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."),et),pt=new ee("app","Firebase",vt),yt=function(){"use strict";function t(n,r,i){var a=this;e(s)(this,t),this._isDeleted=!1,this._options=Object.assign({},n),this._config=Object.assign({},r),this._name=r.name,this._automaticDataCollectionEnabled=r.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new ge("app",(function(){return a}),"PUBLIC"))}return e(c)(t,[{key:"automaticDataCollectionEnabled",get:function(){return this.checkDestroyed(),this._automaticDataCollectionEnabled},set:function(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}},{key:"name",get:function(){return this.checkDestroyed(),this._name}},{key:"options",get:function(){return this.checkDestroyed(),this._options}},{key:"config",get:function(){return this.checkDestroyed(),this._config}},{key:"container",get:function(){return this._container}},{key:"isDeleted",get:function(){return this._isDeleted},set:function(e){this._isDeleted=e}},{key:"checkDestroyed",value:function(){if(this.isDeleted)throw pt.create("app-deleted",{appName:this._name})}}]),t}(),mt="9.10.0";function gt(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if("object"!=typeof t){var n=t;t={name:n}}var r=Object.assign({name:it,automaticDataCollectionEnabled:!1},t),i=r.name;if("string"!=typeof i||!i)throw pt.create("bad-app-name",{appName:String(i)});var a=ot.get(i);if(a){if(ae(e,a.options)&&ae(r,a.config))return a;throw pt.create("duplicate-app",{appName:i})}var o=new be(i),u=!0,s=!1,c=void 0;try{for(var l,h=ut.values()[Symbol.iterator]();!(u=(l=h.next()).done);u=!0){var f=l.value;o.addComponent(f)}}catch(e){s=!0,c=e}finally{try{u||null==h.return||h.return()}finally{if(s)throw c}}var d=new yt(e,r,o);return ot.set(i,d),d}function kt(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:it,t=ot.get(e);if(!t)throw pt.create("no-app",{appName:e});return t}function wt(){return Array.from(ot.values())}function bt(e){return xt.apply(this,arguments)}function xt(){return(xt=e(ve)(e(ye).mark((function t(n){var r;return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=n.name,!ot.has(r)){e.next=6;break}return ot.delete(r),e.next=5,Promise.all(n.container.getProviders().map((function(e){return e.delete()})));case 5:n.isDeleted=!0;case 6:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function It(e,t,n){var r,i=null!==(r=at[e])&&void 0!==r?r:e;n&&(i+="-".concat(n));var a=i.match(/\s|\//),o=t.match(/\s|\//);if(a||o){var u=['Unable to register library "'.concat(i,'" with version "').concat(t,'":')];return a&&u.push('library name "'.concat(i,'" contains illegal characters (whitespace or "/")')),a&&o&&u.push("and"),o&&u.push('version name "'.concat(t,'" contains illegal characters (whitespace or "/")')),void rt.warn(u.join(" "))}lt(new ge("".concat(i,"-version"),(function(){return{library:i,version:t}}),"VERSION"))}function _t(e,t){if(null!==e&&"function"!=typeof e)throw pt.create("invalid-log-argument");Re(e,t)}function Tt(e){var t;t=e,Te.forEach((function(e){e.setLogLevel(t)}))}
/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Et="firebase-heartbeat-store",St=null;function At(){return St||(St=He("firebase-heartbeat-database",1,{upgrade:function(e,t){if(0===t)e.createObjectStore(Et)}}).catch((function(e){throw pt.create("idb-open",{originalErrorMessage:e.message})}))),St}function Ct(e){return Nt.apply(this,arguments)}function Nt(){return(Nt=e(ve)(e(ye).mark((function t(n){var r,i,a;return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=1,e.next=4,At();case 4:return i=e.sent,e.abrupt("return",i.transaction(Et).objectStore(Et).get(Ot(n)));case 8:e.prev=8,e.t0=e.catch(1),e.t0 instanceof $?rt.warn(e.t0.message):(a=pt.create("idb-get",{originalErrorMessage:null===(r=e.t0)||void 0===r?void 0:r.message}),rt.warn(a.message));case 11:case"end":return e.stop()}}),t,null,[[1,8]])})))).apply(this,arguments)}function Dt(e,t){return Rt.apply(this,arguments)}function Rt(){return(Rt=e(ve)(e(ye).mark((function t(n,r){var i,a,o,u,s;return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=1,e.next=4,At();case 4:return a=e.sent,o=a.transaction(Et,"readwrite"),u=o.objectStore(Et),e.next=9,u.put(r,Ot(n));case 9:return e.abrupt("return",o.done);case 12:e.prev=12,e.t0=e.catch(1),e.t0 instanceof $?rt.warn(e.t0.message):(s=pt.create("idb-set",{originalErrorMessage:null===(i=e.t0)||void 0===i?void 0:i.message}),rt.warn(s.message));case 15:case"end":return e.stop()}}),t,null,[[1,12]])})))).apply(this,arguments)}function Ot(e){return"".concat(e.name,"!").concat(e.options.appId)}
/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Pt=function(){"use strict";function t(n){var r=this;e(s)(this,t),this.container=n,this._heartbeatsCache=null;var i=this.container.getProvider("app").getImmediate();this._storage=new Vt(i),this._heartbeatsCachePromise=this._storage.read().then((function(e){return r._heartbeatsCache=e,e}))}return e(c)(t,[{key:"triggerHeartbeat",value:function(){var t=this;return e(ve)(e(ye).mark((function n(){var r,i,a;return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.container.getProvider("platform-logger").getImmediate(),i=r.getPlatformInfoString(),a=Lt(),null!==t._heartbeatsCache){e.next=7;break}return e.next=6,t._heartbeatsCachePromise;case 6:t._heartbeatsCache=e.sent;case 7:if(t._heartbeatsCache.lastSentHeartbeatDate!==a&&!t._heartbeatsCache.heartbeats.some((function(e){return e.date===a}))){e.next=11;break}return e.abrupt("return");case 11:t._heartbeatsCache.heartbeats.push({date:a,agent:i});case 12:return t._heartbeatsCache.heartbeats=t._heartbeatsCache.heartbeats.filter((function(e){var t=new Date(e.date).valueOf();return Date.now()-t<=2592e6})),e.abrupt("return",t._storage.overwrite(t._heartbeatsCache));case 14:case"end":return e.stop()}}),n)})))()}},{key:"getHeartbeatsHeader",value:function(){var t=this;return e(ve)(e(ye).mark((function n(){var r,i,a,o,u;return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==t._heartbeatsCache){e.next=3;break}return e.next=3,t._heartbeatsCachePromise;case 3:if(null!==t._heartbeatsCache&&0!==t._heartbeatsCache.heartbeats.length){e.next=5;break}return e.abrupt("return","");case 5:if(r=Lt(),i=Mt(t._heartbeatsCache.heartbeats),a=i.heartbeatsToSend,o=i.unsentEntries,u=j(JSON.stringify({version:2,heartbeats:a})),t._heartbeatsCache.lastSentHeartbeatDate=r,!(o.length>0)){e.next=15;break}return t._heartbeatsCache.heartbeats=o,e.next=13,t._storage.overwrite(t._heartbeatsCache);case 13:e.next=16;break;case 15:t._heartbeatsCache.heartbeats=[],t._storage.overwrite(t._heartbeatsCache);case 16:return e.abrupt("return",u);case 17:case"end":return e.stop()}}),n)})))()}}]),t}();function Lt(){return(new Date).toISOString().substring(0,10)}function Mt(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1024,n=[],r=e.slice(),i=!0,a=!1,o=void 0;try{for(var u,s=function(e,i){var a=i.value,o=n.find((function(e){return e.agent===a.agent}));if(o){if(o.dates.push(a.date),Ut(n)>t)return o.dates.pop(),"break"}else if(n.push({agent:a.agent,dates:[a.date]}),Ut(n)>t)return n.pop(),"break";r=r.slice(1)},c=e[Symbol.iterator]();!(i=(u=c.next()).done);i=!0){var l=s(c,u);if("break"===l)break}}catch(e){a=!0,o=e}finally{try{i||null==c.return||c.return()}finally{if(a)throw o}}return{heartbeatsToSend:n,unsentEntries:r}}var Ft,Vt=function(){"use strict";function t(n){e(s)(this,t),this.app=n,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}return e(c)(t,[{key:"runIndexedDBEnvironmentCheck",value:function(){return e(ve)(e(ye).mark((function t(){return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Z()){e.next=4;break}return e.abrupt("return",!1);case 4:return e.abrupt("return",new Promise((function(e,t){try{var n=!0,r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=function(){i.result.close(),n||self.indexedDB.deleteDatabase(r),e(!0)},i.onupgradeneeded=function(){n=!1},i.onerror=function(){var e;t((null===(e=i.error)||void 0===e?void 0:e.message)||"")}}catch(e){t(e)}})).then((function(){return!0})).catch((function(){return!1})));case 5:case"end":return e.stop()}}),t)})))()}},{key:"read",value:function(){var t=this;return e(ve)(e(ye).mark((function n(){var r;return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t._canUseIndexedDBPromise;case 2:if(e.sent){e.next=7;break}return e.abrupt("return",{heartbeats:[]});case 7:return e.next=9,Ct(t.app);case 9:return r=e.sent,e.abrupt("return",r||{heartbeats:[]});case 11:case"end":return e.stop()}}),n)})))()}},{key:"overwrite",value:function(t){var n=this;return e(ve)(e(ye).mark((function r(){var i,a;return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=3,n._canUseIndexedDBPromise;case 3:if(e.sent){e.next=8;break}return e.abrupt("return");case 8:return e.next=10,n.read();case 10:return a=e.sent,e.abrupt("return",Dt(n.app,{lastSentHeartbeatDate:null!==(i=t.lastSentHeartbeatDate)&&void 0!==i?i:a.lastSentHeartbeatDate,heartbeats:t.heartbeats}));case 12:case"end":return e.stop()}}),r)})))()}},{key:"add",value:function(t){var n=this;return e(ve)(e(ye).mark((function r(){var i,a;return e(ye).wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=3,n._canUseIndexedDBPromise;case 3:if(r.sent){r.next=8;break}return r.abrupt("return");case 8:return r.next=10,n.read();case 10:return a=r.sent,r.abrupt("return",Dt(n.app,{lastSentHeartbeatDate:null!==(i=t.lastSentHeartbeatDate)&&void 0!==i?i:a.lastSentHeartbeatDate,heartbeats:e(x)(a.heartbeats).concat(e(x)(t.heartbeats))}));case 12:case"end":return r.stop()}}),r)})))()}}]),t}();function Ut(e){return j(JSON.stringify({version:2,heartbeats:e})).length}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Ft="",lt(new ge("platform-logger",(function(e){return new Ze(e)}),"PRIVATE")),lt(new ge("heartbeat",(function(e){return new Pt(e)}),"PRIVATE")),It(tt,nt,Ft),It(tt,nt,"esm2017"),It("fire-js","");
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var Bt,qt=function(){"use strict";function t(n,r){var i=this;e(s)(this,t),this._delegate=n,this.firebase=r,st(n,new ge("app-compat",(function(){return i}),"PUBLIC")),this.container=n.container}return e(c)(t,[{key:"automaticDataCollectionEnabled",get:function(){return this._delegate.automaticDataCollectionEnabled},set:function(e){this._delegate.automaticDataCollectionEnabled=e}},{key:"name",get:function(){return this._delegate.name}},{key:"options",get:function(){return this._delegate.options}},{key:"delete",value:function(){var e=this;return new Promise((function(t){e._delegate.checkDestroyed(),t()})).then((function(){return e.firebase.INTERNAL.removeApp(e.name),bt(e._delegate)}))}},{key:"_getService",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:it;this._delegate.checkDestroyed();var r=this._delegate.container.getProvider(e);return r.isInitialized()||"EXPLICIT"!==(null===(t=r.getComponent())||void 0===t?void 0:t.instantiationMode)||r.initialize(),r.getImmediate({identifier:n})}},{key:"_removeServiceInstance",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:it;this._delegate.container.getProvider(e).clearInstance(t)}},{key:"_addComponent",value:function(e){st(this._delegate,e)}},{key:"_addOrOverwriteComponent",value:function(e){ct(this._delegate,e)}},{key:"toJSON",value:function(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}}}]),t}(),jt=(Bt={},e(h)(Bt,"no-app","No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()"),e(h)(Bt,"invalid-app-argument","firebase.{$appName}() takes either no argument or a Firebase App instance."),Bt),Gt=new ee("app-compat","Firebase",jt);var Kt=
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function e(){var t=
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function(e){var t={},n={__esModule:!0,initializeApp:function(r){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=xe.initializeApp(r,i);if(re(t,a.name))return t[a.name];var o=new e(a,n);return t[a.name]=o,o},app:r,registerVersion:xe.registerVersion,setLogLevel:xe.setLogLevel,onLog:xe.onLog,apps:null,SDK_VERSION:xe.SDK_VERSION,INTERNAL:{registerComponent:function(t){var i=t.name,a=i.replace("-compat","");if(xe._registerComponent(t)&&"PUBLIC"===t.type){var o=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:r();if("function"!=typeof e[a])throw Gt.create("invalid-app-argument",{appName:i});return e[a]()};void 0!==t.serviceProps&&K(o,t.serviceProps),n[a]=o,e.prototype[a]=function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return this._getService.bind(this,i).apply(this,t.multipleInstances?n:[])}}return"PUBLIC"===t.type?n[a]:null},removeApp:function(e){delete t[e]},useAsService:function(e,t){return"serverAuth"===t?null:t},modularAPIs:xe}};function r(e){if(e=e||xe._DEFAULT_ENTRY_NAME,!re(t,e))throw Gt.create("no-app",{appName:e});return t[e]}return n.default=n,Object.defineProperty(n,"apps",{get:function(){return Object.keys(t).map((function(e){return t[e]}))}}),r.App=e,n}(qt);return t.INTERNAL=Object.assign(Object.assign({},t.INTERNAL),{createFirebaseNamespace:e,extendNamespace:function(e){K(t,e)},createSubscribe:le,ErrorFactory:ee,deepExtend:K}),t}(),zt=new De("@firebase/app-compat");
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
if("object"==typeof self&&self.self===self&&void 0!==self.firebase){zt.warn("\n    Warning: Firebase is already defined in the global scope. Please make sure\n    Firebase library is only loaded once.\n  ");var Wt=self.firebase.SDK_VERSION;Wt&&Wt.indexOf("LITE")>=0&&zt.warn("\n    Warning: You are trying to load Firebase while using Firebase Performance standalone script.\n    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.\n    ")}var Ht=Kt;!
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function(e){It("@firebase/app-compat","0.1.34",e)}();
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
Ht.registerVersion("firebase","9.10.0","app-compat");var Qt={};Object.defineProperty(Qt,"__esModule",{value:!0}),Qt.default=function(e,t,n){return Jt(e,t,n)};var Yt=function(e){return e&&e.__esModule?e:{default:e}}(o("2mz0K"));function Jt(e,t,n){return(Jt="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=Yt.default(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n||e):i.value}})(e,t,n)}var Xt=o("fVNic"),Zt={};Object.defineProperty(Zt,"__esModule",{value:!0}),Zt.default=function(e){return $t.default(e)||en.default(e)||nn.default(e,i)||tn.default()};var $t=rn(o("8slrw")),en=rn(o("7AJDX")),tn=rn(o("ifqQW")),nn=rn(o("auk6i"));function rn(e){return e&&e.__esModule?e:{default:e}}f=o("ds8z5"),h=o("hKHmD"),Xt=o("fVNic");function an(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}Object.create;Object.create;
/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var on="facebook.com",un="github.com",sn="google.com",cn="password",ln="twitter.com",hn="EMAIL_SIGNIN",fn="PASSWORD_RESET",dn="RECOVER_EMAIL",vn="REVERT_SECOND_FACTOR_ADDITION",pn="VERIFY_AND_CHANGE_EMAIL",yn="VERIFY_EMAIL";function mn(){return e(h)({},"dependent-sdk-initialized-before-auth","Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK.")}var gn=
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function(){var t;return t={},e(h)(t,"admin-restricted-operation","This operation is restricted to administrators only."),e(h)(t,"argument-error",""),e(h)(t,"app-not-authorized","This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console."),e(h)(t,"app-not-installed","The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device."),e(h)(t,"captcha-check-failed","The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains."),e(h)(t,"code-expired","The SMS code has expired. Please re-send the verification code to try again."),e(h)(t,"cordova-not-ready","Cordova framework is not ready."),e(h)(t,"cors-unsupported","This browser is not supported."),e(h)(t,"credential-already-in-use","This credential is already associated with a different user account."),e(h)(t,"custom-token-mismatch","The custom token corresponds to a different audience."),e(h)(t,"requires-recent-login","This operation is sensitive and requires recent authentication. Log in again before retrying this request."),e(h)(t,"dependent-sdk-initialized-before-auth","Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."),e(h)(t,"dynamic-link-not-activated","Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions."),e(h)(t,"email-change-needs-verification","Multi-factor users must always have a verified email."),e(h)(t,"email-already-in-use","The email address is already in use by another account."),e(h)(t,"emulator-config-failed",'Auth instance has already been used to make a network call. Auth can no longer be configured to use the emulator. Try calling "connectAuthEmulator()" sooner.'),e(h)(t,"expired-action-code","The action code has expired."),e(h)(t,"cancelled-popup-request","This operation has been cancelled due to another conflicting popup being opened."),e(h)(t,"internal-error","An internal AuthError has occurred."),e(h)(t,"invalid-app-credential","The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired."),e(h)(t,"invalid-app-id","The mobile app identifier is not registed for the current project."),e(h)(t,"invalid-user-token","This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key."),e(h)(t,"invalid-auth-event","An internal AuthError has occurred."),e(h)(t,"invalid-verification-code","The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure to use the verification code provided by the user."),e(h)(t,"invalid-continue-uri","The continue URL provided in the request is invalid."),e(h)(t,"invalid-cordova-configuration","The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme."),e(h)(t,"invalid-custom-token","The custom token format is incorrect. Please check the documentation."),e(h)(t,"invalid-dynamic-link-domain","The provided dynamic link domain is not configured or authorized for the current project."),e(h)(t,"invalid-email","The email address is badly formatted."),e(h)(t,"invalid-emulator-scheme","Emulator URL must start with a valid scheme (http:// or https://)."),e(h)(t,"invalid-api-key","Your API key is invalid, please check you have copied it correctly."),e(h)(t,"invalid-cert-hash","The SHA-1 certificate hash provided is invalid."),e(h)(t,"invalid-credential","The supplied auth credential is malformed or has expired."),e(h)(t,"invalid-message-payload","The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console."),e(h)(t,"invalid-multi-factor-session","The request does not contain a valid proof of first factor successful sign-in."),e(h)(t,"invalid-oauth-provider","EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers."),e(h)(t,"invalid-oauth-client-id","The OAuth client ID provided is either invalid or does not match the specified API key."),e(h)(t,"unauthorized-domain","This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console."),e(h)(t,"invalid-action-code","The action code is invalid. This can happen if the code is malformed, expired, or has already been used."),e(h)(t,"wrong-password","The password is invalid or the user does not have a password."),e(h)(t,"invalid-persistence-type","The specified persistence type is invalid. It can only be local, session or none."),e(h)(t,"invalid-phone-number","The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code]."),e(h)(t,"invalid-provider-id","The specified provider ID is invalid."),e(h)(t,"invalid-recipient-email","The email corresponding to this action failed to send as the provided recipient email address is invalid."),e(h)(t,"invalid-sender","The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console."),e(h)(t,"invalid-verification-id","The verification ID used to create the phone auth credential is invalid."),e(h)(t,"invalid-tenant-id","The Auth instance's tenant ID is invalid."),e(h)(t,"login-blocked","Login blocked by user-provided method: {$originalMessage}"),e(h)(t,"missing-android-pkg-name","An Android Package Name must be provided if the Android App is required to be installed."),e(h)(t,"auth-domain-config-required","Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console."),e(h)(t,"missing-app-credential","The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided."),e(h)(t,"missing-verification-code","The phone auth credential was created with an empty SMS verification code."),e(h)(t,"missing-continue-uri","A continue URL must be provided in the request."),e(h)(t,"missing-iframe-start","An internal AuthError has occurred."),e(h)(t,"missing-ios-bundle-id","An iOS Bundle ID must be provided if an App Store ID is provided."),e(h)(t,"missing-or-invalid-nonce","The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload."),e(h)(t,"missing-multi-factor-info","No second factor identifier is provided."),e(h)(t,"missing-multi-factor-session","The request is missing proof of first factor successful sign-in."),e(h)(t,"missing-phone-number","To send verification codes, provide a phone number for the recipient."),e(h)(t,"missing-verification-id","The phone auth credential was created with an empty verification ID."),e(h)(t,"app-deleted","This instance of FirebaseApp has been deleted."),e(h)(t,"multi-factor-info-not-found","The user does not have a second factor matching the identifier provided."),e(h)(t,"multi-factor-auth-required","Proof of ownership of a second factor is required to complete sign-in."),e(h)(t,"account-exists-with-different-credential","An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address."),e(h)(t,"network-request-failed","A network AuthError (such as timeout, interrupted connection or unreachable host) has occurred."),e(h)(t,"no-auth-event","An internal AuthError has occurred."),e(h)(t,"no-such-provider","User was not linked to an account with the given provider."),e(h)(t,"null-user","A null user object was provided as the argument for an operation which requires a non-null user object."),e(h)(t,"operation-not-allowed","The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section."),e(h)(t,"operation-not-supported-in-this-environment",'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.'),e(h)(t,"popup-blocked","Unable to establish a connection with the popup. It may have been blocked by the browser."),e(h)(t,"popup-closed-by-user","The popup has been closed by the user before finalizing the operation."),e(h)(t,"provider-already-linked","User can only be linked to one identity for the given provider."),e(h)(t,"quota-exceeded","The project's quota for this operation has been exceeded."),e(h)(t,"redirect-cancelled-by-user","The redirect operation has been cancelled by the user before finalizing."),e(h)(t,"redirect-operation-pending","A redirect sign-in operation is already pending."),e(h)(t,"rejected-credential","The request contains malformed or mismatching credentials."),e(h)(t,"second-factor-already-in-use","The second factor is already enrolled on this account."),e(h)(t,"maximum-second-factor-count-exceeded","The maximum allowed number of second factors on a user has been exceeded."),e(h)(t,"tenant-id-mismatch","The provided tenant ID does not match the Auth instance's tenant ID"),e(h)(t,"timeout","The operation has timed out."),e(h)(t,"user-token-expired","The user's credential is no longer valid. The user must sign in again."),e(h)(t,"too-many-requests","We have blocked all requests from this device due to unusual activity. Try again later."),e(h)(t,"unauthorized-continue-uri","The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console."),e(h)(t,"unsupported-first-factor","Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor."),e(h)(t,"unsupported-persistence-type","The current environment does not support the specified persistence type."),e(h)(t,"unsupported-tenant-operation","This operation is not supported in a multi-tenant context."),e(h)(t,"unverified-email","The operation requires a verified email."),e(h)(t,"user-cancelled","The user did not grant your application the permissions it requested."),e(h)(t,"user-not-found","There is no user record corresponding to this identifier. The user may have been deleted."),e(h)(t,"user-disabled","The user account has been disabled by an administrator."),e(h)(t,"user-mismatch","The supplied credentials do not correspond to the previously signed in user."),e(h)(t,"user-signed-out",""),e(h)(t,"weak-password","The password must be 6 characters long or more."),e(h)(t,"web-storage-unsupported","This browser is not supported or 3rd party cookies and data may be disabled."),e(h)(t,"already-initialized","initializeAuth() has already been called with different options. To avoid this error, call initializeAuth() with the same options as when it was originally called, or call getAuth() to return the already initialized instance."),t},kn=mn,wn=new ee("auth","Firebase",mn()),bn=new De("@firebase/auth");function xn(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];var a;bn.logLevel<=Ie.ERROR&&(a=bn).error.apply(a,["Auth (".concat(mt,"): ").concat(t)].concat(e(x)(r)))}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function In(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];throw Sn.apply(void 0,[t].concat(e(x)(r)))}function _n(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return Sn.apply(void 0,[t].concat(e(x)(r)))}function Tn(t,n,r){var i=Object.assign(Object.assign({},kn()),e(h)({},n,r));return new ee("auth","Firebase",i).create(n,{appName:t.name})}function En(e,t,n){if(!(t instanceof n))throw n.name!==t.constructor.name&&In(e,"argument-error"),Tn(e,"argument-error","Type of ".concat(t.constructor.name," does not match expected instance.")+"Did you pass a reference from a different Auth SDK?")}function Sn(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];var a;if("string"!=typeof t){var o,u=r[0],s=e(x)(r.slice(1));return s[0]&&(s[0].appName=t.name),(o=t._errorFactory).create.apply(o,[u].concat(e(x)(s)))}return(a=wn).create.apply(a,[t].concat(e(x)(r)))}function An(t,n){for(var r=arguments.length,i=new Array(r>2?r-2:0),a=2;a<r;a++)i[a-2]=arguments[a];if(!t)throw Sn.apply(void 0,[n].concat(e(x)(i)))}function Cn(e){var t="INTERNAL ASSERTION FAILED: "+e;throw xn(t),new Error(t)}function Nn(e,t){e||Cn(t)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Dn=new Map;function Rn(e){Nn(e instanceof Function,"Expected a class definition");var t=Dn.get(e);return t?(Nn(t instanceof e,"Instance stored in cache mismatched with class"),t):(t=new e,Dn.set(e,t),t)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function On(){var e;return"undefined"!=typeof self&&(null===(e=self.location)||void 0===e?void 0:e.href)||""}function Pn(){return"http:"===Ln()||"https:"===Ln()}function Ln(){var e;return"undefined"!=typeof self&&(null===(e=self.location)||void 0===e?void 0:e.protocol)||null}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var Mn=function(){"use strict";function t(n,r){e(s)(this,t),this.shortDelay=n,this.longDelay=r,Nn(r>n,"Short delay should be less than long delay!"),this.isMobile="undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(H())||J()}return e(c)(t,[{key:"get",value:function(){return"undefined"!=typeof navigator&&navigator&&"onLine"in navigator&&"boolean"==typeof navigator.onLine&&(Pn()||Y()||"connection"in navigator)&&!navigator.onLine?Math.min(5e3,this.shortDelay):this.isMobile?this.longDelay:this.shortDelay}}]),t}();
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fn(e,t){Nn(e.emulator,"Emulator should always be set here");var n=e.emulator.url;return t?"".concat(n).concat(t.startsWith("/")?t.slice(1):t):n}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Vn,Un=function(){"use strict";function t(){e(s)(this,t)}return e(c)(t,null,[{key:"initialize",value:function(e,t,n){this.fetchImpl=e,t&&(this.headersImpl=t),n&&(this.responseImpl=n)}},{key:"fetch",value:function(){return this.fetchImpl?this.fetchImpl:"undefined"!=typeof self&&"fetch"in self?self.fetch:void Cn("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}},{key:"headers",value:function(){return this.headersImpl?this.headersImpl:"undefined"!=typeof self&&"Headers"in self?self.Headers:void Cn("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}},{key:"response",value:function(){return this.responseImpl?this.responseImpl:"undefined"!=typeof self&&"Response"in self?self.Response:void Cn("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}]),t}(),Bn=(Vn={},e(h)(Vn,"CREDENTIAL_MISMATCH","custom-token-mismatch"),e(h)(Vn,"MISSING_CUSTOM_TOKEN","internal-error"),e(h)(Vn,"INVALID_IDENTIFIER","invalid-email"),e(h)(Vn,"MISSING_CONTINUE_URI","internal-error"),e(h)(Vn,"INVALID_PASSWORD","wrong-password"),e(h)(Vn,"MISSING_PASSWORD","internal-error"),e(h)(Vn,"EMAIL_EXISTS","email-already-in-use"),e(h)(Vn,"PASSWORD_LOGIN_DISABLED","operation-not-allowed"),e(h)(Vn,"INVALID_IDP_RESPONSE","invalid-credential"),e(h)(Vn,"INVALID_PENDING_TOKEN","invalid-credential"),e(h)(Vn,"FEDERATED_USER_ID_ALREADY_LINKED","credential-already-in-use"),e(h)(Vn,"MISSING_REQ_TYPE","internal-error"),e(h)(Vn,"EMAIL_NOT_FOUND","user-not-found"),e(h)(Vn,"RESET_PASSWORD_EXCEED_LIMIT","too-many-requests"),e(h)(Vn,"EXPIRED_OOB_CODE","expired-action-code"),e(h)(Vn,"INVALID_OOB_CODE","invalid-action-code"),e(h)(Vn,"MISSING_OOB_CODE","internal-error"),e(h)(Vn,"CREDENTIAL_TOO_OLD_LOGIN_AGAIN","requires-recent-login"),e(h)(Vn,"INVALID_ID_TOKEN","invalid-user-token"),e(h)(Vn,"TOKEN_EXPIRED","user-token-expired"),e(h)(Vn,"USER_NOT_FOUND","user-token-expired"),e(h)(Vn,"TOO_MANY_ATTEMPTS_TRY_LATER","too-many-requests"),e(h)(Vn,"INVALID_CODE","invalid-verification-code"),e(h)(Vn,"INVALID_SESSION_INFO","invalid-verification-id"),e(h)(Vn,"INVALID_TEMPORARY_PROOF","invalid-credential"),e(h)(Vn,"MISSING_SESSION_INFO","missing-verification-id"),e(h)(Vn,"SESSION_EXPIRED","code-expired"),e(h)(Vn,"MISSING_ANDROID_PACKAGE_NAME","missing-android-pkg-name"),e(h)(Vn,"UNAUTHORIZED_DOMAIN","unauthorized-continue-uri"),e(h)(Vn,"INVALID_OAUTH_CLIENT_ID","invalid-oauth-client-id"),e(h)(Vn,"ADMIN_ONLY_OPERATION","admin-restricted-operation"),e(h)(Vn,"INVALID_MFA_PENDING_CREDENTIAL","invalid-multi-factor-session"),e(h)(Vn,"MFA_ENROLLMENT_NOT_FOUND","multi-factor-info-not-found"),e(h)(Vn,"MISSING_MFA_ENROLLMENT_ID","missing-multi-factor-info"),e(h)(Vn,"MISSING_MFA_PENDING_CREDENTIAL","missing-multi-factor-session"),e(h)(Vn,"SECOND_FACTOR_EXISTS","second-factor-already-in-use"),e(h)(Vn,"SECOND_FACTOR_LIMIT_EXCEEDED","maximum-second-factor-count-exceeded"),e(h)(Vn,"BLOCKING_FUNCTION_ERROR_RESPONSE","internal-error"),Vn),qn=new Mn(3e4,6e4);function jn(e,t){return e.tenantId&&!t.tenantId?Object.assign(Object.assign({},t),{tenantId:e.tenantId}):t}function Gn(e,t,n,r){return Kn.apply(this,arguments)}function Kn(){return Kn=e(ve)(e(ye).mark((function t(n,r,i,a){var o,u=arguments;return e(ye).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=u.length>4&&void 0!==u[4]?u[4]:{},t.abrupt("return",zn(n,o,e(ve)(e(ye).mark((function t(){var o,u,s,c;return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o={},u={},a&&("GET"===r?u=a:o={body:JSON.stringify(a)}),s=ue(Object.assign({key:n.config.apiKey},u)).slice(1),e.next=6,n._getAdditionalHeaders();case 6:return(c=e.sent)["Content-Type"]="application/json",n.languageCode&&(c["X-Firebase-Locale"]=n.languageCode),e.abrupt("return",Un.fetch()(Yn(n,n.config.apiHost,i,s),Object.assign({method:r,headers:c,referrerPolicy:"no-referrer"},o)));case 10:case"end":return e.stop()}}),t)})))));case 2:case"end":return t.stop()}}),t)}))),Kn.apply(this,arguments)}function zn(e,t,n){return Wn.apply(this,arguments)}function Wn(){return(Wn=e(ve)(e(ye).mark((function t(n,r,i){var a,o,u,s,c,l,h,f,d;return e(ye).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n._canInitEmulator=!1,a=Object.assign(Object.assign({},Bn),r),t.prev=2,o=new Jn(n),t.next=6,Promise.race([i(),o.promise]);case 6:return u=t.sent,o.clearNetworkTimeout(),t.next=10,u.json();case 10:if(!("needConfirmation"in(s=t.sent))){t.next=13;break}throw Xn(n,"account-exists-with-different-credential",s);case 13:if(!u.ok||"errorMessage"in s){t.next=17;break}return t.abrupt("return",s);case 17:if(c=u.ok?s.errorMessage:s.error.message,l=e(y)(c.split(" : "),2),h=l[0],f=l[1],"FEDERATED_USER_ID_ALREADY_LINKED"!==h){t.next=23;break}throw Xn(n,"credential-already-in-use",s);case 23:if("EMAIL_EXISTS"!==h){t.next=27;break}throw Xn(n,"email-already-in-use",s);case 27:if("USER_DISABLED"!==h){t.next=29;break}throw Xn(n,"user-disabled",s);case 29:if(d=a[h]||h.toLowerCase().replace(/[_\s]+/g,"-"),!f){t.next=34;break}throw Tn(n,d,f);case 34:In(n,d);case 35:t.next=42;break;case 37:if(t.prev=37,t.t0=t.catch(2),!(t.t0 instanceof $)){t.next=41;break}throw t.t0;case 41:In(n,"network-request-failed");case 42:case"end":return t.stop()}}),t,null,[[2,37]])})))).apply(this,arguments)}function Hn(e,t,n,r){return Qn.apply(this,arguments)}function Qn(){return Qn=e(ve)(e(ye).mark((function t(n,r,i,a){var o,u,s=arguments;return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=s.length>4&&void 0!==s[4]?s[4]:{},e.next=3,Gn(n,r,i,a,o);case 3:return"mfaPendingCredential"in(u=e.sent)&&In(n,"multi-factor-auth-required",{_serverResponse:u}),e.abrupt("return",u);case 6:case"end":return e.stop()}}),t)}))),Qn.apply(this,arguments)}function Yn(e,t,n,r){var i="".concat(t).concat(n,"?").concat(r);return e.config.emulator?Fn(e.config,i):"".concat(e.config.apiScheme,"://").concat(i)}var Jn=function(){"use strict";function t(n){var r=this;e(s)(this,t),this.auth=n,this.timer=null,this.promise=new Promise((function(e,t){var n=r;r.timer=setTimeout((function(){return t(_n(n.auth,"network-request-failed"))}),qn.get())}))}return e(c)(t,[{key:"clearNetworkTimeout",value:function(){clearTimeout(this.timer)}}]),t}();function Xn(e,t,n){var r={appName:e.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);var i=_n(e,t,r);return i.customData._tokenResponse=n,i}function Zn(e,t){return $n.apply(this,arguments)}function $n(){return($n=
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
e(ve)(e(ye).mark((function t(n,r){return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Gn(n,"POST","/v1/accounts:delete",r));case 1:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function er(e,t){return tr.apply(this,arguments)}function tr(){return(tr=e(ve)(e(ye).mark((function t(n,r){return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Gn(n,"POST","/v1/accounts:update",r));case 1:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function nr(e,t){return rr.apply(this,arguments)}function rr(){return(rr=e(ve)(e(ye).mark((function t(n,r){return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Gn(n,"POST","/v1/accounts:lookup",r));case 1:case"end":return e.stop()}}),t)})))).apply(this,arguments)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ir(e){if(e)try{var t=new Date(Number(e));if(!isNaN(t.getTime()))return t.toUTCString()}catch(e){}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ar(){return ar=e(ve)(e(ye).mark((function t(n){var r,i,a,o,u,s,c=arguments;return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=c.length>1&&void 0!==c[1]&&c[1],i=de(n),e.next=4,i.getIdToken(r);case 4:return a=e.sent,An((o=ur(a))&&o.exp&&o.auth_time&&o.iat,i.auth,"internal-error"),u="object"==typeof o.firebase?o.firebase:void 0,s=null==u?void 0:u.sign_in_provider,e.abrupt("return",{claims:o,token:a,authTime:ir(or(o.auth_time)),issuedAtTime:ir(or(o.iat)),expirationTime:ir(or(o.exp)),signInProvider:s||null,signInSecondFactor:(null==u?void 0:u.sign_in_second_factor)||null});case 10:case"end":return e.stop()}}),t)}))),ar.apply(this,arguments)}function or(e){return 1e3*Number(e)}function ur(t){var n,r=e(y)(t.split("."),3),i=r[0],a=r[1],o=r[2];if(void 0===i||void 0===a||void 0===o)return xn("JWT malformed, contained fewer than 3 sections"),null;try{var u=G(a);return u?JSON.parse(u):(xn("Failed to decode base64 JWT payload"),null)}catch(e){return xn("Caught error parsing JWT payload as JSON",null===(n=e)||void 0===n?void 0:n.toString()),null}}function sr(e,t){return cr.apply(this,arguments)}function cr(){return cr=
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
e(ve)(e(ye).mark((function t(n,r){var i=arguments;return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(i.length>2&&void 0!==i[2]&&i[2])){e.next=3;break}return e.abrupt("return",r);case 3:return e.prev=3,e.next=6,r;case 6:return e.abrupt("return",e.sent);case 9:if(e.prev=9,e.t0=e.catch(3),!(e.t0 instanceof $&&lr(e.t0))){e.next=15;break}if(n.auth.currentUser!==n){e.next=15;break}return e.next=15,n.auth.signOut();case 15:throw e.t0;case 16:case"end":return e.stop()}}),t,null,[[3,9]])}))),cr.apply(this,arguments)}function lr(e){var t=e.code;return"auth/user-disabled"===t||"auth/user-token-expired"===t}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var hr=function(){"use strict";function t(n){e(s)(this,t),this.user=n,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}return e(c)(t,[{key:"_start",value:function(){this.isRunning||(this.isRunning=!0,this.schedule())}},{key:"_stop",value:function(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}},{key:"getInterval",value:function(e){var t;if(e){var n=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),n}this.errorBackoff=3e4;var r=(null!==(t=this.user.stsTokenManager.expirationTime)&&void 0!==t?t:0)-Date.now()-3e5;return Math.max(0,r)}},{key:"schedule",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.isRunning){var n=this.getInterval(t),r=this;this.timerId=setTimeout(e(ve)(e(ye).mark((function t(){return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.iteration();case 2:case"end":return e.stop()}}),t)}))),n)}}},{key:"iteration",value:function(){var t=this;return e(ve)(e(ye).mark((function n(){var r;return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=1,e.next=4,t.user.getIdToken(!0);case 4:e.next=10;break;case 6:return e.prev=6,e.t0=e.catch(1),"auth/network-request-failed"===(null===(r=e.t0)||void 0===r?void 0:r.code)&&t.schedule(!0),e.abrupt("return");case 10:t.schedule();case 11:case"end":return e.stop()}}),n,null,[[1,6]])})))()}}]),t}(),fr=function(){"use strict";function t(n,r){e(s)(this,t),this.createdAt=n,this.lastLoginAt=r,this._initializeTime()}return e(c)(t,[{key:"_initializeTime",value:function(){this.lastSignInTime=ir(this.lastLoginAt),this.creationTime=ir(this.createdAt)}},{key:"_copy",value:function(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}},{key:"toJSON",value:function(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}]),t}();
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dr(e){return vr.apply(this,arguments)}function vr(){return(vr=
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
e(ve)(e(ye).mark((function t(n){var r,i,a,o,u,s,c,l,h,f,d;return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=n.auth,e.next=4,n.getIdToken();case 4:return a=e.sent,e.next=7,sr(n,nr(i,{idToken:a}));case 7:An(null==(o=e.sent)?void 0:o.users.length,i,"internal-error"),u=o.users[0],n._notifyReloadListener(u),s=(null===(r=u.providerUserInfo)||void 0===r?void 0:r.length)?mr(u.providerUserInfo):[],c=yr(n.providerData,s),l=n.isAnonymous,h=!(n.email&&u.passwordHash||(null==c?void 0:c.length)),f=!!l&&h,d={uid:u.localId,displayName:u.displayName||null,photoURL:u.photoUrl||null,email:u.email||null,emailVerified:u.emailVerified||!1,phoneNumber:u.phoneNumber||null,tenantId:u.tenantId||null,providerData:c,metadata:new fr(u.createdAt,u.lastLoginAt),isAnonymous:f},Object.assign(n,d);case 18:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function pr(){return(pr=e(ve)(e(ye).mark((function t(n){var r;return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=de(n),e.next=3,dr(r);case 3:return e.next=5,r.auth._persistUserIfCurrent(r);case 5:r.auth._notifyListenersIfCurrent(r);case 6:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function yr(t,n){var r=t.filter((function(e){return!n.some((function(t){return t.providerId===e.providerId}))}));return e(x)(r).concat(e(x)(n))}function mr(e){return e.map((function(e){var t=e.providerId,n=an(e,["providerId"]);return{providerId:t,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}}))}function gr(e,t){return kr.apply(this,arguments)}function kr(){return(kr=
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
e(ve)(e(ye).mark((function t(n,r){var i;return e(ye).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,zn(n,{},e(ve)(e(ye).mark((function t(){var i,a,o,u,s,c;return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=ue({grant_type:"refresh_token",refresh_token:r}).slice(1),a=n.config,o=a.tokenApiHost,u=a.apiKey,s=Yn(n,o,"/v1/token","key=".concat(u)),e.next=5,n._getAdditionalHeaders();case 5:return(c=e.sent)["Content-Type"]="application/x-www-form-urlencoded",e.abrupt("return",Un.fetch()(s,{method:"POST",headers:c,body:i}));case 8:case"end":return e.stop()}}),t)}))));case 2:return i=t.sent,t.abrupt("return",{accessToken:i.access_token,expiresIn:i.expires_in,refreshToken:i.refresh_token});case 4:case"end":return t.stop()}}),t)})))).apply(this,arguments)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var wr=function(){"use strict";function t(){e(s)(this,t),this.refreshToken=null,this.accessToken=null,this.expirationTime=null}return e(c)(t,[{key:"isExpired",get:function(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}},{key:"updateFromServerResponse",value:function(e){An(e.idToken,"internal-error"),An(void 0!==e.idToken,"internal-error"),An(void 0!==e.refreshToken,"internal-error");var t,n,r="expiresIn"in e&&void 0!==e.expiresIn?Number(e.expiresIn):(t=e.idToken,An(n=ur(t),"internal-error"),An(void 0!==n.exp,"internal-error"),An(void 0!==n.iat,"internal-error"),Number(n.exp)-Number(n.iat));this.updateTokensAndExpiration(e.idToken,e.refreshToken,r)}},{key:"getToken",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=this;return e(ve)(e(ye).mark((function i(){return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(An(!r.accessToken||r.refreshToken,t,"user-token-expired"),n||!r.accessToken||r.isExpired){e.next=3;break}return e.abrupt("return",r.accessToken);case 3:if(!r.refreshToken){e.next=7;break}return e.next=6,r.refresh(t,r.refreshToken);case 6:return e.abrupt("return",r.accessToken);case 7:return e.abrupt("return",null);case 8:case"end":return e.stop()}}),i)})))()}},{key:"clearRefreshToken",value:function(){this.refreshToken=null}},{key:"refresh",value:function(t,n){var r=this;return e(ve)(e(ye).mark((function i(){var a,o,u,s;return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,gr(t,n);case 2:a=e.sent,o=a.accessToken,u=a.refreshToken,s=a.expiresIn,r.updateTokensAndExpiration(o,u,Number(s));case 7:case"end":return e.stop()}}),i)})))()}},{key:"updateTokensAndExpiration",value:function(e,t,n){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+1e3*n}},{key:"toJSON",value:function(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}},{key:"_assign",value:function(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}},{key:"_clone",value:function(){return Object.assign(new t,this.toJSON())}},{key:"_performRefresh",value:function(){return Cn("not implemented")}}],[{key:"fromJSON",value:function(e,n){var r=n.refreshToken,i=n.accessToken,a=n.expirationTime,o=new t;return r&&(An("string"==typeof r,"internal-error",{appName:e}),o.refreshToken=r),i&&(An("string"==typeof i,"internal-error",{appName:e}),o.accessToken=i),a&&(An("number"==typeof a,"internal-error",{appName:e}),o.expirationTime=a),o}}]),t}();
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function br(e,t){An("string"==typeof e||void 0===e,"internal-error",{appName:t})}var xr=function(){"use strict";function t(n){e(s)(this,t);var r=n.uid,i=n.auth,a=n.stsTokenManager,o=an(n,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new hr(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=r,this.auth=i,this.stsTokenManager=a,this.accessToken=a.accessToken,this.displayName=o.displayName||null,this.email=o.email||null,this.emailVerified=o.emailVerified||!1,this.phoneNumber=o.phoneNumber||null,this.photoURL=o.photoURL||null,this.isAnonymous=o.isAnonymous||!1,this.tenantId=o.tenantId||null,this.providerData=o.providerData?e(x)(o.providerData):[],this.metadata=new fr(o.createdAt||void 0,o.lastLoginAt||void 0)}return e(c)(t,[{key:"getIdToken",value:function(t){var n=this;return e(ve)(e(ye).mark((function r(){var i;return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,sr(n,n.stsTokenManager.getToken(n.auth,t));case 2:if(An(i=e.sent,n.auth,"internal-error"),n.accessToken===i){e.next=9;break}return n.accessToken=i,e.next=8,n.auth._persistUserIfCurrent(n);case 8:n.auth._notifyListenersIfCurrent(n);case 9:return e.abrupt("return",i);case 10:case"end":return e.stop()}}),r)})))()}},{key:"getIdTokenResult",value:function(e){return function(e){return ar.apply(this,arguments)}(this,e)}},{key:"reload",value:function(){return function(e){return pr.apply(this,arguments)}(this)}},{key:"_assign",value:function(e){this!==e&&(An(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map((function(e){return Object.assign({},e)})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}},{key:"_clone",value:function(e){return new t(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}))}},{key:"_onReload",value:function(e){An(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}},{key:"_notifyReloadListener",value:function(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}},{key:"_startProactiveRefresh",value:function(){this.proactiveRefresh._start()}},{key:"_stopProactiveRefresh",value:function(){this.proactiveRefresh._stop()}},{key:"_updateTokensIfNecessary",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=this;return e(ve)(e(ye).mark((function i(){var a;return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=!1,t.idToken&&t.idToken!==r.stsTokenManager.accessToken&&(r.stsTokenManager.updateFromServerResponse(t),a=!0),!n){e.next=5;break}return e.next=5,dr(r);case 5:return e.next=7,r.auth._persistUserIfCurrent(r);case 7:a&&r.auth._notifyListenersIfCurrent(r);case 8:case"end":return e.stop()}}),i)})))()}},{key:"delete",value:function(){var t=this;return e(ve)(e(ye).mark((function n(){var r;return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getIdToken();case 2:return r=e.sent,e.next=5,sr(t,Zn(t.auth,{idToken:r}));case 5:return t.stsTokenManager.clearRefreshToken(),e.abrupt("return",t.auth.signOut());case 7:case"end":return e.stop()}}),n)})))()}},{key:"toJSON",value:function(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map((function(e){return Object.assign({},e)})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}},{key:"refreshToken",get:function(){return this.stsTokenManager.refreshToken||""}}],[{key:"_fromJSON",value:function(e,n){var r,i,a,o,u,s,c,l,h=null!==(r=n.displayName)&&void 0!==r?r:void 0,f=null!==(i=n.email)&&void 0!==i?i:void 0,d=null!==(a=n.phoneNumber)&&void 0!==a?a:void 0,v=null!==(o=n.photoURL)&&void 0!==o?o:void 0,p=null!==(u=n.tenantId)&&void 0!==u?u:void 0,y=null!==(s=n._redirectEventId)&&void 0!==s?s:void 0,m=null!==(c=n.createdAt)&&void 0!==c?c:void 0,g=null!==(l=n.lastLoginAt)&&void 0!==l?l:void 0,k=n.uid,w=n.emailVerified,b=n.isAnonymous,x=n.providerData,I=n.stsTokenManager;An(k&&I,e,"internal-error");var _=wr.fromJSON(this.name,I);An("string"==typeof k,e,"internal-error"),br(h,e.name),br(f,e.name),An("boolean"==typeof w,e,"internal-error"),An("boolean"==typeof b,e,"internal-error"),br(d,e.name),br(v,e.name),br(p,e.name),br(y,e.name),br(m,e.name),br(g,e.name);var T=new t({uid:k,auth:e,email:f,emailVerified:w,displayName:h,isAnonymous:b,photoURL:v,phoneNumber:d,tenantId:p,stsTokenManager:_,createdAt:m,lastLoginAt:g});return x&&Array.isArray(x)&&(T.providerData=x.map((function(e){return Object.assign({},e)}))),y&&(T._redirectEventId=y),T}},{key:"_fromIdTokenResponse",value:function(n,r){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return e(ve)(e(ye).mark((function a(){var o,u;return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(o=new wr).updateFromServerResponse(r),u=new t({uid:r.localId,auth:n,stsTokenManager:o,isAnonymous:i}),e.next=5,dr(u);case 5:return e.abrupt("return",u);case 6:case"end":return e.stop()}}),a)})))()}}]),t}(),Ir=function(){"use strict";function t(){e(s)(this,t),this.type="NONE",this.storage={}}return e(c)(t,[{key:"_isAvailable",value:function(){return e(ve)(e(ye).mark((function t(){return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",!0);case 1:case"end":return e.stop()}}),t)})))()}},{key:"_set",value:function(t,n){var r=this;return e(ve)(e(ye).mark((function i(){return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r.storage[t]=n;case 1:case"end":return e.stop()}}),i)})))()}},{key:"_get",value:function(t){var n=this;return e(ve)(e(ye).mark((function r(){var i;return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=n.storage[t],e.abrupt("return",void 0===i?null:i);case 2:case"end":return e.stop()}}),r)})))()}},{key:"_remove",value:function(t){var n=this;return e(ve)(e(ye).mark((function r(){return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:delete n.storage[t];case 1:case"end":return e.stop()}}),r)})))()}},{key:"_addListener",value:function(e,t){}},{key:"_removeListener",value:function(e,t){}}]),t}();
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Ir.type="NONE";var _r=Ir;
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Tr(e,t,n){return"firebase:".concat(e,":").concat(t,":").concat(n)}var Er=function(){"use strict";function t(n,r,i){e(s)(this,t),this.persistence=n,this.auth=r,this.userKey=i;var a=this.auth,o=a.config,u=a.name;this.fullUserKey=Tr(this.userKey,o.apiKey,u),this.fullPersistenceKey=Tr("persistence",o.apiKey,u),this.boundEventHandler=r._onStorageEvent.bind(r),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}return e(c)(t,[{key:"setCurrentUser",value:function(e){return this.persistence._set(this.fullUserKey,e.toJSON())}},{key:"getCurrentUser",value:function(){var t=this;return e(ve)(e(ye).mark((function n(){var r;return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.persistence._get(t.fullUserKey);case 2:return r=e.sent,e.abrupt("return",r?xr._fromJSON(t.auth,r):null);case 4:case"end":return e.stop()}}),n)})))()}},{key:"removeCurrentUser",value:function(){return this.persistence._remove(this.fullUserKey)}},{key:"savePersistenceForRedirect",value:function(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}},{key:"setPersistence",value:function(t){var n=this;return e(ve)(e(ye).mark((function r(){var i;return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.persistence!==t){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,n.getCurrentUser();case 4:return i=e.sent,e.next=7,n.removeCurrentUser();case 7:if(n.persistence=t,!i){e.next=10;break}return e.abrupt("return",n.setCurrentUser(i));case 10:case"end":return e.stop()}}),r)})))()}},{key:"delete",value:function(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}}],[{key:"create",value:function(n,r){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"authUser";return e(ve)(e(ye).mark((function a(){var o,u,s,c,l,h,f,d,v,p,y,m,g;return e(ye).wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(r.length){a.next=2;break}return a.abrupt("return",new t(Rn(_r),n,i));case 2:return a.next=4,Promise.all(r.map(function(){var t=e(ve)(e(ye).mark((function t(n){return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n._isAvailable();case 2:if(!e.sent){e.next=4;break}return e.abrupt("return",n);case 4:return e.abrupt("return",void 0);case 5:case"end":return e.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()));case 4:o=a.sent.filter((function(e){return e})),u=o[0]||Rn(_r),s=Tr(i,n.config.apiKey,n.name),c=null,l=!0,h=!1,f=void 0,a.prev=9,d=r[Symbol.iterator]();case 11:if(l=(v=d.next()).done){a.next=29;break}return p=v.value,a.prev=13,a.next=16,p._get(s);case 16:if(!(y=a.sent)){a.next=22;break}return m=xr._fromJSON(n,y),p!==u&&(c=m),u=p,a.abrupt("break",29);case 22:a.next=26;break;case 24:a.prev=24,a.t0=a.catch(13);case 26:l=!0,a.next=11;break;case 29:a.next=35;break;case 31:a.prev=31,a.t1=a.catch(9),h=!0,f=a.t1;case 35:a.prev=35,a.prev=36,l||null==d.return||d.return();case 38:if(a.prev=38,!h){a.next=41;break}throw f;case 41:return a.finish(38);case 42:return a.finish(35);case 43:if(g=o.filter((function(e){return e._shouldAllowMigration})),u._shouldAllowMigration&&g.length){a.next=46;break}return a.abrupt("return",new t(u,n,i));case 46:if(u=g[0],!c){a.next=50;break}return a.next=50,u._set(s,c.toJSON());case 50:return a.next=52,Promise.all(r.map(function(){var t=e(ve)(e(ye).mark((function t(n){return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n===u){e.next=8;break}return e.prev=1,e.next=4,n._remove(s);case 4:e.next=8;break;case 6:e.prev=6,e.t0=e.catch(1);case 8:case"end":return e.stop()}}),t,null,[[1,6]])})));return function(e){return t.apply(this,arguments)}}()));case 52:return a.abrupt("return",new t(u,n,i));case 53:case"end":return a.stop()}}),a,null,[[9,31,35,43],[13,24],[36,,38,42]])})))()}}]),t}();
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sr(e){var t=e.toLowerCase();if(t.includes("opera/")||t.includes("opr/")||t.includes("opios/"))return"Opera";if(Dr(t))return"IEMobile";if(t.includes("msie")||t.includes("trident/"))return"IE";if(t.includes("edge/"))return"Edge";if(Ar(t))return"Firefox";if(t.includes("silk/"))return"Silk";if(Or(t))return"Blackberry";if(Pr(t))return"Webos";if(Cr(t))return"Safari";if((t.includes("chrome/")||Nr(t))&&!t.includes("edge/"))return"Chrome";if(Rr(t))return"Android";var n=e.match(/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/);return 2===(null==n?void 0:n.length)?n[1]:"Other"}function Ar(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:H();return/firefox\//i.test(e)}function Cr(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:H(),t=e.toLowerCase();return t.includes("safari/")&&!t.includes("chrome/")&&!t.includes("crios/")&&!t.includes("android")}function Nr(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:H();return/crios\//i.test(e)}function Dr(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:H();return/iemobile/i.test(e)}function Rr(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:H();return/android/i.test(e)}function Or(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:H();return/blackberry/i.test(e)}function Pr(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:H();return/webos/i.test(e)}function Lr(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:H();return/iphone|ipad|ipod/i.test(e)||/macintosh/i.test(e)&&/mobile/i.test(e)}function Mr(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:H();return/(iPad|iPhone|iPod).*OS 7_\d/i.test(e)||/(iPad|iPhone|iPod).*OS 8_\d/i.test(e)}function Fr(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:H();return Lr(t)&&!!(null===(e=window.navigator)||void 0===e?void 0:e.standalone)}function Vr(){return X()&&10===document.documentMode}function Ur(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:H();return Lr(e)||Rr(e)||Pr(e)||Or(e)||/windows phone/i.test(e)||Dr(e)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function Br(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];switch(e){case"Browser":t=Sr(H());break;case"Worker":t="".concat(Sr(H()),"-").concat(e);break;default:t=e}var r=n.length?n.join(","):"FirebaseCore-web";return"".concat(t,"/","JsCore","/").concat(mt,"/").concat(r)}
/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var qr=function(){"use strict";function t(n){e(s)(this,t),this.auth=n,this.queue=[]}return e(c)(t,[{key:"pushCallback",value:function(e,t){var n=this,r=function(t){return new Promise((function(n,r){try{n(e(t))}catch(e){r(e)}}))};r.onAbort=t,this.queue.push(r);var i=this.queue.length-1;return function(){n.queue[i]=function(){return Promise.resolve()}}}},{key:"runMiddleware",value:function(t){var n=this;return e(ve)(e(ye).mark((function r(){var i,a,o,u,s,c,l,h,f,d,v,p,y,m;return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.auth.currentUser!==t){e.next=3;break}return e.abrupt("return");case 3:a=[],e.prev=4,o=!0,u=!1,s=void 0,e.prev=6,c=n.queue[Symbol.iterator]();case 8:if(o=(l=c.next()).done){e.next=16;break}return h=l.value,e.next=12,h(t);case 12:h.onAbort&&a.push(h.onAbort);case 13:o=!0,e.next=8;break;case 16:e.next=22;break;case 18:e.prev=18,e.t0=e.catch(6),u=!0,s=e.t0;case 22:e.prev=22,e.prev=23,o||null==c.return||c.return();case 25:if(e.prev=25,!u){e.next=28;break}throw s;case 28:return e.finish(25);case 29:return e.finish(22);case 30:e.next=53;break;case 32:for(e.prev=32,e.t1=e.catch(4),a.reverse(),f=!0,d=!1,v=void 0,e.prev=36,p=a[Symbol.iterator]();!(f=(y=p.next()).done);f=!0){m=y.value;try{m()}catch(e){}}e.next=44;break;case 40:e.prev=40,e.t2=e.catch(36),d=!0,v=e.t2;case 44:e.prev=44,e.prev=45,f||null==p.return||p.return();case 47:if(e.prev=47,!d){e.next=50;break}throw v;case 50:return e.finish(47);case 51:return e.finish(44);case 52:throw n.auth._errorFactory.create("login-blocked",{originalMessage:null===(i=e.t1)||void 0===i?void 0:i.message});case 53:case"end":return e.stop()}}),r,null,[[4,32],[6,18,22,30],[23,,25,29],[36,40,44,52],[45,,47,51]])})))()}}]),t}(),jr=function(){"use strict";function t(n,r,i){e(s)(this,t),this.app=n,this.heartbeatServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Kr(this),this.idTokenSubscription=new Kr(this),this.beforeStateQueue=new qr(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=wn,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=n.name,this.clientVersion=i.sdkClientVersion}return e(c)(t,[{key:"_initializeWithPersistence",value:function(t,n){n&&(this._popupRedirectResolver=Rn(n));var r=this;return this._initializationPromise=this.queue(e(ve)(e(ye).mark((function i(){var a,o;return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!r._deleted){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,Er.create(r,t);case 5:if(r.persistenceManager=e.sent,!r._deleted){e.next=8;break}return e.abrupt("return");case 8:if(!(null===(a=r._popupRedirectResolver)||void 0===a?void 0:a._shouldInitProactively)){e.next=16;break}return e.prev=9,e.next=12,r._popupRedirectResolver._initialize(r);case 12:e.next=16;break;case 14:e.prev=14,e.t0=e.catch(9);case 16:return e.next=18,r.initializeCurrentUser(n);case 18:if(r.lastNotifiedUid=(null===(o=r.currentUser)||void 0===o?void 0:o.uid)||null,!r._deleted){e.next=21;break}return e.abrupt("return");case 21:r._isInitialized=!0;case 22:case"end":return e.stop()}}),i,null,[[9,14]])})))),this._initializationPromise}},{key:"_onStorageEvent",value:function(){var t=this;return e(ve)(e(ye).mark((function n(){var r;return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t._deleted){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,t.assertedPersistence.getCurrentUser();case 4:if(r=e.sent,t.currentUser||r){e.next=7;break}return e.abrupt("return");case 7:if(!t.currentUser||!r||t.currentUser.uid!==r.uid){e.next=12;break}return t._currentUser._assign(r),e.next=11,t.currentUser.getIdToken();case 11:return e.abrupt("return");case 12:return e.next=14,t._updateCurrentUser(r,!0);case 14:case"end":return e.stop()}}),n)})))()}},{key:"initializeCurrentUser",value:function(t){var n=this;return e(ve)(e(ye).mark((function r(){var i,a,o,u,s,c,l;return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=3,n.assertedPersistence.getCurrentUser();case 3:if(a=e.sent,o=a,u=!1,!t||!n.config.authDomain){e.next=15;break}return e.next=9,n.getOrInitRedirectPersistenceManager();case 9:return s=null===(i=n.redirectUser)||void 0===i?void 0:i._redirectEventId,c=null==o?void 0:o._redirectEventId,e.next=13,n.tryRedirectSignIn(t);case 13:l=e.sent,s&&s!==c||!(null==l?void 0:l.user)||(o=l.user,u=!0);case 15:if(o){e.next=17;break}return e.abrupt("return",n.directlySetCurrentUser(null));case 17:if(o._redirectEventId){e.next=33;break}if(!u){e.next=28;break}return e.prev=19,e.next=22,n.beforeStateQueue.runMiddleware(o);case 22:e.next=28;break;case 24:e.prev=24,e.t0=e.catch(19),o=a,n._popupRedirectResolver._overrideRedirectResult(n,(function(){return Promise.reject(e.t0)}));case 28:if(!o){e.next=32;break}return e.abrupt("return",n.reloadAndSetCurrentUserOrClear(o));case 32:return e.abrupt("return",n.directlySetCurrentUser(null));case 33:return An(n._popupRedirectResolver,n,"argument-error"),e.next=36,n.getOrInitRedirectPersistenceManager();case 36:if(!n.redirectUser||n.redirectUser._redirectEventId!==o._redirectEventId){e.next=38;break}return e.abrupt("return",n.directlySetCurrentUser(o));case 38:return e.abrupt("return",n.reloadAndSetCurrentUserOrClear(o));case 39:case"end":return e.stop()}}),r,null,[[19,24]])})))()}},{key:"tryRedirectSignIn",value:function(t){var n=this;return e(ve)(e(ye).mark((function r(){var i;return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=null,e.prev=1,e.next=4,n._popupRedirectResolver._completeRedirectFn(n,t,!0);case 4:i=e.sent,e.next=11;break;case 7:return e.prev=7,e.t0=e.catch(1),e.next=11,n._setRedirectUser(null);case 11:return e.abrupt("return",i);case 12:case"end":return e.stop()}}),r,null,[[1,7]])})))()}},{key:"reloadAndSetCurrentUserOrClear",value:function(t){var n=this;return e(ve)(e(ye).mark((function r(){var i;return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=1,e.next=4,dr(t);case 4:e.next=10;break;case 6:if(e.prev=6,e.t0=e.catch(1),"auth/network-request-failed"===(null===(i=e.t0)||void 0===i?void 0:i.code)){e.next=10;break}return e.abrupt("return",n.directlySetCurrentUser(null));case 10:return e.abrupt("return",n.directlySetCurrentUser(t));case 11:case"end":return e.stop()}}),r,null,[[1,6]])})))()}},{key:"useDeviceLanguage",value:function(){this.languageCode=function(){if("undefined"==typeof navigator)return null;var e=navigator;return e.languages&&e.languages[0]||e.language||null}()}},{key:"_delete",value:function(){var t=this;return e(ve)(e(ye).mark((function n(){return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t._deleted=!0;case 1:case"end":return e.stop()}}),n)})))()}},{key:"updateCurrentUser",value:function(t){var n=this;return e(ve)(e(ye).mark((function r(){var i;return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(i=t?de(t):null)&&An(i.auth.config.apiKey===n.config.apiKey,n,"invalid-user-token"),e.abrupt("return",n._updateCurrentUser(i&&i._clone(n)));case 3:case"end":return e.stop()}}),r)})))()}},{key:"_updateCurrentUser",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=this;return e(ve)(e(ye).mark((function i(){return e(ye).wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(!r._deleted){i.next=2;break}return i.abrupt("return");case 2:if(t&&An(r.tenantId===t.tenantId,r,"tenant-id-mismatch"),n){i.next=6;break}return i.next=6,r.beforeStateQueue.runMiddleware(t);case 6:return i.abrupt("return",r.queue(e(ve)(e(ye).mark((function n(){return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.directlySetCurrentUser(t);case 2:r.notifyAuthListeners();case 3:case"end":return e.stop()}}),n)})))));case 7:case"end":return i.stop()}}),i)})))()}},{key:"signOut",value:function(){var t=this;return e(ve)(e(ye).mark((function n(){return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.beforeStateQueue.runMiddleware(null);case 2:if(!t.redirectPersistenceManager&&!t._popupRedirectResolver){e.next=5;break}return e.next=5,t._setRedirectUser(null);case 5:return e.abrupt("return",t._updateCurrentUser(null,!0));case 6:case"end":return e.stop()}}),n)})))()}},{key:"setPersistence",value:function(t){var n=this;return this.queue(e(ve)(e(ye).mark((function r(){return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.assertedPersistence.setPersistence(Rn(t));case 2:case"end":return e.stop()}}),r)}))))}},{key:"_getPersistence",value:function(){return this.assertedPersistence.persistence.type}},{key:"_updateErrorMap",value:function(e){this._errorFactory=new ee("auth","Firebase",e())}},{key:"onAuthStateChanged",value:function(e,t,n){return this.registerStateListener(this.authStateSubscription,e,t,n)}},{key:"beforeAuthStateChanged",value:function(e,t){return this.beforeStateQueue.pushCallback(e,t)}},{key:"onIdTokenChanged",value:function(e,t,n){return this.registerStateListener(this.idTokenSubscription,e,t,n)}},{key:"toJSON",value:function(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(e=this._currentUser)||void 0===e?void 0:e.toJSON()}}},{key:"_setRedirectUser",value:function(t,n){var r=this;return e(ve)(e(ye).mark((function i(){var a;return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.getOrInitRedirectPersistenceManager(n);case 2:return a=e.sent,e.abrupt("return",null===t?a.removeCurrentUser():a.setCurrentUser(t));case 4:case"end":return e.stop()}}),i)})))()}},{key:"getOrInitRedirectPersistenceManager",value:function(t){var n=this;return e(ve)(e(ye).mark((function r(){var i;return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.redirectPersistenceManager){e.next=9;break}return An(i=t&&Rn(t)||n._popupRedirectResolver,n,"argument-error"),e.next=5,Er.create(n,[Rn(i._redirectPersistence)],"redirectUser");case 5:return n.redirectPersistenceManager=e.sent,e.next=8,n.redirectPersistenceManager.getCurrentUser();case 8:n.redirectUser=e.sent;case 9:return e.abrupt("return",n.redirectPersistenceManager);case 10:case"end":return e.stop()}}),r)})))()}},{key:"_redirectUserForId",value:function(t){var n=this;return e(ve)(e(ye).mark((function r(){var i,a;return e(ye).wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(!n._isInitialized){r.next=4;break}return r.next=4,n.queue(e(ve)(e(ye).mark((function t(){return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),t)}))));case 4:if((null===(i=n._currentUser)||void 0===i?void 0:i._redirectEventId)!==t){r.next=6;break}return r.abrupt("return",n._currentUser);case 6:if((null===(a=n.redirectUser)||void 0===a?void 0:a._redirectEventId)!==t){r.next=8;break}return r.abrupt("return",n.redirectUser);case 8:return r.abrupt("return",null);case 9:case"end":return r.stop()}}),r)})))()}},{key:"_persistUserIfCurrent",value:function(t){var n=this;return e(ve)(e(ye).mark((function r(){return e(ye).wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(t!==n.currentUser){r.next=2;break}return r.abrupt("return",n.queue(e(ve)(e(ye).mark((function r(){return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",n.directlySetCurrentUser(t));case 1:case"end":return e.stop()}}),r)})))));case 2:case"end":return r.stop()}}),r)})))()}},{key:"_notifyListenersIfCurrent",value:function(e){e===this.currentUser&&this.notifyAuthListeners()}},{key:"_key",value:function(){return"".concat(this.config.authDomain,":").concat(this.config.apiKey,":").concat(this.name)}},{key:"_startProactiveRefresh",value:function(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}},{key:"_stopProactiveRefresh",value:function(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}},{key:"_currentUser",get:function(){return this.currentUser}},{key:"notifyAuthListeners",value:function(){var e,t;if(this._isInitialized){this.idTokenSubscription.next(this.currentUser);var n=null!==(t=null===(e=this.currentUser)||void 0===e?void 0:e.uid)&&void 0!==t?t:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}}},{key:"registerStateListener",value:function(e,t,n,r){var i=this;if(this._deleted)return function(){};var a="function"==typeof t?t:t.next.bind(t),o=this._isInitialized?Promise.resolve():this._initializationPromise;return An(o,this,"internal-error"),o.then((function(){return a(i.currentUser)})),"function"==typeof t?e.addObserver(t,n,r):e.addObserver(t)}},{key:"directlySetCurrentUser",value:function(t){var n=this;return e(ve)(e(ye).mark((function r(){return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.currentUser&&n.currentUser!==t&&n._currentUser._stopProactiveRefresh(),t&&n.isProactiveRefreshEnabled&&t._startProactiveRefresh(),n.currentUser=t,!t){e.next=8;break}return e.next=6,n.assertedPersistence.setCurrentUser(t);case 6:e.next=10;break;case 8:return e.next=10,n.assertedPersistence.removeCurrentUser();case 10:case"end":return e.stop()}}),r)})))()}},{key:"queue",value:function(e){return this.operations=this.operations.then(e,e),this.operations}},{key:"assertedPersistence",get:function(){return An(this.persistenceManager,this,"internal-error"),this.persistenceManager}},{key:"_logFramework",value:function(e){e&&!this.frameworks.includes(e)&&(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Br(this.config.clientPlatform,this._getFrameworks()))}},{key:"_getFrameworks",value:function(){return this.frameworks}},{key:"_getAdditionalHeaders",value:function(){var t=this;return e(ve)(e(ye).mark((function n(){var r,i,a;return e(ye).wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return i=e(h)({},"X-Client-Version",t.clientVersion),t.app.options.appId&&(i["X-Firebase-gmpid"]=t.app.options.appId),n.next=5,null===(r=t.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===r?void 0:r.getHeartbeatsHeader();case 5:return(a=n.sent)&&(i["X-Firebase-Client"]=a),n.abrupt("return",i);case 8:case"end":return n.stop()}}),n)})))()}}]),t}();
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gr(e){return de(e)}var Kr=function(){"use strict";function t(n){var r=this;e(s)(this,t),this.auth=n,this.observer=null,this.addObserver=le((function(e){return r.observer=e}))}return e(c)(t,[{key:"next",get:function(){return An(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}]),t}();function zr(t,n,r){var i=Gr(t);An(i._canInitEmulator,i,"emulator-config-failed"),An(/^https?:\/\//.test(n),i,"invalid-emulator-scheme");var a=!!(null==r?void 0:r.disableWarnings),o=Wr(n),u=function(t){var n=Wr(t),r=/(\/\/)?([^?#/]+)/.exec(t.substr(n.length));if(!r)return{host:"",port:null};var i=r[2].split("@").pop()||"",a=/^(\[[^\]]+\])(:|$)/.exec(i);if(a){var o=a[1];return{host:o,port:Hr(i.substr(o.length+1))}}var u=e(y)(i.split(":"),2);return{host:u[0],port:Hr(u[1])}}(n),s=u.host,c=u.port,l=null===c?"":":".concat(c);i.config.emulator={url:"".concat(o,"//").concat(s).concat(l,"/")},i.settings.appVerificationDisabledForTesting=!0,i.emulatorConfig=Object.freeze({host:s,port:c,protocol:o.replace(":",""),options:Object.freeze({disableWarnings:a})}),a||function(){function e(){var e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}"undefined"!=typeof console&&"function"==typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials.");"undefined"!=typeof window&&"undefined"!=typeof document&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",e):e())}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */()}function Wr(e){var t=e.indexOf(":");return t<0?"":e.substr(0,t+1)}function Hr(e){if(!e)return null;var t=Number(e);return isNaN(t)?null:t}var Qr=function(){"use strict";function t(n,r){e(s)(this,t),this.providerId=n,this.signInMethod=r}return e(c)(t,[{key:"toJSON",value:function(){return Cn("not implemented")}},{key:"_getIdTokenResponse",value:function(e){return Cn("not implemented")}},{key:"_linkToIdToken",value:function(e,t){return Cn("not implemented")}},{key:"_getReauthenticationResolver",value:function(e){return Cn("not implemented")}}]),t}();function Yr(e,t){return Jr.apply(this,arguments)}function Jr(){return(Jr=
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
e(ve)(e(ye).mark((function t(n,r){return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Gn(n,"POST","/v1/accounts:resetPassword",jn(n,r)));case 1:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function Xr(e,t){return Zr.apply(this,arguments)}function Zr(){return(Zr=e(ve)(e(ye).mark((function t(n,r){return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Gn(n,"POST","/v1/accounts:update",r));case 1:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function $r(e,t){return ei.apply(this,arguments)}function ei(){return(ei=e(ve)(e(ye).mark((function t(n,r){return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Gn(n,"POST","/v1/accounts:update",jn(n,r)));case 1:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function ti(e,t){return ni.apply(this,arguments)}function ni(){return(ni=
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
e(ve)(e(ye).mark((function t(n,r){return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Hn(n,"POST","/v1/accounts:signInWithPassword",jn(n,r)));case 1:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function ri(e,t){return ii.apply(this,arguments)}function ii(){return(ii=e(ve)(e(ye).mark((function t(n,r){return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Gn(n,"POST","/v1/accounts:sendOobCode",jn(n,r)));case 1:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function ai(e,t){return oi.apply(this,arguments)}function oi(){return(oi=e(ve)(e(ye).mark((function t(n,r){return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",ri(n,r));case 1:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function ui(e,t){return si.apply(this,arguments)}function si(){return(si=e(ve)(e(ye).mark((function t(n,r){return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",ri(n,r));case 1:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function ci(e,t){return li.apply(this,arguments)}function li(){return(li=e(ve)(e(ye).mark((function t(n,r){return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",ri(n,r));case 1:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function hi(e,t){return fi.apply(this,arguments)}function fi(){return(fi=e(ve)(e(ye).mark((function t(n,r){return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",ri(n,r));case 1:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function di(e,t){return vi.apply(this,arguments)}function vi(){return(vi=
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
e(ve)(e(ye).mark((function t(n,r){return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Hn(n,"POST","/v1/accounts:signInWithEmailLink",jn(n,r)));case 1:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function pi(e,t){return yi.apply(this,arguments)}function yi(){return(yi=e(ve)(e(ye).mark((function t(n,r){return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Hn(n,"POST","/v1/accounts:signInWithEmailLink",jn(n,r)));case 1:case"end":return e.stop()}}),t)})))).apply(this,arguments)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var mi=function(t){"use strict";e(d)(r,t);var n=e(L)(r);function r(t,i,a){var o,u=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return e(s)(this,r),(o=n.call(this,"password",a))._email=t,o._password=i,o._tenantId=u,o}return e(c)(r,[{key:"toJSON",value:function(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}},{key:"_getIdTokenResponse",value:function(t){var n=this;return e(ve)(e(ye).mark((function r(){return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=n.signInMethod,e.next="password"===e.t0?3:"emailLink"===e.t0?4:5;break;case 3:return e.abrupt("return",ti(t,{returnSecureToken:!0,email:n._email,password:n._password}));case 4:return e.abrupt("return",di(t,{email:n._email,oobCode:n._password}));case 5:In(t,"internal-error");case 6:case"end":return e.stop()}}),r)})))()}},{key:"_linkToIdToken",value:function(t,n){var r=this;return e(ve)(e(ye).mark((function i(){return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=r.signInMethod,e.next="password"===e.t0?3:"emailLink"===e.t0?4:5;break;case 3:return e.abrupt("return",Xr(t,{idToken:n,returnSecureToken:!0,email:r._email,password:r._password}));case 4:return e.abrupt("return",pi(t,{idToken:n,email:r._email,oobCode:r._password}));case 5:In(t,"internal-error");case 6:case"end":return e.stop()}}),i)})))()}},{key:"_getReauthenticationResolver",value:function(e){return this._getIdTokenResponse(e)}}],[{key:"_fromEmailAndPassword",value:function(e,t){return new r(e,t,"password")}},{key:"_fromEmailAndCode",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return new r(e,t,"emailLink",n)}},{key:"fromJSON",value:function(e){var t="string"==typeof e?JSON.parse(e):e;if((null==t?void 0:t.email)&&(null==t?void 0:t.password)){if("password"===t.signInMethod)return this._fromEmailAndPassword(t.email,t.password);if("emailLink"===t.signInMethod)return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}}]),r}(Qr);function gi(e,t){return ki.apply(this,arguments)}function ki(){return(ki=
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
e(ve)(e(ye).mark((function t(n,r){return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Hn(n,"POST","/v1/accounts:signInWithIdp",jn(n,r)));case 1:case"end":return e.stop()}}),t)})))).apply(this,arguments)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var wi=function(t){"use strict";e(d)(r,t);var n=e(L)(r);function r(){var t;return e(s)(this,r),(t=n.call.apply(n,[this].concat(Array.prototype.slice.call(arguments)))).pendingToken=null,t}return e(c)(r,[{key:"toJSON",value:function(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}},{key:"_getIdTokenResponse",value:function(e){return gi(e,this.buildRequest())}},{key:"_linkToIdToken",value:function(e,t){var n=this.buildRequest();return n.idToken=t,gi(e,n)}},{key:"_getReauthenticationResolver",value:function(e){var t=this.buildRequest();return t.autoCreate=!1,gi(e,t)}},{key:"buildRequest",value:function(){var e={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{var t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=ue(t)}return e}}],[{key:"_fromParams",value:function(e){var t=new r(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):In("argument-error"),t}},{key:"fromJSON",value:function(e){var t="string"==typeof e?JSON.parse(e):e,n=t.providerId,i=t.signInMethod,a=an(t,["providerId","signInMethod"]);if(!n||!i)return null;var o=new r(n,i);return o.idToken=a.idToken||void 0,o.accessToken=a.accessToken||void 0,o.secret=a.secret,o.nonce=a.nonce,o.pendingToken=a.pendingToken||null,o}}]),r}(Qr);function bi(e,t){return xi.apply(this,arguments)}function xi(){return(xi=
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
e(ve)(e(ye).mark((function t(n,r){return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Gn(n,"POST","/v1/accounts:sendVerificationCode",jn(n,r)));case 1:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function Ii(){return(Ii=e(ve)(e(ye).mark((function t(n,r){return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Hn(n,"POST","/v1/accounts:signInWithPhoneNumber",jn(n,r)));case 1:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function _i(){return(_i=e(ve)(e(ye).mark((function t(n,r){var i;return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Hn(n,"POST","/v1/accounts:signInWithPhoneNumber",jn(n,r));case 2:if(!(i=e.sent).temporaryProof){e.next=5;break}throw Xn(n,"account-exists-with-different-credential",i);case 5:return e.abrupt("return",i);case 6:case"end":return e.stop()}}),t)})))).apply(this,arguments)}var Ti=e(h)({},"USER_NOT_FOUND","user-not-found");function Ei(){return(Ei=e(ve)(e(ye).mark((function t(n,r){var i;return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=Object.assign(Object.assign({},r),{operation:"REAUTH"}),e.abrupt("return",Hn(n,"POST","/v1/accounts:signInWithPhoneNumber",jn(n,i),Ti));case 2:case"end":return e.stop()}}),t)})))).apply(this,arguments)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Si=function(t){"use strict";e(d)(r,t);var n=e(L)(r);function r(t){var i;return e(s)(this,r),(i=n.call(this,"phone","phone")).params=t,i}return e(c)(r,[{key:"_getIdTokenResponse",value:function(e){return function(e,t){return Ii.apply(this,arguments)}(e,this._makeVerificationRequest())}},{key:"_linkToIdToken",value:function(e,t){return function(e,t){return _i.apply(this,arguments)}(e,Object.assign({idToken:t},this._makeVerificationRequest()))}},{key:"_getReauthenticationResolver",value:function(e){return function(e,t){return Ei.apply(this,arguments)}(e,this._makeVerificationRequest())}},{key:"_makeVerificationRequest",value:function(){var e=this.params,t=e.temporaryProof,n=e.phoneNumber,r=e.verificationId,i=e.verificationCode;return t&&n?{temporaryProof:t,phoneNumber:n}:{sessionInfo:r,code:i}}},{key:"toJSON",value:function(){var e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}}],[{key:"_fromVerification",value:function(e,t){return new r({verificationId:e,verificationCode:t})}},{key:"_fromTokenResponse",value:function(e,t){return new r({phoneNumber:e,temporaryProof:t})}},{key:"fromJSON",value:function(e){"string"==typeof e&&(e=JSON.parse(e));var t=e.verificationId,n=e.verificationCode,i=e.phoneNumber,a=e.temporaryProof;return n||t||i||a?new r({verificationId:t,verificationCode:n,phoneNumber:i,temporaryProof:a}):null}}]),r}(Qr);
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ai=function(){"use strict";function t(n){var r,i,a,o,u,c;e(s)(this,t);var l=se(ce(n)),h=null!==(r=l.apiKey)&&void 0!==r?r:null,f=null!==(i=l.oobCode)&&void 0!==i?i:null,d=function(e){switch(e){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(a=l.mode)&&void 0!==a?a:null);An(h&&f&&d,"argument-error"),this.apiKey=h,this.operation=d,this.code=f,this.continueUrl=null!==(o=l.continueUrl)&&void 0!==o?o:null,this.languageCode=null!==(u=l.languageCode)&&void 0!==u?u:null,this.tenantId=null!==(c=l.tenantId)&&void 0!==c?c:null}return e(c)(t,null,[{key:"parseLink",value:function(e){var n=function(e){var t=se(ce(e)).link,n=t?se(ce(t)).deep_link_id:null,r=se(ce(e)).deep_link_id;return(r?se(ce(r)).link:null)||r||n||t||e}(e);try{return new t(n)}catch(e){return null}}}]),t}();
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var Ci=function(){"use strict";function t(){e(s)(this,t),this.providerId=t.PROVIDER_ID}return e(c)(t,null,[{key:"credential",value:function(e,t){return mi._fromEmailAndPassword(e,t)}},{key:"credentialWithLink",value:function(e,t){var n=Ai.parseLink(t);return An(n,"argument-error"),mi._fromEmailAndCode(e,n.code,n.tenantId)}}]),t}();Ci.PROVIDER_ID="password",Ci.EMAIL_PASSWORD_SIGN_IN_METHOD="password",Ci.EMAIL_LINK_SIGN_IN_METHOD="emailLink";
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var Ni=function(){"use strict";function t(n){e(s)(this,t),this.providerId=n,this.defaultLanguageCode=null,this.customParameters={}}return e(c)(t,[{key:"setDefaultLanguage",value:function(e){this.defaultLanguageCode=e}},{key:"setCustomParameters",value:function(e){return this.customParameters=e,this}},{key:"getCustomParameters",value:function(){return this.customParameters}}]),t}(),Di=function(t){"use strict";e(d)(r,t);var n=e(L)(r);function r(){var t;return e(s)(this,r),(t=n.call.apply(n,[this].concat(Array.prototype.slice.call(arguments)))).scopes=[],t}return e(c)(r,[{key:"addScope",value:function(e){return this.scopes.includes(e)||this.scopes.push(e),this}},{key:"getScopes",value:function(){return e(x)(this.scopes)}}]),r}(Ni),Ri=function(t){"use strict";e(d)(r,t);var n=e(L)(r);function r(){return e(s)(this,r),n.apply(this,arguments)}return e(c)(r,[{key:"credential",value:function(e){return this._credential(Object.assign(Object.assign({},e),{nonce:e.rawNonce}))}},{key:"_credential",value:function(e){return An(e.idToken||e.accessToken,"argument-error"),wi._fromParams(Object.assign(Object.assign({},e),{providerId:this.providerId,signInMethod:this.providerId}))}}],[{key:"credentialFromJSON",value:function(e){var t="string"==typeof e?JSON.parse(e):e;return An("providerId"in t&&"signInMethod"in t,"argument-error"),wi._fromParams(t)}},{key:"credentialFromResult",value:function(e){return r.oauthCredentialFromTaggedObject(e)}},{key:"credentialFromError",value:function(e){return r.oauthCredentialFromTaggedObject(e.customData||{})}},{key:"oauthCredentialFromTaggedObject",value:function(e){var t=e._tokenResponse;if(!t)return null;var n=t.oauthIdToken,i=t.oauthAccessToken,a=t.oauthTokenSecret,o=t.pendingToken,u=t.nonce,s=t.providerId;if(!(i||a||n||o))return null;if(!s)return null;try{return new r(s)._credential({idToken:n,accessToken:i,nonce:u,pendingToken:o})}catch(e){return null}}}]),r}(Di),Oi=function(t){"use strict";e(d)(r,t);var n=e(L)(r);function r(){return e(s)(this,r),n.call(this,"facebook.com")}return e(c)(r,null,[{key:"credential",value:function(e){return wi._fromParams({providerId:r.PROVIDER_ID,signInMethod:r.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}},{key:"credentialFromResult",value:function(e){return r.credentialFromTaggedObject(e)}},{key:"credentialFromError",value:function(e){return r.credentialFromTaggedObject(e.customData||{})}},{key:"credentialFromTaggedObject",value:function(e){var t=e._tokenResponse;if(!t||!("oauthAccessToken"in t))return null;if(!t.oauthAccessToken)return null;try{return r.credential(t.oauthAccessToken)}catch(e){return null}}}]),r}(Di);
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Oi.FACEBOOK_SIGN_IN_METHOD="facebook.com",Oi.PROVIDER_ID="facebook.com";
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var Pi=function(t){"use strict";e(d)(r,t);var n=e(L)(r);function r(){var t;return e(s)(this,r),(t=n.call(this,"google.com")).addScope("profile"),t}return e(c)(r,null,[{key:"credential",value:function(e,t){return wi._fromParams({providerId:r.PROVIDER_ID,signInMethod:r.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}},{key:"credentialFromResult",value:function(e){return r.credentialFromTaggedObject(e)}},{key:"credentialFromError",value:function(e){return r.credentialFromTaggedObject(e.customData||{})}},{key:"credentialFromTaggedObject",value:function(e){var t=e._tokenResponse;if(!t)return null;var n=t.oauthIdToken,i=t.oauthAccessToken;if(!n&&!i)return null;try{return r.credential(n,i)}catch(e){return null}}}]),r}(Di);Pi.GOOGLE_SIGN_IN_METHOD="google.com",Pi.PROVIDER_ID="google.com";
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var Li=function(t){"use strict";e(d)(r,t);var n=e(L)(r);function r(){return e(s)(this,r),n.call(this,"github.com")}return e(c)(r,null,[{key:"credential",value:function(e){return wi._fromParams({providerId:r.PROVIDER_ID,signInMethod:r.GITHUB_SIGN_IN_METHOD,accessToken:e})}},{key:"credentialFromResult",value:function(e){return r.credentialFromTaggedObject(e)}},{key:"credentialFromError",value:function(e){return r.credentialFromTaggedObject(e.customData||{})}},{key:"credentialFromTaggedObject",value:function(e){var t=e._tokenResponse;if(!t||!("oauthAccessToken"in t))return null;if(!t.oauthAccessToken)return null;try{return r.credential(t.oauthAccessToken)}catch(e){return null}}}]),r}(Di);Li.GITHUB_SIGN_IN_METHOD="github.com",Li.PROVIDER_ID="github.com";
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var Mi=function(t){"use strict";e(d)(r,t);var n=e(L)(r);function r(t,i){var a;return e(s)(this,r),(a=n.call(this,t,t)).pendingToken=i,a}return e(c)(r,[{key:"_getIdTokenResponse",value:function(e){return gi(e,this.buildRequest())}},{key:"_linkToIdToken",value:function(e,t){var n=this.buildRequest();return n.idToken=t,gi(e,n)}},{key:"_getReauthenticationResolver",value:function(e){var t=this.buildRequest();return t.autoCreate=!1,gi(e,t)}},{key:"toJSON",value:function(){return{signInMethod:this.signInMethod,providerId:this.providerId,pendingToken:this.pendingToken}}},{key:"buildRequest",value:function(){return{requestUri:"http://localhost",returnSecureToken:!0,pendingToken:this.pendingToken}}}],[{key:"fromJSON",value:function(e){var t="string"==typeof e?JSON.parse(e):e,n=t.providerId,i=t.signInMethod,a=t.pendingToken;return n&&i&&a&&n===i?new r(n,a):null}},{key:"_create",value:function(e,t){return new r(e,t)}}]),r}(Qr),Fi=function(t){"use strict";e(d)(r,t);var n=e(L)(r);function r(t){return e(s)(this,r),An(t.startsWith("saml."),"argument-error"),n.call(this,t)}return e(c)(r,null,[{key:"credentialFromResult",value:function(e){return r.samlCredentialFromTaggedObject(e)}},{key:"credentialFromError",value:function(e){return r.samlCredentialFromTaggedObject(e.customData||{})}},{key:"credentialFromJSON",value:function(e){var t=Mi.fromJSON(e);return An(t,"argument-error"),t}},{key:"samlCredentialFromTaggedObject",value:function(e){var t=e._tokenResponse;if(!t)return null;var n=t.pendingToken,r=t.providerId;if(!n||!r)return null;try{return Mi._create(r,n)}catch(e){return null}}}]),r}(Ni),Vi=function(t){"use strict";e(d)(r,t);var n=e(L)(r);function r(){return e(s)(this,r),n.call(this,"twitter.com")}return e(c)(r,null,[{key:"credential",value:function(e,t){return wi._fromParams({providerId:r.PROVIDER_ID,signInMethod:r.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}},{key:"credentialFromResult",value:function(e){return r.credentialFromTaggedObject(e)}},{key:"credentialFromError",value:function(e){return r.credentialFromTaggedObject(e.customData||{})}},{key:"credentialFromTaggedObject",value:function(e){var t=e._tokenResponse;if(!t)return null;var n=t.oauthAccessToken,i=t.oauthTokenSecret;if(!n||!i)return null;try{return r.credential(n,i)}catch(e){return null}}}]),r}(Di);function Ui(e,t){return Bi.apply(this,arguments)}function Bi(){return(Bi=
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
e(ve)(e(ye).mark((function t(n,r){return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Hn(n,"POST","/v1/accounts:signUp",jn(n,r)));case 1:case"end":return e.stop()}}),t)})))).apply(this,arguments)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Vi.TWITTER_SIGN_IN_METHOD="twitter.com",Vi.PROVIDER_ID="twitter.com";var qi=function(){"use strict";function t(n){e(s)(this,t),this.user=n.user,this.providerId=n.providerId,this._tokenResponse=n._tokenResponse,this.operationType=n.operationType}return e(c)(t,null,[{key:"_fromIdTokenResponse",value:function(n,r,i){var a=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return e(ve)(e(ye).mark((function o(){var u,s,c;return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,xr._fromIdTokenResponse(n,i,a);case 2:return u=e.sent,s=ji(i),c=new t({user:u,providerId:s,_tokenResponse:i,operationType:r}),e.abrupt("return",c);case 6:case"end":return e.stop()}}),o)})))()}},{key:"_forOperation",value:function(n,r,i){return e(ve)(e(ye).mark((function a(){var o;return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n._updateTokensIfNecessary(i,!0);case 2:return o=ji(i),e.abrupt("return",new t({user:n,providerId:o,_tokenResponse:i,operationType:r}));case 4:case"end":return e.stop()}}),a)})))()}}]),t}();function ji(e){return e.providerId?e.providerId:"phoneNumber"in e?"phone":null}function Gi(){return(Gi=
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
e(ve)(e(ye).mark((function t(n){var r,i,a,o;return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=Gr(n),e.next=4,i._initializationPromise;case 4:if(!(null===(r=i.currentUser)||void 0===r?void 0:r.isAnonymous)){e.next=6;break}return e.abrupt("return",new qi({user:i.currentUser,providerId:null,operationType:"signIn"}));case 6:return e.next=8,Ui(i,{returnSecureToken:!0});case 8:return a=e.sent,e.next=11,qi._fromIdTokenResponse(i,"signIn",a,!0);case 11:return o=e.sent,e.next=14,i._updateCurrentUser(o.user);case 14:return e.abrupt("return",o);case 15:case"end":return e.stop()}}),t)})))).apply(this,arguments)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ki=function(t){"use strict";e(d)(r,t);var n=e(L)(r);function r(t,i,a,o){var u,c;return e(s)(this,r),(u=n.call(this,i.code,i.message)).operationType=a,u.user=o,Object.setPrototypeOf(e(f)(u),r.prototype),u.customData={appName:t.name,tenantId:null!==(c=t.tenantId)&&void 0!==c?c:void 0,_serverResponse:i.customData._serverResponse,operationType:a},u}return e(c)(r,null,[{key:"_fromErrorAndOperation",value:function(e,t,n,i){return new r(e,t,n,i)}}]),r}($);function zi(e,t,n,r){return("reauthenticate"===t?n._getReauthenticationResolver(e):n._getIdTokenResponse(e)).catch((function(n){if("auth/multi-factor-auth-required"===n.code)throw Ki._fromErrorAndOperation(e,n,t,r);throw n}))}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wi(e){return new Set(e.map((function(e){return e.providerId})).filter((function(e){return!!e})))}function Hi(e,t){return Qi.apply(this,arguments)}function Qi(){return(Qi=
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
e(ve)(e(ye).mark((function t(n,r){var i,a,o;return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=de(n),e.next=3,Xi(!0,i,r);case 3:return e.t0=er,e.t1=i.auth,e.next=7,i.getIdToken();case 7:return e.t2=e.sent,e.t3=[r],e.t4={idToken:e.t2,deleteProvider:e.t3},e.next=12,(0,e.t0)(e.t1,e.t4);case 12:return a=e.sent.providerUserInfo,o=Wi(a||[]),i.providerData=i.providerData.filter((function(e){return o.has(e.providerId)})),o.has("phone")||(i.phoneNumber=null),e.next=18,i.auth._persistUserIfCurrent(i);case 18:return e.abrupt("return",i);case 19:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function Yi(e,t){return Ji.apply(this,arguments)}function Ji(){return Ji=e(ve)(e(ye).mark((function t(n,r){var i,a,o=arguments;return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=o.length>2&&void 0!==o[2]&&o[2],e.t0=sr,e.t1=n,e.t2=r,e.t3=n.auth,e.next=7,n.getIdToken();case 7:return e.t4=e.sent,e.t5=e.t2._linkToIdToken.call(e.t2,e.t3,e.t4),e.t6=i,e.next=12,(0,e.t0)(e.t1,e.t5,e.t6);case 12:return a=e.sent,e.abrupt("return",qi._forOperation(n,"link",a));case 14:case"end":return e.stop()}}),t)}))),Ji.apply(this,arguments)}function Xi(e,t,n){return Zi.apply(this,arguments)}function Zi(){return(Zi=e(ve)(e(ye).mark((function t(n,r,i){var a,o;return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,dr(r);case 2:a=Wi(r.providerData),o=!1===n?"provider-already-linked":"no-such-provider",An(a.has(i)===n,r.auth,o);case 5:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function $i(e,t){return ea.apply(this,arguments)}function ea(){return ea=
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
e(ve)(e(ye).mark((function t(n,r){var i,a,o,u,s,c,l,h=arguments;return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=h.length>2&&void 0!==h[2]&&h[2],o=n.auth,u="reauthenticate",e.prev=4,e.next=7,sr(n,zi(o,u,r,n),i);case 7:return An((s=e.sent).idToken,o,"internal-error"),An(c=ur(s.idToken),o,"internal-error"),l=c.sub,An(n.uid===l,o,"user-mismatch"),e.abrupt("return",qi._forOperation(n,u,s));case 16:throw e.prev=16,e.t0=e.catch(4),"auth/user-not-found"===(null===(a=e.t0)||void 0===a?void 0:a.code)&&In(o,"user-mismatch"),e.t0;case 20:case"end":return e.stop()}}),t,null,[[4,16]])}))),ea.apply(this,arguments)}function ta(e,t){return na.apply(this,arguments)}function na(){return na=
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
e(ve)(e(ye).mark((function t(n,r){var i,a,o,u,s=arguments;return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=s.length>2&&void 0!==s[2]&&s[2],a="signIn",e.next=4,zi(n,a,r);case 4:return o=e.sent,e.next=7,qi._fromIdTokenResponse(n,a,o);case 7:if(u=e.sent,i){e.next=11;break}return e.next=11,n._updateCurrentUser(u.user);case 11:return e.abrupt("return",u);case 12:case"end":return e.stop()}}),t)}))),na.apply(this,arguments)}function ra(e,t){return ia.apply(this,arguments)}function ia(){return(ia=e(ve)(e(ye).mark((function t(n,r){return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",ta(Gr(n),r));case 1:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function aa(e,t){return oa.apply(this,arguments)}function oa(){return(oa=e(ve)(e(ye).mark((function t(n,r){var i;return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=de(n),e.next=3,Xi(!1,i,r.providerId);case 3:return e.abrupt("return",Yi(i,r));case 4:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function ua(e,t){return sa.apply(this,arguments)}function sa(){return(sa=e(ve)(e(ye).mark((function t(n,r){return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",$i(de(n),r));case 1:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function ca(e,t){return la.apply(this,arguments)}function la(){return(la=
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
e(ve)(e(ye).mark((function t(n,r){return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Hn(n,"POST","/v1/accounts:signInWithCustomToken",jn(n,r)));case 1:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function ha(){return(ha=
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
e(ve)(e(ye).mark((function t(n,r){var i,a,o;return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=Gr(n),e.next=3,ca(i,{token:r,returnSecureToken:!0});case 3:return a=e.sent,e.next=6,qi._fromIdTokenResponse(i,"signIn",a);case 6:return o=e.sent,e.next=9,i._updateCurrentUser(o.user);case 9:return e.abrupt("return",o);case 10:case"end":return e.stop()}}),t)})))).apply(this,arguments)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var fa=function(){"use strict";function t(n,r){e(s)(this,t),this.factorId=n,this.uid=r.mfaEnrollmentId,this.enrollmentTime=new Date(r.enrolledAt).toUTCString(),this.displayName=r.displayName}return e(c)(t,null,[{key:"_fromServerResponse",value:function(e,t){return"phoneInfo"in t?da._fromServerResponse(e,t):In(e,"internal-error")}}]),t}(),da=function(t){"use strict";e(d)(r,t);var n=e(L)(r);function r(t){var i;return e(s)(this,r),(i=n.call(this,"phone",t)).phoneNumber=t.phoneInfo,i}return e(c)(r,null,[{key:"_fromServerResponse",value:function(e,t){return new r(t)}}]),r}(fa);
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function va(e,t,n){var r;An((null===(r=n.url)||void 0===r?void 0:r.length)>0,e,"invalid-continue-uri"),An(void 0===n.dynamicLinkDomain||n.dynamicLinkDomain.length>0,e,"invalid-dynamic-link-domain"),t.continueUrl=n.url,t.dynamicLinkDomain=n.dynamicLinkDomain,t.canHandleCodeInApp=n.handleCodeInApp,n.iOS&&(An(n.iOS.bundleId.length>0,e,"missing-ios-bundle-id"),t.iOSBundleId=n.iOS.bundleId),n.android&&(An(n.android.packageName.length>0,e,"missing-android-pkg-name"),t.androidInstallApp=n.android.installApp,t.androidMinimumVersionCode=n.android.minimumVersion,t.androidPackageName=n.android.packageName)}function pa(){return(pa=
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
e(ve)(e(ye).mark((function t(n,r,i){var a,o;return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=de(n),o={requestType:"PASSWORD_RESET",email:r},i&&va(a,o,i),e.next=5,ui(a,o);case 5:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function ya(){return(ya=e(ve)(e(ye).mark((function t(n,r,i){return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Yr(de(n),{oobCode:r,newPassword:i});case 2:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function ma(){return(ma=e(ve)(e(ye).mark((function t(n,r){return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,$r(de(n),{oobCode:r});case 2:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function ga(e,t){return ka.apply(this,arguments)}function ka(){return(ka=e(ve)(e(ye).mark((function t(n,r){var i,a,o,u;return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=de(n),e.next=3,Yr(i,{oobCode:r});case 3:a=e.sent,An(o=a.requestType,i,"internal-error"),e.t0=o,e.next="EMAIL_SIGNIN"===e.t0?9:"VERIFY_AND_CHANGE_EMAIL"===e.t0?10:"REVERT_SECOND_FACTOR_ADDITION"===e.t0?12:13;break;case 9:return e.abrupt("break",14);case 10:return An(a.newEmail,i,"internal-error"),e.abrupt("break",14);case 12:An(a.mfaInfo,i,"internal-error");case 13:An(a.email,i,"internal-error");case 14:return u=null,a.mfaInfo&&(u=fa._fromServerResponse(Gr(i),a.mfaInfo)),e.abrupt("return",{data:{email:("VERIFY_AND_CHANGE_EMAIL"===a.requestType?a.newEmail:a.email)||null,previousEmail:("VERIFY_AND_CHANGE_EMAIL"===a.requestType?a.email:a.newEmail)||null,multiFactorInfo:u},operation:o});case 17:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function wa(){return(wa=e(ve)(e(ye).mark((function t(n,r){var i;return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ga(de(n),r);case 2:return i=e.sent.data,e.abrupt("return",i.email);case 4:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function ba(e,t,n){return xa.apply(this,arguments)}function xa(){return(xa=e(ve)(e(ye).mark((function t(n,r,i){var a,o,u;return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=Gr(n),e.next=3,Ui(a,{returnSecureToken:!0,email:r,password:i});case 3:return o=e.sent,e.next=6,qi._fromIdTokenResponse(a,"signIn",o);case 6:return u=e.sent,e.next=9,a._updateCurrentUser(u.user);case 9:return e.abrupt("return",u);case 10:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function Ia(){return(Ia=
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
e(ve)(e(ye).mark((function t(n,r,i){var a,o;return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=de(n),o={requestType:"EMAIL_SIGNIN",email:r},An(i.handleCodeInApp,a,"argument-error"),i&&va(a,o,i),e.next=6,ci(a,o);case 6:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function _a(){return(_a=e(ve)(e(ye).mark((function t(n,r,i){var a,o;return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=de(n),An((o=Ci.credentialWithLink(r,i||On()))._tenantId===(a.tenantId||null),a,"tenant-id-mismatch"),e.abrupt("return",ra(a,o));case 4:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function Ta(e,t){return Ea.apply(this,arguments)}function Ea(){return(Ea=
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
e(ve)(e(ye).mark((function t(n,r){return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Gn(n,"POST","/v1/accounts:createAuthUri",jn(n,r)));case 1:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function Sa(){return(Sa=
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
e(ve)(e(ye).mark((function t(n,r){var i,a,o;return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=Pn()?On():"http://localhost",a={identifier:r,continueUri:i},e.next=4,Ta(de(n),a);case 4:return o=e.sent.signinMethods,e.abrupt("return",o||[]);case 6:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function Aa(){return(Aa=e(ve)(e(ye).mark((function t(n,r){var i,a,o;return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=de(n),e.next=3,n.getIdToken();case 3:return a=e.sent,o={requestType:"VERIFY_EMAIL",idToken:a},r&&va(i.auth,o,r),e.next=8,ai(i.auth,o);case 8:if(e.sent.email===n.email){e.next=12;break}return e.next=12,n.reload();case 12:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function Ca(){return(Ca=e(ve)(e(ye).mark((function t(n,r,i){var a,o,u;return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=de(n),e.next=3,n.getIdToken();case 3:return o=e.sent,u={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:o,newEmail:r},i&&va(a.auth,u,i),e.next=8,hi(a.auth,u);case 8:if(e.sent.email===n.email){e.next=12;break}return e.next=12,n.reload();case 12:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function Na(e,t){return Da.apply(this,arguments)}function Da(){return(Da=
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
e(ve)(e(ye).mark((function t(n,r){return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Gn(n,"POST","/v1/accounts:update",r));case 1:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function Ra(){return(Ra=
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
e(ve)(e(ye).mark((function t(n,r){var i,a,o,u,s,c,l;return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=r.displayName,a=r.photoURL,void 0!==i||void 0!==a){e.next=3;break}return e.abrupt("return");case 3:return o=de(n),e.next=6,o.getIdToken();case 6:return u=e.sent,s={idToken:u,displayName:i,photoUrl:a,returnSecureToken:!0},e.next=10,sr(o,Na(o.auth,s));case 10:return c=e.sent,o.displayName=c.displayName||null,o.photoURL=c.photoUrl||null,(l=o.providerData.find((function(e){return"password"===e.providerId})))&&(l.displayName=o.displayName,l.photoURL=o.photoURL),e.next=17,o._updateTokensIfNecessary(c);case 17:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function Oa(e,t,n){return Pa.apply(this,arguments)}function Pa(){return(Pa=e(ve)(e(ye).mark((function t(n,r,i){var a,o,u,s;return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=n.auth,e.next=3,n.getIdToken();case 3:return o=e.sent,u={idToken:o,returnSecureToken:!0},r&&(u.email=r),i&&(u.password=i),e.next=9,sr(n,Xr(a,u));case 9:return s=e.sent,e.next=12,n._updateTokensIfNecessary(s,!0);case 12:case"end":return e.stop()}}),t)})))).apply(this,arguments)}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var La=function t(n,r){"use strict";var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};e(s)(this,t),this.isNewUser=n,this.providerId=r,this.profile=i},Ma=function(t){"use strict";e(d)(r,t);var n=e(L)(r);function r(t,i,a,o){var u;return e(s)(this,r),(u=n.call(this,t,i,a)).username=o,u}return r}(La),Fa=function(t){"use strict";e(d)(r,t);var n=e(L)(r);function r(t,i){return e(s)(this,r),n.call(this,t,"facebook.com",i)}return r}(La),Va=function(t){"use strict";e(d)(r,t);var n=e(L)(r);function r(t,i){return e(s)(this,r),n.call(this,t,"github.com",i,"string"==typeof(null==i?void 0:i.login)?null==i?void 0:i.login:null)}return r}(Ma),Ua=function(t){"use strict";e(d)(r,t);var n=e(L)(r);function r(t,i){return e(s)(this,r),n.call(this,t,"google.com",i)}return r}(La),Ba=function(t){"use strict";e(d)(r,t);var n=e(L)(r);function r(t,i,a){return e(s)(this,r),n.call(this,t,"twitter.com",i,a)}return r}(Ma);function qa(e){var t=e.user,n=e._tokenResponse;return t.isAnonymous&&!n?{providerId:null,isNewUser:!1,profile:null}:function(e){var t,n;if(!e)return null;var r=e.providerId,i=e.rawUserInfo?JSON.parse(e.rawUserInfo):{},a=e.isNewUser||"identitytoolkit#SignupNewUserResponse"===e.kind;if(!r&&(null==e?void 0:e.idToken)){var o=null===(n=null===(t=ur(e.idToken))||void 0===t?void 0:t.firebase)||void 0===n?void 0:n.sign_in_provider;if(o)return new La(a,"anonymous"!==o&&"custom"!==o?o:null)}if(!r)return null;switch(r){case"facebook.com":return new Fa(a,i);case"github.com":return new Va(a,i);case"google.com":return new Ua(a,i);case"twitter.com":return new Ba(a,i,e.screenName||null);case"custom":case"anonymous":return new La(a,null);default:return new La(a,r,i)}}(n)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ja=function(){"use strict";function t(n,r,i){e(s)(this,t),this.type=n,this.credential=r,this.auth=i}return e(c)(t,[{key:"toJSON",value:function(){var t="enroll"===this.type?"idToken":"pendingCredential";return{multiFactorSession:e(h)({},t,this.credential)}}}],[{key:"_fromIdtoken",value:function(e,n){return new t("enroll",e,n)}},{key:"_fromMfaPendingCredential",value:function(e){return new t("signin",e)}},{key:"fromJSON",value:function(e){var n,r;if(null==e?void 0:e.multiFactorSession){if(null===(n=e.multiFactorSession)||void 0===n?void 0:n.pendingCredential)return t._fromMfaPendingCredential(e.multiFactorSession.pendingCredential);if(null===(r=e.multiFactorSession)||void 0===r?void 0:r.idToken)return t._fromIdtoken(e.multiFactorSession.idToken)}return null}}]),t}(),Ga=function(){"use strict";function t(n,r,i){e(s)(this,t),this.session=n,this.hints=r,this.signInResolver=i}return e(c)(t,[{key:"resolveSignIn",value:function(t){var n=this;return e(ve)(e(ye).mark((function r(){var i;return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=t,e.abrupt("return",n.signInResolver(i));case 2:case"end":return e.stop()}}),r)})))()}}],[{key:"_fromError",value:function(n,r){var i=Gr(n),a=r.customData._serverResponse,o=(a.mfaInfo||[]).map((function(e){return fa._fromServerResponse(i,e)}));An(a.mfaPendingCredential,i,"internal-error");var u,s=ja._fromMfaPendingCredential(a.mfaPendingCredential);return new t(s,o,(u=e(ve)(e(ye).mark((function t(n){var o,u,c;return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n._process(i,s);case 2:o=e.sent,delete a.mfaInfo,delete a.mfaPendingCredential,u=Object.assign(Object.assign({},a),{idToken:o.idToken,refreshToken:o.refreshToken}),e.t0=r.operationType,e.next="signIn"===e.t0?9:"reauthenticate"===e.t0?15:17;break;case 9:return e.next=11,qi._fromIdTokenResponse(i,r.operationType,u);case 11:return c=e.sent,e.next=14,i._updateCurrentUser(c.user);case 14:return e.abrupt("return",c);case 15:return An(r.user,i,"internal-error"),e.abrupt("return",qi._forOperation(r.user,r.operationType,u));case 17:In(i,"internal-error");case 18:case"end":return e.stop()}}),t)}))),function(e){return u.apply(this,arguments)}))}}]),t}();
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function Ka(e,t){return Gn(e,"POST","/v2/accounts/mfaEnrollment:start",jn(e,t))}var za=function(){"use strict";function t(n){var r=this;e(s)(this,t),this.user=n,this.enrolledFactors=[],n._onReload((function(e){e.mfaInfo&&(r.enrolledFactors=e.mfaInfo.map((function(e){return fa._fromServerResponse(n.auth,e)})))}))}return e(c)(t,[{key:"getSession",value:function(){var t=this;return e(ve)(e(ye).mark((function n(){return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=ja,e.next=3,t.user.getIdToken();case 3:return e.t1=e.sent,e.t2=t.user.auth,e.abrupt("return",e.t0._fromIdtoken.call(e.t0,e.t1,e.t2));case 6:case"end":return e.stop()}}),n)})))()}},{key:"enroll",value:function(t,n){var r=this;return e(ve)(e(ye).mark((function i(){var a,o,u;return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t,e.next=3,r.getSession();case 3:return o=e.sent,e.next=6,sr(r.user,a._process(r.user.auth,o,n));case 6:return u=e.sent,e.next=9,r.user._updateTokensIfNecessary(u);case 9:return e.abrupt("return",r.user.reload());case 10:case"end":return e.stop()}}),i)})))()}},{key:"unenroll",value:function(t){var n=this;return e(ve)(e(ye).mark((function r(){var i,a,o,u;return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a="string"==typeof t?t:t.uid,e.next=4,n.user.getIdToken();case 4:return o=e.sent,e.next=7,sr(n.user,Gn(r=n.user.auth,"POST","/v2/accounts/mfaEnrollment:withdraw",jn(r,{idToken:o,mfaEnrollmentId:a})));case 7:return u=e.sent,n.enrolledFactors=n.enrolledFactors.filter((function(e){return e.uid!==a})),e.next=11,n.user._updateTokensIfNecessary(u);case 11:return e.prev=11,e.next=14,n.user.reload();case 14:e.next=20;break;case 16:if(e.prev=16,e.t0=e.catch(11),"auth/user-token-expired"===(null===(i=e.t0)||void 0===i?void 0:i.code)){e.next=20;break}throw e.t0;case 20:case"end":return e.stop()}var r}),r,null,[[11,16]])})))()}}],[{key:"_fromUser",value:function(e){return new t(e)}}]),t}(),Wa=new WeakMap;var Ha="__sak",Qa=function(){"use strict";function t(n,r){e(s)(this,t),this.storageRetriever=n,this.type=r}return e(c)(t,[{key:"_isAvailable",value:function(){try{return this.storage?(this.storage.setItem(Ha,"1"),this.storage.removeItem(Ha),Promise.resolve(!0)):Promise.resolve(!1)}catch(e){return Promise.resolve(!1)}}},{key:"_set",value:function(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}},{key:"_get",value:function(e){var t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}},{key:"_remove",value:function(e){return this.storage.removeItem(e),Promise.resolve()}},{key:"storage",get:function(){return this.storageRetriever()}}]),t}();
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ya=function(t){"use strict";e(d)(r,t);var n=e(L)(r);function r(){var t,i;return e(s)(this,r),(t=n.call(this,(function(){return window.localStorage}),"LOCAL")).boundEventHandler=function(e,n){return t.onStorageEvent(e,n)},t.listeners={},t.localCache={},t.pollTimer=null,t.safariLocalStorageNotSynced=(Cr(i=H())||Lr(i))&&function(){try{return!(!window||window===window.top)}catch(e){return!1}}(),t.fallbackToPolling=Ur(),t._shouldAllowMigration=!0,t}return e(c)(r,[{key:"forAllChangedKeys",value:function(e){var t=!0,n=!1,r=void 0;try{for(var i,a=Object.keys(this.listeners)[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){var o=i.value,u=this.storage.getItem(o),s=this.localCache[o];u!==s&&e(o,s,u)}}catch(e){n=!0,r=e}finally{try{t||null==a.return||a.return()}finally{if(n)throw r}}}},{key:"onStorageEvent",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this;if(e.key){var r=e.key;if(t?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){var i=this.storage.getItem(r);if(e.newValue!==i)null!==e.newValue?this.storage.setItem(r,e.newValue):this.storage.removeItem(r);else if(this.localCache[r]===e.newValue&&!t)return}var a=function(){var e=n.storage.getItem(r);(t||n.localCache[r]!==e)&&n.notifyListeners(r,e)},o=this.storage.getItem(r);Vr()&&o!==e.newValue&&e.newValue!==e.oldValue?setTimeout(a,10):a()}else{var u=this;this.forAllChangedKeys((function(e,t,n){u.notifyListeners(e,n)}))}}},{key:"notifyListeners",value:function(e,t){this.localCache[e]=t;var n=this.listeners[e],r=!0,i=!1,a=void 0;if(n)try{for(var o,u=Array.from(n)[Symbol.iterator]();!(r=(o=u.next()).done);r=!0){(0,o.value)(t?JSON.parse(t):t)}}catch(e){i=!0,a=e}finally{try{r||null==u.return||u.return()}finally{if(i)throw a}}}},{key:"startPolling",value:function(){var e=this;this.stopPolling(),this.pollTimer=setInterval((function(){var t=e;e.forAllChangedKeys((function(e,n,r){t.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:r}),!0)}))}),1e3)}},{key:"stopPolling",value:function(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}},{key:"attachListener",value:function(){window.addEventListener("storage",this.boundEventHandler)}},{key:"detachListener",value:function(){window.removeEventListener("storage",this.boundEventHandler)}},{key:"_addListener",value:function(e,t){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}},{key:"_removeListener",value:function(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}},{key:"_set",value:function(t,n){var i=this,a=this;return e(ve)(e(ye).mark((function o(){return e(ye).wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,e(Qt)(e(Xt)(r.prototype),"_set",i).call(a,t,n);case 2:a.localCache[t]=JSON.stringify(n);case 3:case"end":return o.stop()}}),o)})))()}},{key:"_get",value:function(t){var n=this,i=this;return e(ve)(e(ye).mark((function a(){var o;return e(ye).wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,e(Qt)(e(Xt)(r.prototype),"_get",n).call(i,t);case 2:return o=a.sent,i.localCache[t]=JSON.stringify(o),a.abrupt("return",o);case 5:case"end":return a.stop()}}),a)})))()}},{key:"_remove",value:function(t){var n=this,i=this;return e(ve)(e(ye).mark((function a(){return e(ye).wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,e(Qt)(e(Xt)(r.prototype),"_remove",n).call(i,t);case 2:delete i.localCache[t];case 3:case"end":return a.stop()}}),a)})))()}}]),r}(Qa);Ya.type="LOCAL";var Ja=Ya,Xa=function(t){"use strict";e(d)(r,t);var n=e(L)(r);function r(){return e(s)(this,r),n.call(this,(function(){return window.sessionStorage}),"SESSION")}return e(c)(r,[{key:"_addListener",value:function(e,t){}},{key:"_removeListener",value:function(e,t){}}]),r}(Qa);
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Xa.type="SESSION";var Za=Xa;
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $a(t){return Promise.all(t.map((n=e(ve)(e(ye).mark((function t(n){var r;return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,n;case 3:return r=e.sent,e.abrupt("return",{fulfilled:!0,value:r});case 7:return e.prev=7,e.t0=e.catch(0),e.abrupt("return",{fulfilled:!1,reason:e.t0});case 10:case"end":return e.stop()}}),t,null,[[0,7]])}))),function(e){return n.apply(this,arguments)})));var n}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var eo=function(){"use strict";function t(n){e(s)(this,t),this.eventTarget=n,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}return e(c)(t,[{key:"isListeningto",value:function(e){return this.eventTarget===e}},{key:"handleEvent",value:function(t){var n=this;return e(ve)(e(ye).mark((function r(){var i,a,o,u,s,c,l,h;return e(ye).wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(a=(i=t).data,o=a.eventId,u=a.eventType,s=a.data,null==(c=n.handlersMap[u])?void 0:c.size){r.next=5;break}return r.abrupt("return");case 5:return i.ports[0].postMessage({status:"ack",eventId:o,eventType:u}),l=Array.from(c).map(function(){var t=e(ve)(e(ye).mark((function t(n){return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",n(i.origin,s));case 1:case"end":return e.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),r.next=9,$a(l);case 9:h=r.sent,i.ports[0].postMessage({status:"done",eventId:o,eventType:u,response:h});case 11:case"end":return r.stop()}}),r)})))()}},{key:"_subscribe",value:function(e,t){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}},{key:"_unsubscribe",value:function(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),t&&0!==this.handlersMap[e].size||delete this.handlersMap[e],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}],[{key:"_getInstance",value:function(e){var n=this.receivers.find((function(t){return t.isListeningto(e)}));if(n)return n;var r=new t(e);return this.receivers.push(r),r}}]),t}();
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function to(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,n="",r=0;r<t;r++)n+=Math.floor(10*Math.random());return e+n}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */eo.receivers=[];var no=function(){"use strict";function t(n){e(s)(this,t),this.target=n,this.handlers=new Set}return e(c)(t,[{key:"removeMessageHandler",value:function(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}},{key:"_send",value:function(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:50,i=this;return e(ve)(e(ye).mark((function a(){var o,u,s;return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o="undefined"!=typeof MessageChannel?new MessageChannel:null){e.next=3;break}throw new Error("connection_unavailable");case 3:return e.abrupt("return",new Promise((function(e,a){var c=to("",20);o.port1.start();var l=setTimeout((function(){a(new Error("unsupported_event"))}),r);s={messageChannel:o,onMessage:function(t){var n=t;if(n.data.eventId===c)switch(n.data.status){case"ack":clearTimeout(l),u=setTimeout((function(){a(new Error("timeout"))}),3e3);break;case"done":clearTimeout(u),e(n.data.response);break;default:clearTimeout(l),clearTimeout(u),a(new Error("invalid_response"))}}},i.handlers.add(s),o.port1.addEventListener("message",s.onMessage),i.target.postMessage({eventType:t,eventId:c,data:n},[o.port2])})).finally((function(){s&&i.removeMessageHandler(s)})));case 6:case"end":return e.stop()}}),a)})))()}}]),t}();
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ro(){return window}
/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function io(){return void 0!==ro().WorkerGlobalScope&&"function"==typeof ro().importScripts}function ao(){return oo.apply(this,arguments)}function oo(){return(oo=e(ve)(e(ye).mark((function t(){var n;return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===navigator||void 0===navigator?void 0:navigator.serviceWorker){e.next=2;break}return e.abrupt("return",null);case 2:return e.prev=2,e.next=5,navigator.serviceWorker.ready;case 5:return n=e.sent,e.abrupt("return",n.active);case 9:return e.prev=9,e.t0=e.catch(2),e.abrupt("return",null);case 12:case"end":return e.stop()}}),t,null,[[2,9]])})))).apply(this,arguments)}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var uo="firebaseLocalStorageDb",so="firebaseLocalStorage",co="fbase_key",lo=function(){"use strict";function t(n){e(s)(this,t),this.request=n}return e(c)(t,[{key:"toPromise",value:function(){var e=this;return new Promise((function(t,n){var r=e;e.request.addEventListener("success",(function(){t(r.request.result)})),e.request.addEventListener("error",(function(){n(r.request.error)}))}))}}]),t}();function ho(e,t){return e.transaction([so],t?"readwrite":"readonly").objectStore(so)}function fo(){var e=indexedDB.deleteDatabase(uo);return new lo(e).toPromise()}function vo(){var t=indexedDB.open(uo,1);return new Promise((function(n,r){t.addEventListener("error",(function(){r(t.error)})),t.addEventListener("upgradeneeded",(function(){var e=t.result;try{e.createObjectStore(so,{keyPath:co})}catch(e){r(e)}})),t.addEventListener("success",e(ve)(e(ye).mark((function r(){var i;return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((i=t.result).objectStoreNames.contains(so)){e.next=12;break}return i.close(),e.next=5,fo();case 5:return e.t0=n,e.next=8,vo();case 8:e.t1=e.sent,(0,e.t0)(e.t1),e.next=13;break;case 12:n(i);case 13:case"end":return e.stop()}}),r)}))))}))}function po(e,t,n){return yo.apply(this,arguments)}function yo(){return(yo=e(ve)(e(ye).mark((function t(n,r,i){var a,o;return e(ye).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=ho(n,!0).put((a={},e(h)(a,co,r),e(h)(a,"value",i),a)),t.abrupt("return",new lo(o).toPromise());case 3:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function mo(e,t){return go.apply(this,arguments)}function go(){return(go=e(ve)(e(ye).mark((function t(n,r){var i,a;return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=ho(n,!1).get(r),e.next=3,new lo(i).toPromise();case 3:return a=e.sent,e.abrupt("return",void 0===a?null:a.value);case 5:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function ko(e,t){var n=ho(e,!0).delete(t);return new lo(n).toPromise()}var wo=function(){"use strict";function t(){e(s)(this,t),this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then((function(){}),(function(){}))}return e(c)(t,[{key:"_openDb",value:function(){var t=this;return e(ve)(e(ye).mark((function n(){return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.db){e.next=2;break}return e.abrupt("return",t.db);case 2:return e.next=4,vo();case 4:return t.db=e.sent,e.abrupt("return",t.db);case 6:case"end":return e.stop()}}),n)})))()}},{key:"_withRetries",value:function(t){var n=this;return e(ve)(e(ye).mark((function r(){var i,a;return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i=0;case 1:return e.prev=2,e.next=5,n._openDb();case 5:return a=e.sent,e.next=8,t(a);case 8:return e.abrupt("return",e.sent);case 11:if(e.prev=11,e.t0=e.catch(2),!(i++>3)){e.next=15;break}throw e.t0;case 15:n.db&&(n.db.close(),n.db=void 0);case 16:e.next=1;break;case 18:case"end":return e.stop()}}),r,null,[[2,11]])})))()}},{key:"initializeServiceWorkerMessaging",value:function(){var t=this;return e(ve)(e(ye).mark((function n(){return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",io()?t.initializeReceiver():t.initializeSender());case 1:case"end":return e.stop()}}),n)})))()}},{key:"initializeReceiver",value:function(){var t=this;return e(ve)(e(ye).mark((function n(){return e(ye).wrap((function(n){for(;;)switch(n.prev=n.next){case 0:t.receiver=eo._getInstance(io()?self:null),t.receiver._subscribe("keyChanged",function(){var n=e(ve)(e(ye).mark((function n(r,i){var a;return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t._poll();case 2:return a=e.sent,e.abrupt("return",{keyProcessed:a.includes(i.key)});case 4:case"end":return e.stop()}}),n)})));return function(e,t){return n.apply(this,arguments)}}()),t.receiver._subscribe("ping",function(){var t=e(ve)(e(ye).mark((function t(n,r){return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",["keyChanged"]);case 1:case"end":return e.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}());case 3:case"end":return n.stop()}}),n)})))()}},{key:"initializeSender",value:function(){var t=this;return e(ve)(e(ye).mark((function n(){var r,i,a;return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=3,ao();case 3:if(t.activeServiceWorker=e.sent,t.activeServiceWorker){e.next=6;break}return e.abrupt("return");case 6:return t.sender=new no(t.activeServiceWorker),e.next=9,t.sender._send("ping",{},800);case 9:if(a=e.sent){e.next=12;break}return e.abrupt("return");case 12:(null===(r=a[0])||void 0===r?void 0:r.fulfilled)&&(null===(i=a[0])||void 0===i?void 0:i.value.includes("keyChanged"))&&(t.serviceWorkerReceiverAvailable=!0);case 13:case"end":return e.stop()}}),n)})))()}},{key:"notifyServiceWorker",value:function(t){var n=this;return e(ve)(e(ye).mark((function r(){return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.sender&&n.activeServiceWorker&&(r=void 0,((null===(r=null===navigator||void 0===navigator?void 0:navigator.serviceWorker)||void 0===r?void 0:r.controller)||null)===n.activeServiceWorker)){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,e.next=5,n.sender._send("keyChanged",{key:t},n.serviceWorkerReceiverAvailable?800:50);case 5:e.next=9;break;case 7:e.prev=7,e.t0=e.catch(2);case 9:case"end":return e.stop()}var r}),r,null,[[2,7]])})))()}},{key:"_isAvailable",value:function(){return e(ve)(e(ye).mark((function t(){var n;return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,indexedDB){e.next=3;break}return e.abrupt("return",!1);case 3:return e.next=5,vo();case 5:return n=e.sent,e.next=8,po(n,Ha,"1");case 8:return e.next=10,ko(n,Ha);case 10:return e.abrupt("return",!0);case 13:e.prev=13,e.t0=e.catch(0);case 15:return e.abrupt("return",!1);case 16:case"end":return e.stop()}}),t,null,[[0,13]])})))()}},{key:"_withPendingWrite",value:function(t){var n=this;return e(ve)(e(ye).mark((function r(){return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.pendingWrites++,e.prev=1,e.next=4,t();case 4:return e.prev=4,n.pendingWrites--,e.finish(4);case 7:case"end":return e.stop()}}),r,null,[[1,,4,7]])})))()}},{key:"_set",value:function(t,n){var r=this;return e(ve)(e(ye).mark((function i(){return e(ye).wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",r._withPendingWrite(e(ve)(e(ye).mark((function i(){return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r._withRetries((function(e){return po(e,t,n)}));case 2:return r.localCache[t]=n,e.abrupt("return",r.notifyServiceWorker(t));case 4:case"end":return e.stop()}}),i)})))));case 1:case"end":return i.stop()}}),i)})))()}},{key:"_get",value:function(t){var n=this;return e(ve)(e(ye).mark((function r(){var i;return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n._withRetries((function(e){return mo(e,t)}));case 2:return i=e.sent,n.localCache[t]=i,e.abrupt("return",i);case 5:case"end":return e.stop()}}),r)})))()}},{key:"_remove",value:function(t){var n=this;return e(ve)(e(ye).mark((function r(){return e(ye).wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",n._withPendingWrite(e(ve)(e(ye).mark((function r(){return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n._withRetries((function(e){return ko(e,t)}));case 2:return delete n.localCache[t],e.abrupt("return",n.notifyServiceWorker(t));case 4:case"end":return e.stop()}}),r)})))));case 1:case"end":return r.stop()}}),r)})))()}},{key:"_poll",value:function(){var t=this;return e(ve)(e(ye).mark((function n(){var r,i,a,o,u,s,c,l,h,f,d,v,p,y,m,g,k;return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t._withRetries((function(e){var t=ho(e,!1).getAll();return new lo(t).toPromise()}));case 2:if(r=e.sent){e.next=5;break}return e.abrupt("return",[]);case 5:if(0===t.pendingWrites){e.next=7;break}return e.abrupt("return",[]);case 7:for(i=[],a=new Set,o=!0,u=!1,s=void 0,e.prev=10,c=r[Symbol.iterator]();!(o=(l=c.next()).done);o=!0)h=l.value,f=h.fbase_key,d=h.value,a.add(f),JSON.stringify(t.localCache[f])!==JSON.stringify(d)&&(t.notifyListeners(f,d),i.push(f));e.next=18;break;case 14:e.prev=14,e.t0=e.catch(10),u=!0,s=e.t0;case 18:e.prev=18,e.prev=19,o||null==c.return||c.return();case 21:if(e.prev=21,!u){e.next=24;break}throw s;case 24:return e.finish(21);case 25:return e.finish(18);case 26:for(v=!0,p=!1,y=void 0,e.prev=27,m=Object.keys(t.localCache)[Symbol.iterator]();!(v=(g=m.next()).done);v=!0)k=g.value,t.localCache[k]&&!a.has(k)&&(t.notifyListeners(k,null),i.push(k));e.next=35;break;case 31:e.prev=31,e.t1=e.catch(27),p=!0,y=e.t1;case 35:e.prev=35,e.prev=36,v||null==m.return||m.return();case 38:if(e.prev=38,!p){e.next=41;break}throw y;case 41:return e.finish(38);case 42:return e.finish(35);case 43:return e.abrupt("return",i);case 44:case"end":return e.stop()}}),n,null,[[10,14,18,26],[19,,21,25],[27,31,35,43],[36,,38,42]])})))()}},{key:"notifyListeners",value:function(e,t){this.localCache[e]=t;var n=this.listeners[e],r=!0,i=!1,a=void 0;if(n)try{for(var o,u=Array.from(n)[Symbol.iterator]();!(r=(o=u.next()).done);r=!0){(0,o.value)(t)}}catch(e){i=!0,a=e}finally{try{r||null==u.return||u.return()}finally{if(i)throw a}}}},{key:"startPolling",value:function(){this.stopPolling();var t=this;this.pollTimer=setInterval(e(ve)(e(ye).mark((function n(){return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t._poll());case 1:case"end":return e.stop()}}),n)}))),800)}},{key:"stopPolling",value:function(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}},{key:"_addListener",value:function(e,t){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}},{key:"_removeListener",value:function(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&this.stopPolling()}}]),t}();wo.type="LOCAL";var bo=wo;
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xo(e,t){return Gn(e,"POST","/v2/accounts/mfaSignIn:start",jn(e,t))}function Io(e){return _o.apply(this,arguments)}function _o(){return(_o=
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
e(ve)(e(ye).mark((function t(n){return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Gn(n,"GET","/v1/recaptchaParams");case 2:if(e.t0=e.sent.recaptchaSiteKey,e.t0){e.next=5;break}e.t0="";case 5:return e.abrupt("return",e.t0);case 6:case"end":return e.stop()}}),t)})))).apply(this,arguments)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function To(e){return new Promise((function(t,n){var r,i,a=document.createElement("script");a.setAttribute("src",e),a.onload=t,a.onerror=function(e){var t=_n("internal-error");t.customData=e,n(t)},a.type="text/javascript",a.charset="UTF-8",(null!==(i=null===(r=document.getElementsByTagName("head"))||void 0===r?void 0:r[0])&&void 0!==i?i:document).appendChild(a)}))}function Eo(e){return"__".concat(e).concat(Math.floor(1e6*Math.random()))}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var So=1e12,Ao=function(){"use strict";function t(n){e(s)(this,t),this.auth=n,this.counter=So,this._widgets=new Map}return e(c)(t,[{key:"render",value:function(e,t){var n=this.counter;return this._widgets.set(n,new Co(e,this.auth.name,t||{})),this.counter++,n}},{key:"reset",value:function(e){var t,n=e||So;null===(t=this._widgets.get(n))||void 0===t||t.delete(),this._widgets.delete(n)}},{key:"getResponse",value:function(e){var t,n=e||So;return(null===(t=this._widgets.get(n))||void 0===t?void 0:t.getResponse())||""}},{key:"execute",value:function(t){var n=this;return e(ve)(e(ye).mark((function r(){var i,a;return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t||So,null===(i=n._widgets.get(a))||void 0===i||i.execute(),e.abrupt("return","");case 4:case"end":return e.stop()}}),r)})))()}}]),t}(),Co=function(){"use strict";function t(n,r,i){var a=this;e(s)(this,t),this.params=i,this.timerId=null,this.deleted=!1,this.responseToken=null,this.clickHandler=function(){a.execute()};var o="string"==typeof n?document.getElementById(n):n;An(o,"argument-error",{appName:r}),this.container=o,this.isVisible="invisible"!==this.params.size,this.isVisible?this.execute():this.container.addEventListener("click",this.clickHandler)}return e(c)(t,[{key:"getResponse",value:function(){return this.checkIfDeleted(),this.responseToken}},{key:"delete",value:function(){this.checkIfDeleted(),this.deleted=!0,this.timerId&&(clearTimeout(this.timerId),this.timerId=null),this.container.removeEventListener("click",this.clickHandler)}},{key:"execute",value:function(){var e=this;this.checkIfDeleted(),this.timerId||(this.timerId=window.setTimeout((function(){var t=e;e.responseToken=function(e){for(var t=[],n="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ",r=0;r<e;r++)t.push(n.charAt(Math.floor(Math.random()*n.length)));return t.join("")}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(50);var n=e.params,r=n.callback,i=n["expired-callback"];if(r)try{r(e.responseToken)}catch(e){}e.timerId=window.setTimeout((function(){if(t.timerId=null,t.responseToken=null,i)try{i()}catch(e){}t.isVisible&&t.execute()}),6e4)}),500))}},{key:"checkIfDeleted",value:function(){if(this.deleted)throw new Error("reCAPTCHA mock was already deleted!")}}]),t}();var No=Eo("rcb"),Do=new Mn(3e4,6e4),Ro="https://www.google.com/recaptcha/api.js?",Oo=function(){"use strict";function t(){var n;e(s)(this,t),this.hostLanguage="",this.counter=0,this.librarySeparatelyLoaded=!!(null===(n=ro().grecaptcha)||void 0===n?void 0:n.render)}return e(c)(t,[{key:"load",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=this;return An(Po(t),e,"argument-error"),this.shouldResolveImmediately(t)?Promise.resolve(ro().grecaptcha):new Promise((function(r,i){var a=n,o=ro().setTimeout((function(){i(_n(e,"network-request-failed"))}),Do.get());ro()[No]=function(){var n=a;ro().clearTimeout(o),delete ro()[No];var u=ro().grecaptcha;if(u){var s=u.render;u.render=function(e,t){var r=s(e,t);return n.counter++,r},a.hostLanguage=t,r(u)}else i(_n(e,"internal-error"))},To("".concat(Ro,"?").concat(ue({onload:No,render:"explicit",hl:t}))).catch((function(){clearTimeout(o),i(_n(e,"internal-error"))}))}))}},{key:"clearedOneInstance",value:function(){this.counter--}},{key:"shouldResolveImmediately",value:function(e){var t;return!!(null===(t=ro().grecaptcha)||void 0===t?void 0:t.render)&&(e===this.hostLanguage||this.counter>0||this.librarySeparatelyLoaded)}}]),t}();function Po(e){return e.length<=6&&/^\s*[a-zA-Z0-9\-]*\s*$/.test(e)}var Lo=function(){"use strict";function t(){e(s)(this,t)}return e(c)(t,[{key:"load",value:function(t){return e(ve)(e(ye).mark((function n(){return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Ao(t));case 1:case"end":return e.stop()}}),n)})))()}},{key:"clearedOneInstance",value:function(){}}]),t}(),Mo="recaptcha",Fo={theme:"light",type:"image"},Vo=function(){"use strict";function t(n){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Object.assign({},Fo),i=arguments.length>2?arguments[2]:void 0;e(s)(this,t),this.parameters=r,this.type=Mo,this.destroyed=!1,this.widgetId=null,this.tokenChangeListeners=new Set,this.renderPromise=null,this.recaptcha=null,this.auth=Gr(i),this.isInvisible="invisible"===this.parameters.size,An("undefined"!=typeof document,this.auth,"operation-not-supported-in-this-environment");var a="string"==typeof n?document.getElementById(n):n;An(a,this.auth,"argument-error"),this.container=a,this.parameters.callback=this.makeTokenCallback(this.parameters.callback),this._recaptchaLoader=this.auth.settings.appVerificationDisabledForTesting?new Lo:new Oo,this.validateStartingState()}return e(c)(t,[{key:"verify",value:function(){var t=this;return e(ve)(e(ye).mark((function n(){var r,i,a;return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.assertNotDestroyed(),e.next=3,t.render();case 3:if(r=e.sent,i=t.getAssertedRecaptcha(),!(a=i.getResponse(r))){e.next=8;break}return e.abrupt("return",a);case 8:return e.abrupt("return",new Promise((function(e){var n=function(r){r&&(t.tokenChangeListeners.delete(n),e(r))};t.tokenChangeListeners.add(n),t.isInvisible&&i.execute(r)})));case 9:case"end":return e.stop()}}),n)})))()}},{key:"render",value:function(){var e=this;try{this.assertNotDestroyed()}catch(e){return Promise.reject(e)}return this.renderPromise||(this.renderPromise=this.makeRenderPromise().catch((function(t){throw e.renderPromise=null,t}))),this.renderPromise}},{key:"_reset",value:function(){this.assertNotDestroyed(),null!==this.widgetId&&this.getAssertedRecaptcha().reset(this.widgetId)}},{key:"clear",value:function(){var e=this;this.assertNotDestroyed(),this.destroyed=!0,this._recaptchaLoader.clearedOneInstance(),this.isInvisible||this.container.childNodes.forEach((function(t){e.container.removeChild(t)}))}},{key:"validateStartingState",value:function(){An(!this.parameters.sitekey,this.auth,"argument-error"),An(this.isInvisible||!this.container.hasChildNodes(),this.auth,"argument-error"),An("undefined"!=typeof document,this.auth,"operation-not-supported-in-this-environment")}},{key:"makeTokenCallback",value:function(e){var t=this;return function(n){if(t.tokenChangeListeners.forEach((function(e){return e(n)})),"function"==typeof e)e(n);else if("string"==typeof e){var r=ro()[e];"function"==typeof r&&r(n)}}}},{key:"assertNotDestroyed",value:function(){An(!this.destroyed,this.auth,"internal-error")}},{key:"makeRenderPromise",value:function(){var t=this;return e(ve)(e(ye).mark((function n(){var r,i;return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.init();case 2:return t.widgetId||(r=t.container,t.isInvisible||(i=document.createElement("div"),r.appendChild(i),r=i),t.widgetId=t.getAssertedRecaptcha().render(r,t.parameters)),e.abrupt("return",t.widgetId);case 4:case"end":return e.stop()}}),n)})))()}},{key:"init",value:function(){var t=this;return e(ve)(e(ye).mark((function n(){var r;return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return An(Pn()&&!io(),t.auth,"internal-error"),e.next=3,Uo();case 3:return e.next=5,t._recaptchaLoader.load(t.auth,t.auth.languageCode||void 0);case 5:return t.recaptcha=e.sent,e.next=8,Io(t.auth);case 8:An(r=e.sent,t.auth,"internal-error"),t.parameters.sitekey=r;case 11:case"end":return e.stop()}}),n)})))()}},{key:"getAssertedRecaptcha",value:function(){return An(this.recaptcha,this.auth,"internal-error"),this.recaptcha}}]),t}();
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Uo(){var e=null;return new Promise((function(t){"complete"!==document.readyState?(e=function(){return t()},window.addEventListener("load",e)):t()})).catch((function(t){throw e&&window.removeEventListener("load",e),t}))}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Bo=function(){"use strict";function t(n,r){e(s)(this,t),this.verificationId=n,this.onConfirmation=r}return e(c)(t,[{key:"confirm",value:function(e){var t=Si._fromVerification(this.verificationId,e);return this.onConfirmation(t)}}]),t}();function qo(){return(qo=e(ve)(e(ye).mark((function t(n,r,i){var a,o;return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=Gr(n),e.next=3,zo(a,r,de(i));case 3:return o=e.sent,e.abrupt("return",new Bo(o,(function(e){return ra(a,e)})));case 5:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function jo(e,t,n){return Go.apply(this,arguments)}function Go(){return(Go=e(ve)(e(ye).mark((function t(n,r,i){var a,o;return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=de(n),e.next=3,Xi(!1,a,"phone");case 3:return e.next=5,zo(a.auth,r,de(i));case 5:return o=e.sent,e.abrupt("return",new Bo(o,(function(e){return aa(a,e)})));case 7:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function Ko(){return(Ko=e(ve)(e(ye).mark((function t(n,r,i){var a,o;return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=de(n),e.next=3,zo(a.auth,r,de(i));case 3:return o=e.sent,e.abrupt("return",new Bo(o,(function(e){return ua(a,e)})));case 5:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function zo(e,t,n){return Wo.apply(this,arguments)}function Wo(){return(Wo=e(ve)(e(ye).mark((function t(n,r,i){var a,o,u,s,c,l,h,f;return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=3,i.verify();case 3:if(o=e.sent,e.prev=4,An("string"==typeof o,n,"argument-error"),An(i.type===Mo,n,"argument-error"),!("session"in(u="string"==typeof r?{phoneNumber:r}:r))){e.next=28;break}if(s=u.session,!("phoneNumber"in u)){e.next=19;break}return An("enroll"===s.type,n,"internal-error"),e.next=15,Ka(n,{idToken:s.credential,phoneEnrollmentInfo:{phoneNumber:u.phoneNumber,recaptchaToken:o}});case 15:return c=e.sent,e.abrupt("return",c.phoneSessionInfo.sessionInfo);case 19:return An("signin"===s.type,n,"internal-error"),An(l=(null===(a=u.multiFactorHint)||void 0===a?void 0:a.uid)||u.multiFactorUid,n,"missing-multi-factor-info"),e.next=24,xo(n,{mfaPendingCredential:s.credential,mfaEnrollmentId:l,phoneSignInInfo:{recaptchaToken:o}});case 24:return h=e.sent,e.abrupt("return",h.phoneResponseInfo.sessionInfo);case 26:e.next=32;break;case 28:return e.next=30,bi(n,{phoneNumber:u.phoneNumber,recaptchaToken:o});case 30:return f=e.sent.sessionInfo,e.abrupt("return",f);case 32:return e.prev=32,i._reset(),e.finish(32);case 35:case"end":return e.stop()}}),t,null,[[4,,32,35]])})))).apply(this,arguments)}function Ho(){return(Ho=e(ve)(e(ye).mark((function t(n,r){return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Yi(de(n),r);case 2:case"end":return e.stop()}}),t)})))).apply(this,arguments)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Qo=function(){"use strict";function t(n){e(s)(this,t),this.providerId=t.PROVIDER_ID,this.auth=Gr(n)}return e(c)(t,[{key:"verifyPhoneNumber",value:function(e,t){return zo(this.auth,e,de(t))}}],[{key:"credential",value:function(e,t){return Si._fromVerification(e,t)}},{key:"credentialFromResult",value:function(e){var n=e;return t.credentialFromTaggedObject(n)}},{key:"credentialFromError",value:function(e){return t.credentialFromTaggedObject(e.customData||{})}},{key:"credentialFromTaggedObject",value:function(e){var t=e._tokenResponse;if(!t)return null;var n=t.phoneNumber,r=t.temporaryProof;return n&&r?Si._fromTokenResponse(n,r):null}}]),t}();
/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function Yo(e,t){return t?Rn(t):(An(e._popupRedirectResolver,e,"argument-error"),e._popupRedirectResolver)}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Qo.PROVIDER_ID="phone",Qo.PHONE_SIGN_IN_METHOD="phone";var Jo=function(t){"use strict";e(d)(r,t);var n=e(L)(r);function r(t){var i;return e(s)(this,r),(i=n.call(this,"custom","custom")).params=t,i}return e(c)(r,[{key:"_getIdTokenResponse",value:function(e){return gi(e,this._buildIdpRequest())}},{key:"_linkToIdToken",value:function(e,t){return gi(e,this._buildIdpRequest(t))}},{key:"_getReauthenticationResolver",value:function(e){return gi(e,this._buildIdpRequest())}},{key:"_buildIdpRequest",value:function(e){var t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}]),r}(Qr);function Xo(e){return ta(e.auth,new Jo(e),e.bypassAuthState)}function Zo(e){var t=e.auth,n=e.user;return An(n,t,"internal-error"),$i(n,new Jo(e),e.bypassAuthState)}function $o(e){return eu.apply(this,arguments)}function eu(){return(eu=e(ve)(e(ye).mark((function t(n){var r,i;return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.auth,An(i=n.user,r,"internal-error"),e.abrupt("return",Yi(i,new Jo(n),n.bypassAuthState));case 3:case"end":return e.stop()}}),t)})))).apply(this,arguments)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var tu=function(){"use strict";function t(n,r,i,a){var o=arguments.length>4&&void 0!==arguments[4]&&arguments[4];e(s)(this,t),this.auth=n,this.resolver=i,this.user=a,this.bypassAuthState=o,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(r)?r:[r]}return e(c)(t,[{key:"execute",value:function(){var t,n=this;return new Promise((t=e(ve)(e(ye).mark((function t(r,i){return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.pendingPromise={resolve:r,reject:i},e.prev=1,e.next=4,n.resolver._initialize(n.auth);case 4:return n.eventManager=e.sent,e.next=7,n.onExecution();case 7:n.eventManager.registerConsumer(n),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(1),n.reject(e.t0);case 13:case"end":return e.stop()}}),t,null,[[1,10]])}))),function(e,n){return t.apply(this,arguments)}))}},{key:"onAuthEvent",value:function(t){var n=this;return e(ve)(e(ye).mark((function r(){var i,a,o,u,s,c,l;return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=t.urlResponse,a=t.sessionId,o=t.postBody,u=t.tenantId,s=t.error,c=t.type,!s){e.next=4;break}return n.reject(s),e.abrupt("return");case 4:return l={auth:n.auth,requestUri:i,sessionId:a,tenantId:u||void 0,postBody:o||void 0,user:n.user,bypassAuthState:n.bypassAuthState},e.prev=5,e.t0=n,e.next=9,n.getIdpTask(c)(l);case 9:e.t1=e.sent,e.t0.resolve.call(e.t0,e.t1),e.next=16;break;case 13:e.prev=13,e.t2=e.catch(5),n.reject(e.t2);case 16:case"end":return e.stop()}}),r,null,[[5,13]])})))()}},{key:"onError",value:function(e){this.reject(e)}},{key:"getIdpTask",value:function(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return Xo;case"linkViaPopup":case"linkViaRedirect":return $o;case"reauthViaPopup":case"reauthViaRedirect":return Zo;default:In(this.auth,"internal-error")}}},{key:"resolve",value:function(e){Nn(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}},{key:"reject",value:function(e){Nn(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}},{key:"unregisterAndCleanUp",value:function(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}]),t}(),nu=new Mn(2e3,1e4);
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ru(e,t,n){return iu.apply(this,arguments)}function iu(){return(iu=e(ve)(e(ye).mark((function t(n,r,i){var a,o,u;return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=Gr(n),En(n,r,Ni),o=Yo(a,i),u=new su(a,"signInViaPopup",r,o),e.abrupt("return",u.executeNotNull());case 5:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function au(){return(au=e(ve)(e(ye).mark((function t(n,r,i){var a,o,u;return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return En((a=de(n)).auth,r,Ni),o=Yo(a.auth,i),u=new su(a.auth,"reauthViaPopup",r,o,a),e.abrupt("return",u.executeNotNull());case 5:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function ou(e,t,n){return uu.apply(this,arguments)}function uu(){return(uu=e(ve)(e(ye).mark((function t(n,r,i){var a,o,u;return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return En((a=de(n)).auth,r,Ni),o=Yo(a.auth,i),u=new su(a.auth,"linkViaPopup",r,o,a),e.abrupt("return",u.executeNotNull());case 5:case"end":return e.stop()}}),t)})))).apply(this,arguments)}var su=function(t){"use strict";e(d)(r,t);var n=e(L)(r);function r(t,i,a,o,u){var c;return e(s)(this,r),(c=n.call(this,t,i,o,u)).provider=a,c.authWindow=null,c.pollId=null,r.currentPopupAction&&r.currentPopupAction.cancel(),r.currentPopupAction=e(f)(c),c}return e(c)(r,[{key:"executeNotNull",value:function(){var t=this;return e(ve)(e(ye).mark((function n(){var r;return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.execute();case 2:return An(r=e.sent,t.auth,"internal-error"),e.abrupt("return",r);case 5:case"end":return e.stop()}}),n)})))()}},{key:"onExecution",value:function(){var t=this;return e(ve)(e(ye).mark((function n(){var r;return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Nn(1===t.filter.length,"Popup operations only handle one event"),r=to(),e.next=4,t.resolver._openPopup(t.auth,t.provider,t.filter[0],r);case 4:t.authWindow=e.sent,t.authWindow.associatedEvent=r,t.resolver._originValidation(t.auth).catch((function(e){t.reject(e)})),t.resolver._isIframeWebStorageSupported(t.auth,(function(e){e||t.reject(_n(t.auth,"web-storage-unsupported"))})),t.pollUserCancellation();case 9:case"end":return e.stop()}}),n)})))()}},{key:"eventId",get:function(){var e;return(null===(e=this.authWindow)||void 0===e?void 0:e.associatedEvent)||null}},{key:"cancel",value:function(){this.reject(_n(this.auth,"cancelled-popup-request"))}},{key:"cleanUp",value:function(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,r.currentPopupAction=null}},{key:"pollUserCancellation",value:function(){var e=this,t=function(){var n,r;if(null===(r=null===(n=e.authWindow)||void 0===n?void 0:n.window)||void 0===r?void 0:r.closed){var i=e;e.pollId=window.setTimeout((function(){i.pollId=null,i.reject(_n(i.auth,"popup-closed-by-user"))}),2e3)}else e.pollId=window.setTimeout(t,nu.get())};t()}}]),r}(tu);su.currentPopupAction=null;
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var cu=new Map,lu=function(t){"use strict";e(d)(r,t);var n=e(L)(r);function r(t,i){var a,o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return e(s)(this,r),(a=n.call(this,t,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],i,void 0,o)).eventId=null,a}return e(c)(r,[{key:"execute",value:function(){var t=this,n=this;return e(ve)(e(ye).mark((function i(){var a,o;return e(ye).wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(a=cu.get(n.auth._key())){i.next=21;break}return i.prev=2,i.next=5,hu(n.resolver,n.auth);case 5:if(!i.sent){i.next=12;break}return i.next=9,e(Qt)(e(Xt)(r.prototype),"execute",t).call(n);case 9:i.t0=i.sent,i.next=13;break;case 12:i.t0=null;case 13:o=i.t0,a=function(){return Promise.resolve(o)},i.next=20;break;case 17:i.prev=17,i.t1=i.catch(2),a=function(){return Promise.reject(i.t1)};case 20:cu.set(n.auth._key(),a);case 21:return n.bypassAuthState||cu.set(n.auth._key(),(function(){return Promise.resolve(null)})),i.abrupt("return",a());case 23:case"end":return i.stop()}}),i,null,[[2,17]])})))()}},{key:"onAuthEvent",value:function(t){var n=this,i=this,a=function(){return e(Qt)(e(Xt)(r.prototype),"onAuthEvent",n)};return e(ve)(e(ye).mark((function n(){var r;return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("signInViaRedirect"!==t.type){e.next=4;break}return e.abrupt("return",a().call(i,t));case 4:if("unknown"!==t.type){e.next=7;break}return i.resolve(null),e.abrupt("return");case 7:if(!t.eventId){e.next=17;break}return e.next=10,i.auth._redirectUserForId(t.eventId);case 10:if(!(r=e.sent)){e.next=16;break}return i.user=r,e.abrupt("return",a().call(i,t));case 16:i.resolve(null);case 17:case"end":return e.stop()}}),n)})))()}},{key:"onExecution",value:function(){return e(ve)(e(ye).mark((function t(){return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),t)})))()}},{key:"cleanUp",value:function(){}}]),r}(tu);function hu(e,t){return fu.apply(this,arguments)}function fu(){return(fu=e(ve)(e(ye).mark((function t(n,r){var i,a,o;return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=mu(r),a=yu(n),e.next=4,a._isAvailable();case 4:if(e.sent){e.next=6;break}return e.abrupt("return",!1);case 6:return e.next=8,a._get(i);case 8:return e.t0=e.sent,o="true"===e.t0,e.next=12,a._remove(i);case 12:return e.abrupt("return",o);case 13:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function du(e,t){return vu.apply(this,arguments)}function vu(){return(vu=e(ve)(e(ye).mark((function t(n,r){return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",yu(n)._set(mu(r),"true"));case 1:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function pu(e,t){cu.set(e._key(),t)}function yu(e){return Rn(e._redirectPersistence)}function mu(e){return Tr("pendingRedirect",e.config.apiKey,e.name)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gu(e,t,n){return function(e,t,n){return ku.apply(this,arguments)}(e,t,n)}function ku(){return(ku=e(ve)(e(ye).mark((function t(n,r,i){var a,o;return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=Gr(n),En(n,r,Ni),o=Yo(a,i),e.next=5,du(o,a);case 5:return e.abrupt("return",o._openRedirect(a,r,"signInViaRedirect"));case 6:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function wu(e,t,n){return function(e,t,n){return bu.apply(this,arguments)}(e,t,n)}function bu(){return(bu=e(ve)(e(ye).mark((function t(n,r,i){var a,o,u;return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return En((a=de(n)).auth,r,Ni),o=Yo(a.auth,i),e.next=5,du(o,a.auth);case 5:return e.next=7,Au(a);case 7:return u=e.sent,e.abrupt("return",o._openRedirect(a.auth,r,"reauthViaRedirect",u));case 9:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function xu(e,t,n){return function(e,t,n){return Iu.apply(this,arguments)}(e,t,n)}function Iu(){return(Iu=e(ve)(e(ye).mark((function t(n,r,i){var a,o,u;return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return En((a=de(n)).auth,r,Ni),o=Yo(a.auth,i),e.next=5,Xi(!1,a,r.providerId);case 5:return e.next=7,du(o,a.auth);case 7:return e.next=9,Au(a);case 9:return u=e.sent,e.abrupt("return",o._openRedirect(a.auth,r,"linkViaRedirect",u));case 11:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function _u(e,t){return Tu.apply(this,arguments)}function Tu(){return(Tu=e(ve)(e(ye).mark((function t(n,r){return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Gr(n)._initializationPromise;case 2:return e.abrupt("return",Eu(n,r,!1));case 3:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function Eu(e,t){return Su.apply(this,arguments)}function Su(){return Su=e(ve)(e(ye).mark((function t(n,r){var i,a,o,u,s,c=arguments;return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=c.length>2&&void 0!==c[2]&&c[2],a=Gr(n),o=Yo(a,r),u=new lu(a,o,i),e.next=6,u.execute();case 6:if(!(s=e.sent)||i){e.next=13;break}return delete s.user._redirectEventId,e.next=11,a._persistUserIfCurrent(s.user);case 11:return e.next=13,a._setRedirectUser(null,r);case 13:return e.abrupt("return",s);case 14:case"end":return e.stop()}}),t)}))),Su.apply(this,arguments)}function Au(e){return Cu.apply(this,arguments)}function Cu(){return(Cu=e(ve)(e(ye).mark((function t(n){var r;return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=to("".concat(n.uid,":::")),n._redirectEventId=r,e.next=4,n.auth._setRedirectUser(n);case 4:return e.next=6,n.auth._persistUserIfCurrent(n);case 6:return e.abrupt("return",r);case 7:case"end":return e.stop()}}),t)})))).apply(this,arguments)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Nu=function(){"use strict";function t(n){e(s)(this,t),this.auth=n,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}return e(c)(t,[{key:"registerConsumer",value:function(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}},{key:"unregisterConsumer",value:function(e){this.consumers.delete(e)}},{key:"onEvent",value:function(e){var t=this;if(this.hasEventBeenHandled(e))return!1;var n=!1;return this.consumers.forEach((function(r){t.isEventForConsumer(e,r)&&(n=!0,t.sendToConsumer(e,r),t.saveEventToCache(e))})),this.hasHandledPotentialRedirect||!function(e){switch(e.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Ru(e);default:return!1}}(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}},{key:"sendToConsumer",value:function(e,t){var n;if(e.error&&!Ru(e)){var r=(null===(n=e.error.code)||void 0===n?void 0:n.split("auth/")[1])||"internal-error";t.onError(_n(this.auth,r))}else t.onAuthEvent(e)}},{key:"isEventForConsumer",value:function(e,t){var n=null===t.eventId||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&n}},{key:"hasEventBeenHandled",value:function(e){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(Du(e))}},{key:"saveEventToCache",value:function(e){this.cachedEventUids.add(Du(e)),this.lastProcessedEventTime=Date.now()}}]),t}();function Du(e){return[e.type,e.eventId,e.sessionId,e.tenantId].filter((function(e){return e})).join("-")}function Ru(e){var t=e.type,n=e.error;return"unknown"===t&&"auth/no-auth-event"===(null==n?void 0:n.code)}function Ou(e){return Pu.apply(this,arguments)}function Pu(){return Pu=
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
e(ve)(e(ye).mark((function t(n){var r,i=arguments;return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=i.length>1&&void 0!==i[1]?i[1]:{},e.abrupt("return",Gn(n,"GET","/v1/projects",r));case 2:case"end":return e.stop()}}),t)}))),Pu.apply(this,arguments)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Lu=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Mu=/^https?/;function Fu(){return(Fu=e(ve)(e(ye).mark((function t(n){var r,i,a,o,u,s,c;return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!n.config.emulator){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,Ou(n);case 4:r=e.sent.authorizedDomains,i=!0,a=!1,o=void 0,e.prev=6,u=r[Symbol.iterator]();case 8:if(i=(s=u.next()).done){e.next=20;break}if(c=s.value,e.prev=10,!Vu(c)){e.next=13;break}return e.abrupt("return");case 13:e.next=17;break;case 15:e.prev=15,e.t0=e.catch(10);case 17:i=!0,e.next=8;break;case 20:e.next=26;break;case 22:e.prev=22,e.t1=e.catch(6),a=!0,o=e.t1;case 26:e.prev=26,e.prev=27,i||null==u.return||u.return();case 29:if(e.prev=29,!a){e.next=32;break}throw o;case 32:return e.finish(29);case 33:return e.finish(26);case 34:In(n,"unauthorized-domain");case 35:case"end":return e.stop()}}),t,null,[[6,22,26,34],[10,15],[27,,29,33]])})))).apply(this,arguments)}function Vu(e){var t=On(),n=new URL(t),r=n.protocol,i=n.hostname;if(e.startsWith("chrome-extension://")){var a=new URL(e);return""===a.hostname&&""===i?"chrome-extension:"===r&&e.replace("chrome-extension://","")===t.replace("chrome-extension://",""):"chrome-extension:"===r&&a.hostname===i}if(!Mu.test(r))return!1;if(Lu.test(e))return i===e;var o=e.replace(/\./g,"\\.");return new RegExp("^(.+\\."+o+"|"+o+")$","i").test(i)}
/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Uu=new Mn(3e4,6e4);function Bu(){var t=ro().___jsl,n=!0,r=!1,i=void 0;if(null==t?void 0:t.H)try{for(var a,o=Object.keys(t.H)[Symbol.iterator]();!(n=(a=o.next()).done);n=!0){var u=a.value;if(t.H[u].r=t.H[u].r||[],t.H[u].L=t.H[u].L||[],t.H[u].r=e(x)(t.H[u].L),t.CP)for(var s=0;s<t.CP.length;s++)t.CP[s]=null}}catch(e){r=!0,i=e}finally{try{n||null==o.return||o.return()}finally{if(r)throw i}}}var qu=null;function ju(e){return qu=qu||function(e){return new Promise((function(t,n){var r,i,a;function o(){Bu(),gapi.load("gapi.iframes",{callback:function(){t(gapi.iframes.getContext())},ontimeout:function(){Bu(),n(_n(e,"network-request-failed"))},timeout:Uu.get()})}if(null===(i=null===(r=ro().gapi)||void 0===r?void 0:r.iframes)||void 0===i?void 0:i.Iframe)t(gapi.iframes.getContext());else{if(!(null===(a=ro().gapi)||void 0===a?void 0:a.load)){var u=Eo("iframefcb");return ro()[u]=function(){gapi.load?o():n(_n(e,"network-request-failed"))},To("https://apis.google.com/js/api.js?onload=".concat(u)).catch((function(e){return n(e)}))}o()}})).catch((function(e){throw qu=null,e}))}(e),qu}
/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Gu=new Mn(5e3,15e3),Ku={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},zu=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function Wu(e){var t=e.config;An(t.authDomain,e,"auth-domain-config-required");var n=t.emulator?Fn(t,"emulator/auth/iframe"):"https://".concat(e.config.authDomain,"/").concat("__/auth/iframe"),r={apiKey:t.apiKey,appName:e.name,v:mt},i=zu.get(e.config.apiHost);i&&(r.eid=i);var a=e._getFrameworks();return a.length&&(r.fw=a.join(",")),"".concat(n,"?").concat(ue(r).slice(1))}function Hu(e){return Qu.apply(this,arguments)}function Qu(){return Qu=e(ve)(e(ye).mark((function t(n){var r,i;return e(ye).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,ju(n);case 2:return r=t.sent,An(i=ro().gapi,n,"internal-error"),t.abrupt("return",r.open({where:document.body,url:Wu(n),messageHandlersFilter:i.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:Ku,dontclear:!0},(function(t){return new Promise((r=e(ve)(e(ye).mark((function r(i,a){var o,u,s;return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=function(){ro().clearTimeout(u),i(t)},e.next=3,t.restyle({setHideOnLeave:!1});case 3:o=_n(n,"network-request-failed"),u=ro().setTimeout((function(){a(o)}),Gu.get()),t.ping(s).then(s,(function(){a(o)}));case 7:case"end":return e.stop()}}),r)}))),function(e,t){return r.apply(this,arguments)}));var r})));case 6:case"end":return t.stop()}}),t)}))),Qu.apply(this,arguments)}
/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Yu={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},Ju="_blank",Xu="http://localhost",Zu=function(){"use strict";function t(n){e(s)(this,t),this.window=n,this.associatedEvent=null}return e(c)(t,[{key:"close",value:function(){if(this.window)try{this.window.close()}catch(e){}}}]),t}();function $u(t,n,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:500,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:600,o=Math.max((window.screen.availHeight-a)/2,0).toString(),u=Math.max((window.screen.availWidth-i)/2,0).toString(),s="",c=Object.assign(Object.assign({},Yu),{width:i.toString(),height:a.toString(),top:o,left:u}),l=H().toLowerCase();r&&(s=Nr(l)?Ju:r),Ar(l)&&(n=n||Xu,c.scrollbars="yes");var h=Object.entries(c).reduce((function(t,n){var r=e(y)(n,2),i=r[0],a=r[1];return"".concat(t).concat(i,"=").concat(a,",")}),"");if(Fr(l)&&"_self"!==s)return es(n||"",s),new Zu(null);var f=window.open(n||"",s,h);An(f,t,"popup-blocked");try{f.focus()}catch(e){}return new Zu(f)}function es(e,t){var n=document.createElement("a");n.href=e,n.target=t;var r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}
/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ts="__/auth/handler",ns="emulator/auth/handler";function rs(t,n,r,i,a,o){An(t.config.authDomain,t,"auth-domain-config-required"),An(t.config.apiKey,t,"invalid-api-key");var u={apiKey:t.config.apiKey,appName:t.name,authType:r,redirectUrl:i,v:mt,eventId:a};if(n instanceof Ni){n.setDefaultLanguage(t.languageCode),u.providerId=n.providerId||"",ie(n.getCustomParameters())||(u.customParameters=JSON.stringify(n.getCustomParameters()));var s=!0,c=!1,l=void 0;try{for(var h,f=Object.entries(o||{})[Symbol.iterator]();!(s=(h=f.next()).done);s=!0){var d=e(y)(h.value,2),v=d[0],p=d[1];u[v]=p}}catch(e){c=!0,l=e}finally{try{s||null==f.return||f.return()}finally{if(c)throw l}}}if(n instanceof Di){var m=n.getScopes().filter((function(e){return""!==e}));m.length>0&&(u.scopes=m.join(","))}t.tenantId&&(u.tid=t.tenantId);var g,k,w=u,b=!0,x=!1,I=void 0;try{for(var _,T=Object.keys(w)[Symbol.iterator]();!(b=(_=T.next()).done);b=!0){var E=_.value;void 0===w[E]&&delete w[E]}}catch(e){x=!0,I=e}finally{try{b||null==T.return||T.return()}finally{if(x)throw I}}return"".concat((g=t,k=g.config,k.emulator?Fn(k,ns):"https://".concat(k.authDomain,"/").concat(ts)),"?").concat(ue(w).slice(1))}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var is="webStorageSupport",as=function(){"use strict";function t(){e(s)(this,t),this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Za,this._completeRedirectFn=Eu,this._overrideRedirectResult=pu}return e(c)(t,[{key:"_openPopup",value:function(t,n,r,i){var a=this;return e(ve)(e(ye).mark((function o(){var u,s;return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Nn(null===(u=a.eventManagers[t._key()])||void 0===u?void 0:u.manager,"_initialize() not called before _openPopup()"),s=rs(t,n,r,On(),i),e.abrupt("return",$u(t,s,to()));case 4:case"end":return e.stop()}}),o)})))()}},{key:"_openRedirect",value:function(t,n,r,i){var a=this;return e(ve)(e(ye).mark((function o(){return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a._originValidation(t);case 2:return o=rs(t,n,r,On(),i),ro().location.href=o,e.abrupt("return",new Promise((function(){})));case 4:case"end":return e.stop()}var o}),o)})))()}},{key:"_initialize",value:function(e){var t=this,n=e._key();if(this.eventManagers[n]){var r=this.eventManagers[n],i=r.manager,a=r.promise;return i?Promise.resolve(i):(Nn(a,"If manager is not set, promise should be"),a)}var o=this.initAndGetManager(e);return this.eventManagers[n]={promise:o},o.catch((function(){delete t.eventManagers[n]})),o}},{key:"initAndGetManager",value:function(t){var n=this;return e(ve)(e(ye).mark((function r(){var i,a;return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Hu(t);case 2:return i=e.sent,a=new Nu(t),i.register("authEvent",(function(e){return An(null==e?void 0:e.authEvent,t,"invalid-auth-event"),{status:a.onEvent(e.authEvent)?"ACK":"ERROR"}}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),n.eventManagers[t._key()]={manager:a},n.iframes[t._key()]=i,e.abrupt("return",a);case 8:case"end":return e.stop()}}),r)})))()}},{key:"_isIframeWebStorageSupported",value:function(e,t){this.iframes[e._key()].send(is,{type:is},(function(n){var r,i=null===(r=null==n?void 0:n[0])||void 0===r?void 0:r.webStorageSupport;void 0!==i&&t(!!i),In(e,"internal-error")}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}},{key:"_originValidation",value:function(e){var t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=function(e){return Fu.apply(this,arguments)}(e)),this.originValidationPromises[t]}},{key:"_shouldInitProactively",get:function(){return Ur()||Cr()||Lr()}}]),t}(),os=as,us=function(t){"use strict";e(d)(r,t);var n=e(L)(r);function r(t){var i;return e(s)(this,r),(i=n.call(this,"phone")).credential=t,i}return e(c)(r,[{key:"_finalizeEnroll",value:function(e,t,n){return function(e,t){return Gn(e,"POST","/v2/accounts/mfaEnrollment:finalize",jn(e,t))}(e,{idToken:t,displayName:n,phoneVerificationInfo:this.credential._makeVerificationRequest()})}},{key:"_finalizeSignIn",value:function(e,t){return function(e,t){return Gn(e,"POST","/v2/accounts/mfaSignIn:finalize",jn(e,t))}(e,{mfaPendingCredential:t,phoneVerificationInfo:this.credential._makeVerificationRequest()})}}],[{key:"_fromCredential",value:function(e){return new r(e)}}]),r}(function(){"use strict";function t(n){e(s)(this,t),this.factorId=n}return e(c)(t,[{key:"_process",value:function(e,t,n){switch(t.type){case"enroll":return this._finalizeEnroll(e,t.credential,n);case"signin":return this._finalizeSignIn(e,t.credential);default:return Cn("unexpected MultiFactorSessionType")}}}]),t}()),ss=function(){"use strict";function t(){e(s)(this,t)}return e(c)(t,null,[{key:"assertion",value:function(e){return us._fromCredential(e)}}]),t}();ss.FACTOR_ID="phone";var cs,ls="@firebase/auth",hs="0.20.7",fs=function(){"use strict";function t(n){e(s)(this,t),this.auth=n,this.internalListeners=new Map}return e(c)(t,[{key:"getUid",value:function(){var e;return this.assertAuthConfigured(),(null===(e=this.auth.currentUser)||void 0===e?void 0:e.uid)||null}},{key:"getToken",value:function(t){var n=this;return e(ve)(e(ye).mark((function r(){var i;return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.assertAuthConfigured(),e.next=3,n.auth._initializationPromise;case 3:if(n.auth.currentUser){e.next=5;break}return e.abrupt("return",null);case 5:return e.next=7,n.auth.currentUser.getIdToken(t);case 7:return i=e.sent,e.abrupt("return",{accessToken:i});case 9:case"end":return e.stop()}}),r)})))()}},{key:"addAuthTokenListener",value:function(e){if(this.assertAuthConfigured(),!this.internalListeners.has(e)){var t=this.auth.onIdTokenChanged((function(t){var n;e((null===(n=t)||void 0===n?void 0:n.stsTokenManager.accessToken)||null)}));this.internalListeners.set(e,t),this.updateProactiveRefresh()}}},{key:"removeAuthTokenListener",value:function(e){this.assertAuthConfigured();var t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}},{key:"assertAuthConfigured",value:function(){An(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}},{key:"updateProactiveRefresh",value:function(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}]),t}();
/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function ds(){return window}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */cs="Browser",lt(new ge("auth",(function(e,t){var n=t.options,r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),a=r.options,o=a.apiKey,u=a.authDomain;return function(e,t){An(o&&!o.includes(":"),"invalid-api-key",{appName:e.name}),An(!(null==u?void 0:u.includes(":")),"argument-error",{appName:e.name});var r={apiKey:o,authDomain:u,clientPlatform:cs,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Br(cs)},i=new jr(e,t,r);return function(e,t){var n=(null==t?void 0:t.persistence)||[],r=(Array.isArray(n)?n:[n]).map(Rn);(null==t?void 0:t.errorMap)&&e._updateErrorMap(t.errorMap),e._initializeWithPersistence(r,null==t?void 0:t.popupRedirectResolver)}(i,n),i}(r,i)}),"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((function(e,t,n){e.getProvider("auth-internal").initialize()}))),lt(new ge("auth-internal",(function(e){var t=Gr(e.getProvider("auth").getImmediate());return new fs(t)}),"PRIVATE").setInstantiationMode("EXPLICIT")),It(ls,hs,
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function(e){switch(e){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";default:return}}(cs)),It(ls,hs,"esm2017");function vs(e,t,n){return ps.apply(this,arguments)}function ps(){return(ps=e(ve)(e(ye).mark((function t(n,r,i){var a,o,u,s;return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=ds().BuildInfo,Nn(r.sessionId,"AuthEvent did not contain a session ID"),e.next=5,bs(r.sessionId);case 5:return u=e.sent,s={},Lr()?s.ibi=o.packageName:Rr()?s.apn=o.packageName:In(n,"operation-not-supported-in-this-environment"),o.displayName&&(s.appDisplayName=o.displayName),s.sessionId=u,e.abrupt("return",rs(n,i,r.type,void 0,null!==(a=r.eventId)&&void 0!==a?a:void 0,s));case 11:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function ys(){return(ys=e(ve)(e(ye).mark((function t(n){var r,i;return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=ds().BuildInfo,i={},Lr()?i.iosBundleId=r.packageName:Rr()?i.androidPackageName=r.packageName:In(n,"operation-not-supported-in-this-environment"),e.next=5,Ou(n,i);case 5:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function ms(e){var t=ds().cordova;return new Promise((function(n){t.plugins.browsertab.isAvailable((function(r){var i=null;r?t.plugins.browsertab.openUrl(e):i=t.InAppBrowser.open(e,Mr()?"_blank":"_system","location=yes"),n(i)}))}))}function gs(e,t,n){return ks.apply(this,arguments)}function ks(){return(ks=e(ve)(e(ye).mark((function t(n,r,i){var a,o;return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=ds().cordova,o=function(){},e.prev=2,e.next=5,new Promise((function(e,t){var u=null;function s(){var t;e();var n=null===(t=a.plugins.browsertab)||void 0===t?void 0:t.close;"function"==typeof n&&n(),"function"==typeof(null==i?void 0:i.close)&&i.close()}function c(){u||(u=window.setTimeout((function(){t(_n(n,"redirect-cancelled-by-user"))}),2e3))}function l(){"visible"===(null===document||void 0===document?void 0:document.visibilityState)&&c()}r.addPassiveListener(s),document.addEventListener("resume",c,!1),Rr()&&document.addEventListener("visibilitychange",l,!1),o=function(){r.removePassiveListener(s),document.removeEventListener("resume",c,!1),document.removeEventListener("visibilitychange",l,!1),u&&window.clearTimeout(u)}}));case 5:return e.prev=5,o(),e.finish(5);case 8:case"end":return e.stop()}}),t,null,[[2,,5,8]])})))).apply(this,arguments)}function ws(e){var t,n,r,i,a,o,u,s,c,l,h=ds();An("function"==typeof(null===(t=null==h?void 0:h.universalLinks)||void 0===t?void 0:t.subscribe),e,"invalid-cordova-configuration",{missingPlugin:"cordova-universal-links-plugin-fix"}),An(void 0!==(null===(n=null==h?void 0:h.BuildInfo)||void 0===n?void 0:n.packageName),e,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-buildInfo"}),An("function"==typeof(null===(a=null===(i=null===(r=null==h?void 0:h.cordova)||void 0===r?void 0:r.plugins)||void 0===i?void 0:i.browsertab)||void 0===a?void 0:a.openUrl),e,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),An("function"==typeof(null===(s=null===(u=null===(o=null==h?void 0:h.cordova)||void 0===o?void 0:o.plugins)||void 0===u?void 0:u.browsertab)||void 0===s?void 0:s.isAvailable),e,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),An("function"==typeof(null===(l=null===(c=null==h?void 0:h.cordova)||void 0===c?void 0:c.InAppBrowser)||void 0===l?void 0:l.open),e,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-inappbrowser"})}function bs(e){return xs.apply(this,arguments)}function xs(){return(xs=e(ve)(e(ye).mark((function t(n){var r,i,a;return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=Is(n),e.next=3,crypto.subtle.digest("SHA-256",r);case 3:return i=e.sent,a=Array.from(new Uint8Array(i)),e.abrupt("return",a.map((function(e){return e.toString(16).padStart(2,"0")})).join(""));case 6:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function Is(e){if(Nn(/[0-9a-zA-Z]+/.test(e),"Can only convert alpha-numeric strings"),"undefined"!=typeof TextEncoder)return(new TextEncoder).encode(e);for(var t=new ArrayBuffer(e.length),n=new Uint8Array(t),r=0;r<e.length;r++)n[r]=e.charCodeAt(r);return n}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var _s=function(t){"use strict";e(d)(r,t);var n=e(L)(r);function r(){var t;return e(s)(this,r),(t=n.call.apply(n,[this].concat(Array.prototype.slice.call(arguments)))).passiveListeners=new Set,t.initPromise=new Promise((function(e){t.resolveInialized=e})),t}return e(c)(r,[{key:"addPassiveListener",value:function(e){this.passiveListeners.add(e)}},{key:"removePassiveListener",value:function(e){this.passiveListeners.delete(e)}},{key:"resetRedirect",value:function(){this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1}},{key:"onEvent",value:function(t){return this.resolveInialized(),this.passiveListeners.forEach((function(e){return e(t)})),e(Qt)(e(Xt)(r.prototype),"onEvent",this).call(this,t)}},{key:"initialized",value:function(){var t=this;return e(ve)(e(ye).mark((function n(){return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.initPromise;case 2:case"end":return e.stop()}}),n)})))()}}]),r}(Nu);function Ts(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return{type:t,eventId:n,urlResponse:null,sessionId:Ns(),postBody:null,tenantId:e.tenantId,error:_n(e,"no-auth-event")}}function Es(e,t){return Ds()._set(Rs(e),t)}function Ss(e){return As.apply(this,arguments)}function As(){return(As=e(ve)(e(ye).mark((function t(n){var r;return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ds()._get(Rs(n));case 2:if(!(r=e.sent)){e.next=6;break}return e.next=6,Ds()._remove(Rs(n));case 6:return e.abrupt("return",r);case 7:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function Cs(e,t){var n,r,i=function(e){var t=Os(e),n=t.link?decodeURIComponent(t.link):void 0,r=Os(n).link,i=t.deep_link_id?decodeURIComponent(t.deep_link_id):void 0;return Os(i).link||i||r||n||e}(t);if(i.includes("/__/auth/callback")){var a=Os(i),o=a.firebaseError?function(e){try{return JSON.parse(e)}catch(e){return null}}(decodeURIComponent(a.firebaseError)):null,u=null===(r=null===(n=null==o?void 0:o.code)||void 0===n?void 0:n.split("auth/"))||void 0===r?void 0:r[1],s=u?_n(u):null;return s?{type:e.type,eventId:e.eventId,tenantId:e.tenantId,error:s,urlResponse:null,sessionId:null,postBody:null}:{type:e.type,eventId:e.eventId,tenantId:e.tenantId,sessionId:e.sessionId,urlResponse:i,postBody:null}}return null}function Ns(){for(var e=[],t="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ",n=0;n<20;n++){var r=Math.floor(Math.random()*t.length);e.push(t.charAt(r))}return e.join("")}function Ds(){return Rn(Ja)}function Rs(e){return Tr("authEvent",e.config.apiKey,e.name)}function Os(t){if(!(null==t?void 0:t.includes("?")))return{};var n=e(Zt)(t.split("?"));n[0];return se(n.slice(1).join("?"))}
/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ps=function(){"use strict";function t(){e(s)(this,t),this._redirectPersistence=Za,this._shouldInitProactively=!0,this.eventManagers=new Map,this.originValidationPromises={},this._completeRedirectFn=Eu,this._overrideRedirectResult=pu}return e(c)(t,[{key:"_initialize",value:function(t){var n=this;return e(ve)(e(ye).mark((function r(){var i,a;return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=t._key(),(a=n.eventManagers.get(i))||(a=new _s(t),n.eventManagers.set(i,a),n.attachCallbackListeners(t,a)),e.abrupt("return",a);case 4:case"end":return e.stop()}}),r)})))()}},{key:"_openPopup",value:function(e){In(e,"operation-not-supported-in-this-environment")}},{key:"_openRedirect",value:function(t,n,r,i){var a=this;return e(ve)(e(ye).mark((function o(){var u,s,c,l;return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return ws(t),e.next=3,a._initialize(t);case 3:return u=e.sent,e.next=6,u.initialized();case 6:return u.resetRedirect(),cu.clear(),e.next=10,a._originValidation(t);case 10:return s=Ts(t,r,i),e.next=13,Es(t,s);case 13:return e.next=15,vs(t,s,n);case 15:return c=e.sent,e.next=18,ms(c);case 18:return l=e.sent,e.abrupt("return",gs(t,u,l));case 20:case"end":return e.stop()}}),o)})))()}},{key:"_isIframeWebStorageSupported",value:function(e,t){throw new Error("Method not implemented.")}},{key:"_originValidation",value:function(e){var t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=function(e){return ys.apply(this,arguments)}(e)),this.originValidationPromises[t]}},{key:"attachCallbackListeners",value:function(t,n){var r,i=ds(),a=i.universalLinks,o=i.handleOpenURL,u=i.BuildInfo,s=setTimeout(e(ve)(e(ye).mark((function r(){return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ss(t);case 2:n.onEvent(Ms());case 3:case"end":return e.stop()}}),r)}))),500),c=(r=e(ve)(e(ye).mark((function r(i){var a,o;return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return clearTimeout(s),e.next=3,Ss(t);case 3:a=e.sent,o=null,a&&(null==i?void 0:i.url)&&(o=Cs(a,i.url)),n.onEvent(o||Ms());case 7:case"end":return e.stop()}}),r)}))),function(e){return r.apply(this,arguments)});void 0!==a&&"function"==typeof a.subscribe&&a.subscribe(null,c);var l=o,h="".concat(u.packageName.toLowerCase(),"://");ds().handleOpenURL=function(){var t=e(ve)(e(ye).mark((function t(n){return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.toLowerCase().startsWith(h)&&c({url:n}),"function"==typeof l)try{l(n)}catch(e){console.error(e)}case 2:case"end":return e.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}}]),t}(),Ls=Ps;function Ms(){return{type:"unknown",eventId:null,sessionId:null,urlResponse:null,postBody:null,tenantId:null,error:_n("no-auth-event")}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fs(){var e;return(null===(e=null===self||void 0===self?void 0:self.location)||void 0===e?void 0:e.protocol)||null}function Vs(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:H();return!("file:"!==Fs()&&"ionic:"!==Fs()&&"capacitor:"!==Fs()||!e.toLowerCase().match(/iphone|ipad|ipod|android/))}function Us(){return X()&&11===(null===document||void 0===document?void 0:document.documentMode)}function Bs(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:H();return/Edge\/\d+/.test(e)}function qs(){try{var e=self.localStorage,t=to();if(e)return e.setItem(t,"1"),e.removeItem(t),!function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:H();return Us()||Bs(e)}()||Z()}catch(e){return js()&&Z()}return!1}function js(){return void 0!==t&&"WorkerGlobalScope"in t&&"importScripts"in t}function Gs(){return("http:"===Fs()||"https:"===Fs()||Y()||Vs())&&!(J()||Q())&&qs()&&!js()}function Ks(){return Vs()&&"undefined"!=typeof document}function zs(){return Ws.apply(this,arguments)}function Ws(){return(Ws=e(ve)(e(ye).mark((function t(){return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Ks()){e.next=2;break}return e.abrupt("return",!1);case 2:return e.abrupt("return",new Promise((function(e){var t=setTimeout((function(){e(!1)}),1e3);document.addEventListener("deviceready",(function(){clearTimeout(t),e(!0)}))})));case 3:case"end":return e.stop()}}),t)})))).apply(this,arguments)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var Hs={LOCAL:"local",NONE:"none",SESSION:"session"},Qs=An,Ys="persistence";function Js(e,t){Qs(Object.values(Hs).includes(t),e,"invalid-persistence-type"),J()?Qs(t!==Hs.SESSION,e,"unsupported-persistence-type"):Q()?Qs(t===Hs.NONE,e,"unsupported-persistence-type"):js()?Qs(t===Hs.NONE||t===Hs.LOCAL&&Z(),e,"unsupported-persistence-type"):Qs(t===Hs.NONE||qs(),e,"unsupported-persistence-type")}function Xs(e){return Zs.apply(this,arguments)}function Zs(){return(Zs=e(ve)(e(ye).mark((function t(n){var r,i;return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n._initializationPromise;case 2:r=$s(),i=Tr(Ys,n.config.apiKey,n.name),r&&r.setItem(i,n._getPersistence());case 5:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function $s(){var e;try{return(null===(e="undefined"!=typeof window?window:null)||void 0===e?void 0:e.sessionStorage)||null}catch(e){return null}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ec=An,tc=function(){"use strict";function t(){e(s)(this,t),this.browserResolver=Rn(os),this.cordovaResolver=Rn(Ls),this.underlyingResolver=null,this._redirectPersistence=Za,this._completeRedirectFn=Eu,this._overrideRedirectResult=pu}return e(c)(t,[{key:"_initialize",value:function(t){var n=this;return e(ve)(e(ye).mark((function r(){return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.selectUnderlyingResolver();case 2:return e.abrupt("return",n.assertedUnderlyingResolver._initialize(t));case 3:case"end":return e.stop()}}),r)})))()}},{key:"_openPopup",value:function(t,n,r,i){var a=this;return e(ve)(e(ye).mark((function o(){return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.selectUnderlyingResolver();case 2:return e.abrupt("return",a.assertedUnderlyingResolver._openPopup(t,n,r,i));case 3:case"end":return e.stop()}}),o)})))()}},{key:"_openRedirect",value:function(t,n,r,i){var a=this;return e(ve)(e(ye).mark((function o(){return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.selectUnderlyingResolver();case 2:return e.abrupt("return",a.assertedUnderlyingResolver._openRedirect(t,n,r,i));case 3:case"end":return e.stop()}}),o)})))()}},{key:"_isIframeWebStorageSupported",value:function(e,t){this.assertedUnderlyingResolver._isIframeWebStorageSupported(e,t)}},{key:"_originValidation",value:function(e){return this.assertedUnderlyingResolver._originValidation(e)}},{key:"_shouldInitProactively",get:function(){return Ks()||this.browserResolver._shouldInitProactively}},{key:"assertedUnderlyingResolver",get:function(){return ec(this.underlyingResolver,"internal-error"),this.underlyingResolver}},{key:"selectUnderlyingResolver",value:function(){var t=this;return e(ve)(e(ye).mark((function n(){var r;return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.underlyingResolver){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,zs();case 4:r=e.sent,t.underlyingResolver=r?t.cordovaResolver:t.browserResolver;case 6:case"end":return e.stop()}}),n)})))()}}]),t}();
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function nc(e){return e.unwrap()}function rc(e,t){var n,r,i=null===(n=t.customData)||void 0===n?void 0:n._tokenResponse;if("auth/multi-factor-auth-required"===(null===(r=t)||void 0===r?void 0:r.code))t.resolver=new sc(e,function(e,t){var n,r=de(e),i=t;return An(t.customData.operationType,r,"argument-error"),An(null===(n=i.customData._serverResponse)||void 0===n?void 0:n.mfaPendingCredential,r,"argument-error"),Ga._fromError(r,i)}(e,t));else if(i){var a=ic(t),o=t;a&&(o.credential=a,o.tenantId=i.tenantId||void 0,o.email=i.email||void 0,o.phoneNumber=i.phoneNumber||void 0)}}function ic(e){var t=(e instanceof $?e.customData:e)._tokenResponse;if(!t)return null;if(!(e instanceof $)&&"temporaryProof"in t&&"phoneNumber"in t)return Qo.credentialFromResult(e);var n,r=t.providerId;if(!r||r===cn)return null;switch(r){case sn:n=Pi;break;case on:n=Oi;break;case un:n=Li;break;case ln:n=Vi;break;default:var i=t.oauthIdToken,a=t.oauthAccessToken,o=t.oauthTokenSecret,u=t.pendingToken,s=t.nonce;return a||o||i||u?u?r.startsWith("saml.")?Mi._create(r,u):wi._fromParams({providerId:r,signInMethod:r,pendingToken:u,idToken:i,accessToken:a}):new Ri(r).credential({idToken:i,accessToken:a,rawNonce:s}):null}return e instanceof $?n.credentialFromError(e):n.credentialFromResult(e)}function ac(e,t){return t.catch((function(t){throw t instanceof $&&rc(e,t),t})).then((function(e){var t,n=e.operationType,r=e.user;return{operationType:n,credential:(t=e,ic(t)),additionalUserInfo:qa(e),user:cc.getOrCreate(r)}}))}function oc(e,t){return uc.apply(this,arguments)}function uc(){return(uc=e(ve)(e(ye).mark((function t(n,r){var i;return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r;case 2:return i=e.sent,e.abrupt("return",{verificationId:i.verificationId,confirm:function(e){return ac(n,i.confirm(e))}});case 4:case"end":return e.stop()}}),t)})))).apply(this,arguments)}var sc=function(){"use strict";function t(n,r){e(s)(this,t),this.resolver=r,this.auth=n.wrapped()}return e(c)(t,[{key:"session",get:function(){return this.resolver.session}},{key:"hints",get:function(){return this.resolver.hints}},{key:"resolveSignIn",value:function(e){return ac(nc(this.auth),this.resolver.resolveSignIn(e))}}]),t}(),cc=function(){"use strict";function t(n){var r;e(s)(this,t),this._delegate=n,this.multiFactor=(r=de(n),Wa.has(r)||Wa.set(r,za._fromUser(r)),Wa.get(r))}return e(c)(t,[{key:"delete",value:function(){return this._delegate.delete()}},{key:"reload",value:function(){return this._delegate.reload()}},{key:"toJSON",value:function(){return this._delegate.toJSON()}},{key:"getIdTokenResult",value:function(e){return this._delegate.getIdTokenResult(e)}},{key:"getIdToken",value:function(e){return this._delegate.getIdToken(e)}},{key:"linkAndRetrieveDataWithCredential",value:function(e){return this.linkWithCredential(e)}},{key:"linkWithCredential",value:function(t){var n=this;return e(ve)(e(ye).mark((function r(){return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",ac(n.auth,aa(n._delegate,t)));case 1:case"end":return e.stop()}}),r)})))()}},{key:"linkWithPhoneNumber",value:function(t,n){var r=this;return e(ve)(e(ye).mark((function i(){return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",oc(r.auth,jo(r._delegate,t,n)));case 1:case"end":return e.stop()}}),i)})))()}},{key:"linkWithPopup",value:function(t){var n=this;return e(ve)(e(ye).mark((function r(){return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",ac(n.auth,ou(n._delegate,t,tc)));case 1:case"end":return e.stop()}}),r)})))()}},{key:"linkWithRedirect",value:function(t){var n=this;return e(ve)(e(ye).mark((function r(){return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Xs(Gr(n.auth));case 2:return e.abrupt("return",xu(n._delegate,t,tc));case 3:case"end":return e.stop()}}),r)})))()}},{key:"reauthenticateAndRetrieveDataWithCredential",value:function(e){return this.reauthenticateWithCredential(e)}},{key:"reauthenticateWithCredential",value:function(t){var n=this;return e(ve)(e(ye).mark((function r(){return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",ac(n.auth,ua(n._delegate,t)));case 1:case"end":return e.stop()}}),r)})))()}},{key:"reauthenticateWithPhoneNumber",value:function(e,t){return oc(this.auth,function(e,t,n){return Ko.apply(this,arguments)}(this._delegate,e,t))}},{key:"reauthenticateWithPopup",value:function(e){return ac(this.auth,function(e,t,n){return au.apply(this,arguments)}(this._delegate,e,tc))}},{key:"reauthenticateWithRedirect",value:function(t){var n=this;return e(ve)(e(ye).mark((function r(){return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Xs(Gr(n.auth));case 2:return e.abrupt("return",wu(n._delegate,t,tc));case 3:case"end":return e.stop()}}),r)})))()}},{key:"sendEmailVerification",value:function(e){return function(e,t){return Aa.apply(this,arguments)}(this._delegate,e)}},{key:"unlink",value:function(t){var n=this;return e(ve)(e(ye).mark((function r(){return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Hi(n._delegate,t);case 2:return e.abrupt("return",n);case 3:case"end":return e.stop()}}),r)})))()}},{key:"updateEmail",value:function(e){return function(e,t){return Oa(de(e),t,null)}(this._delegate,e)}},{key:"updatePassword",value:function(e){return function(e,t){return Oa(de(e),null,t)}(this._delegate,e)}},{key:"updatePhoneNumber",value:function(e){return function(e,t){return Ho.apply(this,arguments)}(this._delegate,e)}},{key:"updateProfile",value:function(e){return function(e,t){return Ra.apply(this,arguments)}(this._delegate,e)}},{key:"verifyBeforeUpdateEmail",value:function(e,t){return function(e,t,n){return Ca.apply(this,arguments)}(this._delegate,e,t)}},{key:"emailVerified",get:function(){return this._delegate.emailVerified}},{key:"isAnonymous",get:function(){return this._delegate.isAnonymous}},{key:"metadata",get:function(){return this._delegate.metadata}},{key:"phoneNumber",get:function(){return this._delegate.phoneNumber}},{key:"providerData",get:function(){return this._delegate.providerData}},{key:"refreshToken",get:function(){return this._delegate.refreshToken}},{key:"tenantId",get:function(){return this._delegate.tenantId}},{key:"displayName",get:function(){return this._delegate.displayName}},{key:"email",get:function(){return this._delegate.email}},{key:"photoURL",get:function(){return this._delegate.photoURL}},{key:"providerId",get:function(){return this._delegate.providerId}},{key:"uid",get:function(){return this._delegate.uid}},{key:"auth",get:function(){return this._delegate.auth}}],[{key:"getOrCreate",value:function(e){return t.USER_MAP.has(e)||t.USER_MAP.set(e,new t(e)),t.USER_MAP.get(e)}}]),t}();
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */cc.USER_MAP=new WeakMap;
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var lc=An,hc=function(){"use strict";function t(n,r){if(e(s)(this,t),this.app=n,r.isInitialized())return this._delegate=r.getImmediate(),void this.linkUnderlyingAuth();var i=n.options.apiKey;lc(i,"invalid-api-key",{appName:n.name}),lc(i,"invalid-api-key",{appName:n.name});var a="undefined"!=typeof window?tc:void 0;this._delegate=r.initialize({options:{persistence:dc(i,n.name),popupRedirectResolver:a}}),this._delegate._updateErrorMap(gn),this.linkUnderlyingAuth()}return e(c)(t,[{key:"emulatorConfig",get:function(){return this._delegate.emulatorConfig}},{key:"currentUser",get:function(){return this._delegate.currentUser?cc.getOrCreate(this._delegate.currentUser):null}},{key:"languageCode",get:function(){return this._delegate.languageCode},set:function(e){this._delegate.languageCode=e}},{key:"settings",get:function(){return this._delegate.settings}},{key:"tenantId",get:function(){return this._delegate.tenantId},set:function(e){this._delegate.tenantId=e}},{key:"useDeviceLanguage",value:function(){this._delegate.useDeviceLanguage()}},{key:"signOut",value:function(){return this._delegate.signOut()}},{key:"useEmulator",value:function(e,t){zr(this._delegate,e,t)}},{key:"applyActionCode",value:function(e){return function(e,t){return ma.apply(this,arguments)}(this._delegate,e)}},{key:"checkActionCode",value:function(e){return ga(this._delegate,e)}},{key:"confirmPasswordReset",value:function(e,t){return function(e,t,n){return ya.apply(this,arguments)}(this._delegate,e,t)}},{key:"createUserWithEmailAndPassword",value:function(t,n){var r=this;return e(ve)(e(ye).mark((function i(){return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",ac(r._delegate,ba(r._delegate,t,n)));case 1:case"end":return e.stop()}}),i)})))()}},{key:"fetchProvidersForEmail",value:function(e){return this.fetchSignInMethodsForEmail(e)}},{key:"fetchSignInMethodsForEmail",value:function(e){return function(e,t){return Sa.apply(this,arguments)}(this._delegate,e)}},{key:"isSignInWithEmailLink",value:function(e){return function(e,t){var n=Ai.parseLink(t);return"EMAIL_SIGNIN"===(null==n?void 0:n.operation)}(this._delegate,e)}},{key:"getRedirectResult",value:function(){var t=this;return e(ve)(e(ye).mark((function n(){var r;return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return lc(Gs(),t._delegate,"operation-not-supported-in-this-environment"),e.next=3,_u(t._delegate,tc);case 3:if(r=e.sent){e.next=6;break}return e.abrupt("return",{credential:null,user:null});case 6:return e.abrupt("return",ac(t._delegate,Promise.resolve(r)));case 7:case"end":return e.stop()}}),n)})))()}},{key:"addFrameworkForLogging",value:function(e){!function(e,t){Gr(e)._logFramework(t)}(this._delegate,e)}},{key:"onAuthStateChanged",value:function(e,t,n){var r=fc(e,t,n),i=r.next,a=r.error,o=r.complete;return this._delegate.onAuthStateChanged(i,a,o)}},{key:"onIdTokenChanged",value:function(e,t,n){var r=fc(e,t,n),i=r.next,a=r.error,o=r.complete;return this._delegate.onIdTokenChanged(i,a,o)}},{key:"sendSignInLinkToEmail",value:function(e,t){return function(e,t,n){return Ia.apply(this,arguments)}(this._delegate,e,t)}},{key:"sendPasswordResetEmail",value:function(e,t){return function(e,t,n){return pa.apply(this,arguments)}(this._delegate,e,t||void 0)}},{key:"setPersistence",value:function(t){var n=this;return e(ve)(e(ye).mark((function r(){var i,a;return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Js(n._delegate,t),e.t0=t,e.next=e.t0===Hs.SESSION?5:e.t0===Hs.LOCAL?7:e.t0===Hs.NONE?12:14;break;case 5:return i=Za,e.abrupt("break",15);case 7:return e.next=9,Rn(bo)._isAvailable();case 9:return a=e.sent,i=a?bo:Ja,e.abrupt("break",15);case 12:return i=_r,e.abrupt("break",15);case 14:return e.abrupt("return",In("argument-error",{appName:n._delegate.name}));case 15:return e.abrupt("return",n._delegate.setPersistence(i));case 16:case"end":return e.stop()}}),r)})))()}},{key:"signInAndRetrieveDataWithCredential",value:function(e){return this.signInWithCredential(e)}},{key:"signInAnonymously",value:function(){return ac(this._delegate,function(e){return Gi.apply(this,arguments)}(this._delegate))}},{key:"signInWithCredential",value:function(e){return ac(this._delegate,ra(this._delegate,e))}},{key:"signInWithCustomToken",value:function(e){return ac(this._delegate,function(e,t){return ha.apply(this,arguments)}(this._delegate,e))}},{key:"signInWithEmailAndPassword",value:function(e,t){return ac(this._delegate,function(e,t,n){return ra(de(e),Ci.credential(t,n))}(this._delegate,e,t))}},{key:"signInWithEmailLink",value:function(e,t){return ac(this._delegate,function(e,t,n){return _a.apply(this,arguments)}(this._delegate,e,t))}},{key:"signInWithPhoneNumber",value:function(e,t){return oc(this._delegate,function(e,t,n){return qo.apply(this,arguments)}(this._delegate,e,t))}},{key:"signInWithPopup",value:function(t){var n=this;return e(ve)(e(ye).mark((function r(){return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return lc(Gs(),n._delegate,"operation-not-supported-in-this-environment"),e.abrupt("return",ac(n._delegate,ru(n._delegate,t,tc)));case 2:case"end":return e.stop()}}),r)})))()}},{key:"signInWithRedirect",value:function(t){var n=this;return e(ve)(e(ye).mark((function r(){return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return lc(Gs(),n._delegate,"operation-not-supported-in-this-environment"),e.next=3,Xs(n._delegate);case 3:return e.abrupt("return",gu(n._delegate,t,tc));case 4:case"end":return e.stop()}}),r)})))()}},{key:"updateCurrentUser",value:function(e){return this._delegate.updateCurrentUser(e)}},{key:"verifyPasswordResetCode",value:function(e){return function(e,t){return wa.apply(this,arguments)}(this._delegate,e)}},{key:"unwrap",value:function(){return this._delegate}},{key:"_delete",value:function(){return this._delegate._delete()}},{key:"linkUnderlyingAuth",value:function(){var e=this;this._delegate.wrapped=function(){return e}}}]),t}();function fc(e,t,n){var r,i=e;"function"!=typeof e&&(i=(r=e).next,t=r.error,n=r.complete);var a=i;return{next:function(e){return a(e&&cc.getOrCreate(e))},error:t,complete:n}}function dc(e,t){var n=function(e,t){var n=$s();if(!n)return[];var r=Tr(Ys,e,t);switch(n.getItem(r)){case Hs.NONE:return[_r];case Hs.LOCAL:return[bo,Za];case Hs.SESSION:return[Za];default:return[]}}(e,t);if("undefined"==typeof self||n.includes(bo)||n.push(bo),"undefined"!=typeof window){var r=!0,i=!1,a=void 0;try{for(var o,u=[Ja,Za][Symbol.iterator]();!(r=(o=u.next()).done);r=!0){var s=o.value;n.includes(s)||n.push(s)}}catch(e){i=!0,a=e}finally{try{r||null==u.return||u.return()}finally{if(i)throw a}}}return n.includes(_r)||n.push(_r),n}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */hc.Persistence=Hs;var vc=function(){"use strict";function t(){e(s)(this,t),this.providerId="phone",this._delegate=new Qo(nc(Ht.auth()))}return e(c)(t,[{key:"verifyPhoneNumber",value:function(e,t){return this._delegate.verifyPhoneNumber(e,t)}},{key:"unwrap",value:function(){return this._delegate}}],[{key:"credential",value:function(e,t){return Qo.credential(e,t)}}]),t}();vc.PHONE_SIGN_IN_METHOD=Qo.PHONE_SIGN_IN_METHOD,vc.PROVIDER_ID=Qo.PROVIDER_ID;
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var pc,yc=An,mc=function(){"use strict";function t(n,r){var i,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Ht.app();e(s)(this,t),yc(null===(i=a.options)||void 0===i?void 0:i.apiKey,"invalid-api-key",{appName:a.name}),this._delegate=new Vo(n,r,a.auth()),this.type=this._delegate.type}return e(c)(t,[{key:"clear",value:function(){this._delegate.clear()}},{key:"render",value:function(){return this._delegate.render()}},{key:"verify",value:function(){return this._delegate.verify()}}]),t}();(pc=Ht).INTERNAL.registerComponent(new ge("auth-compat",(function(e){var t=e.getProvider("app-compat").getImmediate(),n=e.getProvider("auth");return new hc(t,n)}),"PUBLIC").setServiceProps({ActionCodeInfo:{Operation:{EMAIL_SIGNIN:hn,PASSWORD_RESET:fn,RECOVER_EMAIL:dn,REVERT_SECOND_FACTOR_ADDITION:vn,VERIFY_AND_CHANGE_EMAIL:pn,VERIFY_EMAIL:yn}},EmailAuthProvider:Ci,FacebookAuthProvider:Oi,GithubAuthProvider:Li,GoogleAuthProvider:Pi,OAuthProvider:Ri,SAMLAuthProvider:Fi,PhoneAuthProvider:vc,PhoneMultiFactorGenerator:ss,RecaptchaVerifier:mc,TwitterAuthProvider:Vi,Auth:hc,AuthCredential:Qr,Error:$}).setInstantiationMode("LAZY").setMultipleInstances(!1)),pc.registerVersion("@firebase/auth-compat","0.2.20");var gc,kc=o("ge8co"),wc=(kc=o("ge8co"),Xt=o("fVNic"),o("jmhxu")),bc=o("l5bVx"),xc=(Xt=o("fVNic"),bc=o("l5bVx"),"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==t?t:"undefined"!=typeof self?self:{}),Ic={},_c=_c||{},Tc=xc||self;function Ec(){}function Sc(t){var n=void 0===t?"undefined":e(bc)(t);return"array"==(n="object"!=n?n:t?Array.isArray(t)?"array":n:"null")||"object"==n&&"number"==typeof t.length}function Ac(t){var n=void 0===t?"undefined":e(bc)(t);return"object"==n&&null!=t||"function"==n}var Cc="closure_uid_"+(1e9*Math.random()>>>0),Nc=0;function Dc(e,t,n){return e.call.apply(e.bind,arguments)}function Rc(e,t,n){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),e.apply(t,n)}}return function(){return e.apply(t,arguments)}}function Oc(e,t,n){return(Oc=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?Dc:Rc).apply(null,arguments)}function Pc(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}function Lc(e,t){function n(){}n.prototype=t.prototype,e.X=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.Vb=function(e,n,r){for(var i=Array(arguments.length-2),a=2;a<arguments.length;a++)i[a-2]=arguments[a];return t.prototype[n].apply(e,i)}}function Mc(){this.s=this.s,this.o=this.o}var Fc={};Mc.prototype.s=!1,Mc.prototype.na=function(){if(!this.s&&(this.s=!0,this.M(),0)){var e=function(e){return Object.prototype.hasOwnProperty.call(e,Cc)&&e[Cc]||(e[Cc]=++Nc)}(this);delete Fc[e]}},Mc.prototype.M=function(){if(this.o)for(;this.o.length;)this.o.shift()()};var Vc=Array.prototype.indexOf?function(e,t){return Array.prototype.indexOf.call(e,t,void 0)}:function(e,t){if("string"==typeof e)return"string"!=typeof t||1!=t.length?-1:e.indexOf(t,0);for(var n=0;n<e.length;n++)if(n in e&&e[n]===t)return n;return-1};function Uc(e){var t=e.length;if(0<t){for(var n=Array(t),r=0;r<t;r++)n[r]=e[r];return n}return[]}function Bc(e,t){for(var n=1;n<arguments.length;n++){var r=arguments[n];if(Sc(r)){var i=e.length||0,a=r.length||0;e.length=i+a;for(var o=0;o<a;o++)e[i+o]=r[o]}else e.push(r)}}function qc(e,t){this.type=e,this.g=this.target=t,this.defaultPrevented=!1}qc.prototype.h=function(){this.defaultPrevented=!0};var jc=function(){if(!Tc.addEventListener||!Object.defineProperty)return!1;var e=!1,t=Object.defineProperty({},"passive",{get:function(){e=!0}});try{Tc.addEventListener("test",Ec,t),Tc.removeEventListener("test",Ec,t)}catch(e){}return e}();function Gc(e){return/^[\s\xa0]*$/.test(e)}var Kc=String.prototype.trim?function(e){return e.trim()}:function(e){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(e)[1]};function zc(e,t){return e<t?-1:e>t?1:0}function Wc(){var e=Tc.navigator;return e&&(e=e.userAgent)?e:""}function Hc(e){return-1!=Wc().indexOf(e)}function Qc(e){return Qc[" "](e),e}Qc[" "]=Ec;var Yc,Jc,Xc=Hc("Opera"),Zc=Hc("Trident")||Hc("MSIE"),$c=Hc("Edge"),el=$c||Zc,tl=Hc("Gecko")&&!(-1!=Wc().toLowerCase().indexOf("webkit")&&!Hc("Edge"))&&!(Hc("Trident")||Hc("MSIE"))&&!Hc("Edge"),nl=-1!=Wc().toLowerCase().indexOf("webkit")&&!Hc("Edge");function rl(){var e=Tc.document;return e?e.documentMode:void 0}e:{var il="",al=(Jc=Wc(),tl?/rv:([^\);]+)(\)|;)/.exec(Jc):$c?/Edge\/([\d\.]+)/.exec(Jc):Zc?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(Jc):nl?/WebKit\/(\S+)/.exec(Jc):Xc?/(?:Version)[ \/]?(\S+)/.exec(Jc):void 0);if(al&&(il=al?al[1]:""),Zc){var ol=rl();if(null!=ol&&ol>parseFloat(il)){Yc=String(ol);break e}}Yc=il}var ul,sl={};function cl(){return function(e){var t=sl;return Object.prototype.hasOwnProperty.call(t,9)?t[9]:t[9]=e(9)}((function(){for(var e=0,t=Kc(String(Yc)).split("."),n=Kc("9").split("."),r=Math.max(t.length,n.length),i=0;0==e&&i<r;i++){var a=t[i]||"",o=n[i]||"";do{if(a=/(\d*)(\D*)(.*)/.exec(a)||["","","",""],o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],0==a[0].length&&0==o[0].length)break;e=zc(0==a[1].length?0:parseInt(a[1],10),0==o[1].length?0:parseInt(o[1],10))||zc(0==a[2].length,0==o[2].length)||zc(a[2],o[2]),a=a[3],o=o[3]}while(0==e)}return 0<=e}))}if(Tc.document&&Zc){var ll=rl();ul=ll||(parseInt(Yc,10)||void 0)}else ul=void 0;var hl=ul;function fl(e,t){if(qc.call(this,e?e.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,e){var n=this.type=e.type,r=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:null;if(this.target=e.target||e.srcElement,this.g=t,t=e.relatedTarget){if(tl){e:{try{Qc(t.nodeName);var i=!0;break e}catch(e){}i=!1}i||(t=null)}}else"mouseover"==n?t=e.fromElement:"mouseout"==n&&(t=e.toElement);this.relatedTarget=t,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==e.clientX?e.clientX:e.pageX,this.clientY=void 0!==e.clientY?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0),this.button=e.button,this.key=e.key||"",this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType="string"==typeof e.pointerType?e.pointerType:dl[e.pointerType]||"",this.state=e.state,this.i=e,e.defaultPrevented&&fl.X.h.call(this)}}Lc(fl,qc);var dl={2:"touch",3:"pen",4:"mouse"};fl.prototype.h=function(){fl.X.h.call(this);var e=this.i;e.preventDefault?e.preventDefault():e.returnValue=!1};var vl="closure_listenable_"+(1e6*Math.random()|0),pl=0;function yl(e,t,n,r,i){this.listener=e,this.proxy=null,this.src=t,this.type=n,this.capture=!!r,this.ha=i,this.key=++pl,this.ba=this.ea=!1}function ml(e){e.ba=!0,e.listener=null,e.proxy=null,e.src=null,e.ha=null}function gl(e,t,n){for(var r in e)t.call(n,e[r],r,e)}function kl(e){var t={};for(var n in e)t[n]=e[n];return t}var wl="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function bl(e,t){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])e[n]=r[n];for(var a=0;a<wl.length;a++)n=wl[a],Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}}function xl(e){this.src=e,this.g={},this.h=0}function Il(e,t){var n=t.type;if(n in e.g){var r,i=e.g[n],a=Vc(i,t);(r=0<=a)&&Array.prototype.splice.call(i,a,1),r&&(ml(t),0==e.g[n].length&&(delete e.g[n],e.h--))}}function _l(e,t,n,r){for(var i=0;i<e.length;++i){var a=e[i];if(!a.ba&&a.listener==t&&a.capture==!!n&&a.ha==r)return i}return-1}xl.prototype.add=function(e,t,n,r,i){var a=e.toString();(e=this.g[a])||(e=this.g[a]=[],this.h++);var o=_l(e,t,r,i);return-1<o?(t=e[o],n||(t.ea=!1)):((t=new yl(t,this.src,a,!!r,i)).ea=n,e.push(t)),t};var Tl="closure_lm_"+(1e6*Math.random()|0),El={};function Sl(e,t,n,r,i){if(r&&r.once)return Cl(e,t,n,r,i);if(Array.isArray(t)){for(var a=0;a<t.length;a++)Sl(e,t[a],n,r,i);return null}return n=Ml(n),e&&e[vl]?e.N(t,n,Ac(r)?!!r.capture:!!r,i):Al(e,t,n,!1,r,i)}function Al(e,t,n,r,i,a){if(!t)throw Error("Invalid event type");var o=Ac(i)?!!i.capture:!!i,u=Pl(e);if(u||(e[Tl]=u=new xl(e)),(n=u.add(t,n,r,o,a)).proxy)return n;if(r=function(){function e(n){return t.call(e.src,e.listener,n)}var t=Ol;return e}(),n.proxy=r,r.src=e,r.listener=n,e.addEventListener)jc||(i=o),void 0===i&&(i=!1),e.addEventListener(t.toString(),r,i);else if(e.attachEvent)e.attachEvent(Rl(t.toString()),r);else{if(!e.addListener||!e.removeListener)throw Error("addEventListener and attachEvent are unavailable.");e.addListener(r)}return n}function Cl(e,t,n,r,i){if(Array.isArray(t)){for(var a=0;a<t.length;a++)Cl(e,t[a],n,r,i);return null}return n=Ml(n),e&&e[vl]?e.O(t,n,Ac(r)?!!r.capture:!!r,i):Al(e,t,n,!0,r,i)}function Nl(e,t,n,r,i){if(Array.isArray(t))for(var a=0;a<t.length;a++)Nl(e,t[a],n,r,i);else r=Ac(r)?!!r.capture:!!r,n=Ml(n),e&&e[vl]?(e=e.i,(t=String(t).toString())in e.g&&(-1<(n=_l(a=e.g[t],n,r,i))&&(ml(a[n]),Array.prototype.splice.call(a,n,1),0==a.length&&(delete e.g[t],e.h--)))):e&&(e=Pl(e))&&(t=e.g[t.toString()],e=-1,t&&(e=_l(t,n,r,i)),(n=-1<e?t[e]:null)&&Dl(n))}function Dl(e){if("number"!=typeof e&&e&&!e.ba){var t=e.src;if(t&&t[vl])Il(t.i,e);else{var n=e.type,r=e.proxy;t.removeEventListener?t.removeEventListener(n,r,e.capture):t.detachEvent?t.detachEvent(Rl(n),r):t.addListener&&t.removeListener&&t.removeListener(r),(n=Pl(t))?(Il(n,e),0==n.h&&(n.src=null,t[Tl]=null)):ml(e)}}}function Rl(e){return e in El?El[e]:El[e]="on"+e}function Ol(e,t){if(e.ba)e=!0;else{t=new fl(t,this);var n=e.listener,r=e.ha||e.src;e.ea&&Dl(e),e=n.call(r,t)}return e}function Pl(e){return(e=e[Tl])instanceof xl?e:null}var Ll="__closure_events_fn_"+(1e9*Math.random()>>>0);function Ml(e){return"function"==typeof e?e:(e[Ll]||(e[Ll]=function(t){return e.handleEvent(t)}),e[Ll])}function Fl(){Mc.call(this),this.i=new xl(this),this.P=this,this.I=null}function Vl(e,t){var n,r=e.I;if(r)for(n=[];r;r=r.I)n.push(r);if(e=e.P,r=t.type||t,"string"==typeof t)t=new qc(t,e);else if(t instanceof qc)t.target=t.target||e;else{var i=t;bl(t=new qc(r,e),i)}if(i=!0,n)for(var a=n.length-1;0<=a;a--){var o=t.g=n[a];i=Ul(o,r,!0,t)&&i}if(i=Ul(o=t.g=e,r,!0,t)&&i,i=Ul(o,r,!1,t)&&i,n)for(a=0;a<n.length;a++)i=Ul(o=t.g=n[a],r,!1,t)&&i}function Ul(e,t,n,r){if(!(t=e.i.g[String(t)]))return!0;t=t.concat();for(var i=!0,a=0;a<t.length;++a){var o=t[a];if(o&&!o.ba&&o.capture==n){var u=o.listener,s=o.ha||o.src;o.ea&&Il(e.i,o),i=!1!==u.call(s,r)&&i}}return i&&!r.defaultPrevented}Lc(Fl,Mc),Fl.prototype[vl]=!0,Fl.prototype.removeEventListener=function(e,t,n,r){Nl(this,e,t,n,r)},Fl.prototype.M=function(){if(Fl.X.M.call(this),this.i){var e,t=this.i;for(e in t.g){for(var n=t.g[e],r=0;r<n.length;r++)ml(n[r]);delete t.g[e],t.h--}}this.I=null},Fl.prototype.N=function(e,t,n,r){return this.i.add(String(e),t,!1,n,r)},Fl.prototype.O=function(e,t,n,r){return this.i.add(String(e),t,!0,n,r)};var Bl=Tc.JSON.stringify;function ql(){var e=Yl,t=null;return e.g&&(t=e.g,e.g=e.g.next,e.g||(e.h=null),t.next=null),t}var jl,Gl=function(){"use strict";function t(){e(s)(this,t),this.h=this.g=null}return e(c)(t,[{key:"add",value:function(e,t){var n=Kl.get();n.set(e,t),this.h?this.h.next=n:this.g=n,this.h=n}}]),t}(),Kl=new(function(){"use strict";function t(n,r){e(s)(this,t),this.i=n,this.j=r,this.h=0,this.g=null}return e(c)(t,[{key:"get",value:function(){var e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}]),t}())((function(){return new zl}),(function(e){return e.reset()})),zl=function(){"use strict";function t(){e(s)(this,t),this.next=this.g=this.h=null}return e(c)(t,[{key:"set",value:function(e,t){this.h=e,this.g=t,this.next=null}},{key:"reset",value:function(){this.next=this.g=this.h=null}}]),t}();function Wl(e){Tc.setTimeout((function(){throw e}),0)}function Hl(e,t){jl||function(){var e=Tc.Promise.resolve(void 0);jl=function(){e.then(Jl)}}(),Ql||(jl(),Ql=!0),Yl.add(e,t)}var Ql=!1,Yl=new Gl;function Jl(){for(var e;e=ql();){try{e.h.call(e.g)}catch(e){Wl(e)}var t=Kl;t.j(e),100>t.h&&(t.h++,e.next=t.g,t.g=e)}Ql=!1}function Xl(e,t){Fl.call(this),this.h=e||1,this.g=t||Tc,this.j=Oc(this.kb,this),this.l=Date.now()}function Zl(e){e.ca=!1,e.R&&(e.g.clearTimeout(e.R),e.R=null)}function $l(e,t,n){if("function"==typeof e)n&&(e=Oc(e,n));else{if(!e||"function"!=typeof e.handleEvent)throw Error("Invalid listener argument");e=Oc(e.handleEvent,e)}return 2147483647<Number(t)?-1:Tc.setTimeout(e,t||0)}function eh(e){e.g=$l((function(){e.g=null,e.i&&(e.i=!1,eh(e))}),e.j);var t=e.h;e.h=null,e.m.apply(null,t)}Lc(Xl,Fl),(gc=Xl.prototype).ca=!1,gc.R=null,gc.kb=function(){if(this.ca){var e=Date.now()-this.l;0<e&&e<.8*this.h?this.R=this.g.setTimeout(this.j,this.h-e):(this.R&&(this.g.clearTimeout(this.R),this.R=null),Vl(this,"tick"),this.ca&&(Zl(this),this.start()))}},gc.start=function(){this.ca=!0,this.R||(this.R=this.g.setTimeout(this.j,this.h),this.l=Date.now())},gc.M=function(){Xl.X.M.call(this),Zl(this),delete this.g};var th=function(t){"use strict";e(d)(r,t);var n=e(L)(r);function r(t,i){var a;return e(s)(this,r),(a=n.call(this)).m=t,a.j=i,a.h=null,a.i=!1,a.g=null,a}return e(c)(r,[{key:"l",value:function(e){this.h=arguments,this.g?this.i=!0:eh(this)}},{key:"M",value:function(){e(Qt)(e(Xt)(r.prototype),"M",this).call(this),this.g&&(Tc.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}]),r}(Mc);function nh(e){Mc.call(this),this.h=e,this.g={}}Lc(nh,Mc);var rh=[];function ih(e,t,n,r){Array.isArray(n)||(n&&(rh[0]=n.toString()),n=rh);for(var i=0;i<n.length;i++){var a=Sl(t,n[i],r||e.handleEvent,!1,e.h||e);if(!a)break;e.g[a.key]=a}}function ah(e){gl(e.g,(function(e,t){this.g.hasOwnProperty(t)&&Dl(e)}),e),e.g={}}function oh(){this.g=!0}function uh(e,t,n,r){e.info((function(){return"XMLHTTP TEXT ("+t+"): "+function(e,t){if(!e.g)return t;if(!t)return null;try{var n=JSON.parse(t);if(n)for(e=0;e<n.length;e++)if(Array.isArray(n[e])){var r=n[e];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var a=i[0];if("noop"!=a&&"stop"!=a&&"close"!=a)for(var o=1;o<i.length;o++)i[o]=""}}}return Bl(n)}catch(e){return t}}(e,n)+(r?" "+r:"")}))}nh.prototype.M=function(){nh.X.M.call(this),ah(this)},nh.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},oh.prototype.Aa=function(){this.g=!1},oh.prototype.info=function(){};var sh={},ch=null;function lh(){return ch=ch||new Fl}function hh(e){qc.call(this,sh.Oa,e)}function fh(e){var t=lh();Vl(t,new hh(t,e))}function dh(e,t){qc.call(this,sh.STAT_EVENT,e),this.stat=t}function vh(e){var t=lh();Vl(t,new dh(t,e))}function ph(e,t){qc.call(this,sh.Pa,e),this.size=t}function yh(e,t){if("function"!=typeof e)throw Error("Fn must not be null and must be a function");return Tc.setTimeout((function(){e()}),t)}sh.Oa="serverreachability",Lc(hh,qc),sh.STAT_EVENT="statevent",Lc(dh,qc),sh.Pa="timingevent",Lc(ph,qc);var mh={NO_ERROR:0,lb:1,yb:2,xb:3,sb:4,wb:5,zb:6,La:7,TIMEOUT:8,Cb:9},gh={qb:"complete",Mb:"success",Ma:"error",La:"abort",Eb:"ready",Fb:"readystatechange",TIMEOUT:"timeout",Ab:"incrementaldata",Db:"progress",tb:"downloadprogress",Ub:"uploadprogress"};function kh(){}function wh(e){return e.h||(e.h=e.i())}function bh(){}kh.prototype.h=null;var xh,Ih={OPEN:"a",pb:"b",Ma:"c",Bb:"d"};function _h(){qc.call(this,"d")}function Th(){qc.call(this,"c")}function Eh(){}function Sh(e,t,n,r){this.l=e,this.j=t,this.m=n,this.U=r||1,this.S=new nh(this),this.O=Ch,e=el?125:void 0,this.T=new Xl(e),this.H=null,this.i=!1,this.s=this.A=this.v=this.K=this.F=this.V=this.B=null,this.D=[],this.g=null,this.C=0,this.o=this.u=null,this.Y=-1,this.I=!1,this.N=0,this.L=null,this.$=this.J=this.Z=this.P=!1,this.h=new Ah}function Ah(){this.i=null,this.g="",this.h=!1}Lc(_h,qc),Lc(Th,qc),Lc(Eh,kh),Eh.prototype.g=function(){return new XMLHttpRequest},Eh.prototype.i=function(){return{}},xh=new Eh;var Ch=45e3,Nh={},Dh={};function Rh(e,t,n){e.K=1,e.v=Xh(Wh(t)),e.s=n,e.P=!0,Oh(e,null)}function Oh(e,t){e.F=Date.now(),Fh(e),e.A=Wh(e.v);var n=e.A,r=e.U;Array.isArray(r)||(r=[String(r)]),hf(n.i,"t",r),e.C=0,n=e.l.H,e.h=new Ah,e.g=hd(e.l,n?t:null,!e.s),0<e.N&&(e.L=new th(Oc(e.Ka,e,e.g),e.N)),ih(e.S,e.g,"readystatechange",e.hb),t=e.H?kl(e.H):{},e.s?(e.u||(e.u="POST"),t["Content-Type"]="application/x-www-form-urlencoded",e.g.da(e.A,e.u,e.s,t)):(e.u="GET",e.g.da(e.A,e.u,null,t)),fh(1),function(e,t,n,r,i,a){e.info((function(){if(e.g)if(a)for(var o="",u=a.split("&"),s=0;s<u.length;s++){var c=u[s].split("=");if(1<c.length){var l=c[0];c=c[1];var h=l.split("_");o=2<=h.length&&"type"==h[1]?o+(l+"=")+c+"&":o+(l+"=redacted&")}}else o=null;else o=a;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+t+"\n"+n+"\n"+o}))}(e.j,e.u,e.A,e.m,e.U,e.s)}function Ph(e){return!!e.g&&("GET"==e.u&&2!=e.K&&e.l.Da)}function Lh(e,t,n){for(var r,i=!0;!e.I&&e.C<n.length;){if((r=Mh(e,n))==Dh){4==t&&(e.o=4,vh(14),i=!1),uh(e.j,e.m,null,"[Incomplete Response]");break}if(r==Nh){e.o=4,vh(15),uh(e.j,e.m,n,"[Invalid Chunk]"),i=!1;break}uh(e.j,e.m,r,null),jh(e,r)}Ph(e)&&r!=Dh&&r!=Nh&&(e.h.g="",e.C=0),4!=t||0!=n.length||e.h.h||(e.o=1,vh(16),i=!1),e.i=e.i&&i,i?0<n.length&&!e.$&&(e.$=!0,(t=e.l).g==e&&t.$&&!t.K&&(t.j.info("Great, no buffering proxy detected. Bytes received: "+n.length),rd(t),t.K=!0,vh(11))):(uh(e.j,e.m,n,"[Invalid Chunked Response]"),qh(e),Bh(e))}function Mh(e,t){var n=e.C,r=t.indexOf("\n",n);return-1==r?Dh:(n=Number(t.substring(n,r)),isNaN(n)?Nh:(r+=1)+n>t.length?Dh:(t=t.substr(r,n),e.C=r+n,t))}function Fh(e){e.V=Date.now()+e.O,Vh(e,e.O)}function Vh(e,t){if(null!=e.B)throw Error("WatchDog timer not null");e.B=yh(Oc(e.fb,e),t)}function Uh(e){e.B&&(Tc.clearTimeout(e.B),e.B=null)}function Bh(e){0==e.l.G||e.I||od(e.l,e)}function qh(e){Uh(e);var t=e.L;t&&"function"==typeof t.na&&t.na(),e.L=null,Zl(e.T),ah(e.S),e.g&&(t=e.g,e.g=null,t.abort(),t.na())}function jh(e,t){try{var n=e.l;if(0!=n.G&&(n.g==e||gf(n.h,e)))if(!e.J&&gf(n.h,e)&&3==n.G){try{var r=n.Fa.g.parse(t)}catch(a){r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){e:if(!n.u){if(n.g){if(!(n.g.F+3e3<e.F))break e;ad(n),Yf(n)}nd(n),vh(18)}}else n.Ba=i[1],0<n.Ba-n.T&&37500>i[2]&&n.L&&0==n.A&&!n.v&&(n.v=yh(Oc(n.bb,n),6e3));if(1>=mf(n.h)&&n.ja){try{n.ja()}catch(a){}n.ja=void 0}}else sd(n,11)}else if((e.J||n.g==e)&&ad(n),!Gc(t))for(i=n.Fa.g.parse(t),t=0;t<i.length;t++){var a=i[t];if(n.T=a[0],a=a[1],2==n.G)if("c"==a[0]){n.I=a[1],n.ka=a[2];var o=a[3];null!=o&&(n.ma=o,n.j.info("VER="+n.ma));var u=a[4];null!=u&&(n.Ca=u,n.j.info("SVER="+n.Ca));var s=a[5];null!=s&&"number"==typeof s&&0<s&&(r=1.5*s,n.J=r,n.j.info("backChannelRequestTimeoutMs_="+r)),r=n;var c=e.g;if(c){var l=c.g?c.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(l){var h=r.h;h.g||-1==l.indexOf("spdy")&&-1==l.indexOf("quic")&&-1==l.indexOf("h2")||(h.j=h.l,h.g=new Set,h.h&&(kf(h,h.h),h.h=null))}if(r.D){var f=c.g?c.g.getResponseHeader("X-HTTP-Session-Id"):null;f&&(r.za=f,Jh(r.F,r.D,f))}}n.G=3,n.l&&n.l.xa(),n.$&&(n.P=Date.now()-e.F,n.j.info("Handshake RTT: "+n.P+"ms"));var d=e;if((r=n).sa=ld(r,r.H?r.ka:null,r.V),d.J){wf(r.h,d);var v=d,p=r.J;p&&v.setTimeout(p),v.B&&(Uh(v),Fh(v)),r.g=d}else td(r);0<n.i.length&&Xf(n)}else"stop"!=a[0]&&"close"!=a[0]||sd(n,7);else 3==n.G&&("stop"==a[0]||"close"==a[0]?"stop"==a[0]?sd(n,7):Qf(n):"noop"!=a[0]&&n.l&&n.l.wa(a),n.A=0)}fh(4)}catch(a){}}function Gh(e,t){if(e.forEach&&"function"==typeof e.forEach)e.forEach(t,void 0);else if(Sc(e)||"string"==typeof e)Array.prototype.forEach.call(e,t,void 0);else for(var n=function(e){if(e.oa&&"function"==typeof e.oa)return e.oa();if(!e.W||"function"!=typeof e.W){if("undefined"!=typeof Map&&e instanceof Map)return Array.from(e.keys());if(!("undefined"!=typeof Set&&e instanceof Set)){if(Sc(e)||"string"==typeof e){var t=[];e=e.length;for(var n=0;n<e;n++)t.push(n);return t}for(var r in t=[],n=0,e)t[n++]=r;return t}}}(e),r=function(e){if(e.W&&"function"==typeof e.W)return e.W();if("undefined"!=typeof Map&&e instanceof Map||"undefined"!=typeof Set&&e instanceof Set)return Array.from(e.values());if("string"==typeof e)return e.split("");if(Sc(e)){for(var t=[],n=e.length,r=0;r<n;r++)t.push(e[r]);return t}for(r in t=[],n=0,e)t[n++]=e[r];return t}(e),i=r.length,a=0;a<i;a++)t.call(void 0,r[a],n&&n[a],e)}(gc=Sh.prototype).setTimeout=function(e){this.O=e},gc.hb=function(e){e=e.target;var t=this.L;t&&3==jf(e)?t.l():this.Ka(e)},gc.Ka=function(e){try{if(e==this.g)e:{var t=jf(this.g),n=this.g.Ea(),r=this.g.aa();if(!(3>t)&&(3!=t||el||this.g&&(this.h.h||this.g.fa()||Gf(this.g)))){this.I||4!=t||7==n||fh(8==n||0>=r?3:2),Uh(this);var i=this.g.aa();this.Y=i;t:if(Ph(this)){var a=Gf(this.g);e="";var o=a.length,u=4==jf(this.g);if(!this.h.i){if("undefined"==typeof TextDecoder){qh(this),Bh(this);var s="";break t}this.h.i=new Tc.TextDecoder}for(n=0;n<o;n++)this.h.h=!0,e+=this.h.i.decode(a[n],{stream:u&&n==o-1});a.splice(0,o),this.h.g+=e,this.C=0,s=this.h.g}else s=this.g.fa();if(this.i=200==i,function(e,t,n,r,i,a,o){e.info((function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+t+"\n"+n+"\n"+a+" "+o}))}(this.j,this.u,this.A,this.m,this.U,t,i),this.i){if(this.Z&&!this.J){t:{if(this.g){var c,l=this.g;if((c=l.g?l.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!Gc(c)){var h=c;break t}}h=null}if(!(i=h)){this.i=!1,this.o=3,vh(12),qh(this),Bh(this);break e}uh(this.j,this.m,i,"Initial handshake response via X-HTTP-Initial-Response"),this.J=!0,jh(this,i)}this.P?(Lh(this,t,s),el&&this.i&&3==t&&(ih(this.S,this.T,"tick",this.gb),this.T.start())):(uh(this.j,this.m,s,null),jh(this,s)),4==t&&qh(this),this.i&&!this.I&&(4==t?od(this.l,this):(this.i=!1,Fh(this)))}else 400==i&&0<s.indexOf("Unknown SID")?(this.o=3,vh(12)):(this.o=0,vh(13)),qh(this),Bh(this)}}}catch(t){}},gc.gb=function(){if(this.g){var e=jf(this.g),t=this.g.fa();this.C<t.length&&(Uh(this),Lh(this,e,t),this.i&&4!=e&&Fh(this))}},gc.cancel=function(){this.I=!0,qh(this)},gc.fb=function(){this.B=null;var e=Date.now();0<=e-this.V?(function(e,t){e.info((function(){return"TIMEOUT: "+t}))}(this.j,this.A),2!=this.K&&(fh(3),vh(17)),qh(this),this.o=2,Bh(this)):Vh(this,this.V-e)};var Kh=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function zh(e,t){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,e instanceof zh){this.h=void 0!==t?t:e.h,Hh(this,e.j),this.s=e.s,this.g=e.g,Qh(this,e.m),this.l=e.l,t=e.i;var n=new uf;n.i=t.i,t.g&&(n.g=new Map(t.g),n.h=t.h),Yh(this,n),this.o=e.o}else e&&(n=String(e).match(Kh))?(this.h=!!t,Hh(this,n[1]||"",!0),this.s=Zh(n[2]||""),this.g=Zh(n[3]||"",!0),Qh(this,n[4]),this.l=Zh(n[5]||"",!0),Yh(this,n[6]||"",!0),this.o=Zh(n[7]||"")):(this.h=!!t,this.i=new uf(null,this.h))}function Wh(e){return new zh(e)}function Hh(e,t,n){e.j=n?Zh(t,!0):t,e.j&&(e.j=e.j.replace(/:$/,""))}function Qh(e,t){if(t){if(t=Number(t),isNaN(t)||0>t)throw Error("Bad port number "+t);e.m=t}else e.m=null}function Yh(e,t,n){t instanceof uf?(e.i=t,function(e,t){t&&!e.j&&(sf(e),e.i=null,e.g.forEach((function(e,t){var n=t.toLowerCase();t!=n&&(cf(this,t),hf(this,n,e))}),e)),e.j=t}(e.i,e.h)):(n||(t=$h(t,af)),e.i=new uf(t,e.h))}function Jh(e,t,n){e.i.set(t,n)}function Xh(e){return Jh(e,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),e}function Zh(e,t){return e?t?decodeURI(e.replace(/%25/g,"%2525")):decodeURIComponent(e):""}function $h(e,t,n){return"string"==typeof e?(e=encodeURI(e).replace(t,ef),n&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function ef(e){return"%"+((e=e.charCodeAt(0))>>4&15).toString(16)+(15&e).toString(16)}zh.prototype.toString=function(){var e=[],t=this.j;t&&e.push($h(t,tf,!0),":");var n=this.g;return(n||"file"==t)&&(e.push("//"),(t=this.s)&&e.push($h(t,tf,!0),"@"),e.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.m)&&e.push(":",String(n))),(n=this.l)&&(this.g&&"/"!=n.charAt(0)&&e.push("/"),e.push($h(n,"/"==n.charAt(0)?rf:nf,!0))),(n=this.i.toString())&&e.push("?",n),(n=this.o)&&e.push("#",$h(n,of)),e.join("")};var tf=/[#\/\?@]/g,nf=/[#\?:]/g,rf=/[#\?]/g,af=/[#\?@]/g,of=/#/g;function uf(e,t){this.h=this.g=null,this.i=e||null,this.j=!!t}function sf(e){e.g||(e.g=new Map,e.h=0,e.i&&function(e,t){if(e){e=e.split("&");for(var n=0;n<e.length;n++){var r=e[n].indexOf("="),i=null;if(0<=r){var a=e[n].substring(0,r);i=e[n].substring(r+1)}else a=e[n];t(a,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(e.i,(function(t,n){e.add(decodeURIComponent(t.replace(/\+/g," ")),n)})))}function cf(e,t){sf(e),t=ff(e,t),e.g.has(t)&&(e.i=null,e.h-=e.g.get(t).length,e.g.delete(t))}function lf(e,t){return sf(e),t=ff(e,t),e.g.has(t)}function hf(e,t,n){cf(e,t),0<n.length&&(e.i=null,e.g.set(ff(e,t),Uc(n)),e.h+=n.length)}function ff(e,t){return t=String(t),e.j&&(t=t.toLowerCase()),t}(gc=uf.prototype).add=function(e,t){sf(this),this.i=null,e=ff(this,e);var n=this.g.get(e);return n||this.g.set(e,n=[]),n.push(t),this.h+=1,this},gc.forEach=function(e,t){sf(this),this.g.forEach((function(n,r){n.forEach((function(n){e.call(t,n,r,this)}),this)}),this)},gc.oa=function(){sf(this);for(var e=Array.from(this.g.values()),t=Array.from(this.g.keys()),n=[],r=0;r<t.length;r++)for(var i=e[r],a=0;a<i.length;a++)n.push(t[r]);return n},gc.W=function(e){sf(this);var t=[];if("string"==typeof e)lf(this,e)&&(t=t.concat(this.g.get(ff(this,e))));else{e=Array.from(this.g.values());for(var n=0;n<e.length;n++)t=t.concat(e[n])}return t},gc.set=function(e,t){return sf(this),this.i=null,lf(this,e=ff(this,e))&&(this.h-=this.g.get(e).length),this.g.set(e,[t]),this.h+=1,this},gc.get=function(e,t){return e&&0<(e=this.W(e)).length?String(e[0]):t},gc.toString=function(){if(this.i)return this.i;if(!this.g)return"";for(var e=[],t=Array.from(this.g.keys()),n=0;n<t.length;n++){var r=t[n],i=encodeURIComponent(String(r)),a=this.W(r);for(r=0;r<a.length;r++){var o=i;""!==a[r]&&(o+="="+encodeURIComponent(String(a[r]))),e.push(o)}}return this.i=e.join("&")};var df=function t(n,r){"use strict";e(s)(this,t),this.h=n,this.g=r};function vf(e){this.l=e||pf,Tc.PerformanceNavigationTiming?e=0<(e=Tc.performance.getEntriesByType("navigation")).length&&("hq"==e[0].nextHopProtocol||"h2"==e[0].nextHopProtocol):e=!!(Tc.g&&Tc.g.Ga&&Tc.g.Ga()&&Tc.g.Ga().Zb),this.j=e?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var pf=10;function yf(e){return!!e.h||!!e.g&&e.g.size>=e.j}function mf(e){return e.h?1:e.g?e.g.size:0}function gf(e,t){return e.h?e.h==t:!!e.g&&e.g.has(t)}function kf(e,t){e.g?e.g.add(t):e.h=t}function wf(e,t){e.h&&e.h==t?e.h=null:e.g&&e.g.has(t)&&e.g.delete(t)}function bf(e){if(null!=e.h)return e.i.concat(e.h.D);if(null!=e.g&&0!==e.g.size){var t=e.i,n=!0,r=!1,i=void 0;try{for(var a,o=e.g.values()[Symbol.iterator]();!(n=(a=o.next()).done);n=!0){var u=a.value;t=t.concat(u.D)}}catch(e){r=!0,i=e}finally{try{n||null==o.return||o.return()}finally{if(r)throw i}}return t}return Uc(e.i)}function xf(){}function If(){this.g=new xf}function _f(e,t,n){var r=n||"";try{Gh(e,(function(e,n){var i=e;Ac(e)&&(i=Bl(e)),t.push(r+n+"="+encodeURIComponent(i))}))}catch(e){throw t.push(r+"type="+encodeURIComponent("_badmap")),e}}function Tf(e,t,n,r,i){try{t.onload=null,t.onerror=null,t.onabort=null,t.ontimeout=null,i(r)}catch(e){}}function Ef(e){this.l=e.$b||null,this.j=e.ib||!1}function Sf(e,t){Fl.call(this),this.D=e,this.u=t,this.m=void 0,this.readyState=Af,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}vf.prototype.cancel=function(){if(this.i=bf(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){var e=!0,t=!1,n=void 0;try{for(var r,i=this.g.values()[Symbol.iterator]();!(e=(r=i.next()).done);e=!0){r.value.cancel()}}catch(e){t=!0,n=e}finally{try{e||null==i.return||i.return()}finally{if(t)throw n}}this.g.clear()}},xf.prototype.stringify=function(e){return Tc.JSON.stringify(e,void 0)},xf.prototype.parse=function(e){return Tc.JSON.parse(e,void 0)},Lc(Ef,kh),Ef.prototype.g=function(){return new Sf(this.l,this.j)},Ef.prototype.i=function(e){return function(){return e}}({}),Lc(Sf,Fl);var Af=0;function Cf(e){e.j.read().then(e.Sa.bind(e)).catch(e.ga.bind(e))}function Nf(e){e.readyState=4,e.l=null,e.j=null,e.A=null,Df(e)}function Df(e){e.onreadystatechange&&e.onreadystatechange.call(e)}(gc=Sf.prototype).open=function(e,t){if(this.readyState!=Af)throw this.abort(),Error("Error reopening a connection");this.C=e,this.B=t,this.readyState=1,Df(this)},gc.send=function(e){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;var t={headers:this.v,method:this.C,credentials:this.m,cache:void 0};e&&(t.body=e),(this.D||Tc).fetch(new Request(this.B,t)).then(this.Va.bind(this),this.ga.bind(this))},gc.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch((function(){})),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,Nf(this)),this.readyState=Af},gc.Va=function(e){if(this.g&&(this.l=e,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=e.headers,this.readyState=2,Df(this)),this.g&&(this.readyState=3,Df(this),this.g)))if("arraybuffer"===this.responseType)e.arrayBuffer().then(this.Ta.bind(this),this.ga.bind(this));else if(void 0!==Tc.ReadableStream&&"body"in e){if(this.j=e.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;Cf(this)}else e.text().then(this.Ua.bind(this),this.ga.bind(this))},gc.Sa=function(e){if(this.g){if(this.u&&e.value)this.response.push(e.value);else if(!this.u){var t=e.value?e.value:new Uint8Array(0);(t=this.A.decode(t,{stream:!e.done}))&&(this.response=this.responseText+=t)}e.done?Nf(this):Df(this),3==this.readyState&&Cf(this)}},gc.Ua=function(e){this.g&&(this.response=this.responseText=e,Nf(this))},gc.Ta=function(e){this.g&&(this.response=e,Nf(this))},gc.ga=function(){this.g&&Nf(this)},gc.setRequestHeader=function(e,t){this.v.append(e,t)},gc.getResponseHeader=function(e){return this.h&&this.h.get(e.toLowerCase())||""},gc.getAllResponseHeaders=function(){if(!this.h)return"";for(var e=[],t=this.h.entries(),n=t.next();!n.done;)n=n.value,e.push(n[0]+": "+n[1]),n=t.next();return e.join("\r\n")},Object.defineProperty(Sf.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(e){this.m=e?"include":"same-origin"}});var Rf=Tc.JSON.parse;function Of(e){Fl.call(this),this.headers=new Map,this.u=e||null,this.h=!1,this.C=this.g=null,this.H="",this.m=0,this.j="",this.l=this.F=this.v=this.D=!1,this.B=0,this.A=null,this.J=Pf,this.K=this.L=!1}Lc(Of,Fl);var Pf="",Lf=/^https?$/i,Mf=["POST","PUT"];function Ff(e,t){e.h=!1,e.g&&(e.l=!0,e.g.abort(),e.l=!1),e.j=t,e.m=5,Vf(e),Bf(e)}function Vf(e){e.D||(e.D=!0,Vl(e,"complete"),Vl(e,"error"))}function Uf(e){if(e.h&&void 0!==_c&&(!e.C[1]||4!=jf(e)||2!=e.aa()))if(e.v&&4==jf(e))$l(e.Ha,0,e);else if(Vl(e,"readystatechange"),4==jf(e)){e.h=!1;try{var t,n=e.aa();e:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var r=!0;break e;default:r=!1}if(!(t=r)){var i;if(i=0===n){var a=String(e.H).match(Kh)[1]||null;if(!a&&Tc.self&&Tc.self.location){var o=Tc.self.location.protocol;a=o.substr(0,o.length-1)}i=!Lf.test(a?a.toLowerCase():"")}t=i}if(t)Vl(e,"complete"),Vl(e,"success");else{e.m=6;try{var u=2<jf(e)?e.g.statusText:""}catch(e){u=""}e.j=u+" ["+e.aa()+"]",Vf(e)}}finally{Bf(e)}}}function Bf(e,t){if(e.g){qf(e);var n=e.g,r=e.C[0]?Ec:null;e.g=null,e.C=null,t||Vl(e,"ready");try{n.onreadystatechange=r}catch(e){}}}function qf(e){e.g&&e.K&&(e.g.ontimeout=null),e.A&&(Tc.clearTimeout(e.A),e.A=null)}function jf(e){return e.g?e.g.readyState:0}function Gf(e){try{if(!e.g)return null;if("response"in e.g)return e.g.response;switch(e.J){case Pf:case"text":return e.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in e.g)return e.g.mozResponseArrayBuffer}return null}catch(e){return null}}function Kf(e){var t="";return gl(e,(function(e,n){t+=n,t+=":",t+=e,t+="\r\n"})),t}function zf(e,t,n){e:{for(r in n){var r=!1;break e}r=!0}r||(n=Kf(n),"string"==typeof e?null!=n&&encodeURIComponent(String(n)):Jh(e,t,n))}function Wf(e,t,n){return n&&n.internalChannelParams&&n.internalChannelParams[e]||t}function Hf(e){this.Ca=0,this.i=[],this.j=new oh,this.ka=this.sa=this.F=this.V=this.g=this.za=this.D=this.ia=this.o=this.S=this.s=null,this.$a=this.U=0,this.Ya=Wf("failFast",!1,e),this.L=this.v=this.u=this.m=this.l=null,this.Y=!0,this.pa=this.Ba=this.T=-1,this.Z=this.A=this.C=0,this.Wa=Wf("baseRetryDelayMs",5e3,e),this.ab=Wf("retryDelaySeedMs",1e4,e),this.Za=Wf("forwardChannelMaxRetries",2,e),this.ta=Wf("forwardChannelRequestTimeoutMs",2e4,e),this.ra=e&&e.xmlHttpFactory||void 0,this.Da=e&&e.Yb||!1,this.J=void 0,this.H=e&&e.supportsCrossDomainXhr||!1,this.I="",this.h=new vf(e&&e.concurrentRequestLimit),this.Fa=new If,this.O=e&&e.fastHandshake||!1,this.N=e&&e.encodeInitMessageHeaders||!1,this.O&&this.N&&(this.N=!1),this.Xa=e&&e.Wb||!1,e&&e.Aa&&this.j.Aa(),e&&e.forceLongPolling&&(this.Y=!1),this.$=!this.O&&this.Y&&e&&e.detectBufferingProxy||!1,this.ja=void 0,this.P=0,this.K=!1,this.la=this.B=null}function Qf(e){if(Jf(e),3==e.G){var t=e.U++,n=Wh(e.F);Jh(n,"SID",e.I),Jh(n,"RID",t),Jh(n,"TYPE","terminate"),$f(e,n),(t=new Sh(e,e.j,t,void 0)).K=2,t.v=Xh(Wh(n)),n=!1,Tc.navigator&&Tc.navigator.sendBeacon&&(n=Tc.navigator.sendBeacon(t.v.toString(),"")),!n&&Tc.Image&&((new Image).src=t.v,n=!0),n||(t.g=hd(t.l,null),t.g.da(t.v)),t.F=Date.now(),Fh(t)}cd(e)}function Yf(e){e.g&&(rd(e),e.g.cancel(),e.g=null)}function Jf(e){Yf(e),e.u&&(Tc.clearTimeout(e.u),e.u=null),ad(e),e.h.cancel(),e.m&&("number"==typeof e.m&&Tc.clearTimeout(e.m),e.m=null)}function Xf(e){yf(e.h)||e.m||(e.m=!0,Hl(e.Ja,e),e.C=0)}function Zf(e,t){var n;n=t?t.m:e.U++;var r=Wh(e.F);Jh(r,"SID",e.I),Jh(r,"RID",n),Jh(r,"AID",e.T),$f(e,r),e.o&&e.s&&zf(r,e.o,e.s),n=new Sh(e,e.j,n,e.C+1),null===e.o&&(n.H=e.s),t&&(e.i=t.D.concat(e.i)),t=ed(e,n,1e3),n.setTimeout(Math.round(.5*e.ta)+Math.round(.5*e.ta*Math.random())),kf(e.h,n),Rh(n,r,t)}function $f(e,t){e.ia&&gl(e.ia,(function(e,n){Jh(t,n,e)})),e.l&&Gh({},(function(e,n){Jh(t,n,e)}))}function ed(e,t,n){n=Math.min(e.i.length,n);var r=e.l?Oc(e.l.Qa,e.l,e):null;e:for(var i=e.i,a=-1;;){var o=["count="+n];-1==a?0<n?(a=i[0].h,o.push("ofs="+a)):a=0:o.push("ofs="+a);for(var u=!0,s=0;s<n;s++){var c=i[s].h,l=i[s].g;if(0>(c-=a))a=Math.max(0,i[s].h-100),u=!1;else try{_f(l,o,"req"+c+"_")}catch(e){r&&r(l)}}if(u){r=o.join("&");break e}}return e=e.i.splice(0,n),t.D=e,r}function td(e){e.g||e.u||(e.Z=1,Hl(e.Ia,e),e.A=0)}function nd(e){return!(e.g||e.u||3<=e.A)&&(e.Z++,e.u=yh(Oc(e.Ia,e),ud(e,e.A)),e.A++,!0)}function rd(e){null!=e.B&&(Tc.clearTimeout(e.B),e.B=null)}function id(e){e.g=new Sh(e,e.j,"rpc",e.Z),null===e.o&&(e.g.H=e.s),e.g.N=0;var t=Wh(e.sa);Jh(t,"RID","rpc"),Jh(t,"SID",e.I),Jh(t,"CI",e.L?"0":"1"),Jh(t,"AID",e.T),Jh(t,"TYPE","xmlhttp"),$f(e,t),e.o&&e.s&&zf(t,e.o,e.s),e.J&&e.g.setTimeout(e.J);var n=e.g;e=e.ka,n.K=1,n.v=Xh(Wh(t)),n.s=null,n.P=!0,Oh(n,e)}function ad(e){null!=e.v&&(Tc.clearTimeout(e.v),e.v=null)}function od(e,t){var n=null;if(e.g==t){ad(e),rd(e),e.g=null;var r=2}else{if(!gf(e.h,t))return;n=t.D,wf(e.h,t),r=1}if(0!=e.G)if(e.pa=t.Y,t.i)if(1==r){n=t.s?t.s.length:0,t=Date.now()-t.F;var i=e.C;Vl(r=lh(),new ph(r,n,t,i)),Xf(e)}else td(e);else if(3==(i=t.o)||0==i&&0<e.pa||!(1==r&&function(e,t){return!(mf(e.h)>=e.h.j-(e.m?1:0)||(e.m?(e.i=t.D.concat(e.i),0):1==e.G||2==e.G||e.C>=(e.Ya?0:e.Za)||(e.m=yh(Oc(e.Ja,e,t),ud(e,e.C)),e.C++,0)))}(e,t)||2==r&&nd(e)))switch(n&&0<n.length&&(t=e.h,t.i=t.i.concat(n)),i){case 1:sd(e,5);break;case 4:sd(e,10);break;case 3:sd(e,6);break;default:sd(e,2)}}function ud(e,t){var n=e.Wa+Math.floor(Math.random()*e.ab);return e.l||(n*=2),n*t}function sd(e,t){if(e.j.info("Error code "+t),2==t){var n=null;e.l&&(n=null);var r=Oc(e.jb,e);n||(n=new zh("//www.google.com/images/cleardot.gif"),Tc.location&&"http"==Tc.location.protocol||Hh(n,"https"),Xh(n)),function(e,t){var n=new oh;if(Tc.Image){var r=new Image;r.onload=Pc(Tf,n,r,"TestLoadImage: loaded",!0,t),r.onerror=Pc(Tf,n,r,"TestLoadImage: error",!1,t),r.onabort=Pc(Tf,n,r,"TestLoadImage: abort",!1,t),r.ontimeout=Pc(Tf,n,r,"TestLoadImage: timeout",!1,t),Tc.setTimeout((function(){r.ontimeout&&r.ontimeout()}),1e4),r.src=e}else t(!1)}(n.toString(),r)}else vh(2);e.G=0,e.l&&e.l.va(t),cd(e),Jf(e)}function cd(e){if(e.G=0,e.la=[],e.l){var t=bf(e.h);0==t.length&&0==e.i.length||(Bc(e.la,t),Bc(e.la,e.i),e.h.i.length=0,Uc(e.i),e.i.length=0),e.l.ua()}}function ld(e,t,n){var r=n instanceof zh?Wh(n):new zh(n,void 0);if(""!=r.g)t&&(r.g=t+"."+r.g),Qh(r,r.m);else{var i=Tc.location;r=i.protocol,t=t?t+"."+i.hostname:i.hostname,i=+i.port;var a=new zh(null,void 0);r&&Hh(a,r),t&&(a.g=t),i&&Qh(a,i),n&&(a.l=n),r=a}return n=e.D,t=e.za,n&&t&&Jh(r,n,t),Jh(r,"VER",e.ma),$f(e,r),r}function hd(e,t,n){if(t&&!e.H)throw Error("Can't create secondary domain capable XhrIo object.");return(t=n&&e.Da&&!e.ra?new Of(new Ef({ib:!0})):new Of(e.ra)).L=e.H,t}function fd(){}function dd(){if(Zc&&!(10<=Number(hl)))throw Error("Environmental error: no available transport.")}function vd(e,t){Fl.call(this),this.g=new Hf(t),this.l=e,this.h=t&&t.messageUrlParams||null,e=t&&t.messageHeaders||null,t&&t.clientProtocolHeaderRequired&&(e?e["X-Client-Protocol"]="webchannel":e={"X-Client-Protocol":"webchannel"}),this.g.s=e,e=t&&t.initMessageHeaders||null,t&&t.messageContentType&&(e?e["X-WebChannel-Content-Type"]=t.messageContentType:e={"X-WebChannel-Content-Type":t.messageContentType}),t&&t.ya&&(e?e["X-WebChannel-Client-Profile"]=t.ya:e={"X-WebChannel-Client-Profile":t.ya}),this.g.S=e,(e=t&&t.Xb)&&!Gc(e)&&(this.g.o=e),this.A=t&&t.supportsCrossDomainXhr||!1,this.v=t&&t.sendRawJson||!1,(t=t&&t.httpSessionIdParam)&&!Gc(t)&&(this.g.D=t,null!==(e=this.h)&&t in e&&(t in(e=this.h)&&delete e[t])),this.j=new md(this)}function pd(e){_h.call(this);var t=e.__sm__;if(t){e:{for(var n in t){e=n;break e}e=void 0}(this.i=e)&&(e=this.i,t=null!==t&&e in t?t[e]:void 0),this.data=t}else this.data=e}function yd(){Th.call(this),this.status=1}function md(e){this.g=e}(gc=Of.prototype).da=function(t,n,r,i){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.H+"; newUri="+t);n=n?n.toUpperCase():"GET",this.H=t,this.j="",this.m=0,this.D=!1,this.h=!0,this.g=this.u?this.u.g():xh.g(),this.C=this.u?wh(this.u):wh(xh),this.g.onreadystatechange=Oc(this.Ha,this);try{this.F=!0,this.g.open(n,String(t),!0),this.F=!1}catch(e){return void Ff(this,e)}if(t=r||"",r=new Map(this.headers),i){var a=!0,o=!1,u=void 0;if(Object.getPrototypeOf(i)===Object.prototype)for(var s in i)r.set(s,i[s]);else{if("function"!=typeof i.keys||"function"!=typeof i.get)throw Error("Unknown input type for opt_headers: "+String(i));try{for(var c,l=i.keys()[Symbol.iterator]();!(a=(c=l.next()).done);a=!0){var h=c.value;r.set(h,i.get(h))}}catch(e){o=!0,u=e}finally{try{a||null==l.return||l.return()}finally{if(o)throw u}}}}i=Array.from(r.keys()).find((function(e){return"content-type"==e.toLowerCase()})),s=Tc.FormData&&t instanceof Tc.FormData,!(0<=Vc(Mf,n))||i||s||r.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");var f=!0,d=!1,v=void 0;try{for(var p,m=r[Symbol.iterator]();!(f=(p=m.next()).done);f=!0){var g=e(y)(p.value,2),k=g[0],w=g[1];this.g.setRequestHeader(k,w)}}catch(e){d=!0,v=e}finally{try{f||null==m.return||m.return()}finally{if(d)throw v}}this.J&&(this.g.responseType=this.J),"withCredentials"in this.g&&this.g.withCredentials!==this.L&&(this.g.withCredentials=this.L);try{qf(this),0<this.B&&((this.K=function(e){return Zc&&cl()&&"number"==typeof e.timeout&&void 0!==e.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=Oc(this.qa,this)):this.A=$l(this.qa,this.B,this)),this.v=!0,this.g.send(t),this.v=!1}catch(e){Ff(this,e)}},gc.qa=function(){void 0!==_c&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,Vl(this,"timeout"),this.abort(8))},gc.abort=function(e){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=e||7,Vl(this,"complete"),Vl(this,"abort"),Bf(this))},gc.M=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),Bf(this,!0)),Of.X.M.call(this)},gc.Ha=function(){this.s||(this.F||this.v||this.l?Uf(this):this.eb())},gc.eb=function(){Uf(this)},gc.aa=function(){try{return 2<jf(this)?this.g.status:-1}catch(e){return-1}},gc.fa=function(){try{return this.g?this.g.responseText:""}catch(e){return""}},gc.Ra=function(e){if(this.g){var t=this.g.responseText;return e&&0==t.indexOf(e)&&(t=t.substring(e.length)),Rf(t)}},gc.Ea=function(){return this.m},gc.Na=function(){return"string"==typeof this.j?this.j:String(this.j)},(gc=Hf.prototype).ma=8,gc.G=1,gc.Ja=function(e){if(this.m)if(this.m=null,1==this.G){if(!e){this.U=Math.floor(1e5*Math.random()),e=this.U++;var t=new Sh(this,this.j,e,void 0),n=this.s;if(this.S&&(n?bl(n=kl(n),this.S):n=this.S),null!==this.o||this.N||(t.H=n,n=null),this.O)e:{for(var r=0,i=0;i<this.i.length;i++){var a=this.i[i];if(void 0===(a="__data__"in a.g&&"string"==typeof(a=a.g.__data__)?a.length:void 0))break;if(4096<(r+=a)){r=i;break e}if(4096===r||i===this.i.length-1){r=i+1;break e}}r=1e3}else r=1e3;r=ed(this,t,r),Jh(i=Wh(this.F),"RID",e),Jh(i,"CVER",22),this.D&&Jh(i,"X-HTTP-Session-Id",this.D),$f(this,i),n&&(this.N?r="headers="+encodeURIComponent(String(Kf(n)))+"&"+r:this.o&&zf(i,this.o,n)),kf(this.h,t),this.Xa&&Jh(i,"TYPE","init"),this.O?(Jh(i,"$req",r),Jh(i,"SID","null"),t.Z=!0,Rh(t,i,null)):Rh(t,i,r),this.G=2}}else 3==this.G&&(e?Zf(this,e):0==this.i.length||yf(this.h)||Zf(this))},gc.Ia=function(){if(this.u=null,id(this),this.$&&!(this.K||null==this.g||0>=this.P)){var e=2*this.P;this.j.info("BP detection timer enabled: "+e),this.B=yh(Oc(this.cb,this),e)}},gc.cb=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.L=!1,this.K=!0,vh(10),Yf(this),id(this))},gc.bb=function(){null!=this.v&&(this.v=null,Yf(this),nd(this),vh(19))},gc.jb=function(e){e?(this.j.info("Successfully pinged google.com"),vh(2)):(this.j.info("Failed to ping google.com"),vh(1))},(gc=fd.prototype).xa=function(){},gc.wa=function(){},gc.va=function(){},gc.ua=function(){},gc.Qa=function(){},dd.prototype.g=function(e,t){return new vd(e,t)},Lc(vd,Fl),vd.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.H=!0);var e=this.g,t=this.l,n=this.h||void 0;vh(0),e.V=t,e.ia=n||{},e.L=e.Y,e.F=ld(e,null,e.V),Xf(e)},vd.prototype.close=function(){Qf(this.g)},vd.prototype.u=function(e){var t=this.g;if("string"==typeof e){var n={};n.__data__=e,e=n}else this.v&&((n={}).__data__=Bl(e),e=n);t.i.push(new df(t.$a++,e)),3==t.G&&Xf(t)},vd.prototype.M=function(){this.g.l=null,delete this.j,Qf(this.g),delete this.g,vd.X.M.call(this)},Lc(pd,_h),Lc(yd,Th),Lc(md,fd),md.prototype.xa=function(){Vl(this.g,"a")},md.prototype.wa=function(e){Vl(this.g,new pd(e))},md.prototype.va=function(e){Vl(this.g,new yd(e))},md.prototype.ua=function(){Vl(this.g,"b")},dd.prototype.createWebChannel=dd.prototype.g,vd.prototype.send=vd.prototype.u,vd.prototype.open=vd.prototype.m,vd.prototype.close=vd.prototype.close,mh.NO_ERROR=0,mh.TIMEOUT=8,mh.HTTP_ERROR=6,gh.COMPLETE="complete",bh.EventType=Ih,Ih.OPEN="a",Ih.CLOSE="b",Ih.ERROR="c",Ih.MESSAGE="d",Fl.prototype.listen=Fl.prototype.N,Of.prototype.listenOnce=Of.prototype.O,Of.prototype.getLastError=Of.prototype.Na,Of.prototype.getLastErrorCode=Of.prototype.Ea,Of.prototype.getStatus=Of.prototype.aa,Of.prototype.getResponseJson=Of.prototype.Ra,Of.prototype.getResponseText=Of.prototype.fa,Of.prototype.send=Of.prototype.da;var gd,kd,wd,bd=Ic.createWebChannelTransport=function(){return new dd},xd=Ic.getStatEventTarget=function(){return lh()},Id=Ic.ErrorCode=mh,_d=Ic.EventType=gh,Td=Ic.Event=sh,Ed=Ic.Stat={rb:0,ub:1,vb:2,Ob:3,Tb:4,Qb:5,Rb:6,Pb:7,Nb:8,Sb:9,PROXY:10,NOPROXY:11,Lb:12,Hb:13,Ib:14,Gb:15,Jb:16,Kb:17,nb:18,mb:19,ob:20},Sd=Ic.FetchXmlHttpFactory=Ef,Ad=Ic.WebChannel=bh,Cd=Ic.XhrIo=Of,Nd=gd={};function Dd(){throw new Error("setTimeout has not been defined")}function Rd(){throw new Error("clearTimeout has not been defined")}function Od(e){if(kd===setTimeout)return setTimeout(e,0);if((kd===Dd||!kd)&&setTimeout)return kd=setTimeout,setTimeout(e,0);try{return kd(e,0)}catch(t){try{return kd.call(null,e,0)}catch(t){return kd.call(this,e,0)}}}!function(){try{kd="function"==typeof setTimeout?setTimeout:Dd}catch(e){kd=Dd}try{wd="function"==typeof clearTimeout?clearTimeout:Rd}catch(e){wd=Rd}}();var Pd,Ld=[],Md=!1,Fd=-1;function Vd(){Md&&Pd&&(Md=!1,Pd.length?Ld=Pd.concat(Ld):Fd=-1,Ld.length&&Ud())}function Ud(){if(!Md){var e=Od(Vd);Md=!0;for(var t=Ld.length;t;){for(Pd=Ld,Ld=[];++Fd<t;)Pd&&Pd[Fd].run();Fd=-1,t=Ld.length}Pd=null,Md=!1,function(e){if(wd===clearTimeout)return clearTimeout(e);if((wd===Rd||!wd)&&clearTimeout)return wd=clearTimeout,clearTimeout(e);try{wd(e)}catch(t){try{return wd.call(null,e)}catch(t){return wd.call(this,e)}}}(e)}}function Bd(e,t){this.fun=e,this.array=t}function qd(){}Nd.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];Ld.push(new Bd(e,t)),1!==Ld.length||Md||Od(Ud)},Bd.prototype.run=function(){this.fun.apply(null,this.array)},Nd.title="browser",Nd.browser=!0,Nd.env={},Nd.argv=[],Nd.version="",Nd.versions={},Nd.on=qd,Nd.addListener=qd,Nd.once=qd,Nd.off=qd,Nd.removeListener=qd,Nd.removeAllListeners=qd,Nd.emit=qd,Nd.prependListener=qd,Nd.prependOnceListener=qd,Nd.listeners=function(e){return[]},Nd.binding=function(e){throw new Error("process.binding is not supported")},Nd.cwd=function(){return"/"},Nd.chdir=function(e){throw new Error("process.chdir is not supported")},Nd.umask=function(){return 0};var jd="@firebase/firestore",Gd=function(){"use strict";function t(n){e(s)(this,t),this.uid=n}return e(c)(t,[{key:"isAuthenticated",value:function(){return null!=this.uid}},{key:"toKey",value:function(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}},{key:"isEqual",value:function(e){return e.uid===this.uid}}]),t}();
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Gd.UNAUTHENTICATED=new Gd(null),Gd.GOOGLE_CREDENTIALS=new Gd("google-credentials-uid"),Gd.FIRST_PARTY=new Gd("first-party-uid"),Gd.MOCK_USER=new Gd("mock-user");
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var Kd="9.10.0",zd=new De("@firebase/firestore");
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wd(){return zd.logLevel}function Hd(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];if(zd.logLevel<=Ie.DEBUG){var a,o=r.map(Jd);(a=zd).debug.apply(a,["Firestore (".concat(Kd,"): ").concat(t)].concat(e(x)(o)))}}function Qd(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];if(zd.logLevel<=Ie.ERROR){var a,o=r.map(Jd);(a=zd).error.apply(a,["Firestore (".concat(Kd,"): ").concat(t)].concat(e(x)(o)))}}function Yd(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];if(zd.logLevel<=Ie.WARN){var a,o=r.map(Jd);(a=zd).warn.apply(a,["Firestore (".concat(Kd,"): ").concat(t)].concat(e(x)(o)))}}function Jd(e){if("string"==typeof e)return e;try{return t=e,JSON.stringify(t)}catch(t){return e}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var t}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xd(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Unexpected state",t="FIRESTORE (".concat(Kd,") INTERNAL ASSERTION FAILED: ")+e;throw Qd(t),new Error(t)}function Zd(e,t){e||Xd()}function $d(e,t){return e}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ev={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},tv=function(t){"use strict";e(d)(r,t);var n=e(L)(r);function r(t,i){var a;return e(s)(this,r),(a=n.call(this,t,i)).code=t,a.message=i,a.toString=function(){return"".concat(a.name,": [code=").concat(a.code,"]: ").concat(a.message)},e(wc)(a)}return r}($),nv=function t(){"use strict";var n=this;e(s)(this,t),this.promise=new Promise((function(e,t){n.resolve=e,n.reject=t}))},rv=function t(n,r){"use strict";e(s)(this,t),this.user=r,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization","Bearer ".concat(n))},iv=function(){"use strict";function t(){e(s)(this,t)}return e(c)(t,[{key:"getToken",value:function(){return Promise.resolve(null)}},{key:"invalidateToken",value:function(){}},{key:"start",value:function(e,t){e.enqueueRetryable((function(){return t(Gd.UNAUTHENTICATED)}))}},{key:"shutdown",value:function(){}}]),t}(),av=function(){"use strict";function t(n){e(s)(this,t),this.token=n,this.changeListener=null}return e(c)(t,[{key:"getToken",value:function(){return Promise.resolve(this.token)}},{key:"invalidateToken",value:function(){}},{key:"start",value:function(e,t){var n=this;this.changeListener=t,e.enqueueRetryable((function(){return t(n.token.user)}))}},{key:"shutdown",value:function(){this.changeListener=null}}]),t}(),ov=function(){"use strict";function t(n){e(s)(this,t),this.t=n,this.currentUser=Gd.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}return e(c)(t,[{key:"start",value:function(t,n){var r=this,i=this.i,a=function(e){return r.i!==i?(i=r.i,n(e)):Promise.resolve()},o=new nv;this.o=function(){var e=r;r.i++,r.currentUser=r.u(),o.resolve(),o=new nv,t.enqueueRetryable((function(){return a(e.currentUser)}))};var u=function(){var n=o,i=r;t.enqueueRetryable(e(ve)(e(ye).mark((function t(){return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.promise;case 2:return e.next=4,a(i.currentUser);case 4:case"end":return e.stop()}}),t)}))))},s=function(e){Hd("FirebaseAuthCredentialsProvider","Auth detected"),r.auth=e,r.auth.addAuthTokenListener(r.o),u()};this.t.onInit((function(e){return s(e)})),setTimeout((function(){if(!r.auth){var e=r.t.getImmediate({optional:!0});e?s(e):(Hd("FirebaseAuthCredentialsProvider","Auth not yet detected"),o.resolve(),o=new nv)}}),0),u()}},{key:"getToken",value:function(){var e=this,t=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then((function(n){return e.i!==t?(Hd("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),e.getToken()):n?(Zd("string"==typeof n.accessToken),new rv(n.accessToken,e.currentUser)):null})):Promise.resolve(null)}},{key:"invalidateToken",value:function(){this.forceRefresh=!0}},{key:"shutdown",value:function(){this.auth&&this.auth.removeAuthTokenListener(this.o)}},{key:"u",value:function(){var e=this.auth&&this.auth.getUid();return Zd(null===e||"string"==typeof e),new Gd(e)}}]),t}(),uv=function(){"use strict";function t(n,r,i,a){e(s)(this,t),this.h=n,this.l=r,this.m=i,this.g=a,this.type="FirstParty",this.user=Gd.FIRST_PARTY,this.p=new Map}return e(c)(t,[{key:"I",value:function(){return this.g?this.g():(Zd(!("object"!=typeof this.h||null===this.h||!this.h.auth||!this.h.auth.getAuthHeaderValueForFirstParty)),this.h.auth.getAuthHeaderValueForFirstParty([]))}},{key:"headers",get:function(){this.p.set("X-Goog-AuthUser",this.l);var e=this.I();return e&&this.p.set("Authorization",e),this.m&&this.p.set("X-Goog-Iam-Authorization-Token",this.m),this.p}}]),t}(),sv=function(){"use strict";function t(n,r,i,a){e(s)(this,t),this.h=n,this.l=r,this.m=i,this.g=a}return e(c)(t,[{key:"getToken",value:function(){return Promise.resolve(new uv(this.h,this.l,this.m,this.g))}},{key:"start",value:function(e,t){e.enqueueRetryable((function(){return t(Gd.FIRST_PARTY)}))}},{key:"shutdown",value:function(){}},{key:"invalidateToken",value:function(){}}]),t}(),cv=function t(n){"use strict";e(s)(this,t),this.value=n,this.type="AppCheck",this.headers=new Map,n&&n.length>0&&this.headers.set("x-firebase-appcheck",this.value)},lv=function(){"use strict";function t(n){e(s)(this,t),this.T=n,this.forceRefresh=!1,this.appCheck=null,this.A=null}return e(c)(t,[{key:"start",value:function(e,t){var n=this;this.o=function(r){e.enqueueRetryable((function(){return function(e){null!=e.error&&Hd("FirebaseAppCheckTokenProvider","Error getting App Check token; using placeholder token instead. Error: ".concat(e.error.message));var r=e.token!==n.A;return n.A=e.token,Hd("FirebaseAppCheckTokenProvider","Received ".concat(r?"new":"existing"," token.")),r?t(e.token):Promise.resolve()}(r)}))};var r=function(e){Hd("FirebaseAppCheckTokenProvider","AppCheck detected"),n.appCheck=e,n.appCheck.addTokenListener(n.o)};this.T.onInit((function(e){return r(e)})),setTimeout((function(){if(!n.appCheck){var e=n.T.getImmediate({optional:!0});e?r(e):Hd("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}},{key:"getToken",value:function(){var e=this,t=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(t).then((function(t){return t?(Zd("string"==typeof t.token),e.A=t.token,new cv(t.token)):null})):Promise.resolve(null)}},{key:"invalidateToken",value:function(){this.forceRefresh=!0}},{key:"shutdown",value:function(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}]),t}();
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function hv(e){var t="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(e);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(n);else for(var r=0;r<e;r++)n[r]=Math.floor(256*Math.random());return n}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var fv=function(){"use strict";function t(){e(s)(this,t)}return e(c)(t,null,[{key:"R",value:function(){for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length,n="";n.length<20;)for(var r=hv(40),i=0;i<r.length;++i)n.length<20&&r[i]<t&&(n+=e.charAt(r[i]%e.length));return n}}]),t}();function dv(e,t){return e<t?-1:e>t?1:0}function vv(e,t,n){return e.length===t.length&&e.every((function(e,r){return n(e,t[r])}))}function pv(e){return e+"\0"}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var yv=function(){"use strict";function t(n,r){if(e(s)(this,t),this.seconds=n,this.nanoseconds=r,r<0)throw new tv(ev.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(r>=1e9)throw new tv(ev.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(n<-62135596800)throw new tv(ev.INVALID_ARGUMENT,"Timestamp seconds out of range: "+n);if(n>=253402300800)throw new tv(ev.INVALID_ARGUMENT,"Timestamp seconds out of range: "+n)}return e(c)(t,[{key:"toDate",value:function(){return new Date(this.toMillis())}},{key:"toMillis",value:function(){return 1e3*this.seconds+this.nanoseconds/1e6}},{key:"_compareTo",value:function(e){return this.seconds===e.seconds?dv(this.nanoseconds,e.nanoseconds):dv(this.seconds,e.seconds)}},{key:"isEqual",value:function(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}},{key:"toString",value:function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}},{key:"toJSON",value:function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}},{key:"valueOf",value:function(){var e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}],[{key:"now",value:function(){return t.fromMillis(Date.now())}},{key:"fromDate",value:function(e){return t.fromMillis(e.getTime())}},{key:"fromMillis",value:function(e){var n=Math.floor(e/1e3);return new t(n,Math.floor(1e6*(e-1e3*n)))}}]),t}(),mv=function(){"use strict";function t(n){e(s)(this,t),this.timestamp=n}return e(c)(t,[{key:"compareTo",value:function(e){return this.timestamp._compareTo(e.timestamp)}},{key:"isEqual",value:function(e){return this.timestamp.isEqual(e.timestamp)}},{key:"toMicroseconds",value:function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}},{key:"toString",value:function(){return"SnapshotVersion("+this.timestamp.toString()+")"}},{key:"toTimestamp",value:function(){return this.timestamp}}],[{key:"fromTimestamp",value:function(e){return new t(e)}},{key:"min",value:function(){return new t(new yv(0,0))}},{key:"max",value:function(){return new t(new yv(253402300799,999999999))}}]),t}(),gv=function(){"use strict";function t(n,r,i){e(s)(this,t),void 0===r?r=0:r>n.length&&Xd(),void 0===i?i=n.length-r:i>n.length-r&&Xd(),this.segments=n,this.offset=r,this.len=i}return e(c)(t,[{key:"length",get:function(){return this.len}},{key:"isEqual",value:function(e){return 0===t.comparator(this,e)}},{key:"child",value:function(e){var n=this.segments.slice(this.offset,this.limit());return e instanceof t?e.forEach((function(e){n.push(e)})):n.push(e),this.construct(n)}},{key:"limit",value:function(){return this.offset+this.length}},{key:"popFirst",value:function(e){return e=void 0===e?1:e,this.construct(this.segments,this.offset+e,this.length-e)}},{key:"popLast",value:function(){return this.construct(this.segments,this.offset,this.length-1)}},{key:"firstSegment",value:function(){return this.segments[this.offset]}},{key:"lastSegment",value:function(){return this.get(this.length-1)}},{key:"get",value:function(e){return this.segments[this.offset+e]}},{key:"isEmpty",value:function(){return 0===this.length}},{key:"isPrefixOf",value:function(e){if(e.length<this.length)return!1;for(var t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}},{key:"isImmediateParentOf",value:function(e){if(this.length+1!==e.length)return!1;for(var t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}},{key:"forEach",value:function(e){for(var t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}},{key:"toArray",value:function(){return this.segments.slice(this.offset,this.limit())}}],[{key:"comparator",value:function(e,t){for(var n=Math.min(e.length,t.length),r=0;r<n;r++){var i=e.get(r),a=t.get(r);if(i<a)return-1;if(i>a)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}]),t}(),kv=function(t){"use strict";e(d)(r,t);var n=e(L)(r);function r(){return e(s)(this,r),n.apply(this,arguments)}return e(c)(r,[{key:"construct",value:function(e,t,n){return new r(e,t,n)}},{key:"canonicalString",value:function(){return this.toArray().join("/")}},{key:"toString",value:function(){return this.canonicalString()}}],[{key:"fromString",value:function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];var a=[],o=!0,u=!1,s=void 0;try{for(var c,l=n[Symbol.iterator]();!(o=(c=l.next()).done);o=!0){var h,f=c.value;if(f.indexOf("//")>=0)throw new tv(ev.INVALID_ARGUMENT,"Invalid segment (".concat(f,"). Paths must not contain // in them."));(h=a).push.apply(h,e(x)(f.split("/").filter((function(e){return e.length>0}))))}}catch(e){u=!0,s=e}finally{try{o||null==l.return||l.return()}finally{if(u)throw s}}return new r(a)}},{key:"emptyPath",value:function(){return new r([])}}]),r}(gv),wv=/^[_a-zA-Z][_a-zA-Z0-9]*$/,bv=function(t){"use strict";e(d)(r,t);var n=e(L)(r);function r(){return e(s)(this,r),n.apply(this,arguments)}return e(c)(r,[{key:"construct",value:function(e,t,n){return new r(e,t,n)}},{key:"canonicalString",value:function(){return this.toArray().map((function(e){return e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),r.isValidIdentifier(e)||(e="`"+e+"`"),e})).join(".")}},{key:"toString",value:function(){return this.canonicalString()}},{key:"isKeyField",value:function(){return 1===this.length&&"__name__"===this.get(0)}}],[{key:"isValidIdentifier",value:function(e){return wv.test(e)}},{key:"keyField",value:function(){return new r(["__name__"])}},{key:"fromServerFormat",value:function(e){for(var t=[],n="",i=0,a=function(){if(0===n.length)throw new tv(ev.INVALID_ARGUMENT,"Invalid field path (".concat(e,"). Paths must not be empty, begin with '.', end with '.', or contain '..'"));t.push(n),n=""},o=!1;i<e.length;){var u=e[i];if("\\"===u){if(i+1===e.length)throw new tv(ev.INVALID_ARGUMENT,"Path has trailing escape character: "+e);var s=e[i+1];if("\\"!==s&&"."!==s&&"`"!==s)throw new tv(ev.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=s,i+=2}else"`"===u?(o=!o,i++):"."!==u||o?(n+=u,i++):(a(),i++)}if(a(),o)throw new tv(ev.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new r(t)}},{key:"emptyPath",value:function(){return new r([])}}]),r}(gv),xv=function(){"use strict";function t(n){e(s)(this,t),this.path=n}return e(c)(t,[{key:"collectionGroup",get:function(){return this.path.popLast().lastSegment()}},{key:"hasCollectionId",value:function(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}},{key:"getCollectionGroup",value:function(){return this.path.get(this.path.length-2)}},{key:"getCollectionPath",value:function(){return this.path.popLast()}},{key:"isEqual",value:function(e){return null!==e&&0===kv.comparator(this.path,e.path)}},{key:"toString",value:function(){return this.path.toString()}}],[{key:"fromPath",value:function(e){return new t(kv.fromString(e))}},{key:"fromName",value:function(e){return new t(kv.fromString(e).popFirst(5))}},{key:"empty",value:function(){return new t(kv.emptyPath())}},{key:"comparator",value:function(e,t){return kv.comparator(e.path,t.path)}},{key:"isDocumentKey",value:function(e){return e.length%2==0}},{key:"fromSegments",value:function(e){return new t(new kv(e.slice()))}}]),t}(),Iv=function t(n,r,i,a){"use strict";e(s)(this,t),this.indexId=n,this.collectionGroup=r,this.fields=i,this.indexState=a};
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _v(e){return e.fields.find((function(e){return 2===e.kind}))}function Tv(e){return e.fields.filter((function(e){return 2!==e.kind}))}Iv.UNKNOWN_ID=-1;var Ev=function t(n,r){"use strict";e(s)(this,t),this.fieldPath=n,this.kind=r};var Sv=function(){"use strict";function t(n,r){e(s)(this,t),this.sequenceNumber=n,this.offset=r}return e(c)(t,null,[{key:"empty",value:function(){return new t(0,Nv.min())}}]),t}();function Av(e,t){var n=e.toTimestamp().seconds,r=e.toTimestamp().nanoseconds+1,i=mv.fromTimestamp(1e9===r?new yv(n+1,0):new yv(n,r));return new Nv(i,xv.empty(),t)}function Cv(e){return new Nv(e.readTime,e.key,-1)}var Nv=function(){"use strict";function t(n,r,i){e(s)(this,t),this.readTime=n,this.documentKey=r,this.largestBatchId=i}return e(c)(t,null,[{key:"min",value:function(){return new t(mv.min(),xv.empty(),-1)}},{key:"max",value:function(){return new t(mv.max(),xv.empty(),-1)}}]),t}();function Dv(e,t){var n=e.readTime.compareTo(t.readTime);return 0!==n?n:0!==(n=xv.comparator(e.documentKey,t.documentKey))?n:dv(e.largestBatchId,t.largestBatchId)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Rv="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",Ov=function(){"use strict";function t(){e(s)(this,t),this.onCommittedListeners=[]}return e(c)(t,[{key:"addOnCommittedListener",value:function(e){this.onCommittedListeners.push(e)}},{key:"raiseOnCommittedEvent",value:function(){this.onCommittedListeners.forEach((function(e){return e()}))}}]),t}();function Pv(e){return Lv.apply(this,arguments)}function Lv(){return(Lv=
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
e(ve)(e(ye).mark((function t(n){return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.code===ev.FAILED_PRECONDITION&&n.message===Rv){e.next=2;break}throw n;case 2:Hd("LocalStore","Unexpectedly lost primary lease");case 3:case"end":return e.stop()}}),t)})))).apply(this,arguments)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Mv=function(){"use strict";function t(n){var r=this;e(s)(this,t),this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,n((function(e){r.isDone=!0,r.result=e,r.nextCallback&&r.nextCallback(e)}),(function(e){r.isDone=!0,r.error=e,r.catchCallback&&r.catchCallback(e)}))}return e(c)(t,[{key:"catch",value:function(e){return this.next(void 0,e)}},{key:"next",value:function(e,n){var r=this;return this.callbackAttached&&Xd(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new t((function(t,i){var a=r;r.nextCallback=function(n){a.wrapSuccess(e,n).next(t,i)},r.catchCallback=function(e){a.wrapFailure(n,e).next(t,i)}}))}},{key:"toPromise",value:function(){var e=this;return new Promise((function(t,n){e.next(t,n)}))}},{key:"wrapUserFunction",value:function(e){try{var n=e();return n instanceof t?n:t.resolve(n)}catch(e){return t.reject(e)}}},{key:"wrapSuccess",value:function(e,n){return e?this.wrapUserFunction((function(){return e(n)})):t.resolve(n)}},{key:"wrapFailure",value:function(e,n){return e?this.wrapUserFunction((function(){return e(n)})):t.reject(n)}}],[{key:"resolve",value:function(e){return new t((function(t,n){t(e)}))}},{key:"reject",value:function(e){return new t((function(t,n){n(e)}))}},{key:"waitFor",value:function(e){return new t((function(t,n){var r=0,i=0,a=!1;e.forEach((function(e){++r,e.next((function(){++i,a&&i===r&&t()}),(function(e){return n(e)}))})),a=!0,i===r&&t()}))}},{key:"or",value:function(e){var n=t.resolve(!1),r=!0,i=!1,a=void 0;try{for(var o,u=function(e,r){var i=r.value;n=n.next((function(e){return e?t.resolve(e):i()}))},s=e[Symbol.iterator]();!(r=(o=s.next()).done);r=!0)u(0,o)}catch(e){i=!0,a=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw a}}return n}},{key:"forEach",value:function(e,t){var n=this,r=[];return e.forEach((function(e,i){r.push(t.call(n,e,i))})),this.waitFor(r)}},{key:"mapArray",value:function(e,n){return new t((function(t,r){for(var i=function(i){var s=i;n(e[s]).next((function(e){o[s]=e,++u===a&&t(o)}),(function(e){return r(e)}))},a=e.length,o=new Array(a),u=0,s=0;s<a;s++)i(s)}))}},{key:"doWhile",value:function(e,n){return new t((function(t,r){var i=function(){!0===e()?n().next((function(){i()}),r):t()};i()}))}}]),t}(),Fv=function(){"use strict";function t(n,r){var i=this;e(s)(this,t),this.action=n,this.transaction=r,this.aborted=!1,this.P=new nv,this.transaction.oncomplete=function(){i.P.resolve()},this.transaction.onabort=function(){r.error?i.P.reject(new Bv(n,r.error)):i.P.resolve()},this.transaction.onerror=function(e){var t=zv(e.target.error);i.P.reject(new Bv(n,t))}}return e(c)(t,[{key:"v",get:function(){return this.P.promise}},{key:"abort",value:function(e){e&&this.P.reject(e),this.aborted||(Hd("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}},{key:"V",value:function(){var e=this.transaction;this.aborted||"function"!=typeof e.commit||e.commit()}},{key:"store",value:function(e){var t=this.transaction.objectStore(e);return new jv(t)}}],[{key:"open",value:function(e,n,r,i){try{return new t(n,e.transaction(i,r))}catch(e){throw new Bv(n,e)}}}]),t}(),Vv=function(){"use strict";function t(n,r,i){e(s)(this,t),this.name=n,this.version=r,this.S=i,12.2===t.D(H())&&Qd("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}return e(c)(t,[{key:"F",value:function(t){var n=this;return e(ve)(e(ye).mark((function r(){return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=n.db,e.t0){e.next=6;break}return Hd("SimpleDb","Opening database:",n.name),e.next=5,new Promise((function(e,r){var i=indexedDB.open(n.name,n.version);i.onsuccess=function(t){var n=t.target.result;e(n)},i.onblocked=function(){r(new Bv(t,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=function(e){var n=e.target.error;"VersionError"===n.name?r(new tv(ev.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):"InvalidStateError"===n.name?r(new tv(ev.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+n)):r(new Bv(t,n))},i.onupgradeneeded=function(e){Hd("SimpleDb",'Database "'+n.name+'" requires upgrade from version:',e.oldVersion);var t=e.target.result;n.S.$(t,i.transaction,e.oldVersion,n.version).next((function(){Hd("SimpleDb","Database upgrade to version "+n.version+" complete")}))}}));case 5:n.db=e.sent;case 6:return n.B&&(n.db.onversionchange=function(e){return n.B(e)}),e.abrupt("return",(e.t0,n.db));case 8:case"end":return e.stop()}}),r)})))()}},{key:"L",value:function(e){this.B=e,this.db&&(this.db.onversionchange=function(t){return e(t)})}},{key:"runTransaction",value:function(t,n,r,i){var a=this;return e(ve)(e(ye).mark((function o(){var u,s,c,l,h,f;return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:u="readonly"===n,s=0;case 2:return++s,e.prev=3,e.next=6,a.F(t);case 6:return a.db=e.sent,c=Fv.open(a.db,t,u?"readonly":"readwrite",r),(l=i(c).next((function(e){return c.V(),e})).catch((function(e){return c.abort(e),Mv.reject(e)})).toPromise()).catch((function(){})),e.next=11,c.v;case 11:return e.abrupt("return",(e.sent,l));case 14:if(e.prev=14,e.t0=e.catch(3),h=e.t0,f="FirebaseError"!==h.name&&s<3,Hd("SimpleDb","Transaction failed with error:",h.message,"Retrying:",f),a.close(),f){e.next=19;break}return e.abrupt("return",Promise.reject(h));case 19:e.next=2;break;case 21:case"end":return e.stop()}}),o,null,[[3,14]])})))()}},{key:"close",value:function(){this.db&&this.db.close(),this.db=void 0}}],[{key:"delete",value:function(e){return Hd("SimpleDb","Removing database:",e),Gv(window.indexedDB.deleteDatabase(e)).toPromise()}},{key:"C",value:function(){if(!Z())return!1;if(t.N())return!0;var e=H(),n=t.D(e),r=0<n&&n<10,i=t.k(e),a=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||a)}},{key:"N",value:function(){var e;return void 0!==gd&&"YES"===(void 0===(e={})?void 0:e.M)}},{key:"O",value:function(e,t){return e.store(t)}},{key:"D",value:function(e){var t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(n)}},{key:"k",value:function(e){var t=e.match(/Android ([\d.]+)/i),n=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(n)}}]),t}(),Uv=function(){"use strict";function t(n){e(s)(this,t),this.U=n,this.q=!1,this.K=null}return e(c)(t,[{key:"isDone",get:function(){return this.q}},{key:"G",get:function(){return this.K}},{key:"cursor",set:function(e){this.U=e}},{key:"done",value:function(){this.q=!0}},{key:"j",value:function(e){this.K=e}},{key:"delete",value:function(){return Gv(this.U.delete())}}]),t}(),Bv=function(t){"use strict";e(d)(r,t);var n=e(L)(r);function r(t,i){var a;return e(s)(this,r),(a=n.call(this,ev.UNAVAILABLE,"IndexedDB transaction '".concat(t,"' failed: ").concat(i))).name="IndexedDbTransactionError",e(wc)(a)}return r}(tv);
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qv(e){return"IndexedDbTransactionError"===e.name}var jv=function(){"use strict";function t(n){e(s)(this,t),this.store=n}return e(c)(t,[{key:"put",value:function(e,t){var n;return void 0!==t?(Hd("SimpleDb","PUT",this.store.name,e,t),n=this.store.put(t,e)):(Hd("SimpleDb","PUT",this.store.name,"<auto-key>",e),n=this.store.put(e)),Gv(n)}},{key:"add",value:function(e){return Hd("SimpleDb","ADD",this.store.name,e,e),Gv(this.store.add(e))}},{key:"get",value:function(e){var t=this;return Gv(this.store.get(e)).next((function(n){return void 0===n&&(n=null),Hd("SimpleDb","GET",t.store.name,e,n),n}))}},{key:"delete",value:function(e){return Hd("SimpleDb","DELETE",this.store.name,e),Gv(this.store.delete(e))}},{key:"count",value:function(){return Hd("SimpleDb","COUNT",this.store.name),Gv(this.store.count())}},{key:"W",value:function(e,t){var n=this.options(e,t);if(n.index||"function"!=typeof this.store.getAll){var r=this.cursor(n),i=[];return this.H(r,(function(e,t){i.push(t)})).next((function(){return i}))}var a=this.store.getAll(n.range);return new Mv((function(e,t){a.onerror=function(e){t(e.target.error)},a.onsuccess=function(t){e(t.target.result)}}))}},{key:"J",value:function(e,t){var n=this.store.getAll(e,null===t?void 0:t);return new Mv((function(e,t){n.onerror=function(e){t(e.target.error)},n.onsuccess=function(t){e(t.target.result)}}))}},{key:"Y",value:function(e,t){Hd("SimpleDb","DELETE ALL",this.store.name);var n=this.options(e,t);n.X=!1;var r=this.cursor(n);return this.H(r,(function(e,t,n){return n.delete()}))}},{key:"Z",value:function(e,t){var n;t?n=e:(n={},t=e);var r=this.cursor(n);return this.H(r,t)}},{key:"tt",value:function(e){var t=this.cursor({});return new Mv((function(n,r){t.onerror=function(e){var t=zv(e.target.error);r(t)},t.onsuccess=function(t){var r=t.target.result;r?e(r.primaryKey,r.value).next((function(e){e?r.continue():n()})):n()}}))}},{key:"H",value:function(e,t){var n=[];return new Mv((function(r,i){e.onerror=function(e){i(e.target.error)},e.onsuccess=function(e){var i=e.target.result;if(i){var a=new Uv(i),o=t(i.primaryKey,i.value,a);if(o instanceof Mv){var u=o.catch((function(e){return a.done(),Mv.reject(e)}));n.push(u)}a.isDone?r():null===a.G?i.continue():i.continue(a.G)}else r()}})).next((function(){return Mv.waitFor(n)}))}},{key:"options",value:function(e,t){var n;return void 0!==e&&("string"==typeof e?n=e:t=e),{index:n,range:t}}},{key:"cursor",value:function(e){var t="next";if(e.reverse&&(t="prev"),e.index){var n=this.store.index(e.index);return e.X?n.openKeyCursor(e.range,t):n.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}]),t}();function Gv(e){return new Mv((function(t,n){e.onsuccess=function(e){var n=e.target.result;t(n)},e.onerror=function(e){var t=zv(e.target.error);n(t)}}))}var Kv=!1;function zv(e){var t=Vv.D(H());if(t>=12.2&&t<13){var n="An internal error was encountered in the Indexed Database server";if(e.message.indexOf(n)>=0){var r=new tv("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '".concat(n,"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround."));return Kv||(Kv=!0,setTimeout((function(){throw r}),0)),r}}return e}var Wv=function(){"use strict";function t(n,r){e(s)(this,t),this.asyncQueue=n,this.et=r,this.task=null}return e(c)(t,[{key:"start",value:function(){this.nt(15e3)}},{key:"stop",value:function(){this.task&&(this.task.cancel(),this.task=null)}},{key:"started",get:function(){return null!==this.task}},{key:"nt",value:function(t){var n=this;Hd("IndexBackiller","Scheduled in ".concat(t,"ms")),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",t,e(ve)(e(ye).mark((function t(){return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.task=null,e.prev=1,e.t0=Hd,e.t1="Documents written: ",e.next=6,n.et.st();case 6:e.t2=e.sent,e.t3=e.t1.concat.call(e.t1,e.t2),(0,e.t0)("IndexBackiller",e.t3),e.next=19;break;case 11:if(e.prev=11,e.t4=e.catch(1),!qv(e.t4)){e.next=17;break}Hd("IndexBackiller","Ignoring IndexedDB error during index backfill: ",e.t4),e.next=19;break;case 17:return e.next=19,Pv(e.t4);case 19:return e.next=21,n.nt(6e4);case 21:case"end":return e.stop()}}),t,null,[[1,11]])}))))}}]),t}(),Hv=function(){"use strict";function t(n,r){e(s)(this,t),this.localStore=n,this.persistence=r}return e(c)(t,[{key:"st",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:50,n=this;return e(ve)(e(ye).mark((function r(){return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",n.persistence.runTransaction("Backfill Indexes","readwrite-primary",(function(e){return n.it(e,t)})));case 1:case"end":return e.stop()}}),r)})))()}},{key:"it",value:function(e,t){var n=this,r=new Set,i=t,a=!0;return Mv.doWhile((function(){return!0===a&&i>0}),(function(){return n.localStore.indexManager.getNextCollectionGroupToUpdate(e).next((function(t){if(null!==t&&!r.has(t))return Hd("IndexBackiller","Processing collection: ".concat(t)),n.rt(e,t,i).next((function(e){i-=e,r.add(t)}));a=!1}))})).next((function(){return t-i}))}},{key:"rt",value:function(e,t,n){var r=this;return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next((function(i){return r.localStore.localDocuments.getNextDocuments(e,t,i,n).next((function(n){var a=r,o=n.changes;return r.localStore.indexManager.updateIndexEntries(e,o).next((function(){return a.ot(i,n)})).next((function(n){return Hd("IndexBackiller","Updating offset: ".concat(n)),a.localStore.indexManager.updateCollectionGroup(e,t,n)})).next((function(){return o.size}))}))}))}},{key:"ot",value:function(e,t){var n=e;return t.changes.forEach((function(e,t){var r=Cv(t);Dv(r,n)>0&&(n=r)})),new Nv(n.readTime,n.documentKey,Math.max(t.batchId,e.largestBatchId))}}]),t}(),Qv=function(){"use strict";function t(n,r){var i=this;e(s)(this,t),this.previousValue=n,r&&(r.sequenceNumberHandler=function(e){return i.ut(e)},this.ct=function(e){return r.writeSequenceNumber(e)})}return e(c)(t,[{key:"ut",value:function(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}},{key:"next",value:function(){var e=++this.previousValue;return this.ct&&this.ct(e),e}}]),t}();
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function Yv(e){var t=0;for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t++;return t}function Jv(e,t){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n])}function Xv(e){for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Qv.at=-1;var Zv=function(){"use strict";function t(n,r){e(s)(this,t),this.comparator=n,this.root=r||ep.EMPTY}return e(c)(t,[{key:"insert",value:function(e,n){return new t(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,ep.BLACK,null,null))}},{key:"remove",value:function(e){return new t(this.comparator,this.root.remove(e,this.comparator).copy(null,null,ep.BLACK,null,null))}},{key:"get",value:function(e){for(var t=this.root;!t.isEmpty();){var n=this.comparator(e,t.key);if(0===n)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}},{key:"indexOf",value:function(e){for(var t=0,n=this.root;!n.isEmpty();){var r=this.comparator(e,n.key);if(0===r)return t+n.left.size;r<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}},{key:"isEmpty",value:function(){return this.root.isEmpty()}},{key:"size",get:function(){return this.root.size}},{key:"minKey",value:function(){return this.root.minKey()}},{key:"maxKey",value:function(){return this.root.maxKey()}},{key:"inorderTraversal",value:function(e){return this.root.inorderTraversal(e)}},{key:"forEach",value:function(e){this.inorderTraversal((function(t,n){return e(t,n),!1}))}},{key:"toString",value:function(){var e=[];return this.inorderTraversal((function(t,n){return e.push("".concat(t,":").concat(n)),!1})),"{".concat(e.join(", "),"}")}},{key:"reverseTraversal",value:function(e){return this.root.reverseTraversal(e)}},{key:"getIterator",value:function(){return new $v(this.root,null,this.comparator,!1)}},{key:"getIteratorFrom",value:function(e){return new $v(this.root,e,this.comparator,!1)}},{key:"getReverseIterator",value:function(){return new $v(this.root,null,this.comparator,!0)}},{key:"getReverseIteratorFrom",value:function(e){return new $v(this.root,e,this.comparator,!0)}}]),t}(),$v=function(){"use strict";function t(n,r,i,a){e(s)(this,t),this.isReverse=a,this.nodeStack=[];for(var o=1;!n.isEmpty();)if(o=r?i(n.key,r):1,r&&a&&(o*=-1),o<0)n=this.isReverse?n.left:n.right;else{if(0===o){this.nodeStack.push(n);break}this.nodeStack.push(n),n=this.isReverse?n.right:n.left}}return e(c)(t,[{key:"getNext",value:function(){var e=this.nodeStack.pop(),t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}},{key:"hasNext",value:function(){return this.nodeStack.length>0}},{key:"peek",value:function(){if(0===this.nodeStack.length)return null;var e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}]),t}(),ep=function(){"use strict";function t(n,r,i,a,o){e(s)(this,t),this.key=n,this.value=r,this.color=null!=i?i:t.RED,this.left=null!=a?a:t.EMPTY,this.right=null!=o?o:t.EMPTY,this.size=this.left.size+1+this.right.size}return e(c)(t,[{key:"copy",value:function(e,n,r,i,a){return new t(null!=e?e:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=a?a:this.right)}},{key:"isEmpty",value:function(){return!1}},{key:"inorderTraversal",value:function(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}},{key:"reverseTraversal",value:function(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}},{key:"min",value:function(){return this.left.isEmpty()?this:this.left.min()}},{key:"minKey",value:function(){return this.min().key}},{key:"maxKey",value:function(){return this.right.isEmpty()?this.key:this.right.maxKey()}},{key:"insert",value:function(e,t,n){var r=this,i=n(e,r.key);return(r=i<0?r.copy(null,null,null,r.left.insert(e,t,n),null):0===i?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n))).fixUp()}},{key:"removeMin",value:function(){if(this.left.isEmpty())return t.EMPTY;var e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),(e=e.copy(null,null,null,e.left.removeMin(),null)).fixUp()}},{key:"remove",value:function(e,n){var r,i=this;if(n(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),0===n(e,i.key)){if(i.right.isEmpty())return t.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.fixUp()}},{key:"isRed",value:function(){return this.color}},{key:"fixUp",value:function(){var e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}},{key:"moveRedLeft",value:function(){var e=this.colorFlip();return e.right.left.isRed()&&(e=(e=(e=e.copy(null,null,null,null,e.right.rotateRight())).rotateLeft()).colorFlip()),e}},{key:"moveRedRight",value:function(){var e=this.colorFlip();return e.left.left.isRed()&&(e=(e=e.rotateRight()).colorFlip()),e}},{key:"rotateLeft",value:function(){var e=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}},{key:"rotateRight",value:function(){var e=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}},{key:"colorFlip",value:function(){var e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}},{key:"checkMaxDepth",value:function(){var e=this.check();return Math.pow(2,e)<=this.size+1}},{key:"check",value:function(){if(this.isRed()&&this.left.isRed())throw Xd();if(this.right.isRed())throw Xd();var e=this.left.check();if(e!==this.right.check())throw Xd();return e+(this.isRed()?0:1)}}]),t}();ep.EMPTY=null,ep.RED=!0,ep.BLACK=!1,ep.EMPTY=new(function(){"use strict";function t(){e(s)(this,t),this.size=0}return e(c)(t,[{key:"key",get:function(){throw Xd()}},{key:"value",get:function(){throw Xd()}},{key:"color",get:function(){throw Xd()}},{key:"left",get:function(){throw Xd()}},{key:"right",get:function(){throw Xd()}},{key:"copy",value:function(e,t,n,r,i){return this}},{key:"insert",value:function(e,t,n){return new ep(e,t)}},{key:"remove",value:function(e,t){return this}},{key:"isEmpty",value:function(){return!0}},{key:"inorderTraversal",value:function(e){return!1}},{key:"reverseTraversal",value:function(e){return!1}},{key:"minKey",value:function(){return null}},{key:"maxKey",value:function(){return null}},{key:"isRed",value:function(){return!1}},{key:"checkMaxDepth",value:function(){return!0}},{key:"check",value:function(){return 0}}]),t}());
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var tp=function(){"use strict";function t(n){e(s)(this,t),this.comparator=n,this.data=new Zv(this.comparator)}return e(c)(t,[{key:"has",value:function(e){return null!==this.data.get(e)}},{key:"first",value:function(){return this.data.minKey()}},{key:"last",value:function(){return this.data.maxKey()}},{key:"size",get:function(){return this.data.size}},{key:"indexOf",value:function(e){return this.data.indexOf(e)}},{key:"forEach",value:function(e){this.data.inorderTraversal((function(t,n){return e(t),!1}))}},{key:"forEachInRange",value:function(e,t){for(var n=this.data.getIteratorFrom(e[0]);n.hasNext();){var r=n.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}},{key:"forEachWhile",value:function(e,t){var n;for(n=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}},{key:"firstAfterOrEqual",value:function(e){var t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}},{key:"getIterator",value:function(){return new np(this.data.getIterator())}},{key:"getIteratorFrom",value:function(e){return new np(this.data.getIteratorFrom(e))}},{key:"add",value:function(e){return this.copy(this.data.remove(e).insert(e,!0))}},{key:"delete",value:function(e){return this.has(e)?this.copy(this.data.remove(e)):this}},{key:"isEmpty",value:function(){return this.data.isEmpty()}},{key:"unionWith",value:function(e){var t=this;return t.size<e.size&&(t=e,e=this),e.forEach((function(e){t=t.add(e)})),t}},{key:"isEqual",value:function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.data.getIterator(),r=e.data.getIterator();n.hasNext();){var i=n.getNext().key,a=r.getNext().key;if(0!==this.comparator(i,a))return!1}return!0}},{key:"toArray",value:function(){var e=[];return this.forEach((function(t){e.push(t)})),e}},{key:"toString",value:function(){var e=[];return this.forEach((function(t){return e.push(t)})),"SortedSet("+e.toString()+")"}},{key:"copy",value:function(e){var n=new t(this.comparator);return n.data=e,n}}]),t}(),np=function(){"use strict";function t(n){e(s)(this,t),this.iter=n}return e(c)(t,[{key:"getNext",value:function(){return this.iter.getNext().key}},{key:"hasNext",value:function(){return this.iter.hasNext()}}]),t}();function rp(e){return e.hasNext()?e.getNext():void 0}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ip=function(){"use strict";function t(n){e(s)(this,t),this.fields=n,n.sort(bv.comparator)}return e(c)(t,[{key:"unionWith",value:function(e){var n=new tp(bv.comparator),r=!0,i=!1,a=void 0;try{for(var o,u=this.fields[Symbol.iterator]();!(r=(o=u.next()).done);r=!0){var s=o.value;n=n.add(s)}}catch(e){i=!0,a=e}finally{try{r||null==u.return||u.return()}finally{if(i)throw a}}var c=!0,l=!1,h=void 0;try{for(var f,d=e[Symbol.iterator]();!(c=(f=d.next()).done);c=!0){var v=f.value;n=n.add(v)}}catch(e){l=!0,h=e}finally{try{c||null==d.return||d.return()}finally{if(l)throw h}}return new t(n.toArray())}},{key:"covers",value:function(e){var t=!0,n=!1,r=void 0;try{for(var i,a=this.fields[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){if(i.value.isPrefixOf(e))return!0}}catch(e){n=!0,r=e}finally{try{t||null==a.return||a.return()}finally{if(n)throw r}}return!1}},{key:"isEqual",value:function(e){return vv(this.fields,e.fields,(function(e,t){return e.isEqual(t)}))}}],[{key:"empty",value:function(){return new t([])}}]),t}();
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ap=Symbol.iterator,op=function(){"use strict";function t(n){e(s)(this,t),this.binaryString=n}return e(c)(t,[{key:ap,value:function(){var e=this,t=0;return{next:function(){return t<e.binaryString.length?{value:e.binaryString.charCodeAt(t++),done:!1}:{value:void 0,done:!0}}}}},{key:"toBase64",value:function(){var e;return e=this.binaryString,btoa(e)}},{key:"toUint8Array",value:function(){return function(e){for(var t=new Uint8Array(e.length),n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}(this.binaryString)}},{key:"approximateByteSize",value:function(){return 2*this.binaryString.length}},{key:"compareTo",value:function(e){return dv(this.binaryString,e.binaryString)}},{key:"isEqual",value:function(e){return this.binaryString===e.binaryString}}],[{key:"fromBase64String",value:function(e){return new t(atob(e))}},{key:"fromUint8Array",value:function(e){return new t(function(e){for(var t="",n=0;n<e.length;++n)t+=String.fromCharCode(e[n]);return t}(e))}}]),t}();
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */op.EMPTY_BYTE_STRING=new op("");var up=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function sp(e){if(Zd(!!e),"string"==typeof e){var t=0,n=up.exec(e);if(Zd(!!n),n[1]){var r=n[1];r=(r+"000000000").substr(0,9),t=Number(r)}var i=new Date(e);return{seconds:Math.floor(i.getTime()/1e3),nanos:t}}return{seconds:cp(e.seconds),nanos:cp(e.nanos)}}function cp(e){return"number"==typeof e?e:"string"==typeof e?Number(e):0}function lp(e){return"string"==typeof e?op.fromBase64String(e):op.fromUint8Array(e)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hp(e){var t,n;return"server_timestamp"===(null===(n=((null===(t=null==e?void 0:e.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function fp(e){var t=e.mapValue.fields.__previous_value__;return hp(t)?fp(t):t}function dp(e){var t=sp(e.mapValue.fields.__local_write_time__.timestampValue);return new yv(t.seconds,t.nanos)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var vp=function t(n,r,i,a,o,u,c,l){"use strict";e(s)(this,t),this.databaseId=n,this.appId=r,this.persistenceKey=i,this.host=a,this.ssl=o,this.forceLongPolling=u,this.autoDetectLongPolling=c,this.useFetchStreams=l},pp=function(){"use strict";function t(n,r){e(s)(this,t),this.projectId=n,this.database=r||"(default)"}return e(c)(t,[{key:"isDefaultDatabase",get:function(){return"(default)"===this.database}},{key:"isEqual",value:function(e){return e instanceof t&&e.projectId===this.projectId&&e.database===this.database}}],[{key:"empty",value:function(){return new t("","")}}]),t}();function yp(e){return null==e}function mp(e){return 0===e&&1/e==-1/0}function gp(e){return"number"==typeof e&&Number.isInteger(e)&&!mp(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var kp={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},wp={nullValue:"NULL_VALUE"};function bp(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?hp(e)?4:Lp(e)?9007199254740991:10:Xd()}function xp(e,t){if(e===t)return!0;var n,r=bp(e);if(r!==bp(t))return!1;switch(r){case 0:case 9007199254740991:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return dp(e).isEqual(dp(t));case 3:return function(e,t){if("string"==typeof e.timestampValue&&"string"==typeof t.timestampValue&&e.timestampValue.length===t.timestampValue.length)return e.timestampValue===t.timestampValue;var n=sp(e.timestampValue),r=sp(t.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(e,t);case 5:return e.stringValue===t.stringValue;case 6:return n=t,lp(e.bytesValue).isEqual(lp(n.bytesValue));case 7:return e.referenceValue===t.referenceValue;case 8:return function(e,t){return cp(e.geoPointValue.latitude)===cp(t.geoPointValue.latitude)&&cp(e.geoPointValue.longitude)===cp(t.geoPointValue.longitude)}(e,t);case 2:return function(e,t){if("integerValue"in e&&"integerValue"in t)return cp(e.integerValue)===cp(t.integerValue);if("doubleValue"in e&&"doubleValue"in t){var n=cp(e.doubleValue),r=cp(t.doubleValue);return n===r?mp(n)===mp(r):isNaN(n)&&isNaN(r)}return!1}(e,t);case 9:return vv(e.arrayValue.values||[],t.arrayValue.values||[],xp);case 10:return function(e,t){var n=e.mapValue.fields||{},r=t.mapValue.fields||{};if(Yv(n)!==Yv(r))return!1;for(var i in n)if(n.hasOwnProperty(i)&&(void 0===r[i]||!xp(n[i],r[i])))return!1;return!0}(e,t);default:return Xd()}}function Ip(e,t){return void 0!==(e.values||[]).find((function(e){return xp(e,t)}))}function _p(e,t){if(e===t)return 0;var n,r,i,a,o=bp(e),u=bp(t);if(o!==u)return dv(o,u);switch(o){case 0:case 9007199254740991:return 0;case 1:return dv(e.booleanValue,t.booleanValue);case 2:return r=t,i=cp((n=e).integerValue||n.doubleValue),a=cp(r.integerValue||r.doubleValue),i<a?-1:i>a?1:i===a?0:isNaN(i)?isNaN(a)?0:-1:1;case 3:return Tp(e.timestampValue,t.timestampValue);case 4:return Tp(dp(e),dp(t));case 5:return dv(e.stringValue,t.stringValue);case 6:return function(e,t){var n=lp(e),r=lp(t);return n.compareTo(r)}(e.bytesValue,t.bytesValue);case 7:return function(e,t){for(var n=e.split("/"),r=t.split("/"),i=0;i<n.length&&i<r.length;i++){var a=dv(n[i],r[i]);if(0!==a)return a}return dv(n.length,r.length)}(e.referenceValue,t.referenceValue);case 8:return function(e,t){var n=dv(cp(e.latitude),cp(t.latitude));return 0!==n?n:dv(cp(e.longitude),cp(t.longitude))}(e.geoPointValue,t.geoPointValue);case 9:return function(e,t){for(var n=e.values||[],r=t.values||[],i=0;i<n.length&&i<r.length;++i){var a=_p(n[i],r[i]);if(a)return a}return dv(n.length,r.length)}(e.arrayValue,t.arrayValue);case 10:return function(e,t){if(e===kp.mapValue&&t===kp.mapValue)return 0;if(e===kp.mapValue)return 1;if(t===kp.mapValue)return-1;var n=e.fields||{},r=Object.keys(n),i=t.fields||{},a=Object.keys(i);r.sort(),a.sort();for(var o=0;o<r.length&&o<a.length;++o){var u=dv(r[o],a[o]);if(0!==u)return u;var s=_p(n[r[o]],i[a[o]]);if(0!==s)return s}return dv(r.length,a.length)}(e.mapValue,t.mapValue);default:throw Xd()}}function Tp(e,t){if("string"==typeof e&&"string"==typeof t&&e.length===t.length)return dv(e,t);var n=sp(e),r=sp(t),i=dv(n.seconds,r.seconds);return 0!==i?i:dv(n.nanos,r.nanos)}function Ep(e){return Sp(e)}function Sp(e){var t,n,r,i;return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?(r=e.timestampValue,i=sp(r),"time(".concat(i.seconds,",").concat(i.nanos,")")):"stringValue"in e?e.stringValue:"bytesValue"in e?lp(e.bytesValue).toBase64():"referenceValue"in e?(n=e.referenceValue,xv.fromName(n).toString()):"geoPointValue"in e?"geo(".concat((t=e.geoPointValue).latitude,",").concat(t.longitude,")"):"arrayValue"in e?function(e){var t="[",n=!0,r=!0,i=!1,a=void 0;try{for(var o,u=(e.values||[])[Symbol.iterator]();!(r=(o=u.next()).done);r=!0){var s=o.value;n?n=!1:t+=",",t+=Sp(s)}}catch(e){i=!0,a=e}finally{try{r||null==u.return||u.return()}finally{if(i)throw a}}return t+"]"}(e.arrayValue):"mapValue"in e?function(e){var t=Object.keys(e.fields||{}).sort(),n="{",r=!0,i=!0,a=!1,o=void 0;try{for(var u,s=t[Symbol.iterator]();!(i=(u=s.next()).done);i=!0){var c=u.value;r?r=!1:n+=",",n+="".concat(c,":").concat(Sp(e.fields[c]))}}catch(e){a=!0,o=e}finally{try{i||null==s.return||s.return()}finally{if(a)throw o}}return n+"}"}(e.mapValue):Xd()}function Ap(e,t){return{referenceValue:"projects/".concat(e.projectId,"/databases/").concat(e.database,"/documents/").concat(t.path.canonicalString())}}function Cp(e){return!!e&&"integerValue"in e}function Np(e){return!!e&&"arrayValue"in e}function Dp(e){return!!e&&"nullValue"in e}function Rp(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function Op(e){return!!e&&"mapValue"in e}function Pp(e){if(e.geoPointValue)return{geoPointValue:Object.assign({},e.geoPointValue)};if(e.timestampValue&&"object"==typeof e.timestampValue)return{timestampValue:Object.assign({},e.timestampValue)};if(e.mapValue){var t={mapValue:{fields:{}}};return Jv(e.mapValue.fields,(function(e,n){return t.mapValue.fields[e]=Pp(n)})),t}if(e.arrayValue){for(var n={arrayValue:{values:[]}},r=0;r<(e.arrayValue.values||[]).length;++r)n.arrayValue.values[r]=Pp(e.arrayValue.values[r]);return n}return Object.assign({},e)}function Lp(e){return"__max__"===(((e.mapValue||{}).fields||{}).__type__||{}).stringValue}function Mp(e){return"nullValue"in e?wp:"booleanValue"in e?{booleanValue:!1}:"integerValue"in e||"doubleValue"in e?{doubleValue:NaN}:"timestampValue"in e?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in e?{stringValue:""}:"bytesValue"in e?{bytesValue:""}:"referenceValue"in e?Ap(pp.empty(),xv.empty()):"geoPointValue"in e?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in e?{arrayValue:{}}:"mapValue"in e?{mapValue:{}}:Xd()}function Fp(e){return"nullValue"in e?{booleanValue:!1}:"booleanValue"in e?{doubleValue:NaN}:"integerValue"in e||"doubleValue"in e?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in e?{stringValue:""}:"stringValue"in e?{bytesValue:""}:"bytesValue"in e?Ap(pp.empty(),xv.empty()):"referenceValue"in e?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in e?{arrayValue:{}}:"arrayValue"in e?{mapValue:{}}:"mapValue"in e?kp:Xd()}function Vp(e,t){var n=_p(e.value,t.value);return 0!==n?n:e.inclusive&&!t.inclusive?-1:!e.inclusive&&t.inclusive?1:0}function Up(e,t){var n=_p(e.value,t.value);return 0!==n?n:e.inclusive&&!t.inclusive?1:!e.inclusive&&t.inclusive?-1:0}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Bp=function(){"use strict";function t(n){e(s)(this,t),this.value=n}return e(c)(t,[{key:"field",value:function(e){if(e.isEmpty())return this.value;for(var t=this.value,n=0;n<e.length-1;++n)if(!Op(t=(t.mapValue.fields||{})[e.get(n)]))return null;return(t=(t.mapValue.fields||{})[e.lastSegment()])||null}},{key:"set",value:function(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Pp(t)}},{key:"setAll",value:function(e){var t=this,n=bv.emptyPath(),r={},i=[];e.forEach((function(e,a){if(!n.isImmediateParentOf(a)){var o=t.getFieldsMap(n);t.applyChanges(o,r,i),r={},i=[],n=a.popLast()}e?r[a.lastSegment()]=Pp(e):i.push(a.lastSegment())}));var a=this.getFieldsMap(n);this.applyChanges(a,r,i)}},{key:"delete",value:function(e){var t=this.field(e.popLast());Op(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}},{key:"isEqual",value:function(e){return xp(this.value,e.value)}},{key:"getFieldsMap",value:function(e){var t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(var n=0;n<e.length;++n){var r=t.mapValue.fields[e.get(n)];Op(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=r),t=r}return t.mapValue.fields}},{key:"applyChanges",value:function(e,t,n){Jv(t,(function(t,n){return e[t]=n}));var r=!0,i=!1,a=void 0;try{for(var o,u=n[Symbol.iterator]();!(r=(o=u.next()).done);r=!0){var s=o.value;delete e[s]}}catch(e){i=!0,a=e}finally{try{r||null==u.return||u.return()}finally{if(i)throw a}}}},{key:"clone",value:function(){return new t(Pp(this.value))}}],[{key:"empty",value:function(){return new t({mapValue:{}})}}]),t}();function qp(e){var t=[];return Jv(e.fields,(function(e,n){var r=new bv([e]);if(Op(n)){var i=qp(n.mapValue).fields,a=!0,o=!1,u=void 0;if(0===i.length)t.push(r);else try{for(var s,c=i[Symbol.iterator]();!(a=(s=c.next()).done);a=!0){var l=s.value;t.push(r.child(l))}}catch(e){o=!0,u=e}finally{try{a||null==c.return||c.return()}finally{if(o)throw u}}}else t.push(r)})),new ip(t)
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */}var jp=function(){"use strict";function t(n,r,i,a,o,u){e(s)(this,t),this.key=n,this.documentType=r,this.version=i,this.readTime=a,this.data=o,this.documentState=u}return e(c)(t,[{key:"convertToFoundDocument",value:function(e,t){return this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}},{key:"convertToNoDocument",value:function(e){return this.version=e,this.documentType=2,this.data=Bp.empty(),this.documentState=0,this}},{key:"convertToUnknownDocument",value:function(e){return this.version=e,this.documentType=3,this.data=Bp.empty(),this.documentState=2,this}},{key:"setHasCommittedMutations",value:function(){return this.documentState=2,this}},{key:"setHasLocalMutations",value:function(){return this.documentState=1,this.version=mv.min(),this}},{key:"setReadTime",value:function(e){return this.readTime=e,this}},{key:"hasLocalMutations",get:function(){return 1===this.documentState}},{key:"hasCommittedMutations",get:function(){return 2===this.documentState}},{key:"hasPendingWrites",get:function(){return this.hasLocalMutations||this.hasCommittedMutations}},{key:"isValidDocument",value:function(){return 0!==this.documentType}},{key:"isFoundDocument",value:function(){return 1===this.documentType}},{key:"isNoDocument",value:function(){return 2===this.documentType}},{key:"isUnknownDocument",value:function(){return 3===this.documentType}},{key:"isEqual",value:function(e){return e instanceof t&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}},{key:"mutableCopy",value:function(){return new t(this.key,this.documentType,this.version,this.readTime,this.data.clone(),this.documentState)}},{key:"toString",value:function(){return"Document(".concat(this.key,", ").concat(this.version,", ").concat(JSON.stringify(this.data.value),", {documentType: ").concat(this.documentType,"}), {documentState: ").concat(this.documentState,"})")}}],[{key:"newInvalidDocument",value:function(e){return new t(e,0,mv.min(),mv.min(),Bp.empty(),0)}},{key:"newFoundDocument",value:function(e,n,r){return new t(e,1,n,mv.min(),r,0)}},{key:"newNoDocument",value:function(e,n){return new t(e,2,n,mv.min(),Bp.empty(),0)}},{key:"newUnknownDocument",value:function(e,n){return new t(e,3,n,mv.min(),Bp.empty(),2)}}]),t}(),Gp=function t(n){"use strict";var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,c=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;e(s)(this,t),this.path=n,this.collectionGroup=r,this.orderBy=i,this.filters=a,this.limit=o,this.startAt=u,this.endAt=c,this.ht=null};
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kp(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;return new Gp(e,t,n,r,i,a,o)}function zp(e){var t=$d(e);if(null===t.ht){var n=t.path.canonicalString();null!==t.collectionGroup&&(n+="|cg:"+t.collectionGroup),n+="|f:",n+=t.filters.map((function(e){var t;return(t=e).field.canonicalString()+t.op.toString()+Ep(t.value)})).join(","),n+="|ob:",n+=t.orderBy.map((function(e){return(t=e).field.canonicalString()+t.dir;var t})).join(","),yp(t.limit)||(n+="|l:",n+=t.limit),t.startAt&&(n+="|lb:",n+=t.startAt.inclusive?"b:":"a:",n+=t.startAt.position.map((function(e){return Ep(e)})).join(",")),t.endAt&&(n+="|ub:",n+=t.endAt.inclusive?"a:":"b:",n+=t.endAt.position.map((function(e){return Ep(e)})).join(",")),t.ht=n}return t.ht}function Wp(e,t){if(e.limit!==t.limit)return!1;if(e.orderBy.length!==t.orderBy.length)return!1;for(var n=0;n<e.orderBy.length;n++)if(!sy(e.orderBy[n],t.orderBy[n]))return!1;if(e.filters.length!==t.filters.length)return!1;for(var r=0;r<e.filters.length;r++)if(i=e.filters[r],a=t.filters[r],i.op!==a.op||!i.field.isEqual(a.field)||!xp(i.value,a.value))return!1;var i,a;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!ly(e.startAt,t.startAt)&&ly(e.endAt,t.endAt)}function Hp(e){return xv.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}function Qp(e,t){return e.filters.filter((function(e){return e instanceof Xp&&e.field.isEqual(t)}))}function Yp(e,t,n){var r=wp,i=!0,a=!0,o=!1,u=void 0;try{for(var s,c=Qp(e,t)[Symbol.iterator]();!(a=(s=c.next()).done);a=!0){var l=s.value,h=wp,f=!0;switch(l.op){case"<":case"<=":h=Mp(l.value);break;case"==":case"in":case">=":h=l.value;break;case">":h=l.value,f=!1;break;case"!=":case"not-in":h=wp}Vp({value:r,inclusive:i},{value:h,inclusive:f})<0&&(r=h,i=f)}}catch(e){o=!0,u=e}finally{try{a||null==c.return||c.return()}finally{if(o)throw u}}if(null!==n)for(var d=0;d<e.orderBy.length;++d)if(e.orderBy[d].field.isEqual(t)){var v=n.position[d];Vp({value:r,inclusive:i},{value:v,inclusive:n.inclusive})<0&&(r=v,i=n.inclusive);break}return{value:r,inclusive:i}}function Jp(e,t,n){var r=kp,i=!0,a=!0,o=!1,u=void 0;try{for(var s,c=Qp(e,t)[Symbol.iterator]();!(a=(s=c.next()).done);a=!0){var l=s.value,h=kp,f=!0;switch(l.op){case">=":case">":h=Fp(l.value),f=!1;break;case"==":case"in":case"<=":h=l.value;break;case"<":h=l.value,f=!1;break;case"!=":case"not-in":h=kp}Up({value:r,inclusive:i},{value:h,inclusive:f})>0&&(r=h,i=f)}}catch(e){o=!0,u=e}finally{try{a||null==c.return||c.return()}finally{if(o)throw u}}if(null!==n)for(var d=0;d<e.orderBy.length;++d)if(e.orderBy[d].field.isEqual(t)){var v=n.position[d];Up({value:r,inclusive:i},{value:v,inclusive:n.inclusive})>0&&(r=v,i=n.inclusive);break}return{value:r,inclusive:i}}var Xp=function(t){"use strict";e(d)(r,(function t(){e(s)(this,t)}));var n=e(L)(r);function r(t,i,a){var o;return e(s)(this,r),(o=n.call(this)).field=t,o.op=i,o.value=a,e(wc)(o)}return e(c)(r,[{key:"matches",value:function(e){var t=e.data.field(this.field);return"!="===this.op?null!==t&&this.ft(_p(t,this.value)):null!==t&&bp(this.value)===bp(t)&&this.ft(_p(t,this.value))}},{key:"ft",value:function(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return Xd()}}},{key:"dt",value:function(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}}],[{key:"create",value:function(e,t,n){return e.isKeyField()?"in"===t||"not-in"===t?this.lt(e,t,n):new Zp(e,t,n):"array-contains"===t?new ny(e,n):"in"===t?new ry(e,n):"not-in"===t?new iy(e,n):"array-contains-any"===t?new ay(e,n):new r(e,t,n)}},{key:"lt",value:function(e,t,n){return"in"===t?new $p(e,n):new ey(e,n)}}]),r}(),Zp=function(t){"use strict";e(d)(r,t);var n=e(L)(r);function r(t,i,a){var o;return e(s)(this,r),(o=n.call(this,t,i,a)).key=xv.fromName(a.referenceValue),e(wc)(o)}return e(c)(r,[{key:"matches",value:function(e){var t=xv.comparator(e.key,this.key);return this.ft(t)}}]),r}(Xp),$p=function(t){"use strict";e(d)(r,t);var n=e(L)(r);function r(t,i){var a;return e(s)(this,r),(a=n.call(this,t,"in",i)).keys=ty("in",i),e(wc)(a)}return e(c)(r,[{key:"matches",value:function(e){return this.keys.some((function(t){return t.isEqual(e.key)}))}}]),r}(Xp),ey=function(t){"use strict";e(d)(r,t);var n=e(L)(r);function r(t,i){var a;return e(s)(this,r),(a=n.call(this,t,"not-in",i)).keys=ty("not-in",i),e(wc)(a)}return e(c)(r,[{key:"matches",value:function(e){return!this.keys.some((function(t){return t.isEqual(e.key)}))}}]),r}(Xp);function ty(e,t){var n;return((null===(n=t.arrayValue)||void 0===n?void 0:n.values)||[]).map((function(e){return xv.fromName(e.referenceValue)}))}var ny=function(t){"use strict";e(d)(r,t);var n=e(L)(r);function r(t,i){return e(s)(this,r),n.call(this,t,"array-contains",i)}return e(c)(r,[{key:"matches",value:function(e){var t=e.data.field(this.field);return Np(t)&&Ip(t.arrayValue,this.value)}}]),r}(Xp),ry=function(t){"use strict";e(d)(r,t);var n=e(L)(r);function r(t,i){return e(s)(this,r),n.call(this,t,"in",i)}return e(c)(r,[{key:"matches",value:function(e){var t=e.data.field(this.field);return null!==t&&Ip(this.value.arrayValue,t)}}]),r}(Xp),iy=function(t){"use strict";e(d)(r,t);var n=e(L)(r);function r(t,i){return e(s)(this,r),n.call(this,t,"not-in",i)}return e(c)(r,[{key:"matches",value:function(e){if(Ip(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;var t=e.data.field(this.field);return null!==t&&!Ip(this.value.arrayValue,t)}}]),r}(Xp),ay=function(t){"use strict";e(d)(r,t);var n=e(L)(r);function r(t,i){return e(s)(this,r),n.call(this,t,"array-contains-any",i)}return e(c)(r,[{key:"matches",value:function(e){var t=this,n=e.data.field(this.field);return!(!Np(n)||!n.arrayValue.values)&&n.arrayValue.values.some((function(e){return Ip(t.value.arrayValue,e)}))}}]),r}(Xp),oy=function t(n,r){"use strict";e(s)(this,t),this.position=n,this.inclusive=r},uy=function t(n){"use strict";var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc";e(s)(this,t),this.field=n,this.dir=r};function sy(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}function cy(e,t,n){for(var r=0,i=0;i<e.position.length;i++){var a=t[i],o=e.position[i];if(r=a.field.isKeyField()?xv.comparator(xv.fromName(o.referenceValue),n.key):_p(o,n.data.field(a.field)),"desc"===a.dir&&(r*=-1),0!==r)break}return r}function ly(e,t){if(null===e)return null===t;if(null===t)return!1;if(e.inclusive!==t.inclusive||e.position.length!==t.position.length)return!1;for(var n=0;n<e.position.length;n++)if(!xp(e.position[n],t.position[n]))return!1;return!0}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var hy=function t(n){"use strict";var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"F",c=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,l=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;e(s)(this,t),this.path=n,this.collectionGroup=r,this.explicitOrderBy=i,this.filters=a,this.limit=o,this.limitType=u,this.startAt=c,this.endAt=l,this._t=null,this.wt=null,this.startAt,this.endAt};function fy(e,t,n,r,i,a,o,u){return new hy(e,t,n,r,i,a,o,u)}function dy(e){return new hy(e)}function vy(e){return 0===e.filters.length&&null===e.limit&&null==e.startAt&&null==e.endAt&&(0===e.explicitOrderBy.length||1===e.explicitOrderBy.length&&e.explicitOrderBy[0].field.isKeyField())}function py(e){return e.explicitOrderBy.length>0?e.explicitOrderBy[0].field:null}function yy(e){var t=!0,n=!1,r=void 0;try{for(var i,a=e.filters[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){var o=i.value;if(o.dt())return o.field}}catch(e){n=!0,r=e}finally{try{t||null==a.return||a.return()}finally{if(n)throw r}}return null}function my(e){return null!==e.collectionGroup}function gy(e){var t=$d(e);if(null===t._t){t._t=[];var n=yy(t),r=py(t);if(null!==n&&null===r)n.isKeyField()||t._t.push(new uy(n)),t._t.push(new uy(bv.keyField(),"asc"));else{var i=!1,a=!0,o=!1,u=void 0;try{for(var s,c=t.explicitOrderBy[Symbol.iterator]();!(a=(s=c.next()).done);a=!0){var l=s.value;t._t.push(l),l.field.isKeyField()&&(i=!0)}}catch(e){o=!0,u=e}finally{try{a||null==c.return||c.return()}finally{if(o)throw u}}if(!i){var h=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc";t._t.push(new uy(bv.keyField(),h))}}}return t._t}function ky(e){var t=$d(e);if(!t.wt)if("F"===t.limitType)t.wt=Kp(t.path,t.collectionGroup,gy(t),t.filters,t.limit,t.startAt,t.endAt);else{var n=[],r=!0,i=!1,a=void 0;try{for(var o,u=gy(t)[Symbol.iterator]();!(r=(o=u.next()).done);r=!0){var s=o.value,c="desc"===s.dir?"asc":"desc";n.push(new uy(s.field,c))}}catch(e){i=!0,a=e}finally{try{r||null==u.return||u.return()}finally{if(i)throw a}}var l=t.endAt?new oy(t.endAt.position,t.endAt.inclusive):null,h=t.startAt?new oy(t.startAt.position,t.startAt.inclusive):null;t.wt=Kp(t.path,t.collectionGroup,n,t.filters,t.limit,l,h)}return t.wt}function wy(e,t,n){return new hy(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,n,e.startAt,e.endAt)}function by(e,t){return Wp(ky(e),ky(t))&&e.limitType===t.limitType}function xy(e){return"".concat(zp(ky(e)),"|lt:").concat(e.limitType)}function Iy(e){return"Query(target=".concat((t=ky(e),n=t.path.canonicalString(),null!==t.collectionGroup&&(n+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(n+=", filters: [".concat(t.filters.map((function(e){var t;return"".concat((t=e).field.canonicalString()," ").concat(t.op," ").concat(Ep(t.value))})).join(", "),"]")),yp(t.limit)||(n+=", limit: "+t.limit),t.orderBy.length>0&&(n+=", orderBy: [".concat(t.orderBy.map((function(e){return"".concat((t=e).field.canonicalString()," (").concat(t.dir,")");var t})).join(", "),"]")),t.startAt&&(n+=", startAt: ",n+=t.startAt.inclusive?"b:":"a:",n+=t.startAt.position.map((function(e){return Ep(e)})).join(",")),t.endAt&&(n+=", endAt: ",n+=t.endAt.inclusive?"a:":"b:",n+=t.endAt.position.map((function(e){return Ep(e)})).join(",")),"Target(".concat(n,")")),"; limitType=").concat(e.limitType,")");var t,n}function _y(e,t){return t.isFoundDocument()&&(i=e,o=(a=t).key.path,null!==i.collectionGroup?a.key.hasCollectionId(i.collectionGroup)&&i.path.isPrefixOf(o):xv.isDocumentKey(i.path)?i.path.isEqual(o):i.path.isImmediateParentOf(o))&&function(e,t){var n=!0,r=!1,i=void 0;try{for(var a,o=e.explicitOrderBy[Symbol.iterator]();!(n=(a=o.next()).done);n=!0){var u=a.value;if(!u.field.isKeyField()&&null===t.data.field(u.field))return!1}}catch(e){r=!0,i=e}finally{try{n||null==o.return||o.return()}finally{if(r)throw i}}return!0}(e,t)&&function(e,t){var n=!0,r=!1,i=void 0;try{for(var a,o=e.filters[Symbol.iterator]();!(n=(a=o.next()).done);n=!0){if(!a.value.matches(t))return!1}}catch(e){r=!0,i=e}finally{try{n||null==o.return||o.return()}finally{if(r)throw i}}return!0}(e,t)&&(r=t,!((n=e).startAt&&!function(e,t,n){var r=cy(e,t,n);return e.inclusive?r<=0:r<0}(n.startAt,gy(n),r)||n.endAt&&!function(e,t,n){var r=cy(e,t,n);return e.inclusive?r>=0:r>0}(n.endAt,gy(n),r)));var n,r,i,a,o}function Ty(e){return e.collectionGroup||(e.path.length%2==1?e.path.lastSegment():e.path.get(e.path.length-2))}function Ey(e){return function(t,n){var r=!1,i=!0,a=!1,o=void 0;try{for(var u,s=gy(e)[Symbol.iterator]();!(i=(u=s.next()).done);i=!0){var c=u.value,l=Sy(c,t,n);if(0!==l)return l;r=r||c.field.isKeyField()}}catch(e){a=!0,o=e}finally{try{i||null==s.return||s.return()}finally{if(a)throw o}}return 0}}function Sy(e,t,n){var r=e.field.isKeyField()?xv.comparator(t.key,n.key):function(e,t,n){var r=t.data.field(e),i=n.data.field(e);return null!==r&&null!==i?_p(r,i):Xd()}(e.field,t,n);switch(e.dir){case"asc":return r;case"desc":return-1*r;default:return Xd()}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ay(e,t){if(e.gt){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:mp(t)?"-0":t}}function Cy(e){return{integerValue:""+e}}function Ny(e,t){return gp(t)?Cy(t):Ay(e,t)}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Dy=function t(){"use strict";e(s)(this,t),this._=void 0};function Ry(e,t,n){return e instanceof Ly?(i=t,a={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:(r=n).seconds,nanos:r.nanoseconds}}}},i&&(a.fields.__previous_value__=i),{mapValue:a}):e instanceof My?Fy(e,t):e instanceof Vy?Uy(e,t):function(e,t){var n=Py(e,t),r=qy(n)+qy(e.yt);return Cp(n)&&Cp(e.yt)?Cy(r):Ay(e.It,r)}(e,t);var r,i,a}function Oy(e,t,n){return e instanceof My?Fy(e,t):e instanceof Vy?Uy(e,t):n}function Py(e,t){var n,r;return e instanceof By?Cp(n=t)||(r=n)&&"doubleValue"in r?t:{integerValue:0}:null}var Ly=function(t){"use strict";e(d)(r,t);var n=e(L)(r);function r(){return e(s)(this,r),n.apply(this,arguments)}return r}(Dy),My=function(t){"use strict";e(d)(r,t);var n=e(L)(r);function r(t){var i;return e(s)(this,r),(i=n.call(this)).elements=t,e(wc)(i)}return r}(Dy);function Fy(e,t){var n=jy(t),r=!0,i=!1,a=void 0;try{for(var o,u=function(e,t){var r=t.value;n.some((function(e){return xp(e,r)}))||n.push(r)},s=e.elements[Symbol.iterator]();!(r=(o=s.next()).done);r=!0)u(0,o)}catch(e){i=!0,a=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw a}}return{arrayValue:{values:n}}}var Vy=function(t){"use strict";e(d)(r,t);var n=e(L)(r);function r(t){var i;return e(s)(this,r),(i=n.call(this)).elements=t,e(wc)(i)}return r}(Dy);function Uy(e,t){var n=jy(t),r=!0,i=!1,a=void 0;try{for(var o,u=function(e,t){var r=t.value;n=n.filter((function(e){return!xp(e,r)}))},s=e.elements[Symbol.iterator]();!(r=(o=s.next()).done);r=!0)u(0,o)}catch(e){i=!0,a=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw a}}return{arrayValue:{values:n}}}var By=function(t){"use strict";e(d)(r,t);var n=e(L)(r);function r(t,i){var a;return e(s)(this,r),(a=n.call(this)).It=t,a.yt=i,e(wc)(a)}return r}(Dy);function qy(e){return cp(e.integerValue||e.doubleValue)}function jy(e){return Np(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Gy=function t(n,r){"use strict";e(s)(this,t),this.field=n,this.transform=r};var Ky=function t(n,r){"use strict";e(s)(this,t),this.version=n,this.transformResults=r},zy=function(){"use strict";function t(n,r){e(s)(this,t),this.updateTime=n,this.exists=r}return e(c)(t,[{key:"isNone",get:function(){return void 0===this.updateTime&&void 0===this.exists}},{key:"isEqual",value:function(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}],[{key:"none",value:function(){return new t}},{key:"exists",value:function(e){return new t(void 0,e)}},{key:"updateTime",value:function(e){return new t(e)}}]),t}();function Wy(e,t){return void 0!==e.updateTime?t.isFoundDocument()&&t.version.isEqual(e.updateTime):void 0===e.exists||e.exists===t.isFoundDocument()}var Hy=function t(){"use strict";e(s)(this,t)};function Qy(e,t){if(!e.hasLocalMutations||t&&0===t.fields.length)return null;if(null===t)return e.isNoDocument()?new om(e.key,zy.none()):new $y(e.key,e.data,zy.none());var n=e.data,r=Bp.empty(),i=new tp(bv.comparator),a=!0,o=!1,u=void 0;try{for(var s,c=t.fields[Symbol.iterator]();!(a=(s=c.next()).done);a=!0){var l=s.value;if(!i.has(l)){var h=n.field(l);null===h&&l.length>1&&(l=l.popLast(),h=n.field(l)),null===h?r.delete(l):r.set(l,h),i=i.add(l)}}}catch(e){o=!0,u=e}finally{try{a||null==c.return||c.return()}finally{if(o)throw u}}return new em(e.key,r,new ip(i.toArray()),zy.none())}function Yy(e,t,n){var r;e instanceof $y?function(e,t,n){var r=e.value.clone(),i=nm(e.fieldTransforms,t,n.transformResults);r.setAll(i),t.convertToFoundDocument(n.version,r).setHasCommittedMutations()}(e,t,n):e instanceof em?function(e,t,n){if(Wy(e.precondition,t)){var r=nm(e.fieldTransforms,t,n.transformResults),i=t.data;i.setAll(tm(e)),i.setAll(r),t.convertToFoundDocument(n.version,i).setHasCommittedMutations()}else t.convertToUnknownDocument(n.version)}(e,t,n):(r=n,t.convertToNoDocument(r.version).setHasCommittedMutations())}function Jy(e,t,n,r){return e instanceof $y?function(e,t,n,r){if(!Wy(e.precondition,t))return n;var i=e.value.clone(),a=rm(e.fieldTransforms,r,t);return i.setAll(a),t.convertToFoundDocument(t.version,i).setHasLocalMutations(),null}(e,t,n,r):e instanceof em?function(e,t,n,r){if(!Wy(e.precondition,t))return n;var i=rm(e.fieldTransforms,r,t),a=t.data;return a.setAll(tm(e)),a.setAll(i),t.convertToFoundDocument(t.version,a).setHasLocalMutations(),null===n?null:n.unionWith(e.fieldMask.fields).unionWith(e.fieldTransforms.map((function(e){return e.field})))}(e,t,n,r):(i=t,a=n,Wy(e.precondition,i)?(i.convertToNoDocument(i.version).setHasLocalMutations(),null):a);var i,a}function Xy(e,t){var n=null,r=!0,i=!1,a=void 0;try{for(var o,u=e.fieldTransforms[Symbol.iterator]();!(r=(o=u.next()).done);r=!0){var s=o.value,c=t.data.field(s.field),l=Py(s.transform,c||null);null!=l&&(null===n&&(n=Bp.empty()),n.set(s.field,l))}}catch(e){i=!0,a=e}finally{try{r||null==u.return||u.return()}finally{if(i)throw a}}return n||null}function Zy(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&(n=e.fieldTransforms,r=t.fieldTransforms,!!(void 0===n&&void 0===r||n&&r&&vv(n,r,(function(e,t){return function(e,t){return e.field.isEqual(t.field)&&(n=e.transform,r=t.transform,n instanceof My&&r instanceof My||n instanceof Vy&&r instanceof Vy?vv(n.elements,r.elements,xp):n instanceof By&&r instanceof By?xp(n.yt,r.yt):n instanceof Ly&&r instanceof Ly);var n,r}(e,t)}))))&&(0===e.type?e.value.isEqual(t.value):1!==e.type||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask));var n,r}var $y=function(t){"use strict";e(d)(r,t);var n=e(L)(r);function r(t,i,a){var o,u=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];return e(s)(this,r),(o=n.call(this)).key=t,o.value=i,o.precondition=a,o.fieldTransforms=u,o.type=0,e(wc)(o)}return e(c)(r,[{key:"getFieldMask",value:function(){return null}}]),r}(Hy),em=function(t){"use strict";e(d)(r,t);var n=e(L)(r);function r(t,i,a,o){var u,c=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];return e(s)(this,r),(u=n.call(this)).key=t,u.data=i,u.fieldMask=a,u.precondition=o,u.fieldTransforms=c,u.type=1,e(wc)(u)}return e(c)(r,[{key:"getFieldMask",value:function(){return this.fieldMask}}]),r}(Hy);function tm(e){var t=new Map;return e.fieldMask.fields.forEach((function(n){if(!n.isEmpty()){var r=e.data.field(n);t.set(n,r)}})),t}function nm(e,t,n){var r=new Map;Zd(e.length===n.length);for(var i=0;i<n.length;i++){var a=e[i],o=a.transform,u=t.data.field(a.field);r.set(a.field,Oy(o,u,n[i]))}return r}function rm(e,t,n){var r=new Map,i=!0,a=!1,o=void 0;try{for(var u,s=e[Symbol.iterator]();!(i=(u=s.next()).done);i=!0){var c=u.value,l=c.transform,h=n.data.field(c.field);r.set(c.field,Ry(l,h,t))}}catch(e){a=!0,o=e}finally{try{i||null==s.return||s.return()}finally{if(a)throw o}}return r}var im,am,om=function(t){"use strict";e(d)(r,t);var n=e(L)(r);function r(t,i){var a;return e(s)(this,r),(a=n.call(this)).key=t,a.precondition=i,a.type=2,a.fieldTransforms=[],e(wc)(a)}return e(c)(r,[{key:"getFieldMask",value:function(){return null}}]),r}(Hy),um=function(t){"use strict";e(d)(r,t);var n=e(L)(r);function r(t,i){var a;return e(s)(this,r),(a=n.call(this)).key=t,a.precondition=i,a.type=3,a.fieldTransforms=[],e(wc)(a)}return e(c)(r,[{key:"getFieldMask",value:function(){return null}}]),r}(Hy),sm=function t(n){"use strict";e(s)(this,t),this.count=n};function cm(e){switch(e){default:return Xd();case ev.CANCELLED:case ev.UNKNOWN:case ev.DEADLINE_EXCEEDED:case ev.RESOURCE_EXHAUSTED:case ev.INTERNAL:case ev.UNAVAILABLE:case ev.UNAUTHENTICATED:return!1;case ev.INVALID_ARGUMENT:case ev.NOT_FOUND:case ev.ALREADY_EXISTS:case ev.PERMISSION_DENIED:case ev.FAILED_PRECONDITION:case ev.ABORTED:case ev.OUT_OF_RANGE:case ev.UNIMPLEMENTED:case ev.DATA_LOSS:return!0}}function lm(e){if(void 0===e)return Qd("GRPC error has no .code"),ev.UNKNOWN;switch(e){case im.OK:return ev.OK;case im.CANCELLED:return ev.CANCELLED;case im.UNKNOWN:return ev.UNKNOWN;case im.DEADLINE_EXCEEDED:return ev.DEADLINE_EXCEEDED;case im.RESOURCE_EXHAUSTED:return ev.RESOURCE_EXHAUSTED;case im.INTERNAL:return ev.INTERNAL;case im.UNAVAILABLE:return ev.UNAVAILABLE;case im.UNAUTHENTICATED:return ev.UNAUTHENTICATED;case im.INVALID_ARGUMENT:return ev.INVALID_ARGUMENT;case im.NOT_FOUND:return ev.NOT_FOUND;case im.ALREADY_EXISTS:return ev.ALREADY_EXISTS;case im.PERMISSION_DENIED:return ev.PERMISSION_DENIED;case im.FAILED_PRECONDITION:return ev.FAILED_PRECONDITION;case im.ABORTED:return ev.ABORTED;case im.OUT_OF_RANGE:return ev.OUT_OF_RANGE;case im.UNIMPLEMENTED:return ev.UNIMPLEMENTED;case im.DATA_LOSS:return ev.DATA_LOSS;default:return Xd()}}(am=im||(im={}))[am.OK=0]="OK",am[am.CANCELLED=1]="CANCELLED",am[am.UNKNOWN=2]="UNKNOWN",am[am.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",am[am.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",am[am.NOT_FOUND=5]="NOT_FOUND",am[am.ALREADY_EXISTS=6]="ALREADY_EXISTS",am[am.PERMISSION_DENIED=7]="PERMISSION_DENIED",am[am.UNAUTHENTICATED=16]="UNAUTHENTICATED",am[am.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",am[am.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",am[am.ABORTED=10]="ABORTED",am[am.OUT_OF_RANGE=11]="OUT_OF_RANGE",am[am.UNIMPLEMENTED=12]="UNIMPLEMENTED",am[am.INTERNAL=13]="INTERNAL",am[am.UNAVAILABLE=14]="UNAVAILABLE",am[am.DATA_LOSS=15]="DATA_LOSS";
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var hm=function(){"use strict";function t(n,r){e(s)(this,t),this.mapKeyFn=n,this.equalsFn=r,this.inner={},this.innerSize=0}return e(c)(t,[{key:"get",value:function(t){var n=this.mapKeyFn(t),r=this.inner[n];if(void 0!==r){var i=!0,a=!1,o=void 0;try{for(var u,s=r[Symbol.iterator]();!(i=(u=s.next()).done);i=!0){var c=e(y)(u.value,2),l=c[0],h=c[1];if(this.equalsFn(l,t))return h}}catch(e){a=!0,o=e}finally{try{i||null==s.return||s.return()}finally{if(a)throw o}}}}},{key:"has",value:function(e){return void 0!==this.get(e)}},{key:"set",value:function(e,t){var n=this.mapKeyFn(e),r=this.inner[n];if(void 0===r)return this.inner[n]=[[e,t]],void this.innerSize++;for(var i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return void(r[i]=[e,t]);r.push([e,t]),this.innerSize++}},{key:"delete",value:function(e){var t=this.mapKeyFn(e),n=this.inner[t];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.equalsFn(n[r][0],e))return 1===n.length?delete this.inner[t]:n.splice(r,1),this.innerSize--,!0;return!1}},{key:"forEach",value:function(t){Jv(this.inner,(function(n,r){var i=!0,a=!1,o=void 0;try{for(var u,s=r[Symbol.iterator]();!(i=(u=s.next()).done);i=!0){var c=e(y)(u.value,2),l=c[0],h=c[1];t(l,h)}}catch(e){a=!0,o=e}finally{try{i||null==s.return||s.return()}finally{if(a)throw o}}}))}},{key:"isEmpty",value:function(){return Xv(this.inner)}},{key:"size",value:function(){return this.innerSize}}]),t}(),fm=new Zv(xv.comparator);
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dm(){return fm}var vm=new Zv(xv.comparator);function pm(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=vm,i=!0,a=!1,o=void 0;try{for(var u,s=t[Symbol.iterator]();!(i=(u=s.next()).done);i=!0){var c=u.value;r=r.insert(c.key,c)}}catch(e){a=!0,o=e}finally{try{i||null==s.return||s.return()}finally{if(a)throw o}}return r}function ym(e){var t=vm;return e.forEach((function(e,n){return t=t.insert(e,n.overlayedDocument)})),t}function mm(){return km()}function gm(){return km()}function km(){return new hm((function(e){return e.toString()}),(function(e,t){return e.isEqual(t)}))}var wm=new Zv(xv.comparator),bm=new tp(xv.comparator);function xm(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=bm,i=!0,a=!1,o=void 0;try{for(var u,s=t[Symbol.iterator]();!(i=(u=s.next()).done);i=!0){var c=u.value;r=r.add(c)}}catch(e){a=!0,o=e}finally{try{i||null==s.return||s.return()}finally{if(a)throw o}}return r}var Im=new tp(dv);function _m(){return Im}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Tm=function(){"use strict";function t(n,r,i,a,o){e(s)(this,t),this.snapshotVersion=n,this.targetChanges=r,this.targetMismatches=i,this.documentUpdates=a,this.resolvedLimboDocuments=o}return e(c)(t,null,[{key:"createSynthesizedRemoteEventForCurrentChange",value:function(e,n){var r=new Map;return r.set(e,Em.createSynthesizedTargetChangeForCurrentChange(e,n)),new t(mv.min(),r,_m(),dm(),xm())}}]),t}(),Em=function(){"use strict";function t(n,r,i,a,o){e(s)(this,t),this.resumeToken=n,this.current=r,this.addedDocuments=i,this.modifiedDocuments=a,this.removedDocuments=o}return e(c)(t,null,[{key:"createSynthesizedTargetChangeForCurrentChange",value:function(e,n){return new t(op.EMPTY_BYTE_STRING,n,xm(),xm(),xm())}}]),t}(),Sm=function t(n,r,i,a){"use strict";e(s)(this,t),this.Tt=n,this.removedTargetIds=r,this.key=i,this.Et=a},Am=function t(n,r){"use strict";e(s)(this,t),this.targetId=n,this.At=r},Cm=function t(n,r){"use strict";var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:op.EMPTY_BYTE_STRING,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;e(s)(this,t),this.state=n,this.targetIds=r,this.resumeToken=i,this.cause=a},Nm=function(){"use strict";function t(){e(s)(this,t),this.Rt=0,this.bt=Om(),this.Pt=op.EMPTY_BYTE_STRING,this.vt=!1,this.Vt=!0}return e(c)(t,[{key:"current",get:function(){return this.vt}},{key:"resumeToken",get:function(){return this.Pt}},{key:"St",get:function(){return 0!==this.Rt}},{key:"Dt",get:function(){return this.Vt}},{key:"Ct",value:function(e){e.approximateByteSize()>0&&(this.Vt=!0,this.Pt=e)}},{key:"xt",value:function(){var e=xm(),t=xm(),n=xm();return this.bt.forEach((function(r,i){switch(i){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:n=n.add(r);break;default:Xd()}})),new Em(this.Pt,this.vt,e,t,n)}},{key:"Nt",value:function(){this.Vt=!1,this.bt=Om()}},{key:"kt",value:function(e,t){this.Vt=!0,this.bt=this.bt.insert(e,t)}},{key:"Mt",value:function(e){this.Vt=!0,this.bt=this.bt.remove(e)}},{key:"Ot",value:function(){this.Rt+=1}},{key:"Ft",value:function(){this.Rt-=1}},{key:"$t",value:function(){this.Vt=!0,this.vt=!0}}]),t}(),Dm=function(){"use strict";function t(n){e(s)(this,t),this.Bt=n,this.Lt=new Map,this.Ut=dm(),this.qt=Rm(),this.Kt=new tp(dv)}return e(c)(t,[{key:"Gt",value:function(e){var t=!0,n=!1,r=void 0;try{for(var i,a=e.Tt[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){var o=i.value;e.Et&&e.Et.isFoundDocument()?this.Qt(o,e.Et):this.jt(o,e.key,e.Et)}}catch(e){n=!0,r=e}finally{try{t||null==a.return||a.return()}finally{if(n)throw r}}var u=!0,s=!1,c=void 0;try{for(var l,h=e.removedTargetIds[Symbol.iterator]();!(u=(l=h.next()).done);u=!0){var f=l.value;this.jt(f,e.key,e.Et)}}catch(e){s=!0,c=e}finally{try{u||null==h.return||h.return()}finally{if(s)throw c}}}},{key:"Wt",value:function(e){var t=this;this.forEachTarget(e,(function(n){var r=t.zt(n);switch(e.state){case 0:t.Ht(n)&&r.Ct(e.resumeToken);break;case 1:r.Ft(),r.St||r.Nt(),r.Ct(e.resumeToken);break;case 2:r.Ft(),r.St||t.removeTarget(n);break;case 3:t.Ht(n)&&(r.$t(),r.Ct(e.resumeToken));break;case 4:t.Ht(n)&&(t.Jt(n),r.Ct(e.resumeToken));break;default:Xd()}}))}},{key:"forEachTarget",value:function(e,t){var n=this;e.targetIds.length>0?e.targetIds.forEach(t):this.Lt.forEach((function(e,r){n.Ht(r)&&t(r)}))}},{key:"Yt",value:function(e){var t=e.targetId,n=e.At.count,r=this.Xt(t);if(r){var i=r.target;if(Hp(i))if(0===n){var a=new xv(i.path);this.jt(t,a,jp.newNoDocument(a,mv.min()))}else Zd(1===n);else this.Zt(t)!==n&&(this.Jt(t),this.Kt=this.Kt.add(t))}}},{key:"te",value:function(e){var t=this,n=new Map;this.Lt.forEach((function(r,i){var a=t.Xt(i);if(a){if(r.current&&Hp(a.target)){var o=new xv(a.target.path);null!==t.Ut.get(o)||t.ee(i,o)||t.jt(i,o,jp.newNoDocument(o,e))}r.Dt&&(n.set(i,r.xt()),r.Nt())}}));var r=xm();this.qt.forEach((function(e,n){var i=t,a=!0;n.forEachWhile((function(e){var t=i.Xt(e);return!t||2===t.purpose||(a=!1,!1)})),a&&(r=r.add(e))})),this.Ut.forEach((function(t,n){return n.setReadTime(e)}));var i=new Tm(e,n,this.Kt,this.Ut,r);return this.Ut=dm(),this.qt=Rm(),this.Kt=new tp(dv),i}},{key:"Qt",value:function(e,t){if(this.Ht(e)){var n=this.ee(e,t.key)?2:0;this.zt(e).kt(t.key,n),this.Ut=this.Ut.insert(t.key,t),this.qt=this.qt.insert(t.key,this.ne(t.key).add(e))}}},{key:"jt",value:function(e,t,n){if(this.Ht(e)){var r=this.zt(e);this.ee(e,t)?r.kt(t,1):r.Mt(t),this.qt=this.qt.insert(t,this.ne(t).delete(e)),n&&(this.Ut=this.Ut.insert(t,n))}}},{key:"removeTarget",value:function(e){this.Lt.delete(e)}},{key:"Zt",value:function(e){var t=this.zt(e).xt();return this.Bt.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}},{key:"Ot",value:function(e){this.zt(e).Ot()}},{key:"zt",value:function(e){var t=this.Lt.get(e);return t||(t=new Nm,this.Lt.set(e,t)),t}},{key:"ne",value:function(e){var t=this.qt.get(e);return t||(t=new tp(dv),this.qt=this.qt.insert(e,t)),t}},{key:"Ht",value:function(e){var t=null!==this.Xt(e);return t||Hd("WatchChangeAggregator","Detected inactive target",e),t}},{key:"Xt",value:function(e){var t=this.Lt.get(e);return t&&t.St?null:this.Bt.se(e)}},{key:"Jt",value:function(e){var t=this;this.Lt.set(e,new Nm),this.Bt.getRemoteKeysForTarget(e).forEach((function(n){t.jt(e,n,null)}))}},{key:"ee",value:function(e,t){return this.Bt.getRemoteKeysForTarget(e).has(t)}}]),t}();function Rm(){return new Zv(xv.comparator)}function Om(){return new Zv(xv.comparator)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Pm={asc:"ASCENDING",desc:"DESCENDING"},Lm={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Mm=function t(n,r){"use strict";e(s)(this,t),this.databaseId=n,this.gt=r};function Fm(e,t){return e.gt?"".concat(new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z",""),".").concat(("000000000"+t.nanoseconds).slice(-9),"Z"):{seconds:""+t.seconds,nanos:t.nanoseconds}}function Vm(e,t){return e.gt?t.toBase64():t.toUint8Array()}function Um(e,t){return Fm(e,t.toTimestamp())}function Bm(e){return Zd(!!e),mv.fromTimestamp((t=sp(e),new yv(t.seconds,t.nanos)));var t}function qm(e,t){return(n=e,new kv(["projects",n.projectId,"databases",n.database])).child("documents").child(t).canonicalString();var n}function jm(e){var t=kv.fromString(e);return Zd(sg(t)),t}function Gm(e,t){return qm(e.databaseId,t.path)}function Km(e,t){var n=jm(t);if(n.get(1)!==e.databaseId.projectId)throw new tv(ev.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+e.databaseId.projectId);if(n.get(3)!==e.databaseId.database)throw new tv(ev.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+e.databaseId.database);return new xv(Qm(n))}function zm(e,t){return qm(e.databaseId,t)}function Wm(e){var t=jm(e);return 4===t.length?kv.emptyPath():Qm(t)}function Hm(e){return new kv(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function Qm(e){return Zd(e.length>4&&"documents"===e.get(4)),e.popFirst(5)}function Ym(e,t,n){return{name:Gm(e,t),fields:n.value.mapValue.fields}}function Jm(e,t,n){var r=Km(e,t.name),i=Bm(t.updateTime),a=new Bp({mapValue:{fields:t.fields}}),o=jp.newFoundDocument(r,i,a);return n&&o.setHasCommittedMutations(),n?o.setHasCommittedMutations():o}function Xm(e,t){var n,r,i;if(t instanceof $y)n={update:Ym(e,t.key,t.value)};else if(t instanceof om)n={delete:Gm(e,t.key)};else if(t instanceof em)n={update:Ym(e,t.key,t.data),updateMask:(r=t.fieldMask,i=[],r.fields.forEach((function(e){return i.push(e.canonicalString())})),{fieldPaths:i})};else{if(!(t instanceof um))return Xd();n={verify:Gm(e,t.key)}}return t.fieldTransforms.length>0&&(n.updateTransforms=t.fieldTransforms.map((function(e){return function(e,t){var n=t.transform;if(n instanceof Ly)return{fieldPath:t.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof My)return{fieldPath:t.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof Vy)return{fieldPath:t.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof By)return{fieldPath:t.field.canonicalString(),increment:n.yt};throw Xd()}(0,e)}))),t.precondition.isNone||(n.currentDocument=function(e,t){return void 0!==t.updateTime?{updateTime:Um(e,t.updateTime)}:void 0!==t.exists?{exists:t.exists}:Xd()}(e,t.precondition)),n}function Zm(e,t){var n,r,i,a=t.currentDocument?void 0!==(n=t.currentDocument).updateTime?zy.updateTime(Bm(n.updateTime)):void 0!==n.exists?zy.exists(n.exists):zy.none():zy.none(),o=t.updateTransforms?t.updateTransforms.map((function(t){return function(e,t){var n=null;if("setToServerValue"in t)Zd("REQUEST_TIME"===t.setToServerValue),n=new Ly;else if("appendMissingElements"in t){var r=t.appendMissingElements.values||[];n=new My(r)}else if("removeAllFromArray"in t){var i=t.removeAllFromArray.values||[];n=new Vy(i)}else"increment"in t?n=new By(e,t.increment):Xd();var a=bv.fromServerFormat(t.fieldPath);return new Gy(a,n)}(e,t)})):[];if(t.update){t.update.name;var u=Km(e,t.update.name),s=new Bp({mapValue:{fields:t.update.fields}});if(t.updateMask){var c=(r=t.updateMask,i=r.fieldPaths||[],new ip(i.map((function(e){return bv.fromServerFormat(e)}))));return new em(u,s,c,a,o)}return new $y(u,s,a,o)}if(t.delete){var l=Km(e,t.delete);return new om(l,a)}if(t.verify){var h=Km(e,t.verify);return new um(h,a)}return Xd()}function $m(e,t){return{documents:[zm(e,t.path)]}}function eg(e,t){var n={structuredQuery:{}},r=t.path;null!==t.collectionGroup?(n.parent=zm(e,r),n.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(n.parent=zm(e,r.popLast()),n.structuredQuery.from=[{collectionId:r.lastSegment()}]);var i=function(e){if(0!==e.length){var t=e.map((function(e){return function(e){if("=="===e.op){if(Rp(e.value))return{unaryFilter:{field:ag(e.field),op:"IS_NAN"}};if(Dp(e.value))return{unaryFilter:{field:ag(e.field),op:"IS_NULL"}}}else if("!="===e.op){if(Rp(e.value))return{unaryFilter:{field:ag(e.field),op:"IS_NOT_NAN"}};if(Dp(e.value))return{unaryFilter:{field:ag(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:ag(e.field),op:ig(e.op),value:e.value}}}(e)}));return 1===t.length?t[0]:{compositeFilter:{op:"AND",filters:t}}}}(t.filters);i&&(n.structuredQuery.where=i);var a=function(e){if(0!==e.length)return e.map((function(e){return{field:ag((t=e).field),direction:rg(t.dir)};var t}))}(t.orderBy);a&&(n.structuredQuery.orderBy=a);var o,u,s,c=(o=e,u=t.limit,o.gt||yp(u)?u:{value:u});return null!==c&&(n.structuredQuery.limit=c),t.startAt&&(n.structuredQuery.startAt={before:(s=t.startAt).inclusive,values:s.position}),t.endAt&&(n.structuredQuery.endAt=function(e){return{before:!e.inclusive,values:e.position}}(t.endAt)),n}function tg(e){var t=Wm(e.parent),n=e.structuredQuery,r=n.from?n.from.length:0,i=null;if(r>0){Zd(1===r);var a=n.from[0];a.allDescendants?i=a.collectionId:t=t.child(a.collectionId)}var o=[];n.where&&(o=ng(n.where));var u=[];n.orderBy&&(u=n.orderBy.map((function(e){return new uy(og((t=e).field),function(e){switch(e){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(t.direction));var t})));var s,c,l=null;n.limit&&(s=n.limit,l=yp(c="object"==typeof s?s.value:s)?null:c);var h=null;n.startAt&&(h=function(e){var t=!!e.before,n=e.values||[];return new oy(n,t)}(n.startAt));var f=null;return n.endAt&&(f=function(e){var t=!e.before,n=e.values||[];return new oy(n,t)}(n.endAt)),fy(t,i,u,o,l,"F",h,f)}function ng(e){return e?void 0!==e.unaryFilter?[ug(e)]:void 0!==e.fieldFilter?[(t=e,Xp.create(og(t.fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return Xd()}}(t.fieldFilter.op),t.fieldFilter.value))]:void 0!==e.compositeFilter?e.compositeFilter.filters.map((function(e){return ng(e)})).reduce((function(e,t){return e.concat(t)})):Xd():[];var t}function rg(e){return Pm[e]}function ig(e){return Lm[e]}function ag(e){return{fieldPath:e.canonicalString()}}function og(e){return bv.fromServerFormat(e.fieldPath)}function ug(e){switch(e.unaryFilter.op){case"IS_NAN":var t=og(e.unaryFilter.field);return Xp.create(t,"==",{doubleValue:NaN});case"IS_NULL":var n=og(e.unaryFilter.field);return Xp.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":var r=og(e.unaryFilter.field);return Xp.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":var i=og(e.unaryFilter.field);return Xp.create(i,"!=",{nullValue:"NULL_VALUE"});default:return Xd()}}function sg(e){return e.length>=4&&"projects"===e.get(0)&&"databases"===e.get(2)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cg(e){for(var t="",n=0;n<e.length;n++)t.length>0&&(t=hg(t)),t=lg(e.get(n),t);return hg(t)}function lg(e,t){for(var n=t,r=e.length,i=0;i<r;i++){var a=e.charAt(i);switch(a){case"\0":n+="";break;case"":n+="";break;default:n+=a}}return n}function hg(e){return e+""}function fg(e){var t=e.length;if(Zd(t>=2),2===t)return Zd(""===e.charAt(0)&&""===e.charAt(1)),kv.emptyPath();for(var n=t-2,r=[],i="",a=0;a<t;){var o=e.indexOf("",a);switch((o<0||o>n)&&Xd(),e.charAt(o+1)){case"":var u=e.substring(a,o),s=void 0;0===i.length?s=u:(s=i+=u,i=""),r.push(s);break;case"":i+=e.substring(a,o),i+="\0";break;case"":i+=e.substring(a,o+1);break;default:Xd()}a=o+2}return new kv(r)}
/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var dg=["userId","batchId"];
/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vg(e,t){return[e,cg(t)]}function pg(e,t,n){return[e,cg(t),n]}var yg={},mg=["prefixPath","collectionGroup","readTime","documentId"],gg=["prefixPath","collectionGroup","documentId"],kg=["collectionGroup","readTime","prefixPath","documentId"],wg=["canonicalId","targetId"],bg=["targetId","path"],xg=["path","targetId"],Ig=["collectionId","parent"],_g=["indexId","uid"],Tg=["uid","sequenceNumber"],Eg=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],Sg=["indexId","uid","orderedDocumentKey"],Ag=["userId","collectionPath","documentId"],Cg=["userId","collectionPath","largestBatchId"],Ng=["userId","collectionGroup","largestBatchId"],Dg=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],Rg=e(x)(Dg).concat(["documentOverlays"]),Og=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],Pg=Og,Lg=e(x)(Pg).concat(["indexConfiguration","indexState","indexEntries"]),Mg=function(t){"use strict";e(d)(r,t);var n=e(L)(r);function r(t,i){var a;return e(s)(this,r),(a=n.call(this)).ie=t,a.currentSequenceNumber=i,e(wc)(a)}return r}(Ov);
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fg(e,t){var n=$d(e);return Vv.O(n.ie,t)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Vg=function(){"use strict";function t(n,r,i,a){e(s)(this,t),this.batchId=n,this.localWriteTime=r,this.baseMutations=i,this.mutations=a}return e(c)(t,[{key:"applyToRemoteDocument",value:function(e,t){for(var n=t.mutationResults,r=0;r<this.mutations.length;r++){var i=this.mutations[r];i.key.isEqual(e.key)&&Yy(i,e,n[r])}}},{key:"applyToLocalView",value:function(e,t){var n=!0,r=!1,i=void 0;try{for(var a,o=this.baseMutations[Symbol.iterator]();!(n=(a=o.next()).done);n=!0){var u=a.value;u.key.isEqual(e.key)&&(t=Jy(u,e,t,this.localWriteTime))}}catch(e){r=!0,i=e}finally{try{n||null==o.return||o.return()}finally{if(r)throw i}}var s=!0,c=!1,l=void 0;try{for(var h,f=this.mutations[Symbol.iterator]();!(s=(h=f.next()).done);s=!0){var d=h.value;d.key.isEqual(e.key)&&(t=Jy(d,e,t,this.localWriteTime))}}catch(e){c=!0,l=e}finally{try{s||null==f.return||f.return()}finally{if(c)throw l}}return t}},{key:"applyToLocalDocumentSet",value:function(e,t){var n=this,r=gm();return this.mutations.forEach((function(i){var a=e.get(i.key),o=a.overlayedDocument,u=n.applyToLocalView(o,a.mutatedFields),s=Qy(o,u=t.has(i.key)?null:u);null!==s&&r.set(i.key,s),o.isValidDocument()||o.convertToNoDocument(mv.min())})),r}},{key:"keys",value:function(){return this.mutations.reduce((function(e,t){return e.add(t.key)}),xm())}},{key:"isEqual",value:function(e){return this.batchId===e.batchId&&vv(this.mutations,e.mutations,(function(e,t){return Zy(e,t)}))&&vv(this.baseMutations,e.baseMutations,(function(e,t){return Zy(e,t)}))}}]),t}(),Ug=function(){"use strict";function t(n,r,i,a){e(s)(this,t),this.batch=n,this.commitVersion=r,this.mutationResults=i,this.docVersions=a}return e(c)(t,null,[{key:"from",value:function(e,n,r){Zd(e.mutations.length===r.length);for(var i=wm,a=e.mutations,o=0;o<a.length;o++)i=i.insert(a[o].key,r[o].version);return new t(e,n,r,i)}}]),t}(),Bg=function(){"use strict";function t(n,r){e(s)(this,t),this.largestBatchId=n,this.mutation=r}return e(c)(t,[{key:"getKey",value:function(){return this.mutation.key}},{key:"isEqual",value:function(e){return null!==e&&this.mutation===e.mutation}},{key:"toString",value:function(){return"Overlay{\n      largestBatchId: ".concat(this.largestBatchId,",\n      mutation: ").concat(this.mutation.toString(),"\n    }")}}]),t}(),qg=function(){"use strict";function t(n,r,i,a){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:mv.min(),u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:mv.min(),c=arguments.length>6&&void 0!==arguments[6]?arguments[6]:op.EMPTY_BYTE_STRING;e(s)(this,t),this.target=n,this.targetId=r,this.purpose=i,this.sequenceNumber=a,this.snapshotVersion=o,this.lastLimboFreeSnapshotVersion=u,this.resumeToken=c}return e(c)(t,[{key:"withSequenceNumber",value:function(e){return new t(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken)}},{key:"withResumeToken",value:function(e,n){return new t(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e)}},{key:"withLastLimboFreeSnapshotVersion",value:function(e){return new t(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken)}}]),t}(),jg=function t(n){"use strict";e(s)(this,t),this.re=n};function Gg(e,t){var n,r,i=t.key,a={prefixPath:i.getCollectionPath().popLast().toArray(),collectionGroup:i.collectionGroup,documentId:i.path.lastSegment(),readTime:Kg(t.readTime),hasCommittedMutations:t.hasCommittedMutations};if(t.isFoundDocument())a.document={name:Gm(n=e.re,(r=t).key),fields:r.data.value.mapValue.fields,updateTime:Fm(n,r.version.toTimestamp())};else if(t.isNoDocument())a.noDocument={path:i.path.toArray(),readTime:zg(t.version)};else{if(!t.isUnknownDocument())return Xd();a.unknownDocument={path:i.path.toArray(),version:zg(t.version)}}return a}function Kg(e){var t=e.toTimestamp();return[t.seconds,t.nanoseconds]}function zg(e){var t=e.toTimestamp();return{seconds:t.seconds,nanoseconds:t.nanoseconds}}function Wg(e){var t=new yv(e.seconds,e.nanoseconds);return mv.fromTimestamp(t)}function Hg(e,t){for(var n=(t.baseMutations||[]).map((function(t){return Zm(e.re,t)})),r=0;r<t.mutations.length-1;++r){var i=t.mutations[r];if(r+1<t.mutations.length&&void 0!==t.mutations[r+1].transform){var a=t.mutations[r+1];i.updateTransforms=a.transform.fieldTransforms,t.mutations.splice(r+1,1),++r}}var o=t.mutations.map((function(t){return Zm(e.re,t)})),u=yv.fromMillis(t.localWriteTimeMs);return new Vg(t.batchId,u,n,o)}function Qg(e){var t,n,r=Wg(e.readTime),i=void 0!==e.lastLimboFreeSnapshotVersion?Wg(e.lastLimboFreeSnapshotVersion):mv.min();return void 0!==e.query.documents?(Zd(1===(n=e.query).documents.length),t=ky(dy(Wm(n.documents[0])))):t=ky(tg(e.query)),new qg(t,e.targetId,0,e.lastListenSequenceNumber,r,i,op.fromBase64String(e.resumeToken))}function Yg(e,t){var n,r=zg(t.snapshotVersion),i=zg(t.lastLimboFreeSnapshotVersion);n=Hp(t.target)?$m(e.re,t.target):eg(e.re,t.target);var a=t.resumeToken.toBase64();return{targetId:t.targetId,canonicalId:zp(t.target),readTime:r,resumeToken:a,lastListenSequenceNumber:t.sequenceNumber,lastLimboFreeSnapshotVersion:i,query:n}}function Jg(e){var t=tg({parent:e.parent,structuredQuery:e.structuredQuery});return"LAST"===e.limitType?wy(t,t.limit,"L"):t}function Xg(e,t){return new Bg(t.largestBatchId,Zm(e.re,t.overlayMutation))}function Zg(e,t){var n=t.path.lastSegment();return[e,cg(t.path.popLast()),n]}function $g(e,t,n,r){return{indexId:e,uid:t.uid||"",sequenceNumber:n,readTime:zg(r.readTime),documentKey:cg(r.documentKey.path),largestBatchId:r.largestBatchId}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ek=function(){"use strict";function t(){e(s)(this,t)}return e(c)(t,[{key:"getBundleMetadata",value:function(e,t){return tk(e).get(t).next((function(e){if(e)return{id:(t=e).bundleId,createTime:Wg(t.createTime),version:t.version};var t}))}},{key:"saveBundleMetadata",value:function(e,t){var n;return tk(e).put({bundleId:(n=t).id,createTime:zg(Bm(n.createTime)),version:n.version})}},{key:"getNamedQuery",value:function(e,t){return nk(e).get(t).next((function(e){if(e)return{name:(t=e).name,query:Jg(t.bundledQuery),readTime:Wg(t.readTime)};var t}))}},{key:"saveNamedQuery",value:function(e,t){return nk(e).put({name:(n=t).name,readTime:zg(Bm(n.readTime)),bundledQuery:n.bundledQuery});var n}}]),t}();function tk(e){return Fg(e,"bundles")}function nk(e){return Fg(e,"namedQueries")}
/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var rk=function(){"use strict";function t(n,r){e(s)(this,t),this.It=n,this.userId=r}return e(c)(t,[{key:"getOverlay",value:function(e,t){var n=this;return ik(e).get(Zg(this.userId,t)).next((function(e){return e?Xg(n.It,e):null}))}},{key:"getOverlays",value:function(e,t){var n=this,r=mm();return Mv.forEach(t,(function(t){return n.getOverlay(e,t).next((function(e){null!==e&&r.set(t,e)}))})).next((function(){return r}))}},{key:"saveOverlays",value:function(e,t,n){var r=this,i=[];return n.forEach((function(n,a){var o=new Bg(t,a);i.push(r.ue(e,o))})),Mv.waitFor(i)}},{key:"removeOverlaysForBatchId",value:function(e,t,n){var r=this,i=new Set;t.forEach((function(e){return i.add(cg(e.getCollectionPath()))}));var a=[];return i.forEach((function(t){var i=IDBKeyRange.bound([r.userId,t,n],[r.userId,t,n+1],!1,!0);a.push(ik(e).Y("collectionPathOverlayIndex",i))})),Mv.waitFor(a)}},{key:"getOverlaysForCollection",value:function(e,t,n){var r=this,i=mm(),a=cg(t),o=IDBKeyRange.bound([this.userId,a,n],[this.userId,a,Number.POSITIVE_INFINITY],!0);return ik(e).W("collectionPathOverlayIndex",o).next((function(e){var t=!0,n=!1,a=void 0;try{for(var o,u=e[Symbol.iterator]();!(t=(o=u.next()).done);t=!0){var s=o.value,c=Xg(r.It,s);i.set(c.getKey(),c)}}catch(e){n=!0,a=e}finally{try{t||null==u.return||u.return()}finally{if(n)throw a}}return i}))}},{key:"getOverlaysForCollectionGroup",value:function(e,t,n,r){var i,a=this,o=mm(),u=IDBKeyRange.bound([this.userId,t,n],[this.userId,t,Number.POSITIVE_INFINITY],!0);return ik(e).Z({index:"collectionGroupOverlayIndex",range:u},(function(e,t,n){var u=Xg(a.It,t);o.size()<r||u.largestBatchId===i?(o.set(u.getKey(),u),i=u.largestBatchId):n.done()})).next((function(){return o}))}},{key:"ue",value:function(t,n){return ik(t).put(function(t,n,r){var i=e(y)(Zg(n,r.mutation.key),3);i[0];return{userId:n,collectionPath:i[1],documentId:i[2],collectionGroup:r.mutation.key.getCollectionGroup(),largestBatchId:r.largestBatchId,overlayMutation:Xm(t.re,r.mutation)}}(this.It,this.userId,n))}}],[{key:"oe",value:function(e,n){return new t(e,n.uid||"")}}]),t}();function ik(e){return Fg(e,"documentOverlays")}
/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ak=function(){"use strict";function t(){e(s)(this,t)}return e(c)(t,[{key:"ce",value:function(e,t){this.ae(e,t),t.he()}},{key:"ae",value:function(e,t){if("nullValue"in e)this.le(t,5);else if("booleanValue"in e)this.le(t,10),t.fe(e.booleanValue?1:0);else if("integerValue"in e)this.le(t,15),t.fe(cp(e.integerValue));else if("doubleValue"in e){var n=cp(e.doubleValue);isNaN(n)?this.le(t,13):(this.le(t,15),mp(n)?t.fe(0):t.fe(n))}else if("timestampValue"in e){var r=e.timestampValue;this.le(t,20),"string"==typeof r?t.de(r):(t.de("".concat(r.seconds||"")),t.fe(r.nanos||0))}else if("stringValue"in e)this._e(e.stringValue,t),this.we(t);else if("bytesValue"in e)this.le(t,30),t.me(lp(e.bytesValue)),this.we(t);else if("referenceValue"in e)this.ge(e.referenceValue,t);else if("geoPointValue"in e){var i=e.geoPointValue;this.le(t,45),t.fe(i.latitude||0),t.fe(i.longitude||0)}else"mapValue"in e?Lp(e)?this.le(t,Number.MAX_SAFE_INTEGER):(this.ye(e.mapValue,t),this.we(t)):"arrayValue"in e?(this.pe(e.arrayValue,t),this.we(t)):Xd()}},{key:"_e",value:function(e,t){this.le(t,25),this.Ie(e,t)}},{key:"Ie",value:function(e,t){t.de(e)}},{key:"ye",value:function(e,t){var n=e.fields||{};this.le(t,55);var r=!0,i=!1,a=void 0;try{for(var o,u=Object.keys(n)[Symbol.iterator]();!(r=(o=u.next()).done);r=!0){var s=o.value;this._e(s,t),this.ae(n[s],t)}}catch(e){i=!0,a=e}finally{try{r||null==u.return||u.return()}finally{if(i)throw a}}}},{key:"pe",value:function(e,t){var n=e.values||[];this.le(t,50);var r=!0,i=!1,a=void 0;try{for(var o,u=n[Symbol.iterator]();!(r=(o=u.next()).done);r=!0){var s=o.value;this.ae(s,t)}}catch(e){i=!0,a=e}finally{try{r||null==u.return||u.return()}finally{if(i)throw a}}}},{key:"ge",value:function(e,t){var n=this;this.le(t,37),xv.fromName(e).path.forEach((function(e){n.le(t,60),n.Ie(e,t)}))}},{key:"le",value:function(e,t){e.fe(t)}},{key:"we",value:function(e){e.fe(2)}}]),t}();function ok(e){if(0===e)return 8;var t=0;return e>>4==0&&(t+=4,e<<=4),e>>6==0&&(t+=2,e<<=2),e>>7==0&&(t+=1),t}function uk(e){var t=64-function(e){for(var t=0,n=0;n<8;++n){var r=ok(255&e[n]);if(t+=r,8!==r)break}return t}(e);return Math.ceil(t/8)}ak.Te=new ak;var sk=function(){"use strict";function t(){e(s)(this,t),this.buffer=new Uint8Array(1024),this.position=0}return e(c)(t,[{key:"Ee",value:function(e){for(var t=e[Symbol.iterator](),n=t.next();!n.done;)this.Ae(n.value),n=t.next();this.Re()}},{key:"be",value:function(e){for(var t=e[Symbol.iterator](),n=t.next();!n.done;)this.Pe(n.value),n=t.next();this.ve()}},{key:"Ve",value:function(e){var t=!0,n=!1,r=void 0;try{for(var i,a=e[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){var o=i.value,u=o.charCodeAt(0);if(u<128)this.Ae(u);else if(u<2048)this.Ae(960|u>>>6),this.Ae(128|63&u);else if(o<"\ud800"||"\udbff"<o)this.Ae(480|u>>>12),this.Ae(128|63&u>>>6),this.Ae(128|63&u);else{var s=o.codePointAt(0);this.Ae(240|s>>>18),this.Ae(128|63&s>>>12),this.Ae(128|63&s>>>6),this.Ae(128|63&s)}}}catch(e){n=!0,r=e}finally{try{t||null==a.return||a.return()}finally{if(n)throw r}}this.Re()}},{key:"Se",value:function(e){var t=!0,n=!1,r=void 0;try{for(var i,a=e[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){var o=i.value,u=o.charCodeAt(0);if(u<128)this.Pe(u);else if(u<2048)this.Pe(960|u>>>6),this.Pe(128|63&u);else if(o<"\ud800"||"\udbff"<o)this.Pe(480|u>>>12),this.Pe(128|63&u>>>6),this.Pe(128|63&u);else{var s=o.codePointAt(0);this.Pe(240|s>>>18),this.Pe(128|63&s>>>12),this.Pe(128|63&s>>>6),this.Pe(128|63&s)}}}catch(e){n=!0,r=e}finally{try{t||null==a.return||a.return()}finally{if(n)throw r}}this.ve()}},{key:"De",value:function(e){var t=this.Ce(e),n=uk(t);this.xe(1+n),this.buffer[this.position++]=255&n;for(var r=t.length-n;r<t.length;++r)this.buffer[this.position++]=255&t[r]}},{key:"Ne",value:function(e){var t=this.Ce(e),n=uk(t);this.xe(1+n),this.buffer[this.position++]=~(255&n);for(var r=t.length-n;r<t.length;++r)this.buffer[this.position++]=~(255&t[r])}},{key:"ke",value:function(){this.Me(255),this.Me(255)}},{key:"Oe",value:function(){this.Fe(255),this.Fe(255)}},{key:"reset",value:function(){this.position=0}},{key:"seed",value:function(e){this.xe(e.length),this.buffer.set(e,this.position),this.position+=e.length}},{key:"$e",value:function(){return this.buffer.slice(0,this.position)}},{key:"Ce",value:function(e){var t,n,r=(t=e,(n=new DataView(new ArrayBuffer(8))).setFloat64(0,t,!1),new Uint8Array(n.buffer)),i=0!=(128&r[0]);r[0]^=i?255:128;for(var a=1;a<r.length;++a)r[a]^=i?255:0;return r}},{key:"Ae",value:function(e){var t=255&e;0===t?(this.Me(0),this.Me(255)):255===t?(this.Me(255),this.Me(0)):this.Me(t)}},{key:"Pe",value:function(e){var t=255&e;0===t?(this.Fe(0),this.Fe(255)):255===t?(this.Fe(255),this.Fe(0)):this.Fe(e)}},{key:"Re",value:function(){this.Me(0),this.Me(1)}},{key:"ve",value:function(){this.Fe(0),this.Fe(1)}},{key:"Me",value:function(e){this.xe(1),this.buffer[this.position++]=e}},{key:"Fe",value:function(e){this.xe(1),this.buffer[this.position++]=~e}},{key:"xe",value:function(e){var t=e+this.position;if(!(t<=this.buffer.length)){var n=2*this.buffer.length;n<t&&(n=t);var r=new Uint8Array(n);r.set(this.buffer),this.buffer=r}}}]),t}(),ck=function(){"use strict";function t(n){e(s)(this,t),this.Be=n}return e(c)(t,[{key:"me",value:function(e){this.Be.Ee(e)}},{key:"de",value:function(e){this.Be.Ve(e)}},{key:"fe",value:function(e){this.Be.De(e)}},{key:"he",value:function(){this.Be.ke()}}]),t}(),lk=function(){"use strict";function t(n){e(s)(this,t),this.Be=n}return e(c)(t,[{key:"me",value:function(e){this.Be.be(e)}},{key:"de",value:function(e){this.Be.Se(e)}},{key:"fe",value:function(e){this.Be.Ne(e)}},{key:"he",value:function(){this.Be.Oe()}}]),t}(),hk=function(){"use strict";function t(){e(s)(this,t),this.Be=new sk,this.Le=new ck(this.Be),this.Ue=new lk(this.Be)}return e(c)(t,[{key:"seed",value:function(e){this.Be.seed(e)}},{key:"qe",value:function(e){return 0===e?this.Le:this.Ue}},{key:"$e",value:function(){return this.Be.$e()}},{key:"reset",value:function(){this.Be.reset()}}]),t}(),fk=function(){"use strict";function t(n,r,i,a){e(s)(this,t),this.indexId=n,this.documentKey=r,this.arrayValue=i,this.directionalValue=a}return e(c)(t,[{key:"Ke",value:function(){var e=this.directionalValue.length,n=0===e||255===this.directionalValue[e-1]?e+1:e,r=new Uint8Array(n);return r.set(this.directionalValue,0),n!==e?r.set([0],this.directionalValue.length):++r[r.length-1],new t(this.indexId,this.documentKey,this.arrayValue,r)}}]),t}();function dk(e,t){var n=e.indexId-t.indexId;return 0!==n?n:0!==(n=vk(e.arrayValue,t.arrayValue))?n:0!==(n=vk(e.directionalValue,t.directionalValue))?n:xv.comparator(e.documentKey,t.documentKey)}function vk(e,t){for(var n=0;n<e.length&&n<t.length;++n){var r=e[n]-t[n];if(0!==r)return r}return e.length-t.length}
/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var pk=function(){"use strict";function t(n){e(s)(this,t),this.collectionId=null!=n.collectionGroup?n.collectionGroup:n.path.lastSegment(),this.Ge=n.orderBy,this.Qe=[];var r=!0,i=!1,a=void 0;try{for(var o,u=n.filters[Symbol.iterator]();!(r=(o=u.next()).done);r=!0){var c=o.value;c.dt()?this.je=c:this.Qe.push(c)}}catch(e){i=!0,a=e}finally{try{r||null==u.return||u.return()}finally{if(i)throw a}}}return e(c)(t,[{key:"We",value:function(e){var t=_v(e);if(void 0!==t&&!this.ze(t))return!1;for(var n=Tv(e),r=0,i=0;r<n.length&&this.ze(n[r]);++r);if(r===n.length)return!0;if(void 0!==this.je){var a=n[r];if(!this.He(this.je,a)||!this.Je(this.Ge[i++],a))return!1;++r}for(;r<n.length;++r){var o=n[r];if(i>=this.Ge.length||!this.Je(this.Ge[i++],o))return!1}return!0}},{key:"ze",value:function(e){var t=!0,n=!1,r=void 0;try{for(var i,a=this.Qe[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){var o=i.value;if(this.He(o,e))return!0}}catch(e){n=!0,r=e}finally{try{t||null==a.return||a.return()}finally{if(n)throw r}}return!1}},{key:"He",value:function(e,t){if(void 0===e||!e.field.isEqual(t.fieldPath))return!1;var n="array-contains"===e.op||"array-contains-any"===e.op;return 2===t.kind===n}},{key:"Je",value:function(e,t){return!!e.field.isEqual(t.fieldPath)&&(0===t.kind&&"asc"===e.dir||1===t.kind&&"desc"===e.dir)}}]),t}(),yk=function(){"use strict";function t(){e(s)(this,t),this.Ye=new mk}return e(c)(t,[{key:"addToCollectionParentIndex",value:function(e,t){return this.Ye.add(t),Mv.resolve()}},{key:"getCollectionParents",value:function(e,t){return Mv.resolve(this.Ye.getEntries(t))}},{key:"addFieldIndex",value:function(e,t){return Mv.resolve()}},{key:"deleteFieldIndex",value:function(e,t){return Mv.resolve()}},{key:"getDocumentsMatchingTarget",value:function(e,t){return Mv.resolve(null)}},{key:"getIndexType",value:function(e,t){return Mv.resolve(0)}},{key:"getFieldIndexes",value:function(e,t){return Mv.resolve([])}},{key:"getNextCollectionGroupToUpdate",value:function(e){return Mv.resolve(null)}},{key:"getMinOffset",value:function(e,t){return Mv.resolve(Nv.min())}},{key:"getMinOffsetFromCollectionGroup",value:function(e,t){return Mv.resolve(Nv.min())}},{key:"updateCollectionGroup",value:function(e,t,n){return Mv.resolve()}},{key:"updateIndexEntries",value:function(e,t){return Mv.resolve()}}]),t}(),mk=function(){"use strict";function t(){e(s)(this,t),this.index={}}return e(c)(t,[{key:"add",value:function(e){var t=e.lastSegment(),n=e.popLast(),r=this.index[t]||new tp(kv.comparator),i=!r.has(n);return this.index[t]=r.add(n),i}},{key:"has",value:function(e){var t=e.lastSegment(),n=e.popLast(),r=this.index[t];return r&&r.has(n)}},{key:"getEntries",value:function(e){return(this.index[e]||new tp(kv.comparator)).toArray()}}]),t}(),gk=new Uint8Array(0),kk=function(){"use strict";function t(n,r){e(s)(this,t),this.user=n,this.databaseId=r,this.Xe=new mk,this.Ze=new hm((function(e){return zp(e)}),(function(e,t){return Wp(e,t)})),this.uid=n.uid||""}return e(c)(t,[{key:"addToCollectionParentIndex",value:function(e,t){if(!this.Xe.has(t)){var n=this,r=t.lastSegment(),i=t.popLast();e.addOnCommittedListener((function(){n.Xe.add(t)}));var a={collectionId:r,parent:cg(i)};return wk(e).put(a)}return Mv.resolve()}},{key:"getCollectionParents",value:function(e,t){var n=[],r=IDBKeyRange.bound([t,""],[pv(t),""],!1,!0);return wk(e).W(r).next((function(e){var r=!0,i=!1,a=void 0;try{for(var o,u=e[Symbol.iterator]();!(r=(o=u.next()).done);r=!0){var s=o.value;if(s.collectionId!==t)break;n.push(fg(s.parent))}}catch(e){i=!0,a=e}finally{try{r||null==u.return||u.return()}finally{if(i)throw a}}return n}))}},{key:"addFieldIndex",value:function(e,t){var n,r=xk(e),i={indexId:(n=t).indexId,collectionGroup:n.collectionGroup,fields:n.fields.map((function(e){return[e.fieldPath.canonicalString(),e.kind]}))};delete i.indexId;var a=r.add(i);if(t.indexState){var o=this,u=Ik(e);return a.next((function(e){u.put($g(e,o.user,t.indexState.sequenceNumber,t.indexState.offset))}))}return a.next()}},{key:"deleteFieldIndex",value:function(e,t){var n=xk(e),r=Ik(e),i=bk(e);return n.delete(t.indexId).next((function(){return r.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))})).next((function(){return i.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))}))}},{key:"getDocumentsMatchingTarget",value:function(e,t){var n=this,r=bk(e),i=!0,a=new Map;return Mv.forEach(this.tn(t),(function(t){return n.en(e,t).next((function(e){i&&(i=!!e),a.set(t,e)}))})).next((function(){if(i){var e=n,o=xm(),u=[];return Mv.forEach(a,(function(n,i){var a;Hd("IndexedDbIndexManager","Using index ".concat((a=n,"id=".concat(a.indexId,"|cg=").concat(a.collectionGroup,"|f=").concat(a.fields.map((function(e){return"".concat(e.fieldPath,":").concat(e.kind)})).join(",")))," to execute ").concat(zp(t)));var s=function(e,t){var n=_v(t);if(void 0===n)return null;var r=!0,i=!1,a=void 0;try{for(var o,u=Qp(e,n.fieldPath)[Symbol.iterator]();!(r=(o=u.next()).done);r=!0){var s=o.value;switch(s.op){case"array-contains-any":return s.value.arrayValue.values||[];case"array-contains":return[s.value]}}}catch(e){i=!0,a=e}finally{try{r||null==u.return||u.return()}finally{if(i)throw a}}return null}(i,n),c=function(e,t){var n=new Map,r=!0,i=!1,a=void 0,o=!0,u=!1,s=void 0;try{for(var c,l=Tv(t)[Symbol.iterator]();!(o=(c=l.next()).done);o=!0){var h=c.value;try{for(var f,d=Qp(e,h.fieldPath)[Symbol.iterator]();!(r=(f=d.next()).done);r=!0){var v=f.value;switch(v.op){case"==":case"in":n.set(h.fieldPath.canonicalString(),v.value);break;case"not-in":case"!=":return n.set(h.fieldPath.canonicalString(),v.value),Array.from(n.values())}}}catch(e){i=!0,a=e}finally{try{r||null==d.return||d.return()}finally{if(i)throw a}}}}catch(e){u=!0,s=e}finally{try{o||null==l.return||l.return()}finally{if(u)throw s}}return null}(i,n),l=function(e,t){var n=[],r=!0,i=!0,a=!1,o=void 0;try{for(var u,s=Tv(t)[Symbol.iterator]();!(i=(u=s.next()).done);i=!0){var c=u.value,l=0===c.kind?Yp(e,c.fieldPath,e.startAt):Jp(e,c.fieldPath,e.startAt);n.push(l.value),r&&(r=l.inclusive)}}catch(e){a=!0,o=e}finally{try{i||null==s.return||s.return()}finally{if(a)throw o}}return new oy(n,r)}(i,n),h=function(e,t){var n=[],r=!0,i=!0,a=!1,o=void 0;try{for(var u,s=Tv(t)[Symbol.iterator]();!(i=(u=s.next()).done);i=!0){var c=u.value,l=0===c.kind?Jp(e,c.fieldPath,e.endAt):Yp(e,c.fieldPath,e.endAt);n.push(l.value),r&&(r=l.inclusive)}}catch(e){a=!0,o=e}finally{try{i||null==s.return||s.return()}finally{if(a)throw o}}return new oy(n,r)}(i,n),f=e.nn(n,i,l),d=e.nn(n,i,h),v=e.sn(n,i,c),p=e.rn(n.indexId,s,f,l.inclusive,d,h.inclusive,v);return Mv.forEach(p,(function(e){return r.J(e,t.limit).next((function(e){e.forEach((function(e){var t=xv.fromSegments(e.documentKey);o.has(t)||(o=o.add(t),u.push(t))}))}))}))})).next((function(){return u}))}return Mv.resolve(null)}))}},{key:"tn",value:function(e){var t=this.Ze.get(e);return t||(t=[e],this.Ze.set(e,t),t)}},{key:"rn",value:function(t,n,r,i,a,o,u){for(var s=this,c=function(c){var l,d=s,v=n?s.on(n[c/h]):gk,p=s.un(t,v,r[c%h],i),y=s.cn(t,v,a[c%h],o),m=u.map((function(e){return d.un(t,v,e,!0)}));(l=f).push.apply(l,e(x)(s.createRange(p,y,m)))},l=(null!=n?n.length:1)*Math.max(r.length,a.length),h=l/(null!=n?n.length:1),f=[],d=0;d<l;++d)c(d);return f}},{key:"un",value:function(e,t,n,r){var i=new fk(e,xv.empty(),t,n);return r?i:i.Ke()}},{key:"cn",value:function(e,t,n,r){var i=new fk(e,xv.empty(),t,n);return r?i.Ke():i}},{key:"en",value:function(e,t){var n=new pk(t),r=null!=t.collectionGroup?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,r).next((function(e){var t=null,r=!0,i=!1,a=void 0;try{for(var o,u=e[Symbol.iterator]();!(r=(o=u.next()).done);r=!0){var s=o.value;n.We(s)&&(!t||s.fields.length>t.fields.length)&&(t=s)}}catch(e){i=!0,a=e}finally{try{r||null==u.return||u.return()}finally{if(i)throw a}}return t}))}},{key:"getIndexType",value:function(e,t){var n=this,r=2;return Mv.forEach(this.tn(t),(function(t){return n.en(e,t).next((function(e){e?0!==r&&e.fields.length<function(e){var t=new tp(bv.comparator),n=!1,r=!0,i=!1,a=void 0;try{for(var o,u=e.filters[Symbol.iterator]();!(r=(o=u.next()).done);r=!0){var s=o.value;s.field.isKeyField()||("array-contains"===s.op||"array-contains-any"===s.op?n=!0:t=t.add(s.field))}}catch(e){i=!0,a=e}finally{try{r||null==u.return||u.return()}finally{if(i)throw a}}var c=!0,l=!1,h=void 0;try{for(var f,d=e.orderBy[Symbol.iterator]();!(c=(f=d.next()).done);c=!0){var v=f.value;v.field.isKeyField()||(t=t.add(v.field))}}catch(e){l=!0,h=e}finally{try{c||null==d.return||d.return()}finally{if(l)throw h}}return t.size+(n?1:0)}(t)&&(r=1):r=0}))})).next((function(){return r}))}},{key:"an",value:function(e,t){var n=new hk,r=!0,i=!1,a=void 0;try{for(var o,u=Tv(e)[Symbol.iterator]();!(r=(o=u.next()).done);r=!0){var s=o.value,c=t.data.field(s.fieldPath);if(null==c)return null;var l=n.qe(s.kind);ak.Te.ce(c,l)}}catch(e){i=!0,a=e}finally{try{r||null==u.return||u.return()}finally{if(i)throw a}}return n.$e()}},{key:"on",value:function(e){var t=new hk;return ak.Te.ce(e,t.qe(0)),t.$e()}},{key:"hn",value:function(e,t){var n,r=new hk;return ak.Te.ce(Ap(this.databaseId,t),r.qe(0===(n=Tv(e)).length?0:n[n.length-1].kind)),r.$e()}},{key:"sn",value:function(e,t,n){if(null===n)return[];var r=[];r.push(new hk);var i=0,a=!0,o=!1,u=void 0;try{for(var s,c=Tv(e)[Symbol.iterator]();!(a=(s=c.next()).done);a=!0){var l=s.value,h=n[i++],f=!0,d=!1,v=void 0;try{for(var p,y=r[Symbol.iterator]();!(f=(p=y.next()).done);f=!0){var m=p.value;if(this.ln(t,l.fieldPath)&&Np(h))r=this.fn(r,l,h);else{var g=m.qe(l.kind);ak.Te.ce(h,g)}}}catch(e){d=!0,v=e}finally{try{f||null==y.return||y.return()}finally{if(d)throw v}}}}catch(e){o=!0,u=e}finally{try{a||null==c.return||c.return()}finally{if(o)throw u}}return this.dn(r)}},{key:"nn",value:function(e,t,n){return this.sn(e,t,n.position)}},{key:"dn",value:function(e){for(var t=[],n=0;n<e.length;++n)t[n]=e[n].$e();return t}},{key:"fn",value:function(t,n,r){var i=e(x)(t),a=[],o=!0,u=!1,s=void 0,c=!0,l=!1,h=void 0;try{for(var f,d=(r.arrayValue.values||[])[Symbol.iterator]();!(c=(f=d.next()).done);c=!0){var v=f.value;try{for(var p,y=i[Symbol.iterator]();!(o=(p=y.next()).done);o=!0){var m=p.value,g=new hk;g.seed(m.$e()),ak.Te.ce(v,g.qe(n.kind)),a.push(g)}}catch(e){u=!0,s=e}finally{try{o||null==y.return||y.return()}finally{if(u)throw s}}}}catch(e){l=!0,h=e}finally{try{c||null==d.return||d.return()}finally{if(l)throw h}}return a}},{key:"ln",value:function(e,t){return!!e.filters.find((function(e){return e instanceof Xp&&e.field.isEqual(t)&&("in"===e.op||"not-in"===e.op)}))}},{key:"getFieldIndexes",value:function(t,n){var r=this,i=xk(t),a=Ik(t);return(n?i.W("collectionGroupIndex",IDBKeyRange.bound(n,n)):i.W()).next((function(t){var n=r,i=[];return Mv.forEach(t,(function(t){return a.get([t.indexId,n.uid]).next((function(n){var r,a,o,u;i.push((r=t,o=(a=n)?new Sv(a.sequenceNumber,new Nv(Wg(a.readTime),new xv(fg(a.documentKey)),a.largestBatchId)):Sv.empty(),u=r.fields.map((function(t){var n=e(y)(t,2),r=n[0],i=n[1];return new Ev(bv.fromServerFormat(r),i)})),new Iv(r.indexId,r.collectionGroup,u,o)))}))})).next((function(){return i}))}))}},{key:"getNextCollectionGroupToUpdate",value:function(e){return this.getFieldIndexes(e).next((function(e){return 0===e.length?null:(e.sort((function(e,t){var n=e.indexState.sequenceNumber-t.indexState.sequenceNumber;return 0!==n?n:dv(e.collectionGroup,t.collectionGroup)})),e[0].collectionGroup)}))}},{key:"updateCollectionGroup",value:function(e,t,n){var r=this,i=xk(e),a=Ik(e);return this._n(e).next((function(e){return i.W("collectionGroupIndex",IDBKeyRange.bound(t,t)).next((function(t){return Mv.forEach(t,(function(t){return a.put($g(t.indexId,r.user,e,n))}))}))}))}},{key:"updateIndexEntries",value:function(e,t){var n=this,r=new Map;return Mv.forEach(t,(function(t,i){var a=n,o=r.get(t.collectionGroup);return(o?Mv.resolve(o):n.getFieldIndexes(e,t.collectionGroup)).next((function(n){return r.set(t.collectionGroup,n),Mv.forEach(n,(function(n){return a.wn(e,t,n).next((function(t){var r=a.mn(i,n);return t.isEqual(r)?Mv.resolve():a.gn(e,i,n,t,r)}))}))}))}))}},{key:"yn",value:function(e,t,n,r){return bk(e).put({indexId:r.indexId,uid:this.uid,arrayValue:r.arrayValue,directionalValue:r.directionalValue,orderedDocumentKey:this.hn(n,t.key),documentKey:t.key.path.toArray()})}},{key:"pn",value:function(e,t,n,r){return bk(e).delete([r.indexId,this.uid,r.arrayValue,r.directionalValue,this.hn(n,t.key),t.key.path.toArray()])}},{key:"wn",value:function(e,t,n){var r=bk(e),i=new tp(dk);return r.Z({index:"documentKeyIndex",range:IDBKeyRange.only([n.indexId,this.uid,this.hn(n,t)])},(function(e,r){i=i.add(new fk(n.indexId,t,r.arrayValue,r.directionalValue))})).next((function(){return i}))}},{key:"mn",value:function(e,t){var n=new tp(dk),r=this.an(t,e);if(null==r)return n;var i=_v(t);if(null!=i){var a=e.data.field(i.fieldPath),o=!0,u=!1,s=void 0;if(Np(a))try{for(var c,l=(a.arrayValue.values||[])[Symbol.iterator]();!(o=(c=l.next()).done);o=!0){var h=c.value;n=n.add(new fk(t.indexId,e.key,this.on(h),r))}}catch(e){u=!0,s=e}finally{try{o||null==l.return||l.return()}finally{if(u)throw s}}}else n=n.add(new fk(t.indexId,e.key,gk,r));return n}},{key:"gn",value:function(e,t,n,r,i){var a=this;Hd("IndexedDbIndexManager","Updating index entries for document '%s'",t.key);var o=[];return function(e,t,n,r,i){for(var a=e.getIterator(),o=t.getIterator(),u=rp(a),s=rp(o);u||s;){var c=!1,l=!1;if(u&&s){var h=n(u,s);h<0?l=!0:h>0&&(c=!0)}else null!=u?l=!0:c=!0;c?(r(s),s=rp(o)):l?(i(u),u=rp(a)):(u=rp(a),s=rp(o))}}(r,i,dk,(function(r){o.push(a.yn(e,t,n,r))}),(function(r){o.push(a.pn(e,t,n,r))})),Mv.waitFor(o)}},{key:"_n",value:function(e){var t=1;return Ik(e).Z({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(function(e,n,r){r.done(),t=n.sequenceNumber+1})).next((function(){return t}))}},{key:"createRange",value:function(e,t,n){n=n.sort((function(e,t){return dk(e,t)})).filter((function(e,t,n){return!t||0!==dk(e,n[t-1])}));var r=[];r.push(e);var i=!0,a=!1,o=void 0;try{for(var u,s=n[Symbol.iterator]();!(i=(u=s.next()).done);i=!0){var c=u.value,l=dk(c,e),h=dk(c,t);if(0===l)r[0]=e.Ke();else if(l>0&&h<0)r.push(c),r.push(c.Ke());else if(h>0)break}}catch(e){a=!0,o=e}finally{try{i||null==s.return||s.return()}finally{if(a)throw o}}r.push(t);for(var f=[],d=0;d<r.length;d+=2)f.push(IDBKeyRange.bound([r[d].indexId,this.uid,r[d].arrayValue,r[d].directionalValue,gk,[]],[r[d+1].indexId,this.uid,r[d+1].arrayValue,r[d+1].directionalValue,gk,[]]));return f}},{key:"getMinOffsetFromCollectionGroup",value:function(e,t){return this.getFieldIndexes(e,t).next(_k)}},{key:"getMinOffset",value:function(e,t){var n=this;return Mv.mapArray(this.tn(t),(function(t){return n.en(e,t).next((function(e){return e||Xd()}))})).next(_k)}}]),t}();
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wk(e){return Fg(e,"collectionParents")}function bk(e){return Fg(e,"indexEntries")}function xk(e){return Fg(e,"indexConfiguration")}function Ik(e){return Fg(e,"indexState")}function _k(e){Zd(0!==e.length);for(var t=e[0].indexState.offset,n=t.largestBatchId,r=1;r<e.length;r++){var i=e[r].indexState.offset;Dv(i,t)<0&&(t=i),n<i.largestBatchId&&(n=i.largestBatchId)}return new Nv(t.readTime,t.documentKey,n)}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Tk={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Ek=function(){"use strict";function t(n,r,i){e(s)(this,t),this.cacheSizeCollectionThreshold=n,this.percentileToCollect=r,this.maximumSequenceNumbersToCollect=i}return e(c)(t,null,[{key:"withCacheSize",value:function(e){return new t(e,t.DEFAULT_COLLECTION_PERCENTILE,t.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}]),t}();
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function Sk(e,t,n){var r=e.store("mutations"),i=e.store("documentMutations"),a=[],o=IDBKeyRange.only(n.batchId),u=0,s=r.Z({range:o},(function(e,t,n){return u++,n.delete()}));a.push(s.next((function(){Zd(1===u)})));var c=[],l=!0,h=!1,f=void 0;try{for(var d,v=n.mutations[Symbol.iterator]();!(l=(d=v.next()).done);l=!0){var p=d.value,y=pg(t,p.key.path,n.batchId);a.push(i.delete(y)),c.push(p.key)}}catch(e){h=!0,f=e}finally{try{l||null==v.return||v.return()}finally{if(h)throw f}}return Mv.waitFor(a).next((function(){return c}))}function Ak(e){if(!e)return 0;var t;if(e.document)t=e.document;else if(e.unknownDocument)t=e.unknownDocument;else{if(!e.noDocument)throw Xd();t=e.noDocument}return JSON.stringify(t).length}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Ek.DEFAULT_COLLECTION_PERCENTILE=10,Ek.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Ek.DEFAULT=new Ek(41943040,Ek.DEFAULT_COLLECTION_PERCENTILE,Ek.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Ek.DISABLED=new Ek(-1,0,0);var Ck=function(){"use strict";function t(n,r,i,a){e(s)(this,t),this.userId=n,this.It=r,this.indexManager=i,this.referenceDelegate=a,this.In={}}return e(c)(t,[{key:"checkEmpty",value:function(e){var t=!0,n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Dk(e).Z({index:"userMutationsIndex",range:n},(function(e,n,r){t=!1,r.done()})).next((function(){return t}))}},{key:"addMutationBatch",value:function(e,t,n,r){var i=this,a=Rk(e),o=Dk(e);return o.add({}).next((function(u){var s=i;Zd("number"==typeof u);var c=new Vg(u,t,n,r),l=function(e,t,n){var r=n.baseMutations.map((function(t){return Xm(e.re,t)})),i=n.mutations.map((function(t){return Xm(e.re,t)}));return{userId:t,batchId:n.batchId,localWriteTimeMs:n.localWriteTime.toMillis(),baseMutations:r,mutations:i}}(i.It,i.userId,c),h=[],f=new tp((function(e,t){return dv(e.canonicalString(),t.canonicalString())})),d=!0,v=!1,p=void 0;try{for(var y,m=r[Symbol.iterator]();!(d=(y=m.next()).done);d=!0){var g=y.value,k=pg(i.userId,g.key.path,u);f=f.add(g.key.path.popLast()),h.push(o.put(l)),h.push(a.put(k,yg))}}catch(e){v=!0,p=e}finally{try{d||null==m.return||m.return()}finally{if(v)throw p}}return f.forEach((function(t){h.push(s.indexManager.addToCollectionParentIndex(e,t))})),e.addOnCommittedListener((function(){s.In[u]=c.keys()})),Mv.waitFor(h).next((function(){return c}))}))}},{key:"lookupMutationBatch",value:function(e,t){var n=this;return Dk(e).get(t).next((function(e){return e?(Zd(e.userId===n.userId),Hg(n.It,e)):null}))}},{key:"Tn",value:function(e,t){var n=this;return this.In[t]?Mv.resolve(this.In[t]):this.lookupMutationBatch(e,t).next((function(e){if(e){var r=e.keys();return n.In[t]=r,r}return null}))}},{key:"getNextMutationBatchAfterBatchId",value:function(e,t){var n=this,r=t+1,i=IDBKeyRange.lowerBound([this.userId,r]),a=null;return Dk(e).Z({index:"userMutationsIndex",range:i},(function(e,t,i){t.userId===n.userId&&(Zd(t.batchId>=r),a=Hg(n.It,t)),i.done()})).next((function(){return a}))}},{key:"getHighestUnacknowledgedBatchId",value:function(e){var t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),n=-1;return Dk(e).Z({index:"userMutationsIndex",range:t,reverse:!0},(function(e,t,r){n=t.batchId,r.done()})).next((function(){return n}))}},{key:"getAllMutationBatches",value:function(e){var t=this,n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Dk(e).W("userMutationsIndex",n).next((function(e){return e.map((function(e){return Hg(t.It,e)}))}))}},{key:"getAllMutationBatchesAffectingDocumentKey",value:function(t,n){var r=this,i=vg(this.userId,n.path),a=IDBKeyRange.lowerBound(i),o=[];return Rk(t).Z({range:a},(function(i,a,u){var s=r,c=e(y)(i,3),l=c[0],h=c[1],f=c[2],d=fg(h);if(l===r.userId&&n.path.isEqual(d))return Dk(t).get(f).next((function(e){if(!e)throw Xd();Zd(e.userId===s.userId),o.push(Hg(s.It,e))}));u.done()})).next((function(){return o}))}},{key:"getAllMutationBatchesAffectingDocumentKeys",value:function(t,n){var r=this,i=new tp(dv),a=[];return n.forEach((function(n){var o=r,u=vg(r.userId,n.path),s=IDBKeyRange.lowerBound(u),c=Rk(t).Z({range:s},(function(t,r,a){var u=e(y)(t,3),s=u[0],c=u[1],l=u[2],h=fg(c);s===o.userId&&n.path.isEqual(h)?i=i.add(l):a.done()}));a.push(c)})),Mv.waitFor(a).next((function(){return r.En(t,i)}))}},{key:"getAllMutationBatchesAffectingQuery",value:function(t,n){var r=this,i=n.path,a=i.length+1,o=vg(this.userId,i),u=IDBKeyRange.lowerBound(o),s=new tp(dv);return Rk(t).Z({range:u},(function(t,n,o){var u=e(y)(t,3),c=u[0],l=u[1],h=u[2],f=fg(l);c===r.userId&&i.isPrefixOf(f)?f.length===a&&(s=s.add(h)):o.done()})).next((function(){return r.En(t,s)}))}},{key:"En",value:function(e,t){var n=this,r=[],i=[];return t.forEach((function(t){var a=n;i.push(Dk(e).get(t).next((function(e){if(null===e)throw Xd();Zd(e.userId===a.userId),r.push(Hg(a.It,e))})))})),Mv.waitFor(i).next((function(){return r}))}},{key:"removeMutationBatch",value:function(e,t){var n=this;return Sk(e.ie,this.userId,t).next((function(r){return e.addOnCommittedListener((function(){n.An(t.batchId)})),Mv.forEach(r,(function(t){return n.referenceDelegate.markPotentiallyOrphaned(e,t)}))}))}},{key:"An",value:function(e){delete this.In[e]}},{key:"performConsistencyCheck",value:function(e){var t=this;return this.checkEmpty(e).next((function(n){var r=t;if(!n)return Mv.resolve();var i=IDBKeyRange.lowerBound([t.userId]),a=[];return Rk(e).Z({range:i},(function(e,t,n){if(e[0]===r.userId){var i=fg(e[1]);a.push(i)}else n.done()})).next((function(){Zd(0===a.length)}))}))}},{key:"containsKey",value:function(e,t){return Nk(e,this.userId,t)}},{key:"Rn",value:function(e){var t=this;return Ok(e).get(this.userId).next((function(e){return e||{userId:t.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""}}))}}],[{key:"oe",value:function(e,n,r,i){return Zd(""!==e.uid),new t(e.isAuthenticated()?e.uid:"",n,r,i)}}]),t}();function Nk(t,n,r){var i=vg(n,r.path),a=i[1],o=IDBKeyRange.lowerBound(i),u=!1;return Rk(t).Z({range:o,X:!0},(function(t,r,i){var o=e(y)(t,3),s=o[0],c=o[1];o[2];s===n&&c===a&&(u=!0),i.done()})).next((function(){return u}))}function Dk(e){return Fg(e,"mutations")}function Rk(e){return Fg(e,"documentMutations")}function Ok(e){return Fg(e,"mutationQueues")}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Pk=function(){"use strict";function t(n){e(s)(this,t),this.bn=n}return e(c)(t,[{key:"next",value:function(){return this.bn+=2,this.bn}}],[{key:"Pn",value:function(){return new t(0)}},{key:"vn",value:function(){return new t(-1)}}]),t}(),Lk=function(){"use strict";function t(n,r){e(s)(this,t),this.referenceDelegate=n,this.It=r}return e(c)(t,[{key:"allocateTargetId",value:function(e){var t=this;return this.Vn(e).next((function(n){var r=new Pk(n.highestTargetId);return n.highestTargetId=r.next(),t.Sn(e,n).next((function(){return n.highestTargetId}))}))}},{key:"getLastRemoteSnapshotVersion",value:function(e){return this.Vn(e).next((function(e){return mv.fromTimestamp(new yv(e.lastRemoteSnapshotVersion.seconds,e.lastRemoteSnapshotVersion.nanoseconds))}))}},{key:"getHighestSequenceNumber",value:function(e){return this.Vn(e).next((function(e){return e.highestListenSequenceNumber}))}},{key:"setTargetsMetadata",value:function(e,t,n){var r=this;return this.Vn(e).next((function(i){return i.highestListenSequenceNumber=t,n&&(i.lastRemoteSnapshotVersion=n.toTimestamp()),t>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=t),r.Sn(e,i)}))}},{key:"addTargetData",value:function(e,t){var n=this;return this.Dn(e,t).next((function(){return n.Vn(e).next((function(r){return r.targetCount+=1,n.Cn(t,r),n.Sn(e,r)}))}))}},{key:"updateTargetData",value:function(e,t){return this.Dn(e,t)}},{key:"removeTargetData",value:function(e,t){var n=this;return this.removeMatchingKeysForTargetId(e,t.targetId).next((function(){return Mk(e).delete(t.targetId)})).next((function(){return n.Vn(e)})).next((function(t){return Zd(t.targetCount>0),t.targetCount-=1,n.Sn(e,t)}))}},{key:"removeTargets",value:function(e,t,n){var r=this,i=0,a=[];return Mk(e).Z((function(o,u){var s=Qg(u);s.sequenceNumber<=t&&null===n.get(s.targetId)&&(i++,a.push(r.removeTargetData(e,s)))})).next((function(){return Mv.waitFor(a)})).next((function(){return i}))}},{key:"forEachTarget",value:function(e,t){return Mk(e).Z((function(e,n){var r=Qg(n);t(r)}))}},{key:"Vn",value:function(e){return Fk(e).get("targetGlobalKey").next((function(e){return Zd(null!==e),e}))}},{key:"Sn",value:function(e,t){return Fk(e).put("targetGlobalKey",t)}},{key:"Dn",value:function(e,t){return Mk(e).put(Yg(this.It,t))}},{key:"Cn",value:function(e,t){var n=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,n=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,n=!0),n}},{key:"getTargetCount",value:function(e){return this.Vn(e).next((function(e){return e.targetCount}))}},{key:"getTargetData",value:function(e,t){var n=zp(t),r=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]),i=null;return Mk(e).Z({range:r,index:"queryTargetsIndex"},(function(e,n,r){var a=Qg(n);Wp(t,a.target)&&(i=a,r.done())})).next((function(){return i}))}},{key:"addMatchingKeys",value:function(e,t,n){var r=this,i=[],a=Vk(e);return t.forEach((function(t){var o=cg(t.path);i.push(a.put({targetId:n,path:o})),i.push(r.referenceDelegate.addReference(e,n,t))})),Mv.waitFor(i)}},{key:"removeMatchingKeys",value:function(e,t,n){var r=this,i=Vk(e);return Mv.forEach(t,(function(t){var a=cg(t.path);return Mv.waitFor([i.delete([n,a]),r.referenceDelegate.removeReference(e,n,t)])}))}},{key:"removeMatchingKeysForTargetId",value:function(e,t){var n=Vk(e),r=IDBKeyRange.bound([t],[t+1],!1,!0);return n.delete(r)}},{key:"getMatchingKeysForTargetId",value:function(e,t){var n=IDBKeyRange.bound([t],[t+1],!1,!0),r=Vk(e),i=xm();return r.Z({range:n,X:!0},(function(e,t,n){var r=fg(e[1]),a=new xv(r);i=i.add(a)})).next((function(){return i}))}},{key:"containsKey",value:function(t,n){var r=cg(n.path),i=IDBKeyRange.bound([r],[pv(r)],!1,!0),a=0;return Vk(t).Z({index:"documentTargetsIndex",X:!0,range:i},(function(t,n,r){var i=e(y)(t,2),o=i[0];i[1];0!==o&&(a++,r.done())})).next((function(){return a>0}))}},{key:"se",value:function(e,t){return Mk(e).get(t).next((function(e){return e?Qg(e):null}))}}]),t}();
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mk(e){return Fg(e,"targets")}function Fk(e){return Fg(e,"targetGlobal")}function Vk(e){return Fg(e,"targetDocuments")}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Uk(t,n){var r=e(y)(t,2),i=r[0],a=r[1],o=e(y)(n,2),u=o[0],s=o[1],c=dv(i,u);return 0===c?dv(a,s):c}var Bk=function(){"use strict";function t(n){e(s)(this,t),this.xn=n,this.buffer=new tp(Uk),this.Nn=0}return e(c)(t,[{key:"kn",value:function(){return++this.Nn}},{key:"Mn",value:function(e){var t=[e,this.kn()];if(this.buffer.size<this.xn)this.buffer=this.buffer.add(t);else{var n=this.buffer.last();Uk(t,n)<0&&(this.buffer=this.buffer.delete(n).add(t))}}},{key:"maxValue",get:function(){return this.buffer.last()[0]}}]),t}(),qk=function(){"use strict";function t(n,r,i){e(s)(this,t),this.garbageCollector=n,this.asyncQueue=r,this.localStore=i,this.On=null}return e(c)(t,[{key:"start",value:function(){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.Fn(6e4)}},{key:"stop",value:function(){this.On&&(this.On.cancel(),this.On=null)}},{key:"started",get:function(){return null!==this.On}},{key:"Fn",value:function(t){var n=this;Hd("LruGarbageCollector","Garbage collection scheduled in ".concat(t,"ms")),this.On=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",t,e(ve)(e(ye).mark((function t(){return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.On=null,e.prev=1,e.next=4,n.localStore.collectGarbage(n.garbageCollector);case 4:e.next=14;break;case 6:if(e.prev=6,e.t0=e.catch(1),!qv(e.t0)){e.next=12;break}Hd("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",e.t0),e.next=14;break;case 12:return e.next=14,Pv(e.t0);case 14:return e.next=16,n.Fn(3e5);case 16:case"end":return e.stop()}}),t,null,[[1,6]])}))))}}]),t}(),jk=function(){"use strict";function t(n,r){e(s)(this,t),this.$n=n,this.params=r}return e(c)(t,[{key:"calculateTargetCount",value:function(e,t){return this.$n.Bn(e).next((function(e){return Math.floor(t/100*e)}))}},{key:"nthSequenceNumber",value:function(e,t){var n=this;if(0===t)return Mv.resolve(Qv.at);var r=new Bk(t);return this.$n.forEachTarget(e,(function(e){return r.Mn(e.sequenceNumber)})).next((function(){return n.$n.Ln(e,(function(e){return r.Mn(e)}))})).next((function(){return r.maxValue}))}},{key:"removeTargets",value:function(e,t,n){return this.$n.removeTargets(e,t,n)}},{key:"removeOrphanedDocuments",value:function(e,t){return this.$n.removeOrphanedDocuments(e,t)}},{key:"collect",value:function(e,t){var n=this;return-1===this.params.cacheSizeCollectionThreshold?(Hd("LruGarbageCollector","Garbage collection skipped; disabled"),Mv.resolve(Tk)):this.getCacheSize(e).next((function(r){return r<n.params.cacheSizeCollectionThreshold?(Hd("LruGarbageCollector","Garbage collection skipped; Cache size ".concat(r," is lower than threshold ").concat(n.params.cacheSizeCollectionThreshold)),Tk):n.Un(e,t)}))}},{key:"getCacheSize",value:function(e){return this.$n.getCacheSize(e)}},{key:"Un",value:function(e,t){var n,r,i,a,o,u,s,c=this,l=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((function(t){return t>c.params.maximumSequenceNumbersToCollect?(Hd("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of ".concat(c.params.maximumSequenceNumbersToCollect," from ").concat(t)),r=c.params.maximumSequenceNumbersToCollect):r=t,a=Date.now(),c.nthSequenceNumber(e,r)})).next((function(r){return n=r,o=Date.now(),c.removeTargets(e,n,t)})).next((function(t){return i=t,u=Date.now(),c.removeOrphanedDocuments(e,n)})).next((function(e){return s=Date.now(),Wd()<=Ie.DEBUG&&Hd("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in ".concat(a-l,"ms\n\tDetermined least recently used ").concat(r," in ")+(o-a)+"ms\n"+"\tRemoved ".concat(i," targets in ")+(u-o)+"ms\n"+"\tRemoved ".concat(e," documents in ")+(s-u)+"ms\n"+"Total Duration: ".concat(s-l,"ms")),Mv.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:i,documentsRemoved:e})}))}}]),t}(),Gk=function(){"use strict";function t(n,r){e(s)(this,t),this.db=n,this.garbageCollector=new jk(this,r)}return e(c)(t,[{key:"Bn",value:function(e){var t=this.qn(e);return this.db.getTargetCache().getTargetCount(e).next((function(e){return t.next((function(t){return e+t}))}))}},{key:"qn",value:function(e){var t=0;return this.Ln(e,(function(e){t++})).next((function(){return t}))}},{key:"forEachTarget",value:function(e,t){return this.db.getTargetCache().forEachTarget(e,t)}},{key:"Ln",value:function(e,t){return this.Kn(e,(function(e,n){return t(n)}))}},{key:"addReference",value:function(e,t,n){return Kk(e,n)}},{key:"removeReference",value:function(e,t,n){return Kk(e,n)}},{key:"removeTargets",value:function(e,t,n){return this.db.getTargetCache().removeTargets(e,t,n)}},{key:"markPotentiallyOrphaned",value:function(e,t){return Kk(e,t)}},{key:"Gn",value:function(e,t){return r=t,i=!1,Ok(n=e).tt((function(e){return Nk(n,e,r).next((function(e){return e&&(i=!0),Mv.resolve(!e)}))})).next((function(){return i}));var n,r,i}},{key:"removeOrphanedDocuments",value:function(e,t){var n=this,r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[],a=0;return this.Kn(e,(function(o,u){if(u<=t){var s=n.Gn(e,o).next((function(t){if(!t)return a++,r.getEntry(e,o).next((function(){return r.removeEntry(o,mv.min()),Vk(e).delete([0,cg(o.path)])}))}));i.push(s)}})).next((function(){return Mv.waitFor(i)})).next((function(){return r.apply(e)})).next((function(){return a}))}},{key:"removeTarget",value:function(e,t){var n=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,n)}},{key:"updateLimboDocument",value:function(e,t){return Kk(e,t)}},{key:"Kn",value:function(t,n){var r,i=Vk(t),a=Qv.at;return i.Z({index:"documentTargetsIndex"},(function(t,i){var o=e(y)(t,2),u=o[0],s=(o[1],i.path),c=i.sequenceNumber;0===u?(a!==Qv.at&&n(new xv(fg(r)),a),a=c,r=s):a=Qv.at})).next((function(){a!==Qv.at&&n(new xv(fg(r)),a)}))}},{key:"getCacheSize",value:function(e){return this.db.getRemoteDocumentCache().getSize(e)}}]),t}();function Kk(e,t){return Vk(e).put((n=t,r=e.currentSequenceNumber,{targetId:0,path:cg(n.path),sequenceNumber:r}));var n,r}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var zk=function(){"use strict";function t(){e(s)(this,t),this.changes=new hm((function(e){return e.toString()}),(function(e,t){return e.isEqual(t)})),this.changesApplied=!1}return e(c)(t,[{key:"addEntry",value:function(e){this.assertNotApplied(),this.changes.set(e.key,e)}},{key:"removeEntry",value:function(e,t){this.assertNotApplied(),this.changes.set(e,jp.newInvalidDocument(e).setReadTime(t))}},{key:"getEntry",value:function(e,t){this.assertNotApplied();var n=this.changes.get(t);return void 0!==n?Mv.resolve(n):this.getFromCache(e,t)}},{key:"getEntries",value:function(e,t){return this.getAllFromCache(e,t)}},{key:"apply",value:function(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}},{key:"assertNotApplied",value:function(){}}]),t}(),Wk=function(){"use strict";function t(n){e(s)(this,t),this.It=n}return e(c)(t,[{key:"setIndexManager",value:function(e){this.indexManager=e}},{key:"addEntry",value:function(e,t,n){return Jk(e).put(n)}},{key:"removeEntry",value:function(e,t,n){return Jk(e).delete((r=n,[(i=t.path.toArray()).slice(0,i.length-2),i[i.length-2],Kg(r),i[i.length-1]]));var r,i}},{key:"updateMetadata",value:function(e,t){var n=this;return this.getMetadata(e).next((function(r){return r.byteSize+=t,n.Qn(e,r)}))}},{key:"getEntry",value:function(e,t){var n=this,r=jp.newInvalidDocument(t);return Jk(e).Z({index:"documentKeyIndex",range:IDBKeyRange.only(Xk(t))},(function(e,i){r=n.jn(t,i)})).next((function(){return r}))}},{key:"Wn",value:function(e,t){var n=this,r={size:0,document:jp.newInvalidDocument(t)};return Jk(e).Z({index:"documentKeyIndex",range:IDBKeyRange.only(Xk(t))},(function(e,i){r={document:n.jn(t,i),size:Ak(i)}})).next((function(){return r}))}},{key:"getEntries",value:function(e,t){var n=this,r=dm();return this.zn(e,t,(function(e,t){var i=n.jn(e,t);r=r.insert(e,i)})).next((function(){return r}))}},{key:"Hn",value:function(e,t){var n=this,r=dm(),i=new Zv(xv.comparator);return this.zn(e,t,(function(e,t){var a=n.jn(e,t);r=r.insert(e,a),i=i.insert(e,Ak(t))})).next((function(){return{documents:r,Jn:i}}))}},{key:"zn",value:function(t,n,r){if(n.isEmpty())return Mv.resolve();var i=new tp($k);n.forEach((function(e){return i=i.add(e)}));var a=IDBKeyRange.bound(Xk(i.first()),Xk(i.last())),o=i.getIterator(),u=o.getNext();return Jk(t).Z({index:"documentKeyIndex",range:a},(function(t,n,i){for(var a=xv.fromSegments(e(x)(n.prefixPath).concat([n.collectionGroup,n.documentId]));u&&$k(u,a)<0;)r(u,null),u=o.getNext();u&&u.isEqual(a)&&(r(u,n),u=o.hasNext()?o.getNext():null),u?i.j(Xk(u)):i.done()})).next((function(){for(;u;)r(u,null),u=o.hasNext()?o.getNext():null}))}},{key:"getAllFromCollection",value:function(e,t,n){var r=this,i=[t.popLast().toArray(),t.lastSegment(),Kg(n.readTime),n.documentKey.path.isEmpty()?"":n.documentKey.path.lastSegment()],a=[t.popLast().toArray(),t.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Jk(e).W(IDBKeyRange.bound(i,a,!0)).next((function(e){var t=dm(),n=!0,i=!1,a=void 0;try{for(var o,u=e[Symbol.iterator]();!(n=(o=u.next()).done);n=!0){var s=o.value,c=r.jn(xv.fromSegments(s.prefixPath.concat(s.collectionGroup,s.documentId)),s);t=t.insert(c.key,c)}}catch(e){i=!0,a=e}finally{try{n||null==u.return||u.return()}finally{if(i)throw a}}return t}))}},{key:"getAllFromCollectionGroup",value:function(e,t,n,r){var i=this,a=dm(),o=Zk(t,n),u=Zk(t,Nv.max());return Jk(e).Z({index:"collectionGroupIndex",range:IDBKeyRange.bound(o,u,!0)},(function(e,t,n){var o=i.jn(xv.fromSegments(t.prefixPath.concat(t.collectionGroup,t.documentId)),t);(a=a.insert(o.key,o)).size===r&&n.done()})).next((function(){return a}))}},{key:"newChangeBuffer",value:function(e){return new Qk(this,!!e&&e.trackRemovals)}},{key:"getSize",value:function(e){return this.getMetadata(e).next((function(e){return e.byteSize}))}},{key:"getMetadata",value:function(e){return Yk(e).get("remoteDocumentGlobalKey").next((function(e){return Zd(!!e),e}))}},{key:"Qn",value:function(e,t){return Yk(e).put("remoteDocumentGlobalKey",t)}},{key:"jn",value:function(e,t){if(t){var n=function(e,t){var n,r,i;if(t.document)n=Jm(e.re,t.document,!!t.hasCommittedMutations);else if(t.noDocument){var a=xv.fromSegments(t.noDocument.path),o=Wg(t.noDocument.readTime);n=jp.newNoDocument(a,o),t.hasCommittedMutations&&n.setHasCommittedMutations()}else{if(!t.unknownDocument)return Xd();var u=xv.fromSegments(t.unknownDocument.path),s=Wg(t.unknownDocument.version);n=jp.newUnknownDocument(u,s)}return t.readTime&&n.setReadTime((r=t.readTime,i=new yv(r[0],r[1]),mv.fromTimestamp(i))),n}(this.It,t);if(!n.isNoDocument()||!n.version.isEqual(mv.min()))return n}return jp.newInvalidDocument(e)}}]),t}();
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hk(e){return new Wk(e)}var Qk=function(t){"use strict";e(d)(r,t);var n=e(L)(r);function r(t,i){var a;return e(s)(this,r),(a=n.call(this)).Yn=t,a.trackRemovals=i,a.Xn=new hm((function(e){return e.toString()}),(function(e,t){return e.isEqual(t)})),e(wc)(a)}return e(c)(r,[{key:"applyChanges",value:function(e){var t=this,n=[],r=0,i=new tp((function(e,t){return dv(e.canonicalString(),t.canonicalString())}));return this.changes.forEach((function(a,o){var u=t.Xn.get(a);if(n.push(t.Yn.removeEntry(e,a,u.readTime)),o.isValidDocument()){var s=Gg(t.Yn.It,o);i=i.add(a.path.popLast());var c=Ak(s);r+=c-u.size,n.push(t.Yn.addEntry(e,a,s))}else if(r-=u.size,t.trackRemovals){var l=Gg(t.Yn.It,o.convertToNoDocument(mv.min()));n.push(t.Yn.addEntry(e,a,l))}})),i.forEach((function(r){n.push(t.Yn.indexManager.addToCollectionParentIndex(e,r))})),n.push(this.Yn.updateMetadata(e,r)),Mv.waitFor(n)}},{key:"getFromCache",value:function(e,t){var n=this;return this.Yn.Wn(e,t).next((function(e){return n.Xn.set(t,{size:e.size,readTime:e.document.readTime}),e.document}))}},{key:"getAllFromCache",value:function(e,t){var n=this;return this.Yn.Hn(e,t).next((function(e){var t=e.documents;return e.Jn.forEach((function(e,r){n.Xn.set(e,{size:r,readTime:t.get(e).readTime})})),t}))}}]),r}(zk);function Yk(e){return Fg(e,"remoteDocumentGlobal")}function Jk(e){return Fg(e,"remoteDocumentsV14")}function Xk(e){var t=e.path.toArray();return[t.slice(0,t.length-2),t[t.length-2],t[t.length-1]]}function Zk(e,t){var n=t.documentKey.path.toArray();return[e,Kg(t.readTime),n.slice(0,n.length-2),n.length>0?n[n.length-1]:""]}function $k(e,t){for(var n=e.path.toArray(),r=t.path.toArray(),i=0,a=0;a<n.length-2&&a<r.length-2;++a)if(i=dv(n[a],r[a]))return i;return(i=dv(n.length,r.length))||((i=dv(n[n.length-2],r[r.length-2]))||dv(n[n.length-1],r[r.length-1]))}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ew=function t(n,r){"use strict";e(s)(this,t),this.overlayedDocument=n,this.mutatedFields=r},tw=function(){"use strict";function t(n,r,i,a){e(s)(this,t),this.remoteDocumentCache=n,this.mutationQueue=r,this.documentOverlayCache=i,this.indexManager=a}return e(c)(t,[{key:"getDocument",value:function(e,t){var n=this,r=null;return this.documentOverlayCache.getOverlay(e,t).next((function(i){return r=i,n.getBaseDocument(e,t,r)})).next((function(e){return null!==r&&Jy(r.mutation,e,ip.empty(),yv.now()),e}))}},{key:"getDocuments",value:function(e,t){var n=this;return this.remoteDocumentCache.getEntries(e,t).next((function(t){return n.getLocalViewOfDocuments(e,t,xm()).next((function(){return t}))}))}},{key:"getLocalViewOfDocuments",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:xm(),r=this,i=mm();return this.populateOverlays(e,i,t).next((function(){return r.computeViews(e,t,i,n).next((function(e){var t=pm();return e.forEach((function(e,n){t=t.insert(e,n.overlayedDocument)})),t}))}))}},{key:"getOverlayedDocuments",value:function(e,t){var n=this,r=mm();return this.populateOverlays(e,r,t).next((function(){return n.computeViews(e,t,r,xm())}))}},{key:"populateOverlays",value:function(e,t,n){var r=[];return n.forEach((function(e){t.has(e)||r.push(e)})),this.documentOverlayCache.getOverlays(e,r).next((function(e){e.forEach((function(e,n){t.set(e,n)}))}))}},{key:"computeViews",value:function(e,t,n,r){var i=dm(),a=km(),o=km();return t.forEach((function(e,t){var o=n.get(t.key);r.has(t.key)&&(void 0===o||o.mutation instanceof em)?i=i.insert(t.key,t):void 0!==o&&(a.set(t.key,o.mutation.getFieldMask()),Jy(o.mutation,t,o.mutation.getFieldMask(),yv.now()))})),this.recalculateAndSaveOverlays(e,i).next((function(e){return e.forEach((function(e,t){return a.set(e,t)})),t.forEach((function(e,t){var n;return o.set(e,new ew(t,null!==(n=a.get(e))&&void 0!==n?n:null))})),o}))}},{key:"recalculateAndSaveOverlays",value:function(e,t){var n=this,r=km(),i=new Zv((function(e,t){return e-t})),a=xm();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((function(e){var n=!0,a=!1,o=void 0;try{for(var u,s=function(e,n){var a=n.value;a.keys().forEach((function(e){var n=t.get(e);if(null!==n){var o=r.get(e)||ip.empty();o=a.applyToLocalView(n,o),r.set(e,o);var u=(i.get(a.batchId)||xm()).add(e);i=i.insert(a.batchId,u)}}))},c=e[Symbol.iterator]();!(n=(u=c.next()).done);n=!0)s(0,u)}catch(e){a=!0,o=e}finally{try{n||null==c.return||c.return()}finally{if(a)throw o}}})).next((function(){for(var o=[],u=i.getReverseIterator();u.hasNext();){var s=u.getNext(),c=s.key,l=s.value,h=gm();l.forEach((function(e){if(!a.has(e)){var n=Qy(t.get(e),r.get(e));null!==n&&h.set(e,n),a=a.add(e)}})),o.push(n.documentOverlayCache.saveOverlays(e,c,h))}return Mv.waitFor(o)})).next((function(){return r}))}},{key:"recalculateAndSaveOverlaysForDocumentKeys",value:function(e,t){var n=this;return this.remoteDocumentCache.getEntries(e,t).next((function(t){return n.recalculateAndSaveOverlays(e,t)}))}},{key:"getDocumentsMatchingQuery",value:function(e,t,n){return r=t,xv.isDocumentKey(r.path)&&null===r.collectionGroup&&0===r.filters.length?this.getDocumentsMatchingDocumentQuery(e,t.path):my(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n):this.getDocumentsMatchingCollectionQuery(e,t,n);var r}},{key:"getNextDocuments",value:function(e,t,n,r){var i=this;return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,n,r).next((function(a){var o=i,u=r-a.size>0?i.documentOverlayCache.getOverlaysForCollectionGroup(e,t,n.largestBatchId,r-a.size):Mv.resolve(mm()),s=-1,c=a;return u.next((function(t){return Mv.forEach(t,(function(t,n){return s<n.largestBatchId&&(s=n.largestBatchId),a.get(t)?Mv.resolve():o.getBaseDocument(e,t,n).next((function(e){c=c.insert(t,e)}))})).next((function(){return o.populateOverlays(e,t,a)})).next((function(){return o.computeViews(e,c,t,xm())})).next((function(e){return{batchId:s,changes:ym(e)}}))}))}))}},{key:"getDocumentsMatchingDocumentQuery",value:function(e,t){return this.getDocument(e,new xv(t)).next((function(e){var t=pm();return e.isFoundDocument()&&(t=t.insert(e.key,e)),t}))}},{key:"getDocumentsMatchingCollectionGroupQuery",value:function(e,t,n){var r=this,i=t.collectionGroup,a=pm();return this.indexManager.getCollectionParents(e,i).next((function(o){return Mv.forEach(o,(function(o){var u,s,c=(u=t,s=o.child(i),new hy(s,null,u.explicitOrderBy.slice(),u.filters.slice(),u.limit,u.limitType,u.startAt,u.endAt));return r.getDocumentsMatchingCollectionQuery(e,c,n).next((function(e){e.forEach((function(e,t){a=a.insert(e,t)}))}))})).next((function(){return a}))}))}},{key:"getDocumentsMatchingCollectionQuery",value:function(e,t,n){var r,i=this;return this.remoteDocumentCache.getAllFromCollection(e,t.path,n).next((function(a){return r=a,i.documentOverlayCache.getOverlaysForCollection(e,t.path,n.largestBatchId)})).next((function(e){e.forEach((function(e,t){var n=t.getKey();null===r.get(n)&&(r=r.insert(n,jp.newInvalidDocument(n)))}));var n=pm();return r.forEach((function(r,i){var a=e.get(r);void 0!==a&&Jy(a.mutation,i,ip.empty(),yv.now()),_y(t,i)&&(n=n.insert(r,i))})),n}))}},{key:"getBaseDocument",value:function(e,t,n){return null===n||1===n.mutation.type?this.remoteDocumentCache.getEntry(e,t):Mv.resolve(jp.newInvalidDocument(t))}}]),t}(),nw=function(){"use strict";function t(n){e(s)(this,t),this.It=n,this.Zn=new Map,this.ts=new Map}return e(c)(t,[{key:"getBundleMetadata",value:function(e,t){return Mv.resolve(this.Zn.get(t))}},{key:"saveBundleMetadata",value:function(e,t){var n;return this.Zn.set(t.id,{id:(n=t).id,version:n.version,createTime:Bm(n.createTime)}),Mv.resolve()}},{key:"getNamedQuery",value:function(e,t){return Mv.resolve(this.ts.get(t))}},{key:"saveNamedQuery",value:function(e,t){return this.ts.set(t.name,{name:(n=t).name,query:Jg(n.bundledQuery),readTime:Bm(n.readTime)}),Mv.resolve();var n}}]),t}(),rw=function(){"use strict";function t(){e(s)(this,t),this.overlays=new Zv(xv.comparator),this.es=new Map}return e(c)(t,[{key:"getOverlay",value:function(e,t){return Mv.resolve(this.overlays.get(t))}},{key:"getOverlays",value:function(e,t){var n=this,r=mm();return Mv.forEach(t,(function(t){return n.getOverlay(e,t).next((function(e){null!==e&&r.set(t,e)}))})).next((function(){return r}))}},{key:"saveOverlays",value:function(e,t,n){var r=this;return n.forEach((function(n,i){r.ue(e,t,i)})),Mv.resolve()}},{key:"removeOverlaysForBatchId",value:function(e,t,n){var r=this,i=this.es.get(n);return void 0!==i&&(i.forEach((function(e){return r.overlays=r.overlays.remove(e)})),this.es.delete(n)),Mv.resolve()}},{key:"getOverlaysForCollection",value:function(e,t,n){for(var r=mm(),i=t.length+1,a=new xv(t.child("")),o=this.overlays.getIteratorFrom(a);o.hasNext();){var u=o.getNext().value,s=u.getKey();if(!t.isPrefixOf(s.path))break;s.path.length===i&&u.largestBatchId>n&&r.set(u.getKey(),u)}return Mv.resolve(r)}},{key:"getOverlaysForCollectionGroup",value:function(e,t,n,r){for(var i=new Zv((function(e,t){return e-t})),a=this.overlays.getIterator();a.hasNext();){var o=a.getNext().value;if(o.getKey().getCollectionGroup()===t&&o.largestBatchId>n){var u=i.get(o.largestBatchId);null===u&&(u=mm(),i=i.insert(o.largestBatchId,u)),u.set(o.getKey(),o)}}for(var s=mm(),c=i.getIterator();c.hasNext()&&(c.getNext().value.forEach((function(e,t){return s.set(e,t)})),!(s.size()>=r)););return Mv.resolve(s)}},{key:"ue",value:function(e,t,n){var r=this.overlays.get(n.key);if(null!==r){var i=this.es.get(r.largestBatchId).delete(n.key);this.es.set(r.largestBatchId,i)}this.overlays=this.overlays.insert(n.key,new Bg(t,n));var a=this.es.get(t);void 0===a&&(a=xm(),this.es.set(t,a)),this.es.set(t,a.add(n.key))}}]),t}(),iw=function(){"use strict";function t(){e(s)(this,t),this.ns=new tp(aw.ss),this.rs=new tp(aw.os)}return e(c)(t,[{key:"isEmpty",value:function(){return this.ns.isEmpty()}},{key:"addReference",value:function(e,t){var n=new aw(e,t);this.ns=this.ns.add(n),this.rs=this.rs.add(n)}},{key:"us",value:function(e,t){var n=this;e.forEach((function(e){return n.addReference(e,t)}))}},{key:"removeReference",value:function(e,t){this.cs(new aw(e,t))}},{key:"hs",value:function(e,t){var n=this;e.forEach((function(e){return n.removeReference(e,t)}))}},{key:"ls",value:function(e){var t=this,n=new xv(new kv([])),r=new aw(n,e),i=new aw(n,e+1),a=[];return this.rs.forEachInRange([r,i],(function(e){t.cs(e),a.push(e.key)})),a}},{key:"fs",value:function(){var e=this;this.ns.forEach((function(t){return e.cs(t)}))}},{key:"cs",value:function(e){this.ns=this.ns.delete(e),this.rs=this.rs.delete(e)}},{key:"ds",value:function(e){var t=new xv(new kv([])),n=new aw(t,e),r=new aw(t,e+1),i=xm();return this.rs.forEachInRange([n,r],(function(e){i=i.add(e.key)})),i}},{key:"containsKey",value:function(e){var t=new aw(e,0),n=this.ns.firstAfterOrEqual(t);return null!==n&&e.isEqual(n.key)}}]),t}(),aw=function(){"use strict";function t(n,r){e(s)(this,t),this.key=n,this._s=r}return e(c)(t,null,[{key:"ss",value:function(e,t){return xv.comparator(e.key,t.key)||dv(e._s,t._s)}},{key:"os",value:function(e,t){return dv(e._s,t._s)||xv.comparator(e.key,t.key)}}]),t}(),ow=function(){"use strict";function t(n,r){e(s)(this,t),this.indexManager=n,this.referenceDelegate=r,this.mutationQueue=[],this.ws=1,this.gs=new tp(aw.ss)}return e(c)(t,[{key:"checkEmpty",value:function(e){return Mv.resolve(0===this.mutationQueue.length)}},{key:"addMutationBatch",value:function(e,t,n,r){var i=this.ws;this.ws++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];var a=new Vg(i,t,n,r);this.mutationQueue.push(a);var o=!0,u=!1,s=void 0;try{for(var c,l=r[Symbol.iterator]();!(o=(c=l.next()).done);o=!0){var h=c.value;this.gs=this.gs.add(new aw(h.key,i)),this.indexManager.addToCollectionParentIndex(e,h.key.path.popLast())}}catch(e){u=!0,s=e}finally{try{o||null==l.return||l.return()}finally{if(u)throw s}}return Mv.resolve(a)}},{key:"lookupMutationBatch",value:function(e,t){return Mv.resolve(this.ys(t))}},{key:"getNextMutationBatchAfterBatchId",value:function(e,t){var n=t+1,r=this.ps(n),i=r<0?0:r;return Mv.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}},{key:"getHighestUnacknowledgedBatchId",value:function(){return Mv.resolve(0===this.mutationQueue.length?-1:this.ws-1)}},{key:"getAllMutationBatches",value:function(e){return Mv.resolve(this.mutationQueue.slice())}},{key:"getAllMutationBatchesAffectingDocumentKey",value:function(e,t){var n=this,r=new aw(t,0),i=new aw(t,Number.POSITIVE_INFINITY),a=[];return this.gs.forEachInRange([r,i],(function(e){var t=n.ys(e._s);a.push(t)})),Mv.resolve(a)}},{key:"getAllMutationBatchesAffectingDocumentKeys",value:function(e,t){var n=this,r=new tp(dv);return t.forEach((function(e){var t=new aw(e,0),i=new aw(e,Number.POSITIVE_INFINITY);n.gs.forEachInRange([t,i],(function(e){r=r.add(e._s)}))})),Mv.resolve(this.Is(r))}},{key:"getAllMutationBatchesAffectingQuery",value:function(e,t){var n=t.path,r=n.length+1,i=n;xv.isDocumentKey(i)||(i=i.child(""));var a=new aw(new xv(i),0),o=new tp(dv);return this.gs.forEachWhile((function(e){var t=e.key.path;return!!n.isPrefixOf(t)&&(t.length===r&&(o=o.add(e._s)),!0)}),a),Mv.resolve(this.Is(o))}},{key:"Is",value:function(e){var t=this,n=[];return e.forEach((function(e){var r=t.ys(e);null!==r&&n.push(r)})),n}},{key:"removeMutationBatch",value:function(e,t){var n=this;Zd(0===this.Ts(t.batchId,"removed")),this.mutationQueue.shift();var r=this.gs;return Mv.forEach(t.mutations,(function(i){var a=new aw(i.key,t.batchId);return r=r.delete(a),n.referenceDelegate.markPotentiallyOrphaned(e,i.key)})).next((function(){n.gs=r}))}},{key:"An",value:function(e){}},{key:"containsKey",value:function(e,t){var n=new aw(t,0),r=this.gs.firstAfterOrEqual(n);return Mv.resolve(t.isEqual(r&&r.key))}},{key:"performConsistencyCheck",value:function(e){return this.mutationQueue.length,Mv.resolve()}},{key:"Ts",value:function(e,t){return this.ps(e)}},{key:"ps",value:function(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId}},{key:"ys",value:function(e){var t=this.ps(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}]),t}(),uw=function(){"use strict";function t(n){e(s)(this,t),this.Es=n,this.docs=new Zv(xv.comparator),this.size=0}return e(c)(t,[{key:"setIndexManager",value:function(e){this.indexManager=e}},{key:"addEntry",value:function(e,t){var n=t.key,r=this.docs.get(n),i=r?r.size:0,a=this.Es(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:a}),this.size+=a-i,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}},{key:"removeEntry",value:function(e){var t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}},{key:"getEntry",value:function(e,t){var n=this.docs.get(t);return Mv.resolve(n?n.document.mutableCopy():jp.newInvalidDocument(t))}},{key:"getEntries",value:function(e,t){var n=this,r=dm();return t.forEach((function(e){var t=n.docs.get(e);r=r.insert(e,t?t.document.mutableCopy():jp.newInvalidDocument(e))})),Mv.resolve(r)}},{key:"getAllFromCollection",value:function(e,t,n){for(var r=dm(),i=new xv(t.child("")),a=this.docs.getIteratorFrom(i);a.hasNext();){var o=a.getNext(),u=o.key,s=o.value.document;if(!t.isPrefixOf(u.path))break;u.path.length>t.length+1||Dv(Cv(s),n)<=0||(r=r.insert(s.key,s.mutableCopy()))}return Mv.resolve(r)}},{key:"getAllFromCollectionGroup",value:function(e,t,n,r){Xd()}},{key:"As",value:function(e,t){return Mv.forEach(this.docs,(function(e){return t(e)}))}},{key:"newChangeBuffer",value:function(e){return new sw(this)}},{key:"getSize",value:function(e){return Mv.resolve(this.size)}}]),t}(),sw=function(t){"use strict";e(d)(r,t);var n=e(L)(r);function r(t){var i;return e(s)(this,r),(i=n.call(this)).Yn=t,e(wc)(i)}return e(c)(r,[{key:"applyChanges",value:function(e){var t=this,n=[];return this.changes.forEach((function(r,i){i.isValidDocument()?n.push(t.Yn.addEntry(e,i)):t.Yn.removeEntry(r)})),Mv.waitFor(n)}},{key:"getFromCache",value:function(e,t){return this.Yn.getEntry(e,t)}},{key:"getAllFromCache",value:function(e,t){return this.Yn.getEntries(e,t)}}]),r}(zk),cw=function(){"use strict";function t(n){e(s)(this,t),this.persistence=n,this.Rs=new hm((function(e){return zp(e)}),Wp),this.lastRemoteSnapshotVersion=mv.min(),this.highestTargetId=0,this.bs=0,this.Ps=new iw,this.targetCount=0,this.vs=Pk.Pn()}return e(c)(t,[{key:"forEachTarget",value:function(e,t){return this.Rs.forEach((function(e,n){return t(n)})),Mv.resolve()}},{key:"getLastRemoteSnapshotVersion",value:function(e){return Mv.resolve(this.lastRemoteSnapshotVersion)}},{key:"getHighestSequenceNumber",value:function(e){return Mv.resolve(this.bs)}},{key:"allocateTargetId",value:function(e){return this.highestTargetId=this.vs.next(),Mv.resolve(this.highestTargetId)}},{key:"setTargetsMetadata",value:function(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.bs&&(this.bs=t),Mv.resolve()}},{key:"Dn",value:function(e){this.Rs.set(e.target,e);var t=e.targetId;t>this.highestTargetId&&(this.vs=new Pk(t),this.highestTargetId=t),e.sequenceNumber>this.bs&&(this.bs=e.sequenceNumber)}},{key:"addTargetData",value:function(e,t){return this.Dn(t),this.targetCount+=1,Mv.resolve()}},{key:"updateTargetData",value:function(e,t){return this.Dn(t),Mv.resolve()}},{key:"removeTargetData",value:function(e,t){return this.Rs.delete(t.target),this.Ps.ls(t.targetId),this.targetCount-=1,Mv.resolve()}},{key:"removeTargets",value:function(e,t,n){var r=this,i=0,a=[];return this.Rs.forEach((function(o,u){u.sequenceNumber<=t&&null===n.get(u.targetId)&&(r.Rs.delete(o),a.push(r.removeMatchingKeysForTargetId(e,u.targetId)),i++)})),Mv.waitFor(a).next((function(){return i}))}},{key:"getTargetCount",value:function(e){return Mv.resolve(this.targetCount)}},{key:"getTargetData",value:function(e,t){var n=this.Rs.get(t)||null;return Mv.resolve(n)}},{key:"addMatchingKeys",value:function(e,t,n){return this.Ps.us(t,n),Mv.resolve()}},{key:"removeMatchingKeys",value:function(e,t,n){this.Ps.hs(t,n);var r=this.persistence.referenceDelegate,i=[];return r&&t.forEach((function(t){i.push(r.markPotentiallyOrphaned(e,t))})),Mv.waitFor(i)}},{key:"removeMatchingKeysForTargetId",value:function(e,t){return this.Ps.ls(t),Mv.resolve()}},{key:"getMatchingKeysForTargetId",value:function(e,t){var n=this.Ps.ds(t);return Mv.resolve(n)}},{key:"containsKey",value:function(e,t){return Mv.resolve(this.Ps.containsKey(t))}}]),t}(),lw=function(){"use strict";function t(n,r){var i=this;e(s)(this,t),this.Vs={},this.overlays={},this.Ss=new Qv(0),this.Ds=!1,this.Ds=!0,this.referenceDelegate=n(this),this.Cs=new cw(this),this.indexManager=new yk,this.remoteDocumentCache=new uw((function(e){return i.referenceDelegate.xs(e)})),this.It=new jg(r),this.Ns=new nw(this.It)}return e(c)(t,[{key:"start",value:function(){return Promise.resolve()}},{key:"shutdown",value:function(){return this.Ds=!1,Promise.resolve()}},{key:"started",get:function(){return this.Ds}},{key:"setDatabaseDeletedListener",value:function(){}},{key:"setNetworkEnabled",value:function(){}},{key:"getIndexManager",value:function(e){return this.indexManager}},{key:"getDocumentOverlayCache",value:function(e){var t=this.overlays[e.toKey()];return t||(t=new rw,this.overlays[e.toKey()]=t),t}},{key:"getMutationQueue",value:function(e,t){var n=this.Vs[e.toKey()];return n||(n=new ow(t,this.referenceDelegate),this.Vs[e.toKey()]=n),n}},{key:"getTargetCache",value:function(){return this.Cs}},{key:"getRemoteDocumentCache",value:function(){return this.remoteDocumentCache}},{key:"getBundleCache",value:function(){return this.Ns}},{key:"runTransaction",value:function(e,t,n){var r=this;Hd("MemoryPersistence","Starting transaction:",e);var i=new hw(this.Ss.next());return this.referenceDelegate.ks(),n(i).next((function(e){return r.referenceDelegate.Ms(i).next((function(){return e}))})).toPromise().then((function(e){return i.raiseOnCommittedEvent(),e}))}},{key:"Os",value:function(e,t){return Mv.or(Object.values(this.Vs).map((function(n){return function(){return n.containsKey(e,t)}})))}}]),t}(),hw=function(t){"use strict";e(d)(r,t);var n=e(L)(r);function r(t){var i;return e(s)(this,r),(i=n.call(this)).currentSequenceNumber=t,e(wc)(i)}return r}(Ov),fw=function(){"use strict";function t(n){e(s)(this,t),this.persistence=n,this.Fs=new iw,this.$s=null}return e(c)(t,[{key:"Ls",get:function(){if(this.$s)return this.$s;throw Xd()}},{key:"addReference",value:function(e,t,n){return this.Fs.addReference(n,t),this.Ls.delete(n.toString()),Mv.resolve()}},{key:"removeReference",value:function(e,t,n){return this.Fs.removeReference(n,t),this.Ls.add(n.toString()),Mv.resolve()}},{key:"markPotentiallyOrphaned",value:function(e,t){return this.Ls.add(t.toString()),Mv.resolve()}},{key:"removeTarget",value:function(e,t){var n=this;this.Fs.ls(t.targetId).forEach((function(e){return n.Ls.add(e.toString())}));var r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next((function(e){var t=n;e.forEach((function(e){return t.Ls.add(e.toString())}))})).next((function(){return r.removeTargetData(e,t)}))}},{key:"ks",value:function(){this.$s=new Set}},{key:"Ms",value:function(e){var t=this,n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Mv.forEach(this.Ls,(function(r){var i=xv.fromPath(r);return t.Us(e,i).next((function(e){e||n.removeEntry(i,mv.min())}))})).next((function(){return t.$s=null,n.apply(e)}))}},{key:"updateLimboDocument",value:function(e,t){var n=this;return this.Us(e,t).next((function(e){e?n.Ls.delete(t.toString()):n.Ls.add(t.toString())}))}},{key:"xs",value:function(e){return 0}},{key:"Us",value:function(e,t){var n=this;return Mv.or([function(){return Mv.resolve(n.Fs.containsKey(t))},function(){return n.persistence.getTargetCache().containsKey(e,t)},function(){return n.persistence.Os(e,t)}])}}],[{key:"Bs",value:function(e){return new t(e)}}]),t}(),dw=function(){"use strict";function t(n){e(s)(this,t),this.It=n}return e(c)(t,[{key:"$",value:function(e,t,n,r){var i=this,a=new Fv("createOrUpgrade",t);n<1&&r>=1&&(e.createObjectStore("owner"),function(e){e.createObjectStore("mutationQueues",{keyPath:"userId"}),e.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",dg,{unique:!0}),e.createObjectStore("documentMutations")}(e),vw(e),function(e){e.createObjectStore("remoteDocuments")}(e));var o=Mv.resolve();return n<3&&r>=3&&(0!==n&&(function(e){e.deleteObjectStore("targetDocuments"),e.deleteObjectStore("targets"),e.deleteObjectStore("targetGlobal")}(e),vw(e)),o=o.next((function(){return function(e){var t=e.store("targetGlobal"),n={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:mv.min().toTimestamp(),targetCount:0};return t.put("targetGlobalKey",n)}(a)}))),n<4&&r>=4&&(0!==n&&(o=o.next((function(){return t=e,(n=a).store("mutations").W().next((function(e){t.deleteObjectStore("mutations"),t.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",dg,{unique:!0});var r=n.store("mutations"),i=e.map((function(e){return r.put(e)}));return Mv.waitFor(i)}));var t,n}))),o=o.next((function(){!function(e){e.createObjectStore("clientMetadata",{keyPath:"clientId"})}(e)}))),n<5&&r>=5&&(o=o.next((function(){return i.qs(a)}))),n<6&&r>=6&&(o=o.next((function(){return function(e){e.createObjectStore("remoteDocumentGlobal")}(e),i.Ks(a)}))),n<7&&r>=7&&(o=o.next((function(){return i.Gs(a)}))),n<8&&r>=8&&(o=o.next((function(){return i.Qs(e,a)}))),n<9&&r>=9&&(o=o.next((function(){!function(e){e.objectStoreNames.contains("remoteDocumentChanges")&&e.deleteObjectStore("remoteDocumentChanges")}(e)}))),n<10&&r>=10&&(o=o.next((function(){return i.js(a)}))),n<11&&r>=11&&(o=o.next((function(){!function(e){e.createObjectStore("bundles",{keyPath:"bundleId"})}(e),function(e){e.createObjectStore("namedQueries",{keyPath:"name"})}(e)}))),n<12&&r>=12&&(o=o.next((function(){!function(e){var t=e.createObjectStore("documentOverlays",{keyPath:Ag});t.createIndex("collectionPathOverlayIndex",Cg,{unique:!1}),t.createIndex("collectionGroupOverlayIndex",Ng,{unique:!1})}(e)}))),n<13&&r>=13&&(o=o.next((function(){return function(e){var t=e.createObjectStore("remoteDocumentsV14",{keyPath:mg});t.createIndex("documentKeyIndex",gg),t.createIndex("collectionGroupIndex",kg)}(e)})).next((function(){return i.Ws(e,a)})).next((function(){return e.deleteObjectStore("remoteDocuments")}))),n<14&&r>=14&&(o=o.next((function(){return i.zs(e,a)}))),n<15&&r>=15&&(o=o.next((function(){return function(e){e.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),e.createObjectStore("indexState",{keyPath:_g}).createIndex("sequenceNumberIndex",Tg,{unique:!1}),e.createObjectStore("indexEntries",{keyPath:Eg}).createIndex("documentKeyIndex",Sg,{unique:!1})}(e)}))),o}},{key:"Ks",value:function(e){var t=0;return e.store("remoteDocuments").Z((function(e,n){t+=Ak(n)})).next((function(){var n={byteSize:t};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",n)}))}},{key:"qs",value:function(e){var t=this,n=e.store("mutationQueues"),r=e.store("mutations");return n.W().next((function(n){return Mv.forEach(n,(function(n){var i=t,a=IDBKeyRange.bound([n.userId,-1],[n.userId,n.lastAcknowledgedBatchId]);return r.W("userMutationsIndex",a).next((function(t){return Mv.forEach(t,(function(t){Zd(t.userId===n.userId);var r=Hg(i.It,t);return Sk(e,n.userId,r).next((function(){}))}))}))}))}))}},{key:"Gs",value:function(e){var t=e.store("targetDocuments"),n=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next((function(e){var r=[];return n.Z((function(n,i){var a=new kv(n),o=[0,cg(a)];r.push(t.get(o).next((function(n){return n?Mv.resolve():(r=a,t.put({targetId:0,path:cg(r),sequenceNumber:e.highestListenSequenceNumber}));var r})))})).next((function(){return Mv.waitFor(r)}))}))}},{key:"Qs",value:function(t,n){t.createObjectStore("collectionParents",{keyPath:Ig});var r=n.store("collectionParents"),i=new mk,a=function(e){if(i.add(e)){var t=e.lastSegment(),n=e.popLast();return r.put({collectionId:t,parent:cg(n)})}};return n.store("remoteDocuments").Z({X:!0},(function(e,t){var n=new kv(e);return a(n.popLast())})).next((function(){return n.store("documentMutations").Z({X:!0},(function(t,n){var r=e(y)(t,3),i=(r[0],r[1]),o=(r[2],fg(i));return a(o.popLast())}))}))}},{key:"js",value:function(e){var t=this,n=e.store("targets");return n.Z((function(e,r){var i=Qg(r),a=Yg(t.It,i);return n.put(a)}))}},{key:"Ws",value:function(e,t){var n=t.store("remoteDocuments"),r=[];return n.Z((function(e,n){var i,a=t.store("remoteDocumentsV14"),o=(i=n,i.document?new xv(kv.fromString(i.document.name).popFirst(5)):i.noDocument?xv.fromSegments(i.noDocument.path):i.unknownDocument?xv.fromSegments(i.unknownDocument.path):Xd()).path.toArray(),u={prefixPath:o.slice(0,o.length-2),collectionGroup:o[o.length-2],documentId:o[o.length-1],readTime:n.readTime||[0,0],unknownDocument:n.unknownDocument,noDocument:n.noDocument,document:n.document,hasCommittedMutations:!!n.hasCommittedMutations};r.push(a.put(u))})).next((function(){return Mv.waitFor(r)}))}},{key:"zs",value:function(e,t){var n=this,r=t.store("mutations"),i=Hk(this.It),a=new lw(fw.Bs,this.It.re);return r.W().next((function(e){var r=n,o=new Map;return e.forEach((function(e){var t,n=null!==(t=o.get(e.userId))&&void 0!==t?t:xm();Hg(r.It,e).keys().forEach((function(e){return n=n.add(e)})),o.set(e.userId,n)})),Mv.forEach(o,(function(e,n){var o=new Gd(n),u=rk.oe(r.It,o),s=a.getIndexManager(o),c=Ck.oe(o,r.It,s,a.referenceDelegate);return new tw(i,c,u,s).recalculateAndSaveOverlaysForDocumentKeys(new Mg(t,Qv.at),e).next()}))}))}}]),t}();
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vw(e){e.createObjectStore("targetDocuments",{keyPath:bg}).createIndex("documentTargetsIndex",xg,{unique:!0}),e.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",wg,{unique:!0}),e.createObjectStore("targetGlobal")}var pw="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",yw=function(){"use strict";function t(n,r,i,a,o,u,c,l,h,f){var d=arguments.length>10&&void 0!==arguments[10]?arguments[10]:15;if(e(s)(this,t),this.allowTabSynchronization=n,this.persistenceKey=r,this.clientId=i,this.Hs=o,this.window=u,this.document=c,this.Js=h,this.Ys=f,this.Xs=d,this.Ss=null,this.Ds=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Zs=null,this.inForeground=!1,this.ti=null,this.ei=null,this.ni=Number.NEGATIVE_INFINITY,this.si=function(e){return Promise.resolve()},!t.C())throw new tv(ev.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new Gk(this,a),this.ii=r+"main",this.It=new jg(l),this.ri=new Vv(this.ii,this.Xs,new dw(this.It)),this.Cs=new Lk(this.referenceDelegate,this.It),this.remoteDocumentCache=Hk(this.It),this.Ns=new ek,this.window&&this.window.localStorage?this.oi=this.window.localStorage:(this.oi=null,!1===f&&Qd("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}return e(c)(t,[{key:"start",value:function(){var e=this;return this.ui().then((function(){var t=e;if(!e.isPrimary&&!e.allowTabSynchronization)throw new tv(ev.FAILED_PRECONDITION,pw);return e.ci(),e.ai(),e.hi(),e.runTransaction("getHighestListenSequenceNumber","readonly",(function(e){return t.Cs.getHighestSequenceNumber(e)}))})).then((function(t){e.Ss=new Qv(t,e.Js)})).then((function(){e.Ds=!0})).catch((function(t){return e.ri&&e.ri.close(),Promise.reject(t)}))}},{key:"li",value:function(t){var n,r=this;return this.si=(n=e(ve)(e(ye).mark((function n(i){return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!r.started){e.next=2;break}return e.abrupt("return",t(i));case 2:case"end":return e.stop()}}),n)}))),function(e){return n.apply(this,arguments)}),t(this.isPrimary)}},{key:"setDatabaseDeletedListener",value:function(t){var n;this.ri.L((n=e(ve)(e(ye).mark((function n(r){return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=null===r.newVersion,!e.t0){e.next=4;break}return e.next=4,t();case 4:case"end":return e.stop()}}),n)}))),function(e){return n.apply(this,arguments)}))}},{key:"setNetworkEnabled",value:function(t){var n=this;this.networkEnabled!==t&&(this.networkEnabled=t,this.Hs.enqueueAndForget(e(ve)(e(ye).mark((function t(){return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=n.started,!e.t0){e.next=4;break}return e.next=4,n.ui();case 4:case"end":return e.stop()}}),t)})))))}},{key:"ui",value:function(){var e=this;return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(function(t){return gw(t).put({clientId:e.clientId,updateTimeMs:Date.now(),networkEnabled:e.networkEnabled,inForeground:e.inForeground}).next((function(){var n=e;if(e.isPrimary)return e.fi(t).next((function(e){var t=n;e||(n.isPrimary=!1,n.Hs.enqueueRetryable((function(){return t.si(!1)})))}))})).next((function(){return e.di(t)})).next((function(n){return e.isPrimary&&!n?e._i(t).next((function(){return!1})):!!n&&e.wi(t).next((function(){return!0}))}))})).catch((function(t){if(qv(t))return Hd("IndexedDbPersistence","Failed to extend owner lease: ",t),e.isPrimary;if(!e.allowTabSynchronization)throw t;return Hd("IndexedDbPersistence","Releasing owner lease after error during lease refresh",t),!1})).then((function(t){var n=e;e.isPrimary!==t&&e.Hs.enqueueRetryable((function(){return n.si(t)})),e.isPrimary=t}))}},{key:"fi",value:function(e){var t=this;return mw(e).get("owner").next((function(e){return Mv.resolve(t.mi(e))}))}},{key:"gi",value:function(e){return gw(e).delete(this.clientId)}},{key:"yi",value:function(){var t=this;return e(ve)(e(ye).mark((function n(){var r,i,a,o,u,s,c;return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.isPrimary||t.pi(t.ni,18e5)){e.next=23;break}return t.ni=Date.now(),e.next=4,t.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(function(e){var n=Fg(e,"clientMetadata");return n.W().next((function(e){var r=t.Ii(e,18e5),i=e.filter((function(e){return-1===r.indexOf(e)}));return Mv.forEach(i,(function(e){return n.delete(e.clientId)})).next((function(){return i}))}))})).catch((function(){return[]}));case 4:if(r=e.sent,i=!0,a=!1,o=void 0,!t.oi){e.next=23;break}for(e.prev=7,u=r[Symbol.iterator]();!(i=(s=u.next()).done);i=!0)c=s.value,t.oi.removeItem(t.Ti(c.clientId));e.next=15;break;case 11:e.prev=11,e.t0=e.catch(7),a=!0,o=e.t0;case 15:e.prev=15,e.prev=16,i||null==u.return||u.return();case 18:if(e.prev=18,!a){e.next=21;break}throw o;case 21:return e.finish(18);case 22:return e.finish(15);case 23:case"end":return e.stop()}}),n,null,[[7,11,15,23],[16,,18,22]])})))()}},{key:"hi",value:function(){var e=this;this.ei=this.Hs.enqueueAfterDelay("client_metadata_refresh",4e3,(function(){return e.ui().then((function(){return e.yi()})).then((function(){return e.hi()}))}))}},{key:"mi",value:function(e){return!!e&&e.ownerId===this.clientId}},{key:"di",value:function(e){var t=this;return this.Ys?Mv.resolve(!0):mw(e).get("owner").next((function(n){var r=t;if(null!==n&&t.pi(n.leaseTimestampMs,5e3)&&!t.Ei(n.ownerId)){if(t.mi(n)&&t.networkEnabled)return!0;if(!t.mi(n)){if(!n.allowTabSynchronization)throw new tv(ev.FAILED_PRECONDITION,pw);return!1}}return!(!t.networkEnabled||!t.inForeground)||gw(e).W().next((function(e){return void 0===r.Ii(e,5e3).find((function(e){if(r.clientId!==e.clientId){var t=!r.networkEnabled&&e.networkEnabled,n=!r.inForeground&&e.inForeground,i=r.networkEnabled===e.networkEnabled;if(t||n&&i)return!0}return!1}))}))})).next((function(e){return t.isPrimary!==e&&Hd("IndexedDbPersistence","Client ".concat(e?"is":"is not"," eligible for a primary lease.")),e}))}},{key:"shutdown",value:function(){var t=this;return e(ve)(e(ye).mark((function n(){return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.Ds=!1,t.Ai(),t.ei&&(t.ei.cancel(),t.ei=null),t.Ri(),t.bi(),e.next=7,t.ri.runTransaction("shutdown","readwrite",["owner","clientMetadata"],(function(e){var n=new Mg(e,Qv.at);return t._i(n).next((function(){return t.gi(n)}))}));case 7:t.ri.close(),t.Pi();case 9:case"end":return e.stop()}}),n)})))()}},{key:"Ii",value:function(e,t){var n=this;return e.filter((function(e){return n.pi(e.updateTimeMs,t)&&!n.Ei(e.clientId)}))}},{key:"vi",value:function(){var e=this;return this.runTransaction("getActiveClients","readonly",(function(t){return gw(t).W().next((function(t){return e.Ii(t,18e5).map((function(e){return e.clientId}))}))}))}},{key:"started",get:function(){return this.Ds}},{key:"getMutationQueue",value:function(e,t){return Ck.oe(e,this.It,t,this.referenceDelegate)}},{key:"getTargetCache",value:function(){return this.Cs}},{key:"getRemoteDocumentCache",value:function(){return this.remoteDocumentCache}},{key:"getIndexManager",value:function(e){return new kk(e,this.It.re.databaseId)}},{key:"getDocumentOverlayCache",value:function(e){return rk.oe(this.It,e)}},{key:"getBundleCache",value:function(){return this.Ns}},{key:"runTransaction",value:function(e,t,n){var r=this;Hd("IndexedDbPersistence","Starting transaction:",e);var i,a,o="readonly"===t?"readonly":"readwrite",u=15===(i=this.Xs)?Lg:14===i?Pg:13===i?Og:12===i?Rg:11===i?Dg:void Xd();return this.ri.runTransaction(e,o,u,(function(i){return a=new Mg(i,r.Ss?r.Ss.next():Qv.at),"readwrite-primary"===t?r.fi(a).next((function(e){return!!e||r.di(a)})).next((function(t){var i=r;if(!t)throw Qd("Failed to obtain primary lease for action '".concat(e,"'.")),r.isPrimary=!1,r.Hs.enqueueRetryable((function(){return i.si(!1)})),new tv(ev.FAILED_PRECONDITION,Rv);return n(a)})).next((function(e){return r.wi(a).next((function(){return e}))})):r.Vi(a).next((function(){return n(a)}))})).then((function(e){return a.raiseOnCommittedEvent(),e}))}},{key:"Vi",value:function(e){var t=this;return mw(e).get("owner").next((function(e){if(null!==e&&t.pi(e.leaseTimestampMs,5e3)&&!t.Ei(e.ownerId)&&!t.mi(e)&&!(t.Ys||t.allowTabSynchronization&&e.allowTabSynchronization))throw new tv(ev.FAILED_PRECONDITION,pw)}))}},{key:"wi",value:function(e){var t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return mw(e).put("owner",t)}},{key:"_i",value:function(e){var t=this,n=mw(e);return n.get("owner").next((function(e){return t.mi(e)?(Hd("IndexedDbPersistence","Releasing primary lease."),n.delete("owner")):Mv.resolve()}))}},{key:"pi",value:function(e,t){var n=Date.now();return!(e<n-t||e>n&&(Qd("Detected an update time that is in the future: ".concat(e," > ").concat(n)),1))}},{key:"ci",value:function(){var e=this;null!==this.document&&"function"==typeof this.document.addEventListener&&(this.ti=function(){var t=e;e.Hs.enqueueAndForget((function(){return t.inForeground="visible"===t.document.visibilityState,t.ui()}))},this.document.addEventListener("visibilitychange",this.ti),this.inForeground="visible"===this.document.visibilityState)}},{key:"Ri",value:function(){this.ti&&(this.document.removeEventListener("visibilitychange",this.ti),this.ti=null)}},{key:"ai",value:function(){var e,t=this;"function"==typeof(null===(e=this.window)||void 0===e?void 0:e.addEventListener)&&(this.Zs=function(){var e=t;t.Ai(),!Q()&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")&&navigator.appVersion.match(/Version\/1[45]/)&&t.Hs.enterRestrictedMode(!0),t.Hs.enqueueAndForget((function(){return e.shutdown()}))},this.window.addEventListener("pagehide",this.Zs))}},{key:"bi",value:function(){this.Zs&&(this.window.removeEventListener("pagehide",this.Zs),this.Zs=null)}},{key:"Ei",value:function(e){var t;try{var n=null!==(null===(t=this.oi)||void 0===t?void 0:t.getItem(this.Ti(e)));return Hd("IndexedDbPersistence","Client '".concat(e,"' ").concat(n?"is":"is not"," zombied in LocalStorage")),n}catch(e){return Qd("IndexedDbPersistence","Failed to get zombied client id.",e),!1}}},{key:"Ai",value:function(){if(this.oi)try{this.oi.setItem(this.Ti(this.clientId),String(Date.now()))}catch(e){Qd("Failed to set zombie client id.",e)}}},{key:"Pi",value:function(){if(this.oi)try{this.oi.removeItem(this.Ti(this.clientId))}catch(e){}}},{key:"Ti",value:function(e){return"firestore_zombie_".concat(this.persistenceKey,"_").concat(e)}}],[{key:"C",value:function(){return Vv.C()}}]),t}();function mw(e){return Fg(e,"owner")}function gw(e){return Fg(e,"clientMetadata")}function kw(e,t){var n=e.projectId;return e.isDefaultDatabase||(n+="."+e.database),"firestore/"+t+"/"+n+"/"
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */}var ww=function(){"use strict";function t(n,r,i,a){e(s)(this,t),this.targetId=n,this.fromCache=r,this.Si=i,this.Di=a}return e(c)(t,null,[{key:"Ci",value:function(e,n){var r=xm(),i=xm(),a=!0,o=!1,u=void 0;try{for(var s,c=n.docChanges[Symbol.iterator]();!(a=(s=c.next()).done);a=!0){var l=s.value;switch(l.type){case 0:r=r.add(l.doc.key);break;case 1:i=i.add(l.doc.key)}}}catch(e){o=!0,u=e}finally{try{a||null==c.return||c.return()}finally{if(o)throw u}}return new t(e,n.fromCache,r,i)}}]),t}(),bw=function(){"use strict";function t(){e(s)(this,t),this.xi=!1}return e(c)(t,[{key:"initialize",value:function(e,t){this.Ni=e,this.indexManager=t,this.xi=!0}},{key:"getDocumentsMatchingQuery",value:function(e,t,n,r){var i=this;return this.ki(e,t).next((function(a){return a||i.Mi(e,t,r,n)})).next((function(n){return n||i.Oi(e,t)}))}},{key:"ki",value:function(t,n){var r=this;if(vy(n))return Mv.resolve(null);var i=ky(n);return this.indexManager.getIndexType(t,i).next((function(a){return 0===a?null:(null!==n.limit&&1===a&&(n=wy(n,null,"F"),i=ky(n)),r.indexManager.getDocumentsMatchingTarget(t,i).next((function(a){var o=r,u=xm.apply(void 0,e(x)(a));return r.Ni.getDocuments(t,u).next((function(e){return o.indexManager.getMinOffset(t,i).next((function(r){var i=o.Fi(n,e);return o.$i(n,i,u,r.readTime)?o.ki(t,wy(n,null,"F")):o.Bi(t,i,n,r)}))}))})))}))}},{key:"Mi",value:function(e,t,n,r){var i=this;return vy(t)||r.isEqual(mv.min())?this.Oi(e,t):this.Ni.getDocuments(e,n).next((function(a){var o=i.Fi(t,a);return i.$i(t,o,n,r)?i.Oi(e,t):(Wd()<=Ie.DEBUG&&Hd("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),Iy(t)),i.Bi(e,o,t,Av(r,-1)))}))}},{key:"Fi",value:function(e,t){var n=new tp(Ey(e));return t.forEach((function(t,r){_y(e,r)&&(n=n.add(r))})),n}},{key:"$i",value:function(e,t,n,r){if(null===e.limit)return!1;if(n.size!==t.size)return!0;var i="F"===e.limitType?t.last():t.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(r)>0)}},{key:"Oi",value:function(e,t){return Wd()<=Ie.DEBUG&&Hd("QueryEngine","Using full collection scan to execute query:",Iy(t)),this.Ni.getDocumentsMatchingQuery(e,t,Nv.min())}},{key:"Bi",value:function(e,t,n,r){return this.Ni.getDocumentsMatchingQuery(e,n,r).next((function(e){return t.forEach((function(t){e=e.insert(t.key,t)})),e}))}}]),t}(),xw=function(){"use strict";function t(n,r,i,a){e(s)(this,t),this.persistence=n,this.Li=r,this.It=a,this.Ui=new Zv(dv),this.qi=new hm((function(e){return zp(e)}),Wp),this.Ki=new Map,this.Gi=n.getRemoteDocumentCache(),this.Cs=n.getTargetCache(),this.Ns=n.getBundleCache(),this.Qi(i)}return e(c)(t,[{key:"Qi",value:function(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new tw(this.Gi,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Gi.setIndexManager(this.indexManager),this.Li.initialize(this.localDocuments,this.indexManager)}},{key:"collectGarbage",value:function(e){var t=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",(function(n){return e.collect(n,t.Ui)}))}}]),t}();
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Iw(e,t,n,r){return new xw(e,t,n,r)}function _w(e,t){return Tw.apply(this,arguments)}function Tw(){return(Tw=e(ve)(e(ye).mark((function t(n,r){var i;return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=$d(n),e.next=3,i.persistence.runTransaction("Handle user change","readonly",(function(e){var t;return i.mutationQueue.getAllMutationBatches(e).next((function(n){return t=n,i.Qi(r),i.mutationQueue.getAllMutationBatches(e)})).next((function(n){var r=[],a=[],o=xm(),u=!0,s=!1,c=void 0;try{for(var l,h=t[Symbol.iterator]();!(u=(l=h.next()).done);u=!0){var f=l.value;r.push(f.batchId);var d=!0,v=!1,p=void 0;try{for(var y,m=f.mutations[Symbol.iterator]();!(d=(y=m.next()).done);d=!0){var g=y.value;o=o.add(g.key)}}catch(e){v=!0,p=e}finally{try{d||null==m.return||m.return()}finally{if(v)throw p}}}}catch(e){s=!0,c=e}finally{try{u||null==h.return||h.return()}finally{if(s)throw c}}var k=!0,w=!1,b=void 0;try{for(var x,I=n[Symbol.iterator]();!(k=(x=I.next()).done);k=!0){var _=x.value;a.push(_.batchId);var T=!0,E=!1,S=void 0;try{for(var A,C=_.mutations[Symbol.iterator]();!(T=(A=C.next()).done);T=!0){var N=A.value;o=o.add(N.key)}}catch(e){E=!0,S=e}finally{try{T||null==C.return||C.return()}finally{if(E)throw S}}}}catch(e){w=!0,b=e}finally{try{k||null==I.return||I.return()}finally{if(w)throw b}}return i.localDocuments.getDocuments(e,o).next((function(e){return{ji:e,removedBatchIds:r,addedBatchIds:a}}))}))}));case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function Ew(e,t){var n=$d(e);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",(function(e){var r=t.batch.keys(),i=n.Gi.newChangeBuffer({trackRemovals:!0});return function(e,t,n,r){var i=n.batch,a=i.keys(),o=Mv.resolve();return a.forEach((function(e){o=o.next((function(){return r.getEntry(t,e)})).next((function(t){var a=n.docVersions.get(e);Zd(null!==a),t.version.compareTo(a)<0&&(i.applyToRemoteDocument(t,n),t.isValidDocument()&&(t.setReadTime(n.commitVersion),r.addEntry(t)))}))})),o.next((function(){return e.mutationQueue.removeMutationBatch(t,i)}))}(n,e,t,i).next((function(){return i.apply(e)})).next((function(){return n.mutationQueue.performConsistencyCheck(e)})).next((function(){return n.documentOverlayCache.removeOverlaysForBatchId(e,r,t.batch.batchId)})).next((function(){return n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,function(e){for(var t=xm(),n=0;n<e.mutationResults.length;++n)e.mutationResults[n].transformResults.length>0&&(t=t.add(e.batch.mutations[n].key));return t}(t))})).next((function(){return n.localDocuments.getDocuments(e,r)}))}))}function Sw(e){var t=$d(e);return t.persistence.runTransaction("Get last remote snapshot version","readonly",(function(e){return t.Cs.getLastRemoteSnapshotVersion(e)}))}function Aw(e,t){var n=$d(e),r=t.snapshotVersion,i=n.Ui;return n.persistence.runTransaction("Apply remote event","readwrite-primary",(function(e){var a=n.Gi.newChangeBuffer({trackRemovals:!0});i=n.Ui;var o=[];t.targetChanges.forEach((function(a,u){var s=i.get(u);if(s){o.push(n.Cs.removeMatchingKeys(e,a.removedDocuments,u).next((function(){return n.Cs.addMatchingKeys(e,a.addedDocuments,u)})));var c,l,h,f=s.withSequenceNumber(e.currentSequenceNumber);t.targetMismatches.has(u)?f=f.withResumeToken(op.EMPTY_BYTE_STRING,mv.min()).withLastLimboFreeSnapshotVersion(mv.min()):a.resumeToken.approximateByteSize()>0&&(f=f.withResumeToken(a.resumeToken,r)),i=i.insert(u,f),l=f,h=a,(0===(c=s).resumeToken.approximateByteSize()||l.snapshotVersion.toMicroseconds()-c.snapshotVersion.toMicroseconds()>=3e8||h.addedDocuments.size+h.modifiedDocuments.size+h.removedDocuments.size>0)&&o.push(n.Cs.updateTargetData(e,f))}}));var u=dm(),s=xm();if(t.documentUpdates.forEach((function(r){t.resolvedLimboDocuments.has(r)&&o.push(n.persistence.referenceDelegate.updateLimboDocument(e,r))})),o.push(Cw(e,a,t.documentUpdates).next((function(e){u=e.Wi,s=e.zi}))),!r.isEqual(mv.min())){var c=n.Cs.getLastRemoteSnapshotVersion(e).next((function(t){return n.Cs.setTargetsMetadata(e,e.currentSequenceNumber,r)}));o.push(c)}return Mv.waitFor(o).next((function(){return a.apply(e)})).next((function(){return n.localDocuments.getLocalViewOfDocuments(e,u,s)})).next((function(){return u}))})).then((function(e){return n.Ui=i,e}))}function Cw(e,t,n){var r=xm(),i=xm();return n.forEach((function(e){return r=r.add(e)})),t.getEntries(e,r).next((function(e){var r=dm();return n.forEach((function(n,a){var o=e.get(n);a.isFoundDocument()!==o.isFoundDocument()&&(i=i.add(n)),a.isNoDocument()&&a.version.isEqual(mv.min())?(t.removeEntry(n,a.readTime),r=r.insert(n,a)):!o.isValidDocument()||a.version.compareTo(o.version)>0||0===a.version.compareTo(o.version)&&o.hasPendingWrites?(t.addEntry(a),r=r.insert(n,a)):Hd("LocalStore","Ignoring outdated watch update for ",n,". Current version:",o.version," Watch version:",a.version)})),{Wi:r,zi:i}}))}function Nw(e,t){var n=$d(e);return n.persistence.runTransaction("Get next mutation batch","readonly",(function(e){return void 0===t&&(t=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(e,t)}))}function Dw(e,t){var n=$d(e);return n.persistence.runTransaction("Allocate target","readwrite",(function(e){var r;return n.Cs.getTargetData(e,t).next((function(i){return i?(r=i,Mv.resolve(r)):n.Cs.allocateTargetId(e).next((function(i){return r=new qg(t,i,0,e.currentSequenceNumber),n.Cs.addTargetData(e,r).next((function(){return r}))}))}))})).then((function(e){var r=n.Ui.get(e.targetId);return(null===r||e.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(n.Ui=n.Ui.insert(e.targetId,e),n.qi.set(t,e.targetId)),e}))}function Rw(e,t,n){return Ow.apply(this,arguments)}function Ow(){return(Ow=e(ve)(e(ye).mark((function t(n,r,i){var a,o,u;return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=$d(n),o=a.Ui.get(r),u=i?"readwrite":"readwrite-primary",e.prev=1,e.t0=i,e.t0){e.next=6;break}return e.next=6,a.persistence.runTransaction("Release target",u,(function(e){return a.persistence.referenceDelegate.removeTarget(e,o)}));case 6:e.next=13;break;case 8:if(e.prev=8,e.t1=e.catch(1),qv(e.t1)){e.next=12;break}throw e.t1;case 12:Hd("LocalStore","Failed to update sequence numbers for target ".concat(r,": ").concat(e.t1));case 13:a.Ui=a.Ui.remove(r),a.qi.delete(o.target);case 14:case"end":return e.stop()}}),t,null,[[1,8]])})))).apply(this,arguments)}function Pw(e,t,n){var r=$d(e),i=mv.min(),a=xm();return r.persistence.runTransaction("Execute query","readonly",(function(e){return function(e,t,n){var r=$d(e),i=r.qi.get(n);return void 0!==i?Mv.resolve(r.Ui.get(i)):r.Cs.getTargetData(t,n)}(r,e,ky(t)).next((function(t){if(t)return i=t.lastLimboFreeSnapshotVersion,r.Cs.getMatchingKeysForTargetId(e,t.targetId).next((function(e){a=e}))})).next((function(){return r.Li.getDocumentsMatchingQuery(e,t,n?i:mv.min(),n?a:xm())})).next((function(e){return Fw(r,Ty(t),e),{documents:e,Hi:a}}))}))}function Lw(e,t){var n=$d(e),r=$d(n.Cs),i=n.Ui.get(t);return i?Promise.resolve(i.target):n.persistence.runTransaction("Get target data","readonly",(function(e){return r.se(e,t).next((function(e){return e?e.target:null}))}))}function Mw(e,t){var n=$d(e),r=n.Ki.get(t)||mv.min();return n.persistence.runTransaction("Get new document changes","readonly",(function(e){return n.Gi.getAllFromCollectionGroup(e,t,Av(r,-1),Number.MAX_SAFE_INTEGER)})).then((function(e){return Fw(n,t,e),e}))}function Fw(e,t,n){var r=mv.min();n.forEach((function(e,t){t.readTime.compareTo(r)>0&&(r=t.readTime)})),e.Ki.set(t,r)}function Vw(e,t,n,r){return Uw.apply(this,arguments)}function Uw(){return(Uw=e(ve)(e(ye).mark((function t(n,r,i,a){var o,u,s,c,l,h,f,d,v,p,y,m,g;return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(o=$d(n),u=xm(),s=dm(),c=!0,l=!1,h=void 0,e.prev=3,f=i[Symbol.iterator]();!(c=(d=f.next()).done);c=!0)v=d.value,p=r.Ji(v.metadata.name),v.document&&(u=u.add(p)),(y=r.Yi(v)).setReadTime(r.Xi(v.metadata.readTime)),s=s.insert(p,y);e.next=11;break;case 7:e.prev=7,e.t0=e.catch(3),l=!0,h=e.t0;case 11:e.prev=11,e.prev=12,c||null==f.return||f.return();case 14:if(e.prev=14,!l){e.next=17;break}throw h;case 17:return e.finish(14);case 18:return e.finish(11);case 19:return m=o.Gi.newChangeBuffer({trackRemovals:!0}),e.next=22,Dw(o,(t=a,ky(dy(kv.fromString("__bundle__/docs/".concat(t))))));case 22:return g=e.sent,e.abrupt("return",o.persistence.runTransaction("Apply bundle documents","readwrite",(function(e){return Cw(e,m,s).next((function(t){return m.apply(e),t})).next((function(t){return o.Cs.removeMatchingKeysForTargetId(e,g.targetId).next((function(){return o.Cs.addMatchingKeys(e,u,g.targetId)})).next((function(){return o.localDocuments.getLocalViewOfDocuments(e,t.Wi,t.zi)})).next((function(){return t.Wi}))}))})));case 24:case"end":return e.stop()}var t}),t,null,[[3,7,11,19],[12,,14,18]])})))).apply(this,arguments)}function Bw(e,t){return qw.apply(this,arguments)}function qw(){return qw=e(ve)(e(ye).mark((function t(n,r){var i,a,o,u=arguments;return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=u.length>2&&void 0!==u[2]?u[2]:xm(),e.next=3,Dw(n,ky(Jg(r.bundledQuery)));case 3:return a=e.sent,o=$d(n),e.abrupt("return",o.persistence.runTransaction("Save named query","readwrite",(function(e){var t=Bm(r.readTime);if(a.snapshotVersion.compareTo(t)>=0)return o.Ns.saveNamedQuery(e,r);var n=a.withResumeToken(op.EMPTY_BYTE_STRING,t);return o.Ui=o.Ui.insert(n.targetId,n),o.Cs.updateTargetData(e,n).next((function(){return o.Cs.removeMatchingKeysForTargetId(e,a.targetId)})).next((function(){return o.Cs.addMatchingKeys(e,i,a.targetId)})).next((function(){return o.Ns.saveNamedQuery(e,r)}))})));case 6:case"end":return e.stop()}}),t)}))),qw.apply(this,arguments)}function jw(e,t){return"firestore_clients_".concat(e,"_").concat(t)}function Gw(e,t,n){var r="firestore_mutations_".concat(e,"_").concat(n);return t.isAuthenticated()&&(r+="_".concat(t.uid)),r}function Kw(e,t){return"firestore_targets_".concat(e,"_").concat(t)}var zw=function(){"use strict";function t(n,r,i,a){e(s)(this,t),this.user=n,this.batchId=r,this.state=i,this.error=a}return e(c)(t,[{key:"tr",value:function(){var e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}],[{key:"Zi",value:function(e,n,r){var i,a=JSON.parse(r),o="object"==typeof a&&-1!==["pending","acknowledged","rejected"].indexOf(a.state)&&(void 0===a.error||"object"==typeof a.error);return o&&a.error&&((o="string"==typeof a.error.message&&"string"==typeof a.error.code)&&(i=new tv(a.error.code,a.error.message))),o?new t(e,n,a.state,i):(Qd("SharedClientState","Failed to parse mutation state for ID '".concat(n,"': ").concat(r)),null)}}]),t}(),Ww=function(){"use strict";function t(n,r,i){e(s)(this,t),this.targetId=n,this.state=r,this.error=i}return e(c)(t,[{key:"tr",value:function(){var e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}],[{key:"Zi",value:function(e,n){var r,i=JSON.parse(n),a="object"==typeof i&&-1!==["not-current","current","rejected"].indexOf(i.state)&&(void 0===i.error||"object"==typeof i.error);return a&&i.error&&((a="string"==typeof i.error.message&&"string"==typeof i.error.code)&&(r=new tv(i.error.code,i.error.message))),a?new t(e,i.state,r):(Qd("SharedClientState","Failed to parse target state for ID '".concat(e,"': ").concat(n)),null)}}]),t}(),Hw=function(){"use strict";function t(n,r){e(s)(this,t),this.clientId=n,this.activeTargetIds=r}return e(c)(t,null,[{key:"Zi",value:function(e,n){for(var r=JSON.parse(n),i="object"==typeof r&&r.activeTargetIds instanceof Array,a=_m(),o=0;i&&o<r.activeTargetIds.length;++o)i=gp(r.activeTargetIds[o]),a=a.add(r.activeTargetIds[o]);return i?new t(e,a):(Qd("SharedClientState","Failed to parse client data for instance '".concat(e,"': ").concat(n)),null)}}]),t}(),Qw=function(){"use strict";function t(n,r){e(s)(this,t),this.clientId=n,this.onlineState=r}return e(c)(t,null,[{key:"Zi",value:function(e){var n=JSON.parse(e);return"object"==typeof n&&-1!==["Unknown","Online","Offline"].indexOf(n.onlineState)&&"string"==typeof n.clientId?new t(n.clientId,n.onlineState):(Qd("SharedClientState","Failed to parse online state: ".concat(e)),null)}}]),t}(),Yw=function(){"use strict";function t(){e(s)(this,t),this.activeTargetIds=_m()}return e(c)(t,[{key:"er",value:function(e){this.activeTargetIds=this.activeTargetIds.add(e)}},{key:"nr",value:function(e){this.activeTargetIds=this.activeTargetIds.delete(e)}},{key:"tr",value:function(){var e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}]),t}(),Jw=function(){"use strict";function t(n,r,i,a,o){e(s)(this,t),this.window=n,this.Hs=r,this.persistenceKey=i,this.sr=a,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.ir=this.rr.bind(this),this.ur=new Zv(dv),this.started=!1,this.cr=[];var u,c=i.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=o,this.ar=jw(this.persistenceKey,this.sr),this.hr=(u=this.persistenceKey,"firestore_sequence_number_".concat(u)),this.ur=this.ur.insert(this.sr,new Yw),this.lr=new RegExp("^firestore_clients_".concat(c,"_([^_]*)$")),this.dr=new RegExp("^firestore_mutations_".concat(c,"_(\\d+)(?:_(.*))?$")),this._r=new RegExp("^firestore_targets_".concat(c,"_(\\d+)$")),this.wr=function(e){return"firestore_online_state_".concat(e)}(this.persistenceKey),this.mr=function(e){return"firestore_bundle_loaded_v2_".concat(e)}(this.persistenceKey),this.window.addEventListener("storage",this.ir)}return e(c)(t,[{key:"start",value:function(){var t=this;return e(ve)(e(ye).mark((function n(){var r,i,a,o,u,s,c,l,h,f,d,v,p,y,m,g,k;return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.syncEngine.vi();case 2:r=e.sent,i=!0,a=!1,o=void 0,e.prev=4,u=r[Symbol.iterator]();case 6:if(i=(s=u.next()).done){e.next=15;break}if((c=s.value)!==t.sr){e.next=10;break}return e.abrupt("continue",12);case 10:(l=t.getItem(jw(t.persistenceKey,c)))&&(h=Hw.Zi(c,l))&&(t.ur=t.ur.insert(h.clientId,h));case 12:i=!0,e.next=6;break;case 15:e.next=21;break;case 17:e.prev=17,e.t0=e.catch(4),a=!0,o=e.t0;case 21:e.prev=21,e.prev=22,i||null==u.return||u.return();case 24:if(e.prev=24,!a){e.next=27;break}throw o;case 27:return e.finish(24);case 28:return e.finish(21);case 29:for(t.gr(),(f=t.storage.getItem(t.wr))&&(d=t.yr(f))&&t.pr(d),v=!0,p=!1,y=void 0,e.prev=33,m=t.cr[Symbol.iterator]();!(v=(g=m.next()).done);v=!0)k=g.value,t.rr(k);e.next=41;break;case 37:e.prev=37,e.t1=e.catch(33),p=!0,y=e.t1;case 41:e.prev=41,e.prev=42,v||null==m.return||m.return();case 44:if(e.prev=44,!p){e.next=47;break}throw y;case 47:return e.finish(44);case 48:return e.finish(41);case 49:t.cr=[],t.window.addEventListener("pagehide",(function(){return t.shutdown()})),t.started=!0;case 50:case"end":return e.stop()}}),n,null,[[4,17,21,29],[22,,24,28],[33,37,41,49],[42,,44,48]])})))()}},{key:"writeSequenceNumber",value:function(e){this.setItem(this.hr,JSON.stringify(e))}},{key:"getAllActiveQueryTargets",value:function(){return this.Ir(this.ur)}},{key:"isActiveQueryTarget",value:function(e){var t=!1;return this.ur.forEach((function(n,r){r.activeTargetIds.has(e)&&(t=!0)})),t}},{key:"addPendingMutation",value:function(e){this.Tr(e,"pending")}},{key:"updateMutationState",value:function(e,t,n){this.Tr(e,t,n),this.Er(e)}},{key:"addLocalQueryTarget",value:function(e){var t="not-current";if(this.isActiveQueryTarget(e)){var n=this.storage.getItem(Kw(this.persistenceKey,e));if(n){var r=Ww.Zi(e,n);r&&(t=r.state)}}return this.Ar.er(e),this.gr(),t}},{key:"removeLocalQueryTarget",value:function(e){this.Ar.nr(e),this.gr()}},{key:"isLocalQueryTarget",value:function(e){return this.Ar.activeTargetIds.has(e)}},{key:"clearQueryState",value:function(e){this.removeItem(Kw(this.persistenceKey,e))}},{key:"updateQueryState",value:function(e,t,n){this.Rr(e,t,n)}},{key:"handleUserChange",value:function(e,t,n){var r=this;t.forEach((function(e){r.Er(e)})),this.currentUser=e,n.forEach((function(e){r.addPendingMutation(e)}))}},{key:"setOnlineState",value:function(e){this.br(e)}},{key:"notifyBundleLoaded",value:function(e){this.Pr(e)}},{key:"shutdown",value:function(){this.started&&(this.window.removeEventListener("storage",this.ir),this.removeItem(this.ar),this.started=!1)}},{key:"getItem",value:function(e){var t=this.storage.getItem(e);return Hd("SharedClientState","READ",e,t),t}},{key:"setItem",value:function(e,t){Hd("SharedClientState","SET",e,t),this.storage.setItem(e,t)}},{key:"removeItem",value:function(e){Hd("SharedClientState","REMOVE",e),this.storage.removeItem(e)}},{key:"rr",value:function(t){var n=t;if(n.storageArea===this.storage){if(Hd("SharedClientState","EVENT",n.key,n.newValue),n.key===this.ar)return void Qd("Received WebStorage notification for local change. Another client might have garbage-collected our state");var r=this;this.Hs.enqueueRetryable(e(ve)(e(ye).mark((function t(){var i,a,o,u,s,c,l;return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!r.started){e.next=42;break}if(null===n.key){e.next=40;break}if(!r.lr.test(n.key)){e.next=11;break}if(null!=n.newValue){e.next=6;break}return i=r.vr(n.key),e.abrupt("return",r.Vr(i,null));case 6:if(!(a=r.Sr(n.key,n.newValue))){e.next=9;break}return e.abrupt("return",r.Vr(a.clientId,a));case 9:e.next=40;break;case 11:if(!r.dr.test(n.key)){e.next=18;break}if(null===n.newValue){e.next=16;break}if(!(o=r.Dr(n.key,n.newValue))){e.next=16;break}return e.abrupt("return",r.Cr(o));case 16:e.next=40;break;case 18:if(!r._r.test(n.key)){e.next=25;break}if(null===n.newValue){e.next=23;break}if(!(u=r.Nr(n.key,n.newValue))){e.next=23;break}return e.abrupt("return",r.kr(u));case 23:e.next=40;break;case 25:if(n.key!==r.wr){e.next=32;break}if(null===n.newValue){e.next=30;break}if(!(s=r.yr(n.newValue))){e.next=30;break}return e.abrupt("return",r.pr(s));case 30:e.next=40;break;case 32:if(n.key!==r.hr){e.next=36;break}(c=function(e){var t=Qv.at;if(null!=e)try{var n=JSON.parse(e);Zd("number"==typeof n),t=n}catch(e){Qd("SharedClientState","Failed to read sequence number from WebStorage",e)}return t}(n.newValue))!==Qv.at&&r.sequenceNumberHandler(c),e.next=40;break;case 36:if(n.key!==r.mr){e.next=40;break}return l=r.Mr(n.newValue),e.next=40,Promise.all(l.map((function(e){return r.syncEngine.Or(e)})));case 40:e.next=43;break;case 42:r.cr.push(n);case 43:case"end":return e.stop()}}),t)}))))}}},{key:"Ar",get:function(){return this.ur.get(this.sr)}},{key:"gr",value:function(){this.setItem(this.ar,this.Ar.tr())}},{key:"Tr",value:function(e,t,n){var r=new zw(this.currentUser,e,t,n),i=Gw(this.persistenceKey,this.currentUser,e);this.setItem(i,r.tr())}},{key:"Er",value:function(e){var t=Gw(this.persistenceKey,this.currentUser,e);this.removeItem(t)}},{key:"br",value:function(e){var t={clientId:this.sr,onlineState:e};this.storage.setItem(this.wr,JSON.stringify(t))}},{key:"Rr",value:function(e,t,n){var r=Kw(this.persistenceKey,e),i=new Ww(e,t,n);this.setItem(r,i.tr())}},{key:"Pr",value:function(e){var t=JSON.stringify(Array.from(e));this.setItem(this.mr,t)}},{key:"vr",value:function(e){var t=this.lr.exec(e);return t?t[1]:null}},{key:"Sr",value:function(e,t){var n=this.vr(e);return Hw.Zi(n,t)}},{key:"Dr",value:function(e,t){var n=this.dr.exec(e),r=Number(n[1]),i=void 0!==n[2]?n[2]:null;return zw.Zi(new Gd(i),r,t)}},{key:"Nr",value:function(e,t){var n=this._r.exec(e),r=Number(n[1]);return Ww.Zi(r,t)}},{key:"yr",value:function(e){return Qw.Zi(e)}},{key:"Mr",value:function(e){return JSON.parse(e)}},{key:"Cr",value:function(t){var n=this;return e(ve)(e(ye).mark((function r(){return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.user.uid!==n.currentUser.uid){e.next=2;break}return e.abrupt("return",n.syncEngine.Fr(t.batchId,t.state,t.error));case 2:Hd("SharedClientState","Ignoring mutation for non-active user ".concat(t.user.uid));case 3:case"end":return e.stop()}}),r)})))()}},{key:"kr",value:function(e){return this.syncEngine.$r(e.targetId,e.state,e.error)}},{key:"Vr",value:function(e,t){var n=this,r=t?this.ur.insert(e,t):this.ur.remove(e),i=this.Ir(this.ur),a=this.Ir(r),o=[],u=[];return a.forEach((function(e){i.has(e)||o.push(e)})),i.forEach((function(e){a.has(e)||u.push(e)})),this.syncEngine.Br(o,u).then((function(){n.ur=r}))}},{key:"pr",value:function(e){this.ur.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}},{key:"Ir",value:function(e){var t=_m();return e.forEach((function(e,n){t=t.unionWith(n.activeTargetIds)})),t}}],[{key:"C",value:function(e){return!(!e||!e.localStorage)}}]),t}(),Xw=function(){"use strict";function t(){e(s)(this,t),this.Lr=new Yw,this.Ur={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}return e(c)(t,[{key:"addPendingMutation",value:function(e){}},{key:"updateMutationState",value:function(e,t,n){}},{key:"addLocalQueryTarget",value:function(e){return this.Lr.er(e),this.Ur[e]||"not-current"}},{key:"updateQueryState",value:function(e,t,n){this.Ur[e]=t}},{key:"removeLocalQueryTarget",value:function(e){this.Lr.nr(e)}},{key:"isLocalQueryTarget",value:function(e){return this.Lr.activeTargetIds.has(e)}},{key:"clearQueryState",value:function(e){delete this.Ur[e]}},{key:"getAllActiveQueryTargets",value:function(){return this.Lr.activeTargetIds}},{key:"isActiveQueryTarget",value:function(e){return this.Lr.activeTargetIds.has(e)}},{key:"start",value:function(){return this.Lr=new Yw,Promise.resolve()}},{key:"handleUserChange",value:function(e,t,n){}},{key:"setOnlineState",value:function(e){}},{key:"shutdown",value:function(){}},{key:"writeSequenceNumber",value:function(e){}},{key:"notifyBundleLoaded",value:function(e){}}]),t}(),Zw=function(){"use strict";function t(){e(s)(this,t)}return e(c)(t,[{key:"qr",value:function(e){}},{key:"shutdown",value:function(){}}]),t}(),$w=function(){"use strict";function t(){var n=this;e(s)(this,t),this.Kr=function(){return n.Gr()},this.Qr=function(){return n.jr()},this.Wr=[],this.zr()}return e(c)(t,[{key:"qr",value:function(e){this.Wr.push(e)}},{key:"shutdown",value:function(){window.removeEventListener("online",this.Kr),window.removeEventListener("offline",this.Qr)}},{key:"zr",value:function(){window.addEventListener("online",this.Kr),window.addEventListener("offline",this.Qr)}},{key:"Gr",value:function(){Hd("ConnectivityMonitor","Network connectivity changed: AVAILABLE");var e=!0,t=!1,n=void 0;try{for(var r,i=this.Wr[Symbol.iterator]();!(e=(r=i.next()).done);e=!0){(0,r.value)(0)}}catch(e){t=!0,n=e}finally{try{e||null==i.return||i.return()}finally{if(t)throw n}}}},{key:"jr",value:function(){Hd("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");var e=!0,t=!1,n=void 0;try{for(var r,i=this.Wr[Symbol.iterator]();!(e=(r=i.next()).done);e=!0){(0,r.value)(1)}}catch(e){t=!0,n=e}finally{try{e||null==i.return||i.return()}finally{if(t)throw n}}}}],[{key:"C",value:function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}]),t}(),eb={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},tb=function(){"use strict";function t(n){e(s)(this,t),this.Hr=n.Hr,this.Jr=n.Jr}return e(c)(t,[{key:"Yr",value:function(e){this.Xr=e}},{key:"Zr",value:function(e){this.eo=e}},{key:"onMessage",value:function(e){this.no=e}},{key:"close",value:function(){this.Jr()}},{key:"send",value:function(e){this.Hr(e)}},{key:"so",value:function(){this.Xr()}},{key:"io",value:function(e){this.eo(e)}},{key:"ro",value:function(e){this.no(e)}}]),t}(),nb=function(t){"use strict";e(d)(r,t);var n=e(L)(r);function r(t){var i;return e(s)(this,r),(i=n.call(this,t)).forceLongPolling=t.forceLongPolling,i.autoDetectLongPolling=t.autoDetectLongPolling,i.useFetchStreams=t.useFetchStreams,e(wc)(i)}return e(c)(r,[{key:"lo",value:function(e,t,n,r){return new Promise((function(i,a){var o=new Cd;o.listenOnce(_d.COMPLETE,(function(){try{switch(o.getLastErrorCode()){case Id.NO_ERROR:var t=o.getResponseJson();Hd("Connection","XHR received:",JSON.stringify(t)),i(t);break;case Id.TIMEOUT:Hd("Connection",'RPC "'+e+'" timed out'),a(new tv(ev.DEADLINE_EXCEEDED,"Request time out"));break;case Id.HTTP_ERROR:var n=o.getStatus();if(Hd("Connection",'RPC "'+e+'" failed with status:',n,"response text:",o.getResponseText()),n>0){var r=o.getResponseJson().error;if(r&&r.status&&r.message){var u=(s=r.status,c=s.toLowerCase().replace(/_/g,"-"),Object.values(ev).indexOf(c)>=0?c:ev.UNKNOWN);a(new tv(u,r.message))}else a(new tv(ev.UNKNOWN,"Server responded with status "+o.getStatus()))}else a(new tv(ev.UNAVAILABLE,"Connection failed."));break;default:Xd()}}finally{Hd("Connection",'RPC "'+e+'" completed.')}var s,c}));var u=JSON.stringify(r);o.send(t,"POST",u,n,15)}))}},{key:"_o",value:function(e,t,n){var r=[this.oo,"/","google.firestore.v1.Firestore","/",e,"/channel"],i=bd(),a=xd(),o={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/".concat(this.databaseId.projectId,"/databases/").concat(this.databaseId.database)},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling};this.useFetchStreams&&(o.xmlHttpFactory=new Sd({})),this.ho(o.initMessageHeaders,t,n),o.encodeInitMessageHeaders=!0;var u=r.join("");Hd("Connection","Creating WebChannel: "+u,o);var s=i.createWebChannel(u,o),c=!1,l=!1,h=new tb({Hr:function(e){l?Hd("Connection","Not sending because WebChannel is closed:",e):(c||(Hd("Connection","Opening WebChannel transport."),s.open(),c=!0),Hd("Connection","WebChannel sending:",e),s.send(e))},Jr:function(){return s.close()}}),f=function(e,t,n){e.listen(t,(function(e){try{n(e)}catch(e){setTimeout((function(){throw e}),0)}}))};return f(s,Ad.EventType.OPEN,(function(){l||Hd("Connection","WebChannel transport opened.")})),f(s,Ad.EventType.CLOSE,(function(){l||(l=!0,Hd("Connection","WebChannel transport closed"),h.io())})),f(s,Ad.EventType.ERROR,(function(e){l||(l=!0,Yd("Connection","WebChannel transport errored:",e),h.io(new tv(ev.UNAVAILABLE,"The operation could not be completed")))})),f(s,Ad.EventType.MESSAGE,(function(e){var t;if(!l){var n=e.data[0];Zd(!!n);var r=n,i=r.error||(null===(t=r[0])||void 0===t?void 0:t.error);if(i){Hd("Connection","WebChannel received error:",i);var a=i.status,o=function(e){var t=im[e];if(void 0!==t)return lm(t)}(a),u=i.message;void 0===o&&(o=ev.INTERNAL,u="Unknown error status: "+a+" with message "+i.message),l=!0,h.io(new tv(o,u)),s.close()}else Hd("Connection","WebChannel received:",n),h.ro(n)}})),f(a,Td.STAT_EVENT,(function(e){e.stat===Ed.PROXY?Hd("Connection","Detected buffering proxy"):e.stat===Ed.NOPROXY&&Hd("Connection","Detected no buffering proxy")})),setTimeout((function(){h.so()}),0),h}}]),r}(function(){"use strict";function t(n){e(s)(this,t),this.databaseInfo=n,this.databaseId=n.databaseId;var r=n.ssl?"https":"http";this.oo=r+"://"+n.host,this.uo="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}return e(c)(t,[{key:"co",value:function(e,t,n,r,i){var a=this.ao(e,t);Hd("RestConnection","Sending: ",a,n);var o={};return this.ho(o,r,i),this.lo(e,a,o,n).then((function(e){return Hd("RestConnection","Received: ",e),e}),(function(t){throw Yd("RestConnection","".concat(e," failed with error: "),t,"url: ",a,"request:",n),t}))}},{key:"fo",value:function(e,t,n,r,i,a){return this.co(e,t,n,r,i)}},{key:"ho",value:function(e,t,n){e["X-Goog-Api-Client"]="gl-js/ fire/"+Kd,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((function(t,n){return e[n]=t})),n&&n.headers.forEach((function(t,n){return e[n]=t}))}},{key:"ao",value:function(e,t){var n=eb[e];return"".concat(this.oo,"/v1/").concat(t,":").concat(n)}}]),t}());
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rb(){return"undefined"!=typeof window?window:null}function ib(){return"undefined"!=typeof document?document:null}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ab(e){return new Mm(e,!0)}var ob=function(){"use strict";function t(n,r){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1.5,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:6e4;e(s)(this,t),this.Hs=n,this.timerId=r,this.wo=i,this.mo=a,this.yo=o,this.po=0,this.Io=null,this.To=Date.now(),this.reset()}return e(c)(t,[{key:"reset",value:function(){this.po=0}},{key:"Eo",value:function(){this.po=this.yo}},{key:"Ao",value:function(e){var t=this;this.cancel();var n=Math.floor(this.po+this.Ro()),r=Math.max(0,Date.now()-this.To),i=Math.max(0,n-r);i>0&&Hd("ExponentialBackoff","Backing off for ".concat(i," ms (base delay: ").concat(this.po," ms, delay with jitter: ").concat(n," ms, last attempt: ").concat(r," ms ago)")),this.Io=this.Hs.enqueueAfterDelay(this.timerId,i,(function(){return t.To=Date.now(),e()})),this.po*=this.mo,this.po<this.wo&&(this.po=this.wo),this.po>this.yo&&(this.po=this.yo)}},{key:"bo",value:function(){null!==this.Io&&(this.Io.skipDelay(),this.Io=null)}},{key:"cancel",value:function(){null!==this.Io&&(this.Io.cancel(),this.Io=null)}},{key:"Ro",value:function(){return(Math.random()-.5)*this.po}}]),t}(),ub=function(){"use strict";function t(n,r,i,a,o,u,c,l){e(s)(this,t),this.Hs=n,this.Po=i,this.vo=a,this.Vo=o,this.authCredentialsProvider=u,this.appCheckCredentialsProvider=c,this.listener=l,this.state=0,this.So=0,this.Do=null,this.Co=null,this.stream=null,this.xo=new ob(n,r)}return e(c)(t,[{key:"No",value:function(){return 1===this.state||5===this.state||this.ko()}},{key:"ko",value:function(){return 2===this.state||3===this.state}},{key:"start",value:function(){4!==this.state?this.auth():this.Mo()}},{key:"stop",value:function(){var t=this;return e(ve)(e(ye).mark((function n(){return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=t.No(),!e.t0){e.next=4;break}return e.next=4,t.close(0);case 4:case"end":return e.stop()}}),n)})))()}},{key:"Oo",value:function(){this.state=0,this.xo.reset()}},{key:"Fo",value:function(){var e=this;this.ko()&&null===this.Do&&(this.Do=this.Hs.enqueueAfterDelay(this.Po,6e4,(function(){return e.$o()})))}},{key:"Bo",value:function(e){this.Lo(),this.stream.send(e)}},{key:"$o",value:function(){var t=this;return e(ve)(e(ye).mark((function n(){return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.ko()){e.next=2;break}return e.abrupt("return",t.close(0));case 2:case"end":return e.stop()}}),n)})))()}},{key:"Lo",value:function(){this.Do&&(this.Do.cancel(),this.Do=null)}},{key:"Uo",value:function(){this.Co&&(this.Co.cancel(),this.Co=null)}},{key:"close",value:function(t,n){var r=this;return e(ve)(e(ye).mark((function i(){return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r.Lo(),r.Uo(),r.xo.cancel(),r.So++,4!==t?r.xo.reset():n&&n.code===ev.RESOURCE_EXHAUSTED?(Qd(n.toString()),Qd("Using maximum backoff delay to prevent overloading the backend."),r.xo.Eo()):n&&n.code===ev.UNAUTHENTICATED&&3!==r.state&&(r.authCredentialsProvider.invalidateToken(),r.appCheckCredentialsProvider.invalidateToken()),null!==r.stream&&(r.qo(),r.stream.close(),r.stream=null),r.state=t,e.next=9,r.listener.Zr(n);case 9:case"end":return e.stop()}}),i)})))()}},{key:"qo",value:function(){}},{key:"auth",value:function(){var t=this;this.state=1;var n=this.Ko(this.So),r=this.So;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((function(n){var i=e(y)(n,2),a=i[0],o=i[1];t.So===r&&t.Go(a,o)}),(function(e){var r=t;n((function(){var t=new tv(ev.UNKNOWN,"Fetching auth token failed: "+e.message);return r.Qo(t)}))}))}},{key:"Go",value:function(e,t){var n=this,r=this.Ko(this.So);this.stream=this.jo(e,t),this.stream.Yr((function(){var e=n;r((function(){return e.state=2,e.Co=e.Hs.enqueueAfterDelay(e.vo,1e4,(function(){return e.ko()&&(e.state=3),Promise.resolve()})),e.listener.Yr()}))})),this.stream.Zr((function(e){var t=n;r((function(){return t.Qo(e)}))})),this.stream.onMessage((function(e){var t=n;r((function(){return t.onMessage(e)}))}))}},{key:"Mo",value:function(){var t=this;this.state=5,this.xo.Ao(e(ve)(e(ye).mark((function n(){return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.state=0,t.start();case 1:case"end":return e.stop()}}),n)}))))}},{key:"Qo",value:function(e){return Hd("PersistentStream","close with error: ".concat(e)),this.stream=null,this.close(4,e)}},{key:"Ko",value:function(e){var t=this;return function(n){var r=t;t.Hs.enqueueAndForget((function(){return r.So===e?n():(Hd("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())}))}}}]),t}(),sb=function(t){"use strict";e(d)(r,t);var n=e(L)(r);function r(t,i,a,o,u,c){var l;return e(s)(this,r),(l=n.call(this,t,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",i,a,o,c)).It=u,e(wc)(l)}return e(c)(r,[{key:"jo",value:function(e,t){return this.Vo._o("Listen",e,t)}},{key:"onMessage",value:function(e){this.xo.reset();var t=function(e,t){var n,r;if("targetChange"in t){t.targetChange;var i="NO_CHANGE"===(r=t.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===r?1:"REMOVE"===r?2:"CURRENT"===r?3:"RESET"===r?4:Xd(),a=t.targetChange.targetIds||[],o=function(e,t){return e.gt?(Zd(void 0===t||"string"==typeof t),op.fromBase64String(t||"")):(Zd(void 0===t||t instanceof Uint8Array),op.fromUint8Array(t||new Uint8Array))}(e,t.targetChange.resumeToken),u=t.targetChange.cause,s=u&&function(e){var t=void 0===e.code?ev.UNKNOWN:lm(e.code);return new tv(t,e.message||"")}(u);n=new Cm(i,a,o,s||null)}else if("documentChange"in t){t.documentChange;var c=t.documentChange;c.document,c.document.name,c.document.updateTime;var l=Km(e,c.document.name),h=Bm(c.document.updateTime),f=new Bp({mapValue:{fields:c.document.fields}}),d=jp.newFoundDocument(l,h,f),v=c.targetIds||[],p=c.removedTargetIds||[];n=new Sm(v,p,d.key,d)}else if("documentDelete"in t){t.documentDelete;var y=t.documentDelete;y.document;var m=Km(e,y.document),g=y.readTime?Bm(y.readTime):mv.min(),k=jp.newNoDocument(m,g),w=y.removedTargetIds||[];n=new Sm([],w,k.key,k)}else if("documentRemove"in t){t.documentRemove;var b=t.documentRemove;b.document;var x=Km(e,b.document),I=b.removedTargetIds||[];n=new Sm([],I,x,null)}else{if(!("filter"in t))return Xd();t.filter;var _=t.filter;_.targetId;var T=_.count||0,E=new sm(T),S=_.targetId;n=new Am(S,E)}return n}(this.It,e),n=function(e){if(!("targetChange"in e))return mv.min();var t=e.targetChange;return t.targetIds&&t.targetIds.length?mv.min():t.readTime?Bm(t.readTime):mv.min()}(e);return this.listener.Wo(t,n)}},{key:"zo",value:function(e){var t,n,r,i,a={};a.database=Hm(this.It),a.addTarget=(t=this.It,i=(n=e).target,(r=Hp(i)?{documents:$m(t,i)}:{query:eg(t,i)}).targetId=n.targetId,n.resumeToken.approximateByteSize()>0?r.resumeToken=Vm(t,n.resumeToken):n.snapshotVersion.compareTo(mv.min())>0&&(r.readTime=Fm(t,n.snapshotVersion.toTimestamp())),r);var o=function(e,t){var n=function(e,t){switch(t){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return Xd()}}(0,t.purpose);return null==n?null:{"goog-listen-tags":n}}(this.It,e);o&&(a.labels=o),this.Bo(a)}},{key:"Ho",value:function(e){var t={};t.database=Hm(this.It),t.removeTarget=e,this.Bo(t)}}]),r}(ub),cb=function(t){"use strict";e(d)(r,t);var n=e(L)(r);function r(t,i,a,o,u,c){var l;return e(s)(this,r),(l=n.call(this,t,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",i,a,o,c)).It=u,l.Jo=!1,e(wc)(l)}return e(c)(r,[{key:"Yo",get:function(){return this.Jo}},{key:"start",value:function(){this.Jo=!1,this.lastStreamToken=void 0,e(Qt)(e(Xt)(r.prototype),"start",this).call(this)}},{key:"qo",value:function(){this.Jo&&this.Xo([])}},{key:"jo",value:function(e,t){return this.Vo._o("Write",e,t)}},{key:"onMessage",value:function(e){if(Zd(!!e.streamToken),this.lastStreamToken=e.streamToken,this.Jo){this.xo.reset();var t=(r=e.writeResults,i=e.commitTime,r&&r.length>0?(Zd(void 0!==i),r.map((function(e){return n=i,(r=(t=e).updateTime?Bm(t.updateTime):Bm(n)).isEqual(mv.min())&&(r=Bm(n)),new Ky(r,t.transformResults||[]);var t,n,r}))):[]),n=Bm(e.commitTime);return this.listener.Zo(n,t)}var r,i;return Zd(!e.writeResults||0===e.writeResults.length),this.Jo=!0,this.listener.tu()}},{key:"eu",value:function(){var e={};e.database=Hm(this.It),this.Bo(e)}},{key:"Xo",value:function(e){var t=this,n={streamToken:this.lastStreamToken,writes:e.map((function(e){return Xm(t.It,e)}))};this.Bo(n)}}]),r}(ub),lb=function(t){"use strict";e(d)(r,(function t(){e(s)(this,t)}));var n=e(L)(r);function r(t,i,a,o){var u;return e(s)(this,r),(u=n.call(this)).authCredentials=t,u.appCheckCredentials=i,u.Vo=a,u.It=o,u.nu=!1,e(wc)(u)}return e(c)(r,[{key:"su",value:function(){if(this.nu)throw new tv(ev.FAILED_PRECONDITION,"The client has already been terminated.")}},{key:"co",value:function(t,n,r){var i=this;return this.su(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((function(a){var o=e(y)(a,2),u=o[0],s=o[1];return i.Vo.co(t,n,r,u,s)})).catch((function(e){throw"FirebaseError"===e.name?(e.code===ev.UNAUTHENTICATED&&(i.authCredentials.invalidateToken(),i.appCheckCredentials.invalidateToken()),e):new tv(ev.UNKNOWN,e.toString())}))}},{key:"fo",value:function(t,n,r,i){var a=this;return this.su(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((function(o){var u=e(y)(o,2),s=u[0],c=u[1];return a.Vo.fo(t,n,r,s,c,i)})).catch((function(e){throw"FirebaseError"===e.name?(e.code===ev.UNAUTHENTICATED&&(a.authCredentials.invalidateToken(),a.appCheckCredentials.invalidateToken()),e):new tv(ev.UNKNOWN,e.toString())}))}},{key:"terminate",value:function(){this.nu=!0}}]),r}(),hb=function(){"use strict";function t(n,r){e(s)(this,t),this.asyncQueue=n,this.onlineStateHandler=r,this.state="Unknown",this.iu=0,this.ru=null,this.ou=!0}return e(c)(t,[{key:"uu",value:function(){var e=this;0===this.iu&&(this.cu("Unknown"),this.ru=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(function(){return e.ru=null,e.au("Backend didn't respond within 10 seconds."),e.cu("Offline"),Promise.resolve()})))}},{key:"hu",value:function(e){"Online"===this.state?this.cu("Unknown"):(this.iu++,this.iu>=1&&(this.lu(),this.au("Connection failed 1 times. Most recent error: ".concat(e.toString())),this.cu("Offline")))}},{key:"set",value:function(e){this.lu(),this.iu=0,"Online"===e&&(this.ou=!1),this.cu(e)}},{key:"cu",value:function(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}},{key:"au",value:function(e){var t="Could not reach Cloud Firestore backend. ".concat(e,"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.");this.ou?(Qd(t),this.ou=!1):Hd("OnlineStateTracker",t)}},{key:"lu",value:function(){null!==this.ru&&(this.ru.cancel(),this.ru=null)}}]),t}(),fb=function t(n,r,i,a,o){"use strict";var u=this;e(s)(this,t),this.localStore=n,this.datastore=r,this.asyncQueue=i,this.remoteSyncer={},this.fu=[],this.du=new Map,this._u=new Set,this.wu=[],this.mu=o,this.mu.qr((function(t){var n=u;i.enqueueAndForget(e(ve)(e(ye).mark((function t(){return e(ye).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.t0=Ib(n),!t.t0){t.next=5;break}return Hd("RemoteStore","Restarting streams for network reachability change."),t.next=5,function(){var t=e(ve)(e(ye).mark((function t(n){var r;return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(r=$d(n))._u.add(4),e.next=4,pb(r);case 4:return r.gu.set("Unknown"),r._u.delete(4),e.next=8,db(r);case 8:case"end":return e.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()(n);case 5:case"end":return t.stop()}}),t)}))))})),this.gu=new hb(i,a)};
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function db(e){return vb.apply(this,arguments)}function vb(){return(vb=e(ve)(e(ye).mark((function t(n){var r,i,a,o,u,s;return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=!0,i=!1,a=void 0,!Ib(n)){e.next=25;break}e.prev=2,o=n.wu[Symbol.iterator]();case 4:if(r=(u=o.next()).done){e.next=11;break}return s=u.value,e.next=8,s(!0);case 8:r=!0,e.next=4;break;case 11:e.next=17;break;case 13:e.prev=13,e.t0=e.catch(2),i=!0,a=e.t0;case 17:e.prev=17,e.prev=18,r||null==o.return||o.return();case 20:if(e.prev=20,!i){e.next=23;break}throw a;case 23:return e.finish(20);case 24:return e.finish(17);case 25:case"end":return e.stop()}}),t,null,[[2,13,17,25],[18,,20,24]])})))).apply(this,arguments)}function pb(e){return yb.apply(this,arguments)}function yb(){return(yb=e(ve)(e(ye).mark((function t(n){var r,i,a,o,u,s;return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=!0,i=!1,a=void 0,e.prev=1,o=n.wu[Symbol.iterator]();case 3:if(r=(u=o.next()).done){e.next=10;break}return s=u.value,e.next=7,s(!1);case 7:r=!0,e.next=3;break;case 10:e.next=16;break;case 12:e.prev=12,e.t0=e.catch(1),i=!0,a=e.t0;case 16:e.prev=16,e.prev=17,r||null==o.return||o.return();case 19:if(e.prev=19,!i){e.next=22;break}throw a;case 22:return e.finish(19);case 23:return e.finish(16);case 24:case"end":return e.stop()}}),t,null,[[1,12,16,24],[17,,19,23]])})))).apply(this,arguments)}function mb(e,t){var n=$d(e);n.du.has(t.targetId)||(n.du.set(t.targetId,t),xb(n)?bb(n):Zb(n).ko()&&kb(n,t))}function gb(e,t){var n=$d(e),r=Zb(n);n.du.delete(t),r.ko()&&wb(n,t),0===n.du.size&&(r.ko()?r.Fo():Ib(n)&&n.gu.set("Unknown"))}function kb(e,t){e.yu.Ot(t.targetId),Zb(e).zo(t)}function wb(e,t){e.yu.Ot(t),Zb(e).Ho(t)}function bb(e){e.yu=new Dm({getRemoteKeysForTarget:function(t){return e.remoteSyncer.getRemoteKeysForTarget(t)},se:function(t){return e.du.get(t)||null}}),Zb(e).start(),e.gu.uu()}function xb(e){return Ib(e)&&!Zb(e).No()&&e.du.size>0}function Ib(e){return 0===$d(e)._u.size}function _b(e){e.yu=void 0}function Tb(e){return Eb.apply(this,arguments)}function Eb(){return(Eb=e(ve)(e(ye).mark((function t(n){return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n.du.forEach((function(e,t){kb(n,e)}));case 1:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function Sb(e,t){return Ab.apply(this,arguments)}function Ab(){return(Ab=e(ve)(e(ye).mark((function t(n,r){return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:_b(n),xb(n)?(n.gu.hu(r),bb(n)):n.gu.set("Unknown");case 1:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function Cb(e,t,n){return Nb.apply(this,arguments)}function Nb(){return Nb=e(ve)(e(ye).mark((function t(n,r,i){var a;return e(ye).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n.gu.set("Online"),!(r instanceof Cm&&2===r.state&&r.cause)){t.next=13;break}return t.prev=1,t.next=4,function(){var t=e(ve)(e(ye).mark((function t(n,r){var i,a,o,u,s,c,l;return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i=r.cause,a=!0,o=!1,u=void 0,e.prev=2,s=r.targetIds[Symbol.iterator]();case 4:if(a=(c=s.next()).done){e.next=15;break}if(l=c.value,e.t0=n.du.has(l),!e.t0){e.next=12;break}return e.next=10,n.remoteSyncer.rejectListen(l,i);case 10:n.du.delete(l),n.yu.removeTarget(l);case 12:a=!0,e.next=4;break;case 15:e.next=21;break;case 17:e.prev=17,e.t1=e.catch(2),o=!0,u=e.t1;case 21:e.prev=21,e.prev=22,a||null==s.return||s.return();case 24:if(e.prev=24,!o){e.next=27;break}throw u;case 27:return e.finish(24);case 28:return e.finish(21);case 29:case"end":return e.stop()}}),t,null,[[2,17,21,29],[22,,24,28]])})));return function(e,n){return t.apply(this,arguments)}}()(n,r);case 4:t.next=11;break;case 6:return t.prev=6,t.t0=t.catch(1),Hd("RemoteStore","Failed to remove targets %s: %s ",r.targetIds.join(","),t.t0),t.next=11,Db(n,t.t0);case 11:case 22:t.next=29;break;case 13:if(r instanceof Sm?n.yu.Gt(r):r instanceof Am?n.yu.Yt(r):n.yu.Wt(r),i.isEqual(mv.min())){t.next=29;break}return t.prev=14,t.next=17,Sw(n.localStore);case 17:if(a=t.sent,t.t1=i.compareTo(a)>=0,!t.t1){t.next=22;break}return t.next=22,function(e,t){var n=e.yu.te(t);return n.targetChanges.forEach((function(n,r){if(n.resumeToken.approximateByteSize()>0){var i=e.du.get(r);i&&e.du.set(r,i.withResumeToken(n.resumeToken,t))}})),n.targetMismatches.forEach((function(t){var n=e.du.get(t);if(n){e.du.set(t,n.withResumeToken(op.EMPTY_BYTE_STRING,n.snapshotVersion)),wb(e,t);var r=new qg(n.target,t,1,n.sequenceNumber);kb(e,r)}})),e.remoteSyncer.applyRemoteEvent(n)}(n,i);case 24:return t.prev=24,t.t2=t.catch(14),Hd("RemoteStore","Failed to raise snapshot:",t.t2),t.next=29,Db(n,t.t2);case 29:case"end":return t.stop()}}),t,null,[[1,6],[14,24]])}))),Nb.apply(this,arguments)}function Db(e,t,n){return Rb.apply(this,arguments)}function Rb(){return(Rb=e(ve)(e(ye).mark((function t(n,r,i){return e(ye).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(qv(r)){t.next=2;break}throw r;case 2:return n._u.add(1),t.next=5,pb(n);case 5:n.gu.set("Offline"),i||(i=function(){return Sw(n.localStore)}),n.asyncQueue.enqueueRetryable(e(ve)(e(ye).mark((function t(){return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Hd("RemoteStore","Retrying IndexedDB access"),e.next=3,i();case 3:return n._u.delete(1),e.next=6,db(n);case 6:case"end":return e.stop()}}),t)}))));case 8:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Ob(e,t){return t().catch((function(n){return Db(e,n,t)}))}function Pb(e){return Lb.apply(this,arguments)}function Lb(){return(Lb=e(ve)(e(ye).mark((function t(n){var r,i,a,o;return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=$d(n),i=$b(r),a=r.fu.length>0?r.fu[r.fu.length-1].batchId:-1;case 2:if(!Mb(r)){e.next=19;break}return e.prev=3,e.next=6,Nw(r.localStore,a);case 6:if(null!==(o=e.sent)){e.next=10;break}return 0===r.fu.length&&i.Fo(),e.abrupt("break",19);case 10:a=o.batchId,Fb(r,o),e.next=17;break;case 13:return e.prev=13,e.t0=e.catch(3),e.next=17,Db(r,e.t0);case 17:e.next=2;break;case 19:Vb(r)&&Ub(r);case 20:case"end":return e.stop()}}),t,null,[[3,13]])})))).apply(this,arguments)}function Mb(e){return Ib(e)&&e.fu.length<10}function Fb(e,t){e.fu.push(t);var n=$b(e);n.ko()&&n.Yo&&n.Xo(t.mutations)}function Vb(e){return Ib(e)&&!$b(e).No()&&e.fu.length>0}function Ub(e){$b(e).start()}function Bb(e){return qb.apply(this,arguments)}function qb(){return(qb=e(ve)(e(ye).mark((function t(n){return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:$b(n).eu();case 1:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function jb(e){return Gb.apply(this,arguments)}function Gb(){return(Gb=e(ve)(e(ye).mark((function t(n){var r,i,a,o,u,s,c;return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(r=$b(n),i=!0,a=!1,o=void 0,e.prev=2,u=n.fu[Symbol.iterator]();!(i=(s=u.next()).done);i=!0)c=s.value,r.Xo(c.mutations);e.next=10;break;case 6:e.prev=6,e.t0=e.catch(2),a=!0,o=e.t0;case 10:e.prev=10,e.prev=11,i||null==u.return||u.return();case 13:if(e.prev=13,!a){e.next=16;break}throw o;case 16:return e.finish(13);case 17:return e.finish(10);case 18:case"end":return e.stop()}}),t,null,[[2,6,10,18],[11,,13,17]])})))).apply(this,arguments)}function Kb(e,t,n){return zb.apply(this,arguments)}function zb(){return(zb=e(ve)(e(ye).mark((function t(n,r,i){var a,o;return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=n.fu.shift(),o=Ug.from(a,r,i),e.next=3,Ob(n,(function(){return n.remoteSyncer.applySuccessfulWrite(o)}));case 3:return e.next=5,Pb(n);case 5:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function Wb(e,t){return Hb.apply(this,arguments)}function Hb(){return Hb=e(ve)(e(ye).mark((function t(n,r){return e(ye).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.t0=r&&$b(n).Yo,!t.t0){t.next=4;break}return t.next=4,function(){var t=e(ve)(e(ye).mark((function t(n,r){var i,a;return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!cm(a=r.code)||a===ev.ABORTED){e.next=7;break}return i=n.fu.shift(),$b(n).Oo(),e.next=5,Ob(n,(function(){return n.remoteSyncer.rejectFailedWrite(i.batchId,r)}));case 5:return e.next=7,Pb(n);case 7:case 8:case"end":return e.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()(n,r);case 4:Vb(n)&&Ub(n);case 5:case"end":return t.stop()}}),t)}))),Hb.apply(this,arguments)}function Qb(e,t){return Yb.apply(this,arguments)}function Yb(){return(Yb=e(ve)(e(ye).mark((function t(n,r){var i,a;return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(i=$d(n)).asyncQueue.verifyOperationInProgress(),Hd("RemoteStore","RemoteStore received new credentials"),a=Ib(i),i._u.add(3),e.next=6,pb(i);case 6:return a&&i.gu.set("Unknown"),e.next=9,i.remoteSyncer.handleCredentialChange(r);case 9:return i._u.delete(3),e.next=12,db(i);case 12:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function Jb(e,t){return Xb.apply(this,arguments)}function Xb(){return(Xb=e(ve)(e(ye).mark((function t(n,r){var i;return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=$d(n),!r){e.next=7;break}return i._u.delete(2),e.next=5,db(i);case 5:e.next=13;break;case 7:if(e.t0=r,e.t0){e.next=13;break}return i._u.add(2),e.next=12,pb(i);case 12:i.gu.set("Unknown");case 13:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function Zb(t){return t.pu||(t.pu=(r=t.datastore,i=t.asyncQueue,a={Yr:Tb.bind(null,t),Zr:Sb.bind(null,t),Wo:Cb.bind(null,t)},(o=$d(r)).su(),new sb(i,o.Vo,o.authCredentials,o.appCheckCredentials,o.It,a)),t.wu.push((n=e(ve)(e(ye).mark((function n(r){return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!r){e.next=4;break}t.pu.Oo(),xb(t)?bb(t):t.gu.set("Unknown"),e.next=7;break;case 4:return e.next=6,t.pu.stop();case 6:_b(t);case 7:case"end":return e.stop()}}),n)}))),function(e){return n.apply(this,arguments)}))),t.pu;var n,r,i,a,o}function $b(t){return t.Iu||(t.Iu=(r=t.datastore,i=t.asyncQueue,a={Yr:Bb.bind(null,t),Zr:Wb.bind(null,t),tu:jb.bind(null,t),Zo:Kb.bind(null,t)},(o=$d(r)).su(),new cb(i,o.Vo,o.authCredentials,o.appCheckCredentials,o.It,a)),t.wu.push((n=e(ve)(e(ye).mark((function n(r){return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!r){e.next=6;break}return t.Iu.Oo(),e.next=4,Pb(t);case 4:e.next=9;break;case 6:return e.next=8,t.Iu.stop();case 8:t.fu.length>0&&(Hd("RemoteStore","Stopping write stream with ".concat(t.fu.length," pending writes")),t.fu=[]);case 9:case"end":return e.stop()}}),n)}))),function(e){return n.apply(this,arguments)}))),t.Iu
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */;var n,r,i,a,o}var ex=function(){"use strict";function t(n,r,i,a,o){e(s)(this,t),this.asyncQueue=n,this.timerId=r,this.targetTimeMs=i,this.op=a,this.removalCallback=o,this.deferred=new nv,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((function(e){}))}return e(c)(t,[{key:"start",value:function(e){var t=this;this.timerHandle=setTimeout((function(){return t.handleDelayElapsed()}),e)}},{key:"skipDelay",value:function(){return this.handleDelayElapsed()}},{key:"cancel",value:function(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new tv(ev.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}},{key:"handleDelayElapsed",value:function(){var e=this;this.asyncQueue.enqueueAndForget((function(){return null!==e.timerHandle?(e.clearTimeout(),e.op().then((function(t){return e.deferred.resolve(t)}))):Promise.resolve()}))}},{key:"clearTimeout",value:function(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}],[{key:"createAndSchedule",value:function(e,n,r,i,a){var o=new t(e,n,Date.now()+r,i,a);return o.start(r),o}}]),t}();function tx(e,t){if(Qd("AsyncQueue","".concat(t,": ").concat(e)),qv(e))return new tv(ev.UNAVAILABLE,"".concat(t,": ").concat(e));throw e}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var nx=function(){"use strict";function t(n){e(s)(this,t),this.comparator=n?function(e,t){return n(e,t)||xv.comparator(e.key,t.key)}:function(e,t){return xv.comparator(e.key,t.key)},this.keyedMap=pm(),this.sortedSet=new Zv(this.comparator)}return e(c)(t,[{key:"has",value:function(e){return null!=this.keyedMap.get(e)}},{key:"get",value:function(e){return this.keyedMap.get(e)}},{key:"first",value:function(){return this.sortedSet.minKey()}},{key:"last",value:function(){return this.sortedSet.maxKey()}},{key:"isEmpty",value:function(){return this.sortedSet.isEmpty()}},{key:"indexOf",value:function(e){var t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}},{key:"size",get:function(){return this.sortedSet.size}},{key:"forEach",value:function(e){this.sortedSet.inorderTraversal((function(t,n){return e(t),!1}))}},{key:"add",value:function(e){var t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}},{key:"delete",value:function(e){var t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}},{key:"isEqual",value:function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();n.hasNext();){var i=n.getNext().key,a=r.getNext().key;if(!i.isEqual(a))return!1}return!0}},{key:"toString",value:function(){var e=[];return this.forEach((function(t){e.push(t.toString())})),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}},{key:"copy",value:function(e,n){var r=new t;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}],[{key:"emptySet",value:function(e){return new t(e.comparator)}}]),t}(),rx=function(){"use strict";function t(){e(s)(this,t),this.Tu=new Zv(xv.comparator)}return e(c)(t,[{key:"track",value:function(e){var t=e.doc.key,n=this.Tu.get(t);n?0!==e.type&&3===n.type?this.Tu=this.Tu.insert(t,e):3===e.type&&1!==n.type?this.Tu=this.Tu.insert(t,{type:n.type,doc:e.doc}):2===e.type&&2===n.type?this.Tu=this.Tu.insert(t,{type:2,doc:e.doc}):2===e.type&&0===n.type?this.Tu=this.Tu.insert(t,{type:0,doc:e.doc}):1===e.type&&0===n.type?this.Tu=this.Tu.remove(t):1===e.type&&2===n.type?this.Tu=this.Tu.insert(t,{type:1,doc:n.doc}):0===e.type&&1===n.type?this.Tu=this.Tu.insert(t,{type:2,doc:e.doc}):Xd():this.Tu=this.Tu.insert(t,e)}},{key:"Eu",value:function(){var e=[];return this.Tu.inorderTraversal((function(t,n){e.push(n)})),e}}]),t}(),ix=function(){"use strict";function t(n,r,i,a,o,u,c,l){e(s)(this,t),this.query=n,this.docs=r,this.oldDocs=i,this.docChanges=a,this.mutatedKeys=o,this.fromCache=u,this.syncStateChanged=c,this.excludesMetadataChanges=l}return e(c)(t,[{key:"hasPendingWrites",get:function(){return!this.mutatedKeys.isEmpty()}},{key:"isEqual",value:function(e){if(!(this.fromCache===e.fromCache&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&by(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;var t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(var r=0;r<t.length;r++)if(t[r].type!==n[r].type||!t[r].doc.isEqual(n[r].doc))return!1;return!0}}],[{key:"fromInitialDocuments",value:function(e,n,r,i){var a=[];return n.forEach((function(e){a.push({type:0,doc:e})})),new t(e,n,nx.emptySet(n),a,r,i,!0,!1)}}]),t}(),ax=function t(){"use strict";e(s)(this,t),this.Au=void 0,this.listeners=[]},ox=function t(){"use strict";e(s)(this,t),this.queries=new hm((function(e){return xy(e)}),by),this.onlineState="Unknown",this.Ru=new Set};
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ux(e,t){return sx.apply(this,arguments)}function sx(){return(sx=e(ve)(e(ye).mark((function t(n,r){var i,a,o,u,s;return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=$d(n),a=r.query,o=!1,(u=i.queries.get(a))||(o=!0,u=new ax),!o){e.next=13;break}return e.prev=3,e.next=6,i.onListen(a);case 6:u.Au=e.sent,e.next=13;break;case 9:return e.prev=9,e.t0=e.catch(3),s=tx(e.t0,"Initialization of query '".concat(Iy(r.query),"' failed")),e.abrupt("return",void r.onError(s));case 13:i.queries.set(a,u),u.listeners.push(r),r.bu(i.onlineState),u.Au&&r.Pu(u.Au)&&dx(i);case 14:case"end":return e.stop()}}),t,null,[[3,9]])})))).apply(this,arguments)}function cx(e,t){return lx.apply(this,arguments)}function lx(){return(lx=e(ve)(e(ye).mark((function t(n,r){var i,a,o,u,s;return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=$d(n),a=r.query,o=!1,(u=i.queries.get(a))&&(s=u.listeners.indexOf(r))>=0&&(u.listeners.splice(s,1),o=0===u.listeners.length),!o){e.next=6;break}return e.abrupt("return",(i.queries.delete(a),i.onUnlisten(a)));case 6:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function hx(e,t){var n=$d(e),r=!1,i=!0,a=!1,o=void 0;try{for(var u,s=t[Symbol.iterator]();!(i=(u=s.next()).done);i=!0){var c=u.value,l=c.query,h=n.queries.get(l);if(h){var f=!0,d=!1,v=void 0;try{for(var p,y=h.listeners[Symbol.iterator]();!(f=(p=y.next()).done);f=!0){p.value.Pu(c)&&(r=!0)}}catch(e){d=!0,v=e}finally{try{f||null==y.return||y.return()}finally{if(d)throw v}}h.Au=c}}}catch(e){a=!0,o=e}finally{try{i||null==s.return||s.return()}finally{if(a)throw o}}r&&dx(n)}function fx(e,t,n){var r=$d(e),i=r.queries.get(t),a=!0,o=!1,u=void 0;if(i)try{for(var s,c=i.listeners[Symbol.iterator]();!(a=(s=c.next()).done);a=!0){s.value.onError(n)}}catch(e){o=!0,u=e}finally{try{a||null==c.return||c.return()}finally{if(o)throw u}}r.queries.delete(t)}function dx(e){e.Ru.forEach((function(e){e.next()}))}var vx=function(){"use strict";function t(n,r,i){e(s)(this,t),this.query=n,this.vu=r,this.Vu=!1,this.Su=null,this.onlineState="Unknown",this.options=i||{}}return e(c)(t,[{key:"Pu",value:function(e){if(!this.options.includeMetadataChanges){var t=[],n=!0,r=!1,i=void 0;try{for(var a,o=e.docChanges[Symbol.iterator]();!(n=(a=o.next()).done);n=!0){var u=a.value;3!==u.type&&t.push(u)}}catch(e){r=!0,i=e}finally{try{n||null==o.return||o.return()}finally{if(r)throw i}}e=new ix(e.query,e.docs,e.oldDocs,t,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0)}var s=!1;return this.Vu?this.Du(e)&&(this.vu.next(e),s=!0):this.Cu(e,this.onlineState)&&(this.xu(e),s=!0),this.Su=e,s}},{key:"onError",value:function(e){this.vu.error(e)}},{key:"bu",value:function(e){this.onlineState=e;var t=!1;return this.Su&&!this.Vu&&this.Cu(this.Su,e)&&(this.xu(this.Su),t=!0),t}},{key:"Cu",value:function(e,t){if(!e.fromCache)return!0;var n="Offline"!==t;return!(this.options.Nu&&n||e.docs.isEmpty()&&"Offline"!==t)}},{key:"Du",value:function(e){if(e.docChanges.length>0)return!0;var t=this.Su&&this.Su.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&!0===this.options.includeMetadataChanges}},{key:"xu",value:function(e){e=ix.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache),this.Vu=!0,this.vu.next(e)}}]),t}(),px=function(){"use strict";function t(n,r){e(s)(this,t),this.payload=n,this.byteLength=r}return e(c)(t,[{key:"ku",value:function(){return"metadata"in this.payload}}]),t}(),yx=function(){"use strict";function t(n){e(s)(this,t),this.It=n}return e(c)(t,[{key:"Ji",value:function(e){return Km(this.It,e)}},{key:"Yi",value:function(e){return e.metadata.exists?Jm(this.It,e.document,!1):jp.newNoDocument(this.Ji(e.metadata.name),this.Xi(e.metadata.readTime))}},{key:"Xi",value:function(e){return Bm(e)}}]),t}(),mx=function(){"use strict";function t(n,r,i){e(s)(this,t),this.Mu=n,this.localStore=r,this.It=i,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=gx(n)}return e(c)(t,[{key:"Ou",value:function(e){this.progress.bytesLoaded+=e.byteLength;var t=this.progress.documentsLoaded;if(e.payload.namedQuery)this.queries.push(e.payload.namedQuery);else if(e.payload.documentMetadata){this.documents.push({metadata:e.payload.documentMetadata}),e.payload.documentMetadata.exists||++t;var n=kv.fromString(e.payload.documentMetadata.name);this.collectionGroups.add(n.get(n.length-2))}else e.payload.document&&(this.documents[this.documents.length-1].document=e.payload.document,++t);return t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,Object.assign({},this.progress)):null}},{key:"Fu",value:function(e){var t=new Map,n=new yx(this.It),r=!0,i=!1,a=void 0;try{for(var o,u=e[Symbol.iterator]();!(r=(o=u.next()).done);r=!0){var s=o.value;if(s.metadata.queries){var c=n.Ji(s.metadata.name),l=!0,h=!1,f=void 0;try{for(var d,v=s.metadata.queries[Symbol.iterator]();!(l=(d=v.next()).done);l=!0){var p=d.value,y=(t.get(p)||xm()).add(c);t.set(p,y)}}catch(e){h=!0,f=e}finally{try{l||null==v.return||v.return()}finally{if(h)throw f}}}}}catch(e){i=!0,a=e}finally{try{r||null==u.return||u.return()}finally{if(i)throw a}}return t}},{key:"complete",value:function(){var t=this;return e(ve)(e(ye).mark((function n(){var r,i,a,o,u,s,c,l;return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Vw(t.localStore,new yx(t.It),t.documents,t.Mu.id);case 2:r=e.sent,i=t.Fu(t.documents),a=!0,o=!1,u=void 0,e.prev=5,s=t.queries[Symbol.iterator]();case 7:if(a=(c=s.next()).done){e.next=14;break}return l=c.value,e.next=11,Bw(t.localStore,l,i.get(l.name));case 11:a=!0,e.next=7;break;case 14:e.next=20;break;case 16:e.prev=16,e.t0=e.catch(5),o=!0,u=e.t0;case 20:e.prev=20,e.prev=21,a||null==s.return||s.return();case 23:if(e.prev=23,!o){e.next=26;break}throw u;case 26:return e.finish(23);case 27:return e.finish(20);case 28:return e.abrupt("return",(t.progress.taskState="Success",{progress:t.progress,$u:t.collectionGroups,Bu:r}));case 29:case"end":return e.stop()}}),n,null,[[5,16,20,28],[21,,23,27]])})))()}}]),t}();
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gx(e){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:e.totalDocuments,totalBytes:e.totalBytes}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var kx=function t(n){"use strict";e(s)(this,t),this.key=n},wx=function t(n){"use strict";e(s)(this,t),this.key=n},bx=function(){"use strict";function t(n,r){e(s)(this,t),this.query=n,this.Lu=r,this.Uu=null,this.current=!1,this.qu=xm(),this.mutatedKeys=xm(),this.Ku=Ey(n),this.Gu=new nx(this.Ku)}return e(c)(t,[{key:"Qu",get:function(){return this.Lu}},{key:"ju",value:function(e,t){var n=this,r=t?t.Wu:new rx,i=t?t.Gu:this.Gu,a=t?t.mutatedKeys:this.mutatedKeys,o=i,u=!1,s="F"===this.query.limitType&&i.size===this.query.limit?i.last():null,c="L"===this.query.limitType&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((function(e,t){var l=i.get(e),h=_y(n.query,t)?t:null,f=!!l&&n.mutatedKeys.has(l.key),d=!!h&&(h.hasLocalMutations||n.mutatedKeys.has(h.key)&&h.hasCommittedMutations),v=!1;l&&h?l.data.isEqual(h.data)?f!==d&&(r.track({type:3,doc:h}),v=!0):n.zu(l,h)||(r.track({type:2,doc:h}),v=!0,(s&&n.Ku(h,s)>0||c&&n.Ku(h,c)<0)&&(u=!0)):!l&&h?(r.track({type:0,doc:h}),v=!0):l&&!h&&(r.track({type:1,doc:l}),v=!0,(s||c)&&(u=!0)),v&&(h?(o=o.add(h),a=d?a.add(e):a.delete(e)):(o=o.delete(e),a=a.delete(e)))})),null!==this.query.limit)for(;o.size>this.query.limit;){var l="F"===this.query.limitType?o.last():o.first();o=o.delete(l.key),a=a.delete(l.key),r.track({type:1,doc:l})}return{Gu:o,Wu:r,$i:u,mutatedKeys:a}}},{key:"zu",value:function(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}},{key:"applyChanges",value:function(e,t,n){var r=this,i=this.Gu;this.Gu=e.Gu,this.mutatedKeys=e.mutatedKeys;var a=e.Wu.Eu();a.sort((function(e,t){return n=e.type,i=t.type,(a=function(e){switch(e){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Xd()}})(n)-a(i)||r.Ku(e.doc,t.doc);var n,i,a})),this.Hu(n);var o=t?this.Ju():[],u=0===this.qu.size&&this.current?1:0,s=u!==this.Uu;return this.Uu=u,0!==a.length||s?{snapshot:new ix(this.query,e.Gu,i,a,e.mutatedKeys,0===u,s,!1),Yu:o}:{Yu:o}}},{key:"bu",value:function(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({Gu:this.Gu,Wu:new rx,mutatedKeys:this.mutatedKeys,$i:!1},!1)):{Yu:[]}}},{key:"Xu",value:function(e){return!this.Lu.has(e)&&!!this.Gu.has(e)&&!this.Gu.get(e).hasLocalMutations}},{key:"Hu",value:function(e){var t=this;e&&(e.addedDocuments.forEach((function(e){return t.Lu=t.Lu.add(e)})),e.modifiedDocuments.forEach((function(e){})),e.removedDocuments.forEach((function(e){return t.Lu=t.Lu.delete(e)})),this.current=e.current)}},{key:"Ju",value:function(){var e=this;if(!this.current)return[];var t=this.qu;this.qu=xm(),this.Gu.forEach((function(t){e.Xu(t.key)&&(e.qu=e.qu.add(t.key))}));var n=[];return t.forEach((function(t){e.qu.has(t)||n.push(new wx(t))})),this.qu.forEach((function(e){t.has(e)||n.push(new kx(e))})),n}},{key:"Zu",value:function(e){this.Lu=e.Hi,this.qu=xm();var t=this.ju(e.documents);return this.applyChanges(t,!0)}},{key:"tc",value:function(){return ix.fromInitialDocuments(this.query,this.Gu,this.mutatedKeys,0===this.Uu)}}]),t}(),xx=function t(n,r,i){"use strict";e(s)(this,t),this.query=n,this.targetId=r,this.view=i},Ix=function t(n){"use strict";e(s)(this,t),this.key=n,this.ec=!1},_x=function(){"use strict";function t(n,r,i,a,o,u){e(s)(this,t),this.localStore=n,this.remoteStore=r,this.eventManager=i,this.sharedClientState=a,this.currentUser=o,this.maxConcurrentLimboResolutions=u,this.nc={},this.sc=new hm((function(e){return xy(e)}),by),this.ic=new Map,this.rc=new Set,this.oc=new Zv(xv.comparator),this.uc=new Map,this.cc=new iw,this.ac={},this.hc=new Map,this.lc=Pk.vn(),this.onlineState="Unknown",this.fc=void 0}return e(c)(t,[{key:"isPrimaryClient",get:function(){return!0===this.fc}}]),t}();function Tx(e,t){return Ex.apply(this,arguments)}function Ex(){return(Ex=e(ve)(e(ye).mark((function t(n,r){var i,a,o,u,s,c;return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=gI(n),!(u=i.sc.get(r))){e.next=7;break}a=u.targetId,i.sharedClientState.addLocalQueryTarget(a),o=u.view.tc(),e.next=16;break;case 7:return e.next=9,Dw(i.localStore,ky(r));case 9:return s=e.sent,i.isPrimaryClient&&mb(i.remoteStore,s),c=i.sharedClientState.addLocalQueryTarget(s.targetId),a=s.targetId,e.next=15,Sx(i,r,a,"current"===c);case 15:o=e.sent;case 16:return e.abrupt("return",o);case 17:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function Sx(e,t,n,r){return Ax.apply(this,arguments)}function Ax(){return Ax=e(ve)(e(ye).mark((function t(n,r,i,a){var o,u,s,c,l,h;return e(ye).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n.dc=function(t,r,i){return(a=e(ve)(e(ye).mark((function t(n,r,i,a){var o,u,s;return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=r.view.ju(i),e.t0=o.$i,!e.t0){e.next=6;break}return e.next=5,Pw(n.localStore,r.query,!1).then((function(e){var t=e.documents;return r.view.ju(t,o)}));case 5:o=e.sent;case 6:return u=a&&a.targetChanges.get(r.targetId),s=r.view.applyChanges(o,n.isPrimaryClient,u),e.abrupt("return",(Qx(n,r.targetId,s.Yu),s.snapshot));case 8:case"end":return e.stop()}}),t)}))),function(e,t,n,r){return a.apply(this,arguments)})(n,t,r,i);var a},t.next=3,Pw(n.localStore,r,!0);case 3:return o=t.sent,u=new bx(r,o.Hi),s=u.ju(o.documents),c=Em.createSynthesizedTargetChangeForCurrentChange(i,a&&"Offline"!==n.onlineState),l=u.applyChanges(s,n.isPrimaryClient,c),Qx(n,i,l.Yu),h=new xx(r,i,u),t.abrupt("return",(n.sc.set(r,h),n.ic.has(i)?n.ic.get(i).push(r):n.ic.set(i,[r]),l.snapshot));case 11:case"end":return t.stop()}}),t)}))),Ax.apply(this,arguments)}function Cx(e,t){return Nx.apply(this,arguments)}function Nx(){return(Nx=e(ve)(e(ye).mark((function t(n,r){var i,a,o;return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=$d(n),a=i.sc.get(r),!((o=i.ic.get(a.targetId)).length>1)){e.next=3;break}return e.abrupt("return",(i.ic.set(a.targetId,o.filter((function(e){return!by(e,r)}))),void i.sc.delete(r)));case 3:if(!i.isPrimaryClient){e.next=11;break}if(i.sharedClientState.removeLocalQueryTarget(a.targetId),e.t0=i.sharedClientState.isActiveQueryTarget(a.targetId),e.t0){e.next=9;break}return e.next=9,Rw(i.localStore,a.targetId,!1).then((function(){i.sharedClientState.clearQueryState(a.targetId),gb(i.remoteStore,a.targetId),Wx(i,a.targetId)})).catch(Pv);case 9:e.next=14;break;case 11:return Wx(i,a.targetId),e.next=14,Rw(i.localStore,a.targetId,!0);case 14:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function Dx(e,t,n){return Rx.apply(this,arguments)}function Rx(){return(Rx=e(ve)(e(ye).mark((function t(n,r,i){var a,o,u;return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=kI(n),e.prev=1,e.next=4,function(e,t){var n,r,i=$d(e),a=yv.now(),o=t.reduce((function(e,t){return e.add(t.key)}),xm());return i.persistence.runTransaction("Locally write mutations","readwrite",(function(e){var u=dm(),s=xm();return i.Gi.getEntries(e,o).next((function(e){(u=e).forEach((function(e,t){t.isValidDocument()||(s=s.add(e))}))})).next((function(){return i.localDocuments.getOverlayedDocuments(e,u)})).next((function(r){n=r;var o=[],u=!0,s=!1,c=void 0;try{for(var l,h=t[Symbol.iterator]();!(u=(l=h.next()).done);u=!0){var f=l.value,d=Xy(f,n.get(f.key).overlayedDocument);null!=d&&o.push(new em(f.key,d,qp(d.value.mapValue),zy.exists(!0)))}}catch(e){s=!0,c=e}finally{try{u||null==h.return||h.return()}finally{if(s)throw c}}return i.mutationQueue.addMutationBatch(e,a,o,t)})).next((function(t){r=t;var a=t.applyToLocalDocumentSet(n,s);return i.documentOverlayCache.saveOverlays(e,t.batchId,a)}))})).then((function(){return{batchId:r.batchId,changes:ym(n)}}))}(a.localStore,r);case 4:return o=e.sent,a.sharedClientState.addPendingMutation(o.batchId),t=a,s=o.batchId,c=i,l=void 0,(l=t.ac[t.currentUser.toKey()])||(l=new Zv(dv)),l=l.insert(s,c),t.ac[t.currentUser.toKey()]=l,e.next=9,Xx(a,o.changes);case 9:return e.next=11,Pb(a.remoteStore);case 11:e.next=17;break;case 13:e.prev=13,e.t0=e.catch(1),u=tx(e.t0,"Failed to persist write"),i.reject(u);case 17:case"end":return e.stop()}var t,s,c,l}),t,null,[[1,13]])})))).apply(this,arguments)}function Ox(e,t){return Px.apply(this,arguments)}function Px(){return(Px=e(ve)(e(ye).mark((function t(n,r){var i,a;return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=$d(n),e.prev=1,e.next=4,Aw(i.localStore,r);case 4:return a=e.sent,r.targetChanges.forEach((function(e,t){var n=i.uc.get(t);n&&(Zd(e.addedDocuments.size+e.modifiedDocuments.size+e.removedDocuments.size<=1),e.addedDocuments.size>0?n.ec=!0:e.modifiedDocuments.size>0?Zd(n.ec):e.removedDocuments.size>0&&(Zd(n.ec),n.ec=!1))})),e.next=8,Xx(i,a,r);case 8:e.next=14;break;case 10:return e.prev=10,e.t0=e.catch(1),e.next=14,Pv(e.t0);case 14:case"end":return e.stop()}}),t,null,[[1,10]])})))).apply(this,arguments)}function Lx(e,t,n){var r=$d(e);if(r.isPrimaryClient&&0===n||!r.isPrimaryClient&&1===n){var i=[];r.sc.forEach((function(e,n){var r=n.view.bu(t);r.snapshot&&i.push(r.snapshot)})),function(e,t){var n=$d(e);n.onlineState=t;var r=!1;n.queries.forEach((function(e,n){var i=!0,a=!1,o=void 0;try{for(var u,s=n.listeners[Symbol.iterator]();!(i=(u=s.next()).done);i=!0){u.value.bu(t)&&(r=!0)}}catch(e){a=!0,o=e}finally{try{i||null==s.return||s.return()}finally{if(a)throw o}}})),r&&dx(n)}(r.eventManager,t),i.length&&r.nc.Wo(i),r.onlineState=t,r.isPrimaryClient&&r.sharedClientState.setOnlineState(t)}}function Mx(e,t,n){return Fx.apply(this,arguments)}function Fx(){return(Fx=e(ve)(e(ye).mark((function t(n,r,i){var a,o,u,s,c,l;return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((a=$d(n)).sharedClientState.updateQueryState(r,"rejected",i),o=a.uc.get(r),!(u=o&&o.key)){e.next=14;break}return s=(s=new Zv(xv.comparator)).insert(u,jp.newNoDocument(u,mv.min())),c=xm().add(u),l=new Tm(mv.min(),new Map,new tp(dv),s,c),e.next=9,Ox(a,l);case 9:a.oc=a.oc.remove(u),a.uc.delete(r),Jx(a),e.next=16;break;case 14:return e.next=16,Rw(a.localStore,r,!1).then((function(){return Wx(a,r,i)})).catch(Pv);case 16:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function Vx(e,t){return Ux.apply(this,arguments)}function Ux(){return(Ux=e(ve)(e(ye).mark((function t(n,r){var i,a,o;return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=$d(n),a=r.batch.batchId,e.prev=1,e.next=4,Ew(i.localStore,r);case 4:return o=e.sent,zx(i,a,null),Kx(i,a),i.sharedClientState.updateMutationState(a,"acknowledged"),e.next=10,Xx(i,o);case 10:e.next=16;break;case 12:return e.prev=12,e.t0=e.catch(1),e.next=16,Pv(e.t0);case 16:case"end":return e.stop()}}),t,null,[[1,12]])})))).apply(this,arguments)}function Bx(e,t,n){return qx.apply(this,arguments)}function qx(){return(qx=e(ve)(e(ye).mark((function t(n,r,i){var a,o;return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=$d(n),e.prev=1,e.next=4,function(e,t){var n=$d(e);return n.persistence.runTransaction("Reject batch","readwrite-primary",(function(e){var r;return n.mutationQueue.lookupMutationBatch(e,t).next((function(t){return Zd(null!==t),r=t.keys(),n.mutationQueue.removeMutationBatch(e,t)})).next((function(){return n.mutationQueue.performConsistencyCheck(e)})).next((function(){return n.documentOverlayCache.removeOverlaysForBatchId(e,r,t)})).next((function(){return n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,r)})).next((function(){return n.localDocuments.getDocuments(e,r)}))}))}(a.localStore,r);case 4:return o=e.sent,zx(a,r,i),Kx(a,r),a.sharedClientState.updateMutationState(r,"rejected",i),e.next=10,Xx(a,o);case 10:e.next=16;break;case 12:return e.prev=12,e.t0=e.catch(1),e.next=16,Pv(e.t0);case 16:case"end":return e.stop()}}),t,null,[[1,12]])})))).apply(this,arguments)}function jx(e,t){return Gx.apply(this,arguments)}function Gx(){return(Gx=e(ve)(e(ye).mark((function t(n,r){var i,a,o,u;return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Ib((i=$d(n)).remoteStore)||Hd("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),e.prev=2,e.next=5,function(e){var t=$d(e);return t.persistence.runTransaction("Get highest unacknowledged batch id","readonly",(function(e){return t.mutationQueue.getHighestUnacknowledgedBatchId(e)}))}(i.localStore);case 5:if(-1!==(a=e.sent)){e.next=8;break}return e.abrupt("return",void r.resolve());case 8:(o=i.hc.get(a)||[]).push(r),i.hc.set(a,o),e.next=16;break;case 12:e.prev=12,e.t0=e.catch(2),u=tx(e.t0,"Initialization of waitForPendingWrites() operation failed"),r.reject(u);case 16:case"end":return e.stop()}}),t,null,[[2,12]])})))).apply(this,arguments)}function Kx(e,t){(e.hc.get(t)||[]).forEach((function(e){e.resolve()})),e.hc.delete(t)}function zx(e,t,n){var r=$d(e),i=r.ac[r.currentUser.toKey()];if(i){var a=i.get(t);a&&(n?a.reject(n):a.resolve(),i=i.remove(t)),r.ac[r.currentUser.toKey()]=i}}function Wx(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;e.sharedClientState.removeLocalQueryTarget(t);var r=!0,i=!1,a=void 0;try{for(var o,u=e.ic.get(t)[Symbol.iterator]();!(r=(o=u.next()).done);r=!0){var s=o.value;e.sc.delete(s),n&&e.nc._c(s,n)}}catch(e){i=!0,a=e}finally{try{r||null==u.return||u.return()}finally{if(i)throw a}}e.ic.delete(t),e.isPrimaryClient&&e.cc.ls(t).forEach((function(t){e.cc.containsKey(t)||Hx(e,t)}))}function Hx(e,t){e.rc.delete(t.path.canonicalString());var n=e.oc.get(t);null!==n&&(gb(e.remoteStore,n),e.oc=e.oc.remove(t),e.uc.delete(n),Jx(e))}function Qx(e,t,n){var r=!0,i=!1,a=void 0;try{for(var o,u=n[Symbol.iterator]();!(r=(o=u.next()).done);r=!0){var s=o.value;s instanceof kx?(e.cc.addReference(s.key,t),Yx(e,s)):s instanceof wx?(Hd("SyncEngine","Document no longer in limbo: "+s.key),e.cc.removeReference(s.key,t),e.cc.containsKey(s.key)||Hx(e,s.key)):Xd()}}catch(e){i=!0,a=e}finally{try{r||null==u.return||u.return()}finally{if(i)throw a}}}function Yx(e,t){var n=t.key,r=n.path.canonicalString();e.oc.get(n)||e.rc.has(r)||(Hd("SyncEngine","New document in limbo: "+n),e.rc.add(r),Jx(e))}function Jx(e){for(;e.rc.size>0&&e.oc.size<e.maxConcurrentLimboResolutions;){var t=e.rc.values().next().value;e.rc.delete(t);var n=new xv(kv.fromString(t)),r=e.lc.next();e.uc.set(r,new Ix(n)),e.oc=e.oc.insert(n,r),mb(e.remoteStore,new qg(ky(dy(n.path)),r,2,Qv.at))}}function Xx(e,t,n){return Zx.apply(this,arguments)}function Zx(){return Zx=e(ve)(e(ye).mark((function t(n,r,i){var a,o,u,s;return e(ye).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a=$d(n),o=[],u=[],s=[],t.t0=a.sc.isEmpty(),t.t0){t.next=9;break}return a.sc.forEach((function(e,t){s.push(a.dc(t,r,i).then((function(e){if(e){a.isPrimaryClient&&a.sharedClientState.updateQueryState(t.targetId,e.fromCache?"not-current":"current"),o.push(e);var n=ww.Ci(t.targetId,e);u.push(n)}})))})),t.next=6,Promise.all(s);case 6:return a.nc.Wo(o),t.next=9,function(){var t=e(ve)(e(ye).mark((function t(n,r){var i,a,o,u,s,c,l,h,f,d,v;return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=$d(n),e.prev=1,e.next=4,i.persistence.runTransaction("notifyLocalViewChanges","readwrite",(function(e){return Mv.forEach(r,(function(t){return Mv.forEach(t.Si,(function(n){return i.persistence.referenceDelegate.addReference(e,t.targetId,n)})).next((function(){return Mv.forEach(t.Di,(function(n){return i.persistence.referenceDelegate.removeReference(e,t.targetId,n)}))}))}))}));case 4:e.next=11;break;case 6:if(e.prev=6,e.t0=e.catch(1),qv(e.t0)){e.next=10;break}throw e.t0;case 10:Hd("LocalStore","Failed to update sequence numbers: "+e.t0);case 11:for(a=!0,o=!1,u=void 0,e.prev=12,s=r[Symbol.iterator]();!(a=(c=s.next()).done);a=!0)l=c.value,h=l.targetId,l.fromCache||(f=i.Ui.get(h),d=f.snapshotVersion,v=f.withLastLimboFreeSnapshotVersion(d),i.Ui=i.Ui.insert(h,v));e.next=20;break;case 16:e.prev=16,e.t1=e.catch(12),o=!0,u=e.t1;case 20:e.prev=20,e.prev=21,a||null==s.return||s.return();case 23:if(e.prev=23,!o){e.next=26;break}throw u;case 26:return e.finish(23);case 27:return e.finish(20);case 28:case"end":return e.stop()}}),t,null,[[1,6],[12,16,20,28],[21,,23,27]])})));return function(e,n){return t.apply(this,arguments)}}()(a.localStore,u);case 9:case"end":return t.stop()}}),t)}))),Zx.apply(this,arguments)}function $x(e,t){return eI.apply(this,arguments)}function eI(){return(eI=e(ve)(e(ye).mark((function t(n,r){var i,a;return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((i=$d(n)).currentUser.isEqual(r)){e.next=11;break}return Hd("SyncEngine","User change. New user:",r.toKey()),e.next=5,_w(i.localStore,r);case 5:return a=e.sent,i.currentUser=r,(t=i).hc.forEach((function(e){e.forEach((function(e){e.reject(new tv(ev.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))}))})),t.hc.clear(),i.sharedClientState.handleUserChange(r,a.removedBatchIds,a.addedBatchIds),e.next=11,Xx(i,a.ji);case 11:case"end":return e.stop()}var t}),t)})))).apply(this,arguments)}function tI(e,t){var n=$d(e),r=n.uc.get(t);if(r&&r.ec)return xm().add(r.key);var i=xm(),a=n.ic.get(t);if(!a)return i;var o=!0,u=!1,s=void 0;try{for(var c,l=a[Symbol.iterator]();!(o=(c=l.next()).done);o=!0){var h=c.value,f=n.sc.get(h);i=i.unionWith(f.view.Qu)}}catch(e){u=!0,s=e}finally{try{o||null==l.return||l.return()}finally{if(u)throw s}}return i}function nI(e,t){return rI.apply(this,arguments)}function rI(){return(rI=e(ve)(e(ye).mark((function t(n,r){var i,a,o;return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=$d(n),e.next=3,Pw(i.localStore,r.query,!0);case 3:return a=e.sent,o=r.view.Zu(a),e.abrupt("return",(i.isPrimaryClient&&Qx(i,r.targetId,o.Yu),o));case 6:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function iI(e,t){return aI.apply(this,arguments)}function aI(){return(aI=e(ve)(e(ye).mark((function t(n,r){var i;return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=$d(n),e.abrupt("return",Mw(i.localStore,r).then((function(e){return Xx(i,e)})));case 2:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function oI(e,t,n,r){return uI.apply(this,arguments)}function uI(){return(uI=e(ve)(e(ye).mark((function t(n,r,i,a){var o,u;return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=$d(n),e.next=3,function(e,t){var n=$d(e),r=$d(n.mutationQueue);return n.persistence.runTransaction("Lookup mutation documents","readonly",(function(e){return r.Tn(e,t).next((function(t){return t?n.localDocuments.getDocuments(e,t):Mv.resolve(null)}))}))}(o.localStore,r);case 3:if(null===(u=e.sent)){e.next=15;break}if("pending"!==i){e.next=10;break}return e.next=8,Pb(o.remoteStore);case 8:e.next=11;break;case 10:"acknowledged"===i||"rejected"===i?(zx(o,r,a||null),Kx(o,r),t=o.localStore,s=r,$d($d(t).mutationQueue).An(s)):Xd();case 11:return e.next=13,Xx(o,u);case 13:e.next=16;break;case 15:Hd("SyncEngine","Cannot apply mutation batch with id: "+r);case 16:case"end":return e.stop()}var t,s}),t)})))).apply(this,arguments)}function sI(e,t){return cI.apply(this,arguments)}function cI(){return(cI=e(ve)(e(ye).mark((function t(n,r){var i,a,o,u,s,c,l,h,f,d,v;return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(gI(i=$d(n)),kI(i),!0!==r||!0===i.fc){e.next=28;break}return a=i.sharedClientState.getAllActiveQueryTargets(),e.next=5,lI(i,a.toArray());case 5:return o=e.sent,i.fc=!0,e.next=9,Jb(i.remoteStore,!0);case 9:for(u=!0,s=!1,c=void 0,e.prev=10,l=o[Symbol.iterator]();!(u=(h=l.next()).done);u=!0)f=h.value,mb(i.remoteStore,f);e.next=18;break;case 14:e.prev=14,e.t0=e.catch(10),s=!0,c=e.t0;case 18:e.prev=18,e.prev=19,u||null==l.return||l.return();case 21:if(e.prev=21,!s){e.next=24;break}throw c;case 24:return e.finish(21);case 25:return e.finish(18);case 26:e.next=40;break;case 28:if(!1!==r||!1===i.fc){e.next=40;break}return d=[],v=Promise.resolve(),i.ic.forEach((function(e,t){i.sharedClientState.isLocalQueryTarget(t)?d.push(t):v=v.then((function(){return Wx(i,t),Rw(i.localStore,t,!0)})),gb(i.remoteStore,t)})),e.next=34,v;case 34:return e.next=36,lI(i,d);case 36:return function(e){var t=$d(e);t.uc.forEach((function(e,n){gb(t.remoteStore,n)})),t.cc.fs(),t.uc=new Map,t.oc=new Zv(xv.comparator)}(i),i.fc=!1,e.next=40,Jb(i.remoteStore,!1);case 40:case"end":return e.stop()}}),t,null,[[10,14,18,26],[19,,21,25]])})))).apply(this,arguments)}function lI(e,t,n){return hI.apply(this,arguments)}function hI(){return(hI=e(ve)(e(ye).mark((function t(n,r,i){var a,o,u,s,c,l,h,f,d,v,p,y,m,g,k,w,b,x,I,_;return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=$d(n),o=[],u=[],s=!0,c=!1,l=void 0,e.prev=2,h=r[Symbol.iterator]();case 4:if(s=(f=h.next()).done){e.next=53;break}if(d=f.value,!(p=a.ic.get(d))||0===p.length){e.next=41;break}return e.next=11,Dw(a.localStore,ky(p[0]));case 11:v=e.sent,y=!0,m=!1,g=void 0,e.prev=13,k=p[Symbol.iterator]();case 15:if(y=(w=k.next()).done){e.next=25;break}return b=w.value,x=a.sc.get(b),e.next=20,nI(a,x);case 20:(I=e.sent).snapshot&&u.push(I.snapshot);case 22:y=!0,e.next=15;break;case 25:e.next=31;break;case 27:e.prev=27,e.t0=e.catch(13),m=!0,g=e.t0;case 31:e.prev=31,e.prev=32,y||null==k.return||k.return();case 34:if(e.prev=34,!m){e.next=37;break}throw g;case 37:return e.finish(34);case 38:return e.finish(31);case 39:e.next=49;break;case 41:return e.next=43,Lw(a.localStore,d);case 43:return _=e.sent,e.next=46,Dw(a.localStore,_);case 46:return v=e.sent,e.next=49,Sx(a,fI(_),d,!1);case 49:o.push(v);case 50:s=!0,e.next=4;break;case 53:e.next=59;break;case 55:e.prev=55,e.t1=e.catch(2),c=!0,l=e.t1;case 59:e.prev=59,e.prev=60,s||null==h.return||h.return();case 62:if(e.prev=62,!c){e.next=65;break}throw l;case 65:return e.finish(62);case 66:return e.finish(59);case 67:return e.abrupt("return",(a.nc.Wo(u),o));case 68:case"end":return e.stop()}}),t,null,[[2,55,59,67],[13,27,31,39],[32,,34,38],[60,,62,66]])})))).apply(this,arguments)}function fI(e){return fy(e.path,e.collectionGroup,e.orderBy,e.filters,e.limit,"F",e.startAt,e.endAt)}function dI(e){var t=$d(e);return $d($d(t.localStore).persistence).vi()}function vI(e,t,n,r){return pI.apply(this,arguments)}function pI(){return(pI=e(ve)(e(ye).mark((function t(n,r,i,a){var o,u,s,c;return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(o=$d(n)).fc){e.next=3;break}return e.abrupt("return",void Hd("SyncEngine","Ignoring unexpected query state notification."));case 3:if(!((u=o.ic.get(r))&&u.length>0)){e.next=20;break}e.t0=i,e.next="current"===e.t0||"not-current"===e.t0?8:"rejected"===e.t0?15:19;break;case 8:return e.next=10,Mw(o.localStore,Ty(u[0]));case 10:return s=e.sent,c=Tm.createSynthesizedRemoteEventForCurrentChange(r,"current"===i),e.next=14,Xx(o,s,c);case 14:return e.abrupt("break",20);case 15:return e.next=17,Rw(o.localStore,r,!0);case 17:return Wx(o,r,a),e.abrupt("break",20);case 19:Xd();case 20:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function yI(e,t,n){return mI.apply(this,arguments)}function mI(){return(mI=e(ve)(e(ye).mark((function t(n,r,i){var a,o,u,s,c,l,h,f,d,v,p,y,m,g,k;return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(a=gI(n)).fc){e.next=62;break}o=!0,u=!1,s=void 0,e.prev=3,c=r[Symbol.iterator]();case 5:if(o=(l=c.next()).done){e.next=22;break}if(h=l.value,!a.ic.has(h)){e.next=10;break}return Hd("SyncEngine","Adding an already active target "+h),e.abrupt("continue",19);case 10:return e.next=12,Lw(a.localStore,h);case 12:return f=e.sent,e.next=15,Dw(a.localStore,f);case 15:return d=e.sent,e.next=18,Sx(a,fI(f),d.targetId,!1);case 18:mb(a.remoteStore,d);case 19:o=!0,e.next=5;break;case 22:e.next=28;break;case 24:e.prev=24,e.t0=e.catch(3),u=!0,s=e.t0;case 28:e.prev=28,e.prev=29,o||null==c.return||c.return();case 31:if(e.prev=31,!u){e.next=34;break}throw s;case 34:return e.finish(31);case 35:return e.finish(28);case 36:v=!0,p=!1,y=void 0,e.prev=37,m=i[Symbol.iterator]();case 39:if(v=(g=m.next()).done){e.next=48;break}if(k=g.value,e.t1=a.ic.has(k),!e.t1){e.next=45;break}return e.next=45,Rw(a.localStore,k,!1).then((function(){gb(a.remoteStore,k),Wx(a,k)})).catch(Pv);case 45:v=!0,e.next=39;break;case 48:e.next=54;break;case 50:e.prev=50,e.t2=e.catch(37),p=!0,y=e.t2;case 54:e.prev=54,e.prev=55,v||null==m.return||m.return();case 57:if(e.prev=57,!p){e.next=60;break}throw y;case 60:return e.finish(57);case 61:return e.finish(54);case 62:case"end":return e.stop()}}),t,null,[[3,24,28,36],[29,,31,35],[37,50,54,62],[55,,57,61]])})))).apply(this,arguments)}function gI(e){var t=$d(e);return t.remoteStore.remoteSyncer.applyRemoteEvent=Ox.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=tI.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=Mx.bind(null,t),t.nc.Wo=hx.bind(null,t.eventManager),t.nc._c=fx.bind(null,t.eventManager),t}function kI(e){var t=$d(e);return t.remoteStore.remoteSyncer.applySuccessfulWrite=Vx.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=Bx.bind(null,t),t}function wI(t,n,r){var i,a=$d(t);(i=e(ve)(e(ye).mark((function t(n,r,i){var a,o,u,s,c;return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,r.getMetadata();case 3:return a=e.sent,e.next=6,function(e,t){var n=$d(e),r=Bm(t.createTime);return n.persistence.runTransaction("hasNewerBundle","readonly",(function(e){return n.Ns.getBundleMetadata(e,t.id)})).then((function(e){return!!e&&e.createTime.compareTo(r)>=0}))}(n.localStore,a);case 6:if(!e.sent){e.next=11;break}return e.next=9,r.close();case 9:return i._completeWith({taskState:"Success",documentsLoaded:(t=a).totalDocuments,bytesLoaded:t.totalBytes,totalDocuments:t.totalDocuments,totalBytes:t.totalBytes}),e.abrupt("return",(e.sent,Promise.resolve(new Set)));case 11:return i._updateProgress(gx(a)),o=new mx(a,n.localStore,r.It),e.next=15,r.wc();case 15:u=e.sent;case 16:if(!u){e.next=26;break}return e.next=19,o.Ou(u);case 19:return(s=e.sent)&&i._updateProgress(s),e.next=23,r.wc();case 23:u=e.sent;case 24:e.next=16;break;case 26:return e.next=28,o.complete();case 28:return c=e.sent,e.next=31,Xx(n,c.Bu,void 0);case 31:return e.next=33,function(e,t){var n=$d(e);return n.persistence.runTransaction("Save bundle","readwrite",(function(e){return n.Ns.saveBundleMetadata(e,t)}))}(n.localStore,a);case 33:return i._completeWith(c.progress),e.abrupt("return",(e.sent,e.sent,Promise.resolve(c.$u)));case 37:return e.prev=37,e.t0=e.catch(0),e.abrupt("return",(Yd("SyncEngine","Loading bundle failed with ".concat(e.t0)),i._failWith(e.t0),Promise.resolve(new Set)));case 40:case"end":return e.stop()}var t}),t,null,[[0,37]])}))),function(e,t,n){return i.apply(this,arguments)})(a,n,r).then((function(e){a.sharedClientState.notifyBundleLoaded(e)}))}var bI=function(){"use strict";function t(){e(s)(this,t),this.synchronizeTabs=!1}return e(c)(t,[{key:"initialize",value:function(t){var n=this;return e(ve)(e(ye).mark((function r(){return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.It=ab(t.databaseInfo.databaseId),n.sharedClientState=n.mc(t),n.persistence=n.gc(t),e.next=5,n.persistence.start();case 5:n.localStore=n.yc(t),n.gcScheduler=n.Ic(t,n.localStore),n.indexBackfillerScheduler=n.Tc(t,n.localStore);case 8:case"end":return e.stop()}}),r)})))()}},{key:"Ic",value:function(e,t){return null}},{key:"Tc",value:function(e,t){return null}},{key:"yc",value:function(e){return Iw(this.persistence,new bw,e.initialUser,this.It)}},{key:"gc",value:function(e){return new lw(fw.Bs,this.It)}},{key:"mc",value:function(e){return new Xw}},{key:"terminate",value:function(){var t=this;return e(ve)(e(ye).mark((function n(){return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.gcScheduler&&t.gcScheduler.stop(),e.next=3,t.sharedClientState.shutdown();case 3:return e.next=5,t.persistence.shutdown();case 5:case"end":return e.stop()}}),n)})))()}}]),t}(),xI=function(t){"use strict";e(d)(r,t);var n=e(L)(r);function r(t,i,a){var o;return e(s)(this,r),(o=n.call(this)).Ec=t,o.cacheSizeBytes=i,o.forceOwnership=a,o.synchronizeTabs=!1,e(wc)(o)}return e(c)(r,[{key:"initialize",value:function(t){var n=this,i=this;return e(ve)(e(ye).mark((function a(){return e(ye).wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,e(Qt)(e(Xt)(r.prototype),"initialize",n).call(i,t);case 2:return a.next=4,i.Ec.initialize(i,t);case 4:return a.next=6,kI(i.Ec.syncEngine);case 6:return a.next=8,Pb(i.Ec.remoteStore);case 8:return a.next=10,i.persistence.li((function(){return i.gcScheduler&&!i.gcScheduler.started&&i.gcScheduler.start(),i.indexBackfillerScheduler&&!i.indexBackfillerScheduler.started&&i.indexBackfillerScheduler.start(),Promise.resolve()}));case 10:case"end":return a.stop()}}),a)})))()}},{key:"yc",value:function(e){return Iw(this.persistence,new bw,e.initialUser,this.It)}},{key:"Ic",value:function(e,t){var n=this.persistence.referenceDelegate.garbageCollector;return new qk(n,e.asyncQueue,t)}},{key:"Tc",value:function(e,t){var n=new Hv(t,this.persistence);return new Wv(e.asyncQueue,n)}},{key:"gc",value:function(e){var t=kw(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),n=void 0!==this.cacheSizeBytes?Ek.withCacheSize(this.cacheSizeBytes):Ek.DEFAULT;return new yw(this.synchronizeTabs,t,e.clientId,n,e.asyncQueue,rb(),ib(),this.It,this.sharedClientState,!!this.forceOwnership)}},{key:"mc",value:function(e){return new Xw}}]),r}(bI),II=function(t){"use strict";e(d)(r,t);var n=e(L)(r);function r(t,i){var a;return e(s)(this,r),(a=n.call(this,t,i,!1)).Ec=t,a.cacheSizeBytes=i,a.synchronizeTabs=!0,e(wc)(a)}return e(c)(r,[{key:"initialize",value:function(t){var n=this,i=this;return e(ve)(e(ye).mark((function a(){var o;return e(ye).wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,e(Qt)(e(Xt)(r.prototype),"initialize",n).call(i,t);case 2:if(o=i.Ec.syncEngine,a.t0=i.sharedClientState instanceof Jw,!a.t0){a.next=8;break}return i.sharedClientState.syncEngine={Fr:oI.bind(null,o),$r:vI.bind(null,o),Br:yI.bind(null,o),vi:dI.bind(null,o),Or:iI.bind(null,o)},a.next=8,i.sharedClientState.start();case 8:return a.next=10,i.persistence.li(function(){var t=e(ve)(e(ye).mark((function t(n){return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,sI(i.Ec.syncEngine,n);case 2:i.gcScheduler&&(n&&!i.gcScheduler.started?i.gcScheduler.start():n||i.gcScheduler.stop()),i.indexBackfillerScheduler&&(n&&!i.indexBackfillerScheduler.started?i.indexBackfillerScheduler.start():n||i.indexBackfillerScheduler.stop());case 4:case"end":return e.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 10:case"end":return a.stop()}}),a)})))()}},{key:"mc",value:function(e){var t=rb();if(!Jw.C(t))throw new tv(ev.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");var n=kw(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new Jw(t,e.asyncQueue,n,e.clientId,e.initialUser)}}]),r}(xI),_I=function(){"use strict";function t(){e(s)(this,t)}return e(c)(t,[{key:"initialize",value:function(t,n){var r=this;return e(ve)(e(ye).mark((function i(){return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=r.localStore,e.t0){e.next=12;break}return r.localStore=t.localStore,r.sharedClientState=t.sharedClientState,r.datastore=r.createDatastore(n),r.remoteStore=r.createRemoteStore(n),r.eventManager=r.createEventManager(n),r.syncEngine=r.createSyncEngine(n,!t.synchronizeTabs),r.sharedClientState.onlineStateHandler=function(e){return Lx(r.syncEngine,e,1)},r.remoteStore.remoteSyncer.handleCredentialChange=$x.bind(null,r.syncEngine),e.next=12,Jb(r.remoteStore,r.syncEngine.isPrimaryClient);case 12:case"end":return e.stop()}}),i)})))()}},{key:"createEventManager",value:function(e){return new ox}},{key:"createDatastore",value:function(e){var t,n,r,i=ab(e.databaseInfo.databaseId),a=(t=e.databaseInfo,new nb(t));return n=e.authCredentials,r=e.appCheckCredentials,new lb(n,r,a,i)}},{key:"createRemoteStore",value:function(e){var t,n,r,i,a,o=this;return t=this.localStore,n=this.datastore,r=e.asyncQueue,i=function(e){return Lx(o.syncEngine,e,0)},a=$w.C()?new $w:new Zw,new fb(t,n,r,i,a)}},{key:"createSyncEngine",value:function(e,t){return function(e,t,n,r,i,a,o){var u=new _x(e,t,n,r,i,a);return o&&(u.fc=!0),u}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}},{key:"terminate",value:function(){return(t=e(ve)(e(ye).mark((function t(n){var r;return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=$d(n),Hd("RemoteStore","RemoteStore shutting down."),r._u.add(5),e.next=5,pb(r);case 5:r.mu.shutdown(),r.gu.set("Unknown");case 7:case"end":return e.stop()}}),t)}))),function(e){return t.apply(this,arguments)})(this.remoteStore);var t}}]),t}();
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function TI(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10240,r=0;return{read:function(){return e(ve)(e(ye).mark((function i(){var a;return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(r<t.byteLength)){e.next=3;break}return a={value:t.slice(r,r+n),done:!1},e.abrupt("return",(r+=n,a));case 3:return e.abrupt("return",{done:!0});case 4:case"end":return e.stop()}}),i)})))()},cancel:function(){return e(ve)(e(ye).mark((function t(){return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),t)})))()},releaseLock:function(){},closed:Promise.reject("unimplemented")}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var EI=function(){"use strict";function t(n){e(s)(this,t),this.observer=n,this.muted=!1}return e(c)(t,[{key:"next",value:function(e){this.observer.next&&this.Ac(this.observer.next,e)}},{key:"error",value:function(e){this.observer.error?this.Ac(this.observer.error,e):Qd("Uncaught Error in snapshot listener:",e)}},{key:"Rc",value:function(){this.muted=!0}},{key:"Ac",value:function(e,t){var n=this;this.muted||setTimeout((function(){n.muted||e(t)}),0)}}]),t}(),SI=function(){"use strict";function t(n,r){var i=this;e(s)(this,t),this.bc=n,this.It=r,this.metadata=new nv,this.buffer=new Uint8Array,this.Pc=new TextDecoder("utf-8"),this.vc().then((function(e){e&&e.ku()?i.metadata.resolve(e.payload.metadata):i.metadata.reject(new Error("The first element of the bundle is not a metadata, it is\n             ".concat(JSON.stringify(null==e?void 0:e.payload))))}),(function(e){return i.metadata.reject(e)}))}return e(c)(t,[{key:"close",value:function(){return this.bc.cancel()}},{key:"getMetadata",value:function(){var t=this;return e(ve)(e(ye).mark((function n(){return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t.metadata.promise);case 1:case"end":return e.stop()}}),n)})))()}},{key:"wc",value:function(){var t=this;return e(ve)(e(ye).mark((function n(){return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getMetadata();case 2:return e.abrupt("return",(e.sent,t.vc()));case 3:case"end":return e.stop()}}),n)})))()}},{key:"vc",value:function(){var t=this;return e(ve)(e(ye).mark((function n(){var r,i,a,o;return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.Vc();case 2:if(null!==(r=e.sent)){e.next=5;break}return e.abrupt("return",null);case 5:return i=t.Pc.decode(r),a=Number(i),isNaN(a)&&t.Sc("length string (".concat(i,") is not valid number")),e.next=9,t.Dc(a);case 9:return o=e.sent,e.abrupt("return",new px(JSON.parse(o),r.length+a));case 11:case"end":return e.stop()}}),n)})))()}},{key:"Cc",value:function(){return this.buffer.findIndex((function(e){return e==="{".charCodeAt(0)}))}},{key:"Vc",value:function(){var t=this;return e(ve)(e(ye).mark((function n(){var r,i;return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t.Cc()<0)){e.next=7;break}return e.next=3,t.xc();case 3:if(!e.sent){e.next=5;break}return e.abrupt("break",7);case 5:e.next=0;break;case 7:if(0!==t.buffer.length){e.next=9;break}return e.abrupt("return",null);case 9:return(r=t.Cc())<0&&t.Sc("Reached the end of bundle when a length string is expected."),i=t.buffer.slice(0,r),e.abrupt("return",(t.buffer=t.buffer.slice(r),i));case 13:case"end":return e.stop()}}),n)})))()}},{key:"Dc",value:function(t){var n=this;return e(ve)(e(ye).mark((function r(){var i;return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n.buffer.length<t)){e.next=8;break}return e.next=3,n.xc();case 3:if(e.t0=e.sent,!e.t0){e.next=6;break}n.Sc("Reached the end of bundle when more is expected.");case 6:e.next=0;break;case 8:return i=n.Pc.decode(n.buffer.slice(0,t)),e.abrupt("return",(n.buffer=n.buffer.slice(t),i));case 10:case"end":return e.stop()}}),r)})))()}},{key:"Sc",value:function(e){throw this.bc.cancel(),new Error("Invalid bundle format: ".concat(e))}},{key:"xc",value:function(){var t=this;return e(ve)(e(ye).mark((function n(){var r,i;return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.bc.read();case 2:return(r=e.sent).done||((i=new Uint8Array(t.buffer.length+r.value.length)).set(t.buffer),i.set(r.value,t.buffer.length),t.buffer=i),e.abrupt("return",r.done);case 5:case"end":return e.stop()}}),n)})))()}}]),t}(),AI=function(){"use strict";function t(n){e(s)(this,t),this.datastore=n,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastWriteError=null,this.writtenDocs=new Set}return e(c)(t,[{key:"lookup",value:function(t){var n=this;return e(ve)(e(ye).mark((function r(){var i;return e(ye).wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(n.ensureCommitNotCalled(),!(n.mutations.length>0)){r.next=2;break}throw new tv(ev.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");case 2:return r.next=4,function(){var t=e(ve)(e(ye).mark((function t(n,r){var i,a,o,u,s,c;return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=$d(n),a=Hm(i.It)+"/documents",o={documents:r.map((function(e){return Gm(i.It,e)}))},e.next=5,i.fo("BatchGetDocuments",a,o,r.length);case 5:return u=e.sent,s=new Map,u.forEach((function(e){var t,n,r=(t=i.It,"found"in(n=e)?function(e,t){Zd(!!t.found),t.found.name,t.found.updateTime;var n=Km(e,t.found.name),r=Bm(t.found.updateTime),i=new Bp({mapValue:{fields:t.found.fields}});return jp.newFoundDocument(n,r,i)}(t,n):"missing"in n?function(e,t){Zd(!!t.missing),Zd(!!t.readTime);var n=Km(e,t.missing),r=Bm(t.readTime);return jp.newNoDocument(n,r)}(t,n):Xd());s.set(r.key.toString(),r)})),c=[],e.abrupt("return",(r.forEach((function(e){var t=s.get(e.toString());Zd(!!t),c.push(t)})),c));case 10:case"end":return e.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()(n.datastore,t);case 4:return i=r.sent,r.abrupt("return",(i.forEach((function(e){return n.recordVersion(e)})),i));case 6:case"end":return r.stop()}}),r)})))()}},{key:"set",value:function(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}},{key:"update",value:function(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(e){this.lastWriteError=e}this.writtenDocs.add(e.toString())}},{key:"delete",value:function(e){this.write(new om(e,this.precondition(e))),this.writtenDocs.add(e.toString())}},{key:"commit",value:function(){var t=this;return e(ve)(e(ye).mark((function n(){var r;return e(ye).wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(t.ensureCommitNotCalled(),!t.lastWriteError){n.next=2;break}throw t.lastWriteError;case 2:return r=t.readVersions,t.mutations.forEach((function(e){r.delete(e.key.toString())})),r.forEach((function(e,n){var r=xv.fromPath(n);t.mutations.push(new um(r,t.precondition(r)))})),n.next=7,function(){var t=e(ve)(e(ye).mark((function t(n,r){var i,a,o;return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=$d(n),a=Hm(i.It)+"/documents",o={writes:r.map((function(e){return Xm(i.It,e)}))},e.next=3,i.co("Commit",a,o);case 3:case"end":return e.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()(t.datastore,t.mutations);case 7:t.committed=!0;case 8:case"end":return n.stop()}}),n)})))()}},{key:"recordVersion",value:function(e){var t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw Xd();t=mv.min()}var n=this.readVersions.get(e.key.toString());if(n){if(!t.isEqual(n))throw new tv(ev.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}},{key:"precondition",value:function(e){var t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(mv.min())?zy.exists(!1):zy.updateTime(t):zy.none()}},{key:"preconditionForUpdate",value:function(e){var t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(mv.min()))throw new tv(ev.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return zy.updateTime(t)}return zy.exists(!0)}},{key:"write",value:function(e){this.ensureCommitNotCalled(),this.mutations.push(e)}},{key:"ensureCommitNotCalled",value:function(){}}]),t}(),CI=function(){"use strict";function t(n,r,i,a,o){e(s)(this,t),this.asyncQueue=n,this.datastore=r,this.options=i,this.updateFunction=a,this.deferred=o,this.Nc=i.maxAttempts,this.xo=new ob(this.asyncQueue,"transaction_retry")}return e(c)(t,[{key:"run",value:function(){this.Nc-=1,this.kc()}},{key:"kc",value:function(){var t=this;this.xo.Ao(e(ve)(e(ye).mark((function n(){var r,i;return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=new AI(t.datastore),(i=t.Mc(r))&&i.then((function(e){t.asyncQueue.enqueueAndForget((function(){return r.commit().then((function(){t.deferred.resolve(e)})).catch((function(e){t.Oc(e)}))}))})).catch((function(e){t.Oc(e)}));case 2:case"end":return e.stop()}}),n)}))))}},{key:"Mc",value:function(e){try{var t=this.updateFunction(e);return!yp(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(e){return this.deferred.reject(e),null}}},{key:"Oc",value:function(e){var t=this;this.Nc>0&&this.Fc(e)?(this.Nc-=1,this.asyncQueue.enqueueAndForget((function(){return t.kc(),Promise.resolve()}))):this.deferred.reject(e)}},{key:"Fc",value:function(e){if("FirebaseError"===e.name){var t=e.code;return"aborted"===t||"failed-precondition"===t||!cm(t)}return!1}}]),t}(),NI=function(){"use strict";function t(n,r,i,a){var o=this;e(s)(this,t);var u,c=this;this.authCredentials=n,this.appCheckCredentials=r,this.asyncQueue=i,this.databaseInfo=a,this.user=Gd.UNAUTHENTICATED,this.clientId=fv.R(),this.authCredentialListener=function(){return Promise.resolve()},this.appCheckCredentialListener=function(){return Promise.resolve()},this.authCredentials.start(i,(u=e(ve)(e(ye).mark((function t(n){return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Hd("FirestoreClient","Received user=",n.uid),e.next=3,c.authCredentialListener(n);case 3:c.user=n;case 4:case"end":return e.stop()}}),t)}))),function(e){return u.apply(this,arguments)})),this.appCheckCredentials.start(i,(function(e){return Hd("FirestoreClient","Received new app check token=",e),o.appCheckCredentialListener(e,o.user)}))}return e(c)(t,[{key:"getConfiguration",value:function(){var t=this;return e(ve)(e(ye).mark((function n(){return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",{asyncQueue:t.asyncQueue,databaseInfo:t.databaseInfo,clientId:t.clientId,authCredentials:t.authCredentials,appCheckCredentials:t.appCheckCredentials,initialUser:t.user,maxConcurrentLimboResolutions:100});case 1:case"end":return e.stop()}}),n)})))()}},{key:"setCredentialChangeListener",value:function(e){this.authCredentialListener=e}},{key:"setAppCheckTokenChangeListener",value:function(e){this.appCheckCredentialListener=e}},{key:"verifyNotTerminated",value:function(){if(this.asyncQueue.isShuttingDown)throw new tv(ev.FAILED_PRECONDITION,"The client has already been terminated.")}},{key:"terminate",value:function(){this.asyncQueue.enterRestrictedMode();var t=new nv,n=this;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(e(ve)(e(ye).mark((function r(){var i;return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,e.t0=n.onlineComponents,!e.t0){e.next=5;break}return e.next=5,n.onlineComponents.terminate();case 5:if(e.t1=n.offlineComponents,!e.t1){e.next=9;break}return e.next=9,n.offlineComponents.terminate();case 9:n.authCredentials.shutdown(),n.appCheckCredentials.shutdown(),t.resolve(),e.next=18;break;case 14:e.prev=14,e.t2=e.catch(0),i=tx(e.t2,"Failed to shutdown persistence"),t.reject(i);case 18:case"end":return e.stop()}}),r,null,[[0,14]])})))),t.promise}}]),t}();
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function DI(e,t){return RI.apply(this,arguments)}function RI(){return RI=e(ve)(e(ye).mark((function t(n,r){var i,a;return e(ye).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n.asyncQueue.verifyOperationInProgress(),Hd("FirestoreClient","Initializing OfflineComponentProvider"),t.next=3,n.getConfiguration();case 3:return i=t.sent,t.next=6,r.initialize(i);case 6:a=i.initialUser,n.setCredentialChangeListener(function(){var t=e(ve)(e(ye).mark((function t(n){return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=a.isEqual(n),e.t0){e.next=5;break}return e.next=4,_w(r.localStore,n);case 4:a=n;case 5:case"end":return e.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),r.persistence.setDatabaseDeletedListener((function(){return n.terminate()})),n.offlineComponents=r;case 8:case"end":return t.stop()}}),t)}))),RI.apply(this,arguments)}function OI(e,t){return PI.apply(this,arguments)}function PI(){return(PI=e(ve)(e(ye).mark((function t(n,r){var i,a;return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.asyncQueue.verifyOperationInProgress(),e.next=3,LI(n);case 3:return i=e.sent,Hd("FirestoreClient","Initializing OnlineComponentProvider"),e.next=7,n.getConfiguration();case 7:return a=e.sent,e.next=10,r.initialize(i,a);case 10:n.setCredentialChangeListener((function(e){return Qb(r.remoteStore,e)})),n.setAppCheckTokenChangeListener((function(e,t){return Qb(r.remoteStore,t)})),n.onlineComponents=r;case 13:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function LI(e){return MI.apply(this,arguments)}function MI(){return(MI=e(ve)(e(ye).mark((function t(n){return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=n.offlineComponents,e.t0){e.next=5;break}return Hd("FirestoreClient","Using default OfflineComponentProvider"),e.next=5,DI(n,new bI);case 5:return e.abrupt("return",(e.t0||e.sent,n.offlineComponents));case 6:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function FI(e){return VI.apply(this,arguments)}function VI(){return(VI=e(ve)(e(ye).mark((function t(n){return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=n.onlineComponents,e.t0){e.next=5;break}return Hd("FirestoreClient","Using default OnlineComponentProvider"),e.next=5,OI(n,new _I);case 5:return e.abrupt("return",(e.t0||e.sent,n.onlineComponents));case 6:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function UI(e){return LI(e).then((function(e){return e.persistence}))}function BI(e){return LI(e).then((function(e){return e.localStore}))}function qI(e){return FI(e).then((function(e){return e.remoteStore}))}function jI(e){return FI(e).then((function(e){return e.syncEngine}))}function GI(e){return KI.apply(this,arguments)}function KI(){return(KI=e(ve)(e(ye).mark((function t(n){var r,i;return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,FI(n);case 2:return r=e.sent,i=r.eventManager,e.abrupt("return",(i.onListen=Tx.bind(null,r.syncEngine),i.onUnlisten=Cx.bind(null,r.syncEngine),i));case 5:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function zI(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=new nv;return t.asyncQueue.enqueueAndForget(e(ve)(e(ye).mark((function a(){return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=function(e,t,n,r,i){var a=new EI({next:function(a){t.enqueueAndForget((function(){return cx(e,o)}));var u=a.docs.has(n);!u&&a.fromCache?i.reject(new tv(ev.UNAVAILABLE,"Failed to get document because the client is offline.")):u&&a.fromCache&&r&&"server"===r.source?i.reject(new tv(ev.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):i.resolve(a)},error:function(e){return i.reject(e)}}),o=new vx(dy(n.path),a,{includeMetadataChanges:!0,Nu:!0});return ux(e,o)},e.next=3,GI(t);case 3:return e.t1=e.sent,e.t2=t.asyncQueue,e.t3=n,e.t4=r,e.t5=i,e.abrupt("return",(0,e.t0)(e.t1,e.t2,e.t3,e.t4,e.t5));case 9:case"end":return e.stop()}}),a)})))),i.promise}function WI(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=new nv;return t.asyncQueue.enqueueAndForget(e(ve)(e(ye).mark((function a(){return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=function(e,t,n,r,i){var a=new EI({next:function(n){t.enqueueAndForget((function(){return cx(e,o)})),n.fromCache&&"server"===r.source?i.reject(new tv(ev.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(n)},error:function(e){return i.reject(e)}}),o=new vx(n,a,{includeMetadataChanges:!0,Nu:!0});return ux(e,o)},e.next=3,GI(t);case 3:return e.t1=e.sent,e.t2=t.asyncQueue,e.t3=n,e.t4=r,e.t5=i,e.abrupt("return",(0,e.t0)(e.t1,e.t2,e.t3,e.t4,e.t5));case 9:case"end":return e.stop()}}),a)})))),i.promise}var HI=new Map;
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function QI(e,t,n){if(!n)throw new tv(ev.INVALID_ARGUMENT,"Function ".concat(e,"() cannot be called with an empty ").concat(t,"."))}function YI(e,t,n,r){if(!0===t&&!0===r)throw new tv(ev.INVALID_ARGUMENT,"".concat(e," and ").concat(n," cannot be used together."))}function JI(e){if(!xv.isDocumentKey(e))throw new tv(ev.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but ".concat(e," has ").concat(e.length,"."))}function XI(e){if(xv.isDocumentKey(e))throw new tv(ev.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but ".concat(e," has ").concat(e.length,"."))}function ZI(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return e.length>20&&(e="".concat(e.substring(0,20),"...")),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"==typeof e){if(e instanceof Array)return"an array";var t=(n=e).constructor?n.constructor.name:null;return t?"a custom ".concat(t," object"):"an object"}var n;return"function"==typeof e?"a function":Xd()}function $I(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new tv(ev.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");var n=ZI(e);throw new tv(ev.INVALID_ARGUMENT,"Expected type '".concat(t.name,"', but it was: ").concat(n))}return e}function e_(e,t){if(t<=0)throw new tv(ev.INVALID_ARGUMENT,"Function ".concat(e,"() requires a positive number, but it was: ").concat(t,"."))}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var t_=function(){"use strict";function t(n){var r;if(e(s)(this,t),void 0===n.host){if(void 0!==n.ssl)throw new tv(ev.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=n.host,this.ssl=null===(r=n.ssl)||void 0===r||r;if(this.credentials=n.credentials,this.ignoreUndefinedProperties=!!n.ignoreUndefinedProperties,void 0===n.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==n.cacheSizeBytes&&n.cacheSizeBytes<1048576)throw new tv(ev.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=n.cacheSizeBytes}this.experimentalForceLongPolling=!!n.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!n.experimentalAutoDetectLongPolling,this.useFetchStreams=!!n.useFetchStreams,YI("experimentalForceLongPolling",n.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",n.experimentalAutoDetectLongPolling)}return e(c)(t,[{key:"isEqual",value:function(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}]),t}(),n_=function(){"use strict";function t(n,r,i,a){e(s)(this,t),this._authCredentials=n,this._appCheckCredentials=r,this._databaseId=i,this._app=a,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new t_({}),this._settingsFrozen=!1}return e(c)(t,[{key:"app",get:function(){if(!this._app)throw new tv(ev.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}},{key:"_initialized",get:function(){return this._settingsFrozen}},{key:"_terminated",get:function(){return void 0!==this._terminateTask}},{key:"_setSettings",value:function(e){if(this._settingsFrozen)throw new tv(ev.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new t_(e),void 0!==e.credentials&&(this._authCredentials=function(e){if(!e)return new iv;switch(e.type){case"gapi":var t=e.client;return new sv(t,e.sessionIndex||"0",e.iamToken||null,e.authTokenFactory||null);case"provider":return e.client;default:throw new tv(ev.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}},{key:"_getSettings",value:function(){return this._settings}},{key:"_freezeSettings",value:function(){return this._settingsFrozen=!0,this._settings}},{key:"_delete",value:function(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}},{key:"toJSON",value:function(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}},{key:"_terminate",value:function(){return e=this,(t=HI.get(e))&&(Hd("ComponentProvider","Removing Datastore"),HI.delete(e),t.terminate()),Promise.resolve();var e,t}}]),t}();
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function r_(e,t,n){var r,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},a=(e=$I(e,n_))._getSettings();if("firestore.googleapis.com"!==a.host&&a.host!==t&&Yd("Host has been set in both settings() and useEmulator(), emulator host will be used"),e._setSettings(Object.assign(Object.assign({},a),{host:"".concat(t,":").concat(n),ssl:!1})),i.mockUserToken){var o,u;if("string"==typeof i.mockUserToken)o=i.mockUserToken,u=Gd.MOCK_USER;else{o=W(i.mockUserToken,null===(r=e._app)||void 0===r?void 0:r.options.projectId);var s=i.mockUserToken.sub||i.mockUserToken.user_id;if(!s)throw new tv(ev.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");u=new Gd(s)}e._authCredentials=new av(new rv(o,u))}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var i_=function(){"use strict";function t(n,r,i){e(s)(this,t),this.converter=r,this._key=i,this.type="document",this.firestore=n}return e(c)(t,[{key:"_path",get:function(){return this._key.path}},{key:"id",get:function(){return this._key.path.lastSegment()}},{key:"path",get:function(){return this._key.path.canonicalString()}},{key:"parent",get:function(){return new o_(this.firestore,this.converter,this._key.path.popLast())}},{key:"withConverter",value:function(e){return new t(this.firestore,e,this._key)}}]),t}(),a_=function(){"use strict";function t(n,r,i){e(s)(this,t),this.converter=r,this._query=i,this.type="query",this.firestore=n}return e(c)(t,[{key:"withConverter",value:function(e){return new t(this.firestore,e,this._query)}}]),t}(),o_=function(t){"use strict";e(d)(r,t);var n=e(L)(r);function r(t,i,a){var o;return e(s)(this,r),(o=n.call(this,t,i,dy(a)))._path=a,o.type="collection",e(wc)(o)}return e(c)(r,[{key:"id",get:function(){return this._query.path.lastSegment()}},{key:"path",get:function(){return this._query.path.canonicalString()}},{key:"parent",get:function(){var e=this._path.popLast();return e.isEmpty()?null:new i_(this.firestore,null,new xv(e))}},{key:"withConverter",value:function(e){return new r(this.firestore,e,this._path)}}]),r}(a_);function u_(t,n){for(var r=arguments.length,i=new Array(r>2?r-2:0),a=2;a<r;a++)i[a-2]=arguments[a];if(t=de(t),QI("collection","path",n),t instanceof n_){var o,u=(o=kv).fromString.apply(o,[n].concat(e(x)(i)));return XI(u),new o_(t,null,u)}var s;if(!(t instanceof i_||t instanceof o_))throw new tv(ev.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");var c=t._path.child((s=kv).fromString.apply(s,[n].concat(e(x)(i))));return XI(c),new o_(t.firestore,null,c)}function s_(e,t){if(e=$I(e,n_),QI("collectionGroup","collection id",t),t.indexOf("/")>=0)throw new tv(ev.INVALID_ARGUMENT,"Invalid collection ID '".concat(t,"' passed to function collectionGroup(). Collection IDs must not contain '/'."));return new a_(e,null,(n=t,new hy(kv.emptyPath(),n)));var n}function c_(t,n){for(var r=arguments.length,i=new Array(r>2?r-2:0),a=2;a<r;a++)i[a-2]=arguments[a];if(t=de(t),1===arguments.length&&(n=fv.R()),QI("doc","path",n),t instanceof n_){var o,u=(o=kv).fromString.apply(o,[n].concat(e(x)(i)));return JI(u),new i_(t,null,new xv(u))}var s;if(!(t instanceof i_||t instanceof o_))throw new tv(ev.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");var c=t._path.child((s=kv).fromString.apply(s,[n].concat(e(x)(i))));return JI(c),new i_(t.firestore,t instanceof o_?t.converter:null,new xv(c))}function l_(e,t){return e=de(e),t=de(t),(e instanceof i_||e instanceof o_)&&(t instanceof i_||t instanceof o_)&&e.firestore===t.firestore&&e.path===t.path&&e.converter===t.converter}function h_(e,t){return e=de(e),t=de(t),e instanceof a_&&t instanceof a_&&e.firestore===t.firestore&&by(e._query,t._query)&&e.converter===t.converter
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */}var f_=function(){"use strict";function t(){var n=this;e(s)(this,t),this.$c=Promise.resolve(),this.Bc=[],this.Lc=!1,this.Uc=[],this.qc=null,this.Kc=!1,this.Gc=!1,this.Qc=[],this.xo=new ob(this,"async_queue_retry"),this.jc=function(){var e=ib();e&&Hd("AsyncQueue","Visibility state changed to "+e.visibilityState),n.xo.bo()};var r=ib();r&&"function"==typeof r.addEventListener&&r.addEventListener("visibilitychange",this.jc)}return e(c)(t,[{key:"isShuttingDown",get:function(){return this.Lc}},{key:"enqueueAndForget",value:function(e){this.enqueue(e)}},{key:"enqueueAndForgetEvenWhileRestricted",value:function(e){this.Wc(),this.zc(e)}},{key:"enterRestrictedMode",value:function(e){if(!this.Lc){this.Lc=!0,this.Gc=e||!1;var t=ib();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.jc)}}},{key:"enqueue",value:function(e){var t=this;if(this.Wc(),this.Lc)return new Promise((function(){}));var n=new nv;return this.zc((function(){return t.Lc&&t.Gc?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)})).then((function(){return n.promise}))}},{key:"enqueueRetryable",value:function(e){var t=this;this.enqueueAndForget((function(){return t.Bc.push(e),t.Hc()}))}},{key:"Hc",value:function(){var t=this;return e(ve)(e(ye).mark((function n(){return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0===t.Bc.length){e.next=14;break}return e.prev=1,e.next=4,t.Bc[0]();case 4:t.Bc.shift(),t.xo.reset(),e.next=13;break;case 8:if(e.prev=8,e.t0=e.catch(1),qv(e.t0)){e.next=12;break}throw e.t0;case 12:Hd("AsyncQueue","Operation failed with retryable error: "+e.t0);case 13:t.Bc.length>0&&t.xo.Ao((function(){return t.Hc()}));case 14:case"end":return e.stop()}}),n,null,[[1,8]])})))()}},{key:"zc",value:function(e){var t=this,n=this.$c.then((function(){return t.Kc=!0,e().catch((function(e){var n,r;throw t.qc=e,t.Kc=!1,Qd("INTERNAL UNHANDLED ERROR: ",(r=(n=e).message||"",n.stack&&(r=n.stack.includes(n.message)?n.stack:n.message+"\n"+n.stack),r)),e})).then((function(e){return t.Kc=!1,e}))}));return this.$c=n,n}},{key:"enqueueAfterDelay",value:function(e,t,n){var r=this;this.Wc(),this.Qc.indexOf(e)>-1&&(t=0);var i=ex.createAndSchedule(this,e,t,n,(function(e){return r.Jc(e)}));return this.Uc.push(i),i}},{key:"Wc",value:function(){this.qc&&Xd()}},{key:"verifyOperationInProgress",value:function(){}},{key:"Yc",value:function(){var t=this;return e(ve)(e(ye).mark((function n(){var r;return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case 1:return r=t.$c,e.next=4,r;case 4:if(r!==t.$c){e.next=1;break}case 5:case"end":return e.stop()}}),n)})))()}},{key:"Xc",value:function(e){var t=!0,n=!1,r=void 0;try{for(var i,a=this.Uc[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){if(i.value.timerId===e)return!0}}catch(e){n=!0,r=e}finally{try{t||null==a.return||a.return()}finally{if(n)throw r}}return!1}},{key:"Zc",value:function(e){var t=this;return this.Yc().then((function(){t.Uc.sort((function(e,t){return e.targetTimeMs-t.targetTimeMs}));var n=!0,r=!1,i=void 0;try{for(var a,o=t.Uc[Symbol.iterator]();!(n=(a=o.next()).done);n=!0){var u=a.value;if(u.skipDelay(),"all"!==e&&u.timerId===e)break}}catch(e){r=!0,i=e}finally{try{n||null==o.return||o.return()}finally{if(r)throw i}}return t.Yc()}))}},{key:"ta",value:function(e){this.Qc.push(e)}},{key:"Jc",value:function(e){var t=this.Uc.indexOf(e);this.Uc.splice(t,1)}}]),t}();function d_(e){return function(e,t){if("object"!=typeof e||null===e)return!1;var n=e,r=!0,i=!1,a=void 0;try{for(var o,u=["next","error","complete"][Symbol.iterator]();!(r=(o=u.next()).done);r=!0){var s=o.value;if(s in n&&"function"==typeof n[s])return!0}}catch(e){i=!0,a=e}finally{try{r||null==u.return||u.return()}finally{if(i)throw a}}return!1}(e)}var v_=function(){"use strict";function t(){e(s)(this,t),this._progressObserver={},this._taskCompletionResolver=new nv,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}return e(c)(t,[{key:"onProgress",value:function(e,t,n){this._progressObserver={next:e,error:t,complete:n}}},{key:"catch",value:function(e){return this._taskCompletionResolver.promise.catch(e)}},{key:"then",value:function(e,t){return this._taskCompletionResolver.promise.then(e,t)}},{key:"_completeWith",value:function(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}},{key:"_failWith",value:function(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}},{key:"_updateProgress",value:function(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}}]),t}(),p_=function(t){"use strict";e(d)(r,t);var n=e(L)(r);function r(t,i,a,o){var u;return e(s)(this,r),(u=n.call(this,t,i,a,o)).type="firestore",u._queue=new f_,u._persistenceKey=(null==o?void 0:o.name)||"[DEFAULT]",e(wc)(u)}return e(c)(r,[{key:"_terminate",value:function(){return this._firestoreClient||m_(this),this._firestoreClient.terminate()}}]),r}(n_);
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function y_(e){return e._firestoreClient||m_(e),e._firestoreClient.verifyNotTerminated(),e._firestoreClient}function m_(e){var t,n,r,i,a,o=e._freezeSettings(),u=(n=e._databaseId,r=(null===(t=e._app)||void 0===t?void 0:t.options.appId)||"",i=e._persistenceKey,new vp(n,r,i,(a=o).host,a.ssl,a.experimentalForceLongPolling,a.experimentalAutoDetectLongPolling,a.useFetchStreams));e._firestoreClient=new NI(e._authCredentials,e._appCheckCredentials,e._queue,u)}function g_(e,t){E_(e=$I(e,p_));var n=y_(e),r=e._freezeSettings(),i=new _I;return w_(n,i,new xI(i,r.cacheSizeBytes,null==t?void 0:t.forceOwnership))}function k_(e){E_(e=$I(e,p_));var t=y_(e),n=e._freezeSettings(),r=new _I;return w_(t,r,new II(r,n.cacheSizeBytes))}function w_(t,n,r){var i=new nv;return t.asyncQueue.enqueue(e(ve)(e(ye).mark((function a(){var o;return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,DI(t,r);case 3:return e.next=5,OI(t,n);case 5:i.resolve(),e.next=14;break;case 8:if(e.prev=8,e.t0=e.catch(0),o=e.t0,"FirebaseError"===(a=o).name?a.code===ev.FAILED_PRECONDITION||a.code===ev.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&a instanceof DOMException)||22===a.code||20===a.code||11===a.code){e.next=13;break}throw o;case 13:Yd("Error enabling offline persistence. Falling back to persistence disabled: "+o),i.reject(o);case 14:case"end":return e.stop()}var a}),a,null,[[0,8]])})))).then((function(){return i.promise}))}function b_(t){if(t._initialized&&!t._terminated)throw new tv(ev.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");var n=new nv;return t._queue.enqueueAndForgetEvenWhileRestricted(e(ve)(e(ye).mark((function r(){return e(ye).wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,function(){var t=e(ve)(e(ye).mark((function t(n){var r;return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Vv.C()){e.next=2;break}return e.abrupt("return",Promise.resolve());case 2:return r=n+"main",e.next=5,Vv.delete(r);case 5:case"end":return e.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()(kw(t._databaseId,t._persistenceKey));case 3:n.resolve(),r.next=9;break;case 6:r.prev=6,r.t0=r.catch(0),n.reject(r.t0);case 9:case"end":return r.stop()}}),r,null,[[0,6]])})))),n.promise}function x_(t){return(n=y_(t=$I(t,p_))).asyncQueue.enqueue(e(ve)(e(ye).mark((function t(){var r,i;return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,UI(n);case 2:return r=e.sent,e.next=5,qI(n);case 5:return i=e.sent,e.abrupt("return",(r.setNetworkEnabled(!0),t=void 0,(t=$d(i))._u.delete(0),db(t)));case 7:case"end":return e.stop()}var t}),t)}))));var n}function I_(t){return(n=y_(t=$I(t,p_))).asyncQueue.enqueue(e(ve)(e(ye).mark((function t(){var r,i;return e(ye).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,UI(n);case 2:return r=t.sent,t.next=5,qI(n);case 5:return i=t.sent,t.abrupt("return",(r.setNetworkEnabled(!1),function(){var t=e(ve)(e(ye).mark((function t(n){var r;return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(r=$d(n))._u.add(0),e.next=4,pb(r);case 4:r.gu.set("Offline");case 5:case"end":return e.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()(i)));case 7:case"end":return t.stop()}}),t)}))));var n}function __(t,n){var r=y_(t=$I(t,p_)),i=new v_;return function(t,n,r,i){var a,o,u,s,c=(a=r,o=ab(n),u="string"==typeof a?(new TextEncoder).encode(a):a,s=function(e,t){if(e instanceof Uint8Array)return TI(e,t);if(e instanceof ArrayBuffer)return TI(new Uint8Array(e),t);if(e instanceof ReadableStream)return e.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(u),new SI(s,o));t.asyncQueue.enqueueAndForget(e(ve)(e(ye).mark((function n(){return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=wI,e.next=3,jI(t);case 3:e.t1=e.sent,e.t2=c,e.t3=i,(0,e.t0)(e.t1,e.t2,e.t3);case 7:case"end":return e.stop()}}),n)}))))}(r,t._databaseId,n,i),i}function T_(t,n){return(r=y_(t=$I(t,p_)),i=n,r.asyncQueue.enqueue(e(ve)(e(ye).mark((function t(){return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=function(e,t){var n=$d(e);return n.persistence.runTransaction("Get named query","readonly",(function(e){return n.Ns.getNamedQuery(e,t)}))},e.next=3,BI(r);case 3:return e.t1=e.sent,e.t2=i,e.abrupt("return",(0,e.t0)(e.t1,e.t2));case 6:case"end":return e.stop()}}),t)}))))).then((function(e){return e?new a_(t,null,e.query):null}));var r,i}function E_(e){if(e._initialized||e._terminated)throw new tv(ev.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var S_=function(){"use strict";function t(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];e(s)(this,t);for(var a=0;a<r.length;++a)if(0===r[a].length)throw new tv(ev.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new bv(r)}return e(c)(t,[{key:"isEqual",value:function(e){return this._internalPath.isEqual(e._internalPath)}}]),t}();
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var A_=function(){"use strict";function t(n){e(s)(this,t),this._byteString=n}return e(c)(t,[{key:"toBase64",value:function(){return this._byteString.toBase64()}},{key:"toUint8Array",value:function(){return this._byteString.toUint8Array()}},{key:"toString",value:function(){return"Bytes(base64: "+this.toBase64()+")"}},{key:"isEqual",value:function(e){return this._byteString.isEqual(e._byteString)}}],[{key:"fromBase64String",value:function(e){try{return new t(op.fromBase64String(e))}catch(e){throw new tv(ev.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}}},{key:"fromUint8Array",value:function(e){return new t(op.fromUint8Array(e))}}]),t}(),C_=function t(n){"use strict";e(s)(this,t),this._methodName=n},N_=function(){"use strict";function t(n,r){if(e(s)(this,t),!isFinite(n)||n<-90||n>90)throw new tv(ev.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+n);if(!isFinite(r)||r<-180||r>180)throw new tv(ev.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+r);this._lat=n,this._long=r}return e(c)(t,[{key:"latitude",get:function(){return this._lat}},{key:"longitude",get:function(){return this._long}},{key:"isEqual",value:function(e){return this._lat===e._lat&&this._long===e._long}},{key:"toJSON",value:function(){return{latitude:this._lat,longitude:this._long}}},{key:"_compareTo",value:function(e){return dv(this._lat,e._lat)||dv(this._long,e._long)}}]),t}(),D_=/^__.*__$/,R_=function(){"use strict";function t(n,r,i){e(s)(this,t),this.data=n,this.fieldMask=r,this.fieldTransforms=i}return e(c)(t,[{key:"toMutation",value:function(e,t){return null!==this.fieldMask?new em(e,this.data,this.fieldMask,t,this.fieldTransforms):new $y(e,this.data,t,this.fieldTransforms)}}]),t}(),O_=function(){"use strict";function t(n,r,i){e(s)(this,t),this.data=n,this.fieldMask=r,this.fieldTransforms=i}return e(c)(t,[{key:"toMutation",value:function(e,t){return new em(e,this.data,this.fieldMask,t,this.fieldTransforms)}}]),t}();
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function P_(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Xd()}}var L_=function(){"use strict";function t(n,r,i,a,o,u){e(s)(this,t),this.settings=n,this.databaseId=r,this.It=i,this.ignoreUndefinedProperties=a,void 0===o&&this.ea(),this.fieldTransforms=o||[],this.fieldMask=u||[]}return e(c)(t,[{key:"path",get:function(){return this.settings.path}},{key:"na",get:function(){return this.settings.na}},{key:"sa",value:function(e){return new t(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.It,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}},{key:"ia",value:function(e){var t,n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.sa({path:n,ra:!1});return r.oa(e),r}},{key:"ua",value:function(e){var t,n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.sa({path:n,ra:!1});return r.ea(),r}},{key:"ca",value:function(e){return this.sa({path:void 0,ra:!0})}},{key:"aa",value:function(e){return tT(e,this.settings.methodName,this.settings.ha||!1,this.path,this.settings.la)}},{key:"contains",value:function(e){return void 0!==this.fieldMask.find((function(t){return e.isPrefixOf(t)}))||void 0!==this.fieldTransforms.find((function(t){return e.isPrefixOf(t.field)}))}},{key:"ea",value:function(){if(this.path)for(var e=0;e<this.path.length;e++)this.oa(this.path.get(e))}},{key:"oa",value:function(e){if(0===e.length)throw this.aa("Document fields must not be empty");if(P_(this.na)&&D_.test(e))throw this.aa('Document fields cannot begin and end with "__"')}}]),t}(),M_=function(){"use strict";function t(n,r,i){e(s)(this,t),this.databaseId=n,this.ignoreUndefinedProperties=r,this.It=i||ab(n)}return e(c)(t,[{key:"fa",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return new L_({na:e,methodName:t,la:n,path:bv.emptyPath(),ra:!1,ha:r},this.databaseId,this.It,this.ignoreUndefinedProperties)}}]),t}();function F_(e){var t=e._freezeSettings(),n=ab(e._databaseId);return new M_(e._databaseId,!!t.ignoreUndefinedProperties,n)}function V_(e,t,n,r,i){var a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},o=e.fa(a.merge||a.mergeFields?2:0,t,n,i);X_("Data must be an object, but it was:",o,r);var u,s,c=Y_(r,o);if(a.merge)u=new ip(o.fieldMask),s=o.fieldTransforms;else if(a.mergeFields){var l=[],h=!0,f=!1,d=void 0;try{for(var v,p=a.mergeFields[Symbol.iterator]();!(h=(v=p.next()).done);h=!0){var y=v.value,m=Z_(t,y,n);if(!o.contains(m))throw new tv(ev.INVALID_ARGUMENT,"Field '".concat(m,"' is specified in your field mask but missing from your input data."));nT(l,m)||l.push(m)}}catch(e){f=!0,d=e}finally{try{h||null==p.return||p.return()}finally{if(f)throw d}}u=new ip(l),s=o.fieldTransforms.filter((function(e){return u.covers(e.field)}))}else u=null,s=o.fieldTransforms;return new R_(new Bp(c),u,s)}var U_=function(t){"use strict";e(d)(r,t);var n=e(L)(r);function r(){return e(s)(this,r),n.apply(this,arguments)}return e(c)(r,[{key:"_toFieldTransform",value:function(e){if(2!==e.na)throw 1===e.na?e.aa("".concat(this._methodName,"() can only appear at the top level of your update data")):e.aa("".concat(this._methodName,"() cannot be used with set() unless you pass {merge:true}"));return e.fieldMask.push(e.path),null}},{key:"isEqual",value:function(e){return e instanceof r}}]),r}(C_);function B_(e,t,n){return new L_({na:3,la:t.settings.la,methodName:e._methodName,ra:n},t.databaseId,t.It,t.ignoreUndefinedProperties)}var q_=function(t){"use strict";e(d)(r,t);var n=e(L)(r);function r(){return e(s)(this,r),n.apply(this,arguments)}return e(c)(r,[{key:"_toFieldTransform",value:function(e){return new Gy(e.path,new Ly)}},{key:"isEqual",value:function(e){return e instanceof r}}]),r}(C_),j_=function(t){"use strict";e(d)(r,t);var n=e(L)(r);function r(t,i){var a;return e(s)(this,r),(a=n.call(this,t)).da=i,e(wc)(a)}return e(c)(r,[{key:"_toFieldTransform",value:function(e){var t=B_(this,e,!0),n=this.da.map((function(e){return Q_(e,t)})),r=new My(n);return new Gy(e.path,r)}},{key:"isEqual",value:function(e){return this===e}}]),r}(C_),G_=function(t){"use strict";e(d)(r,t);var n=e(L)(r);function r(t,i){var a;return e(s)(this,r),(a=n.call(this,t)).da=i,e(wc)(a)}return e(c)(r,[{key:"_toFieldTransform",value:function(e){var t=B_(this,e,!0),n=this.da.map((function(e){return Q_(e,t)})),r=new Vy(n);return new Gy(e.path,r)}},{key:"isEqual",value:function(e){return this===e}}]),r}(C_),K_=function(t){"use strict";e(d)(r,t);var n=e(L)(r);function r(t,i){var a;return e(s)(this,r),(a=n.call(this,t))._a=i,e(wc)(a)}return e(c)(r,[{key:"_toFieldTransform",value:function(e){var t=new By(e.It,Ny(e.It,this._a));return new Gy(e.path,t)}},{key:"isEqual",value:function(e){return this===e}}]),r}(C_);function z_(e,t,n,r){var i=e.fa(1,t,n);X_("Data must be an object, but it was:",i,r);var a=[],o=Bp.empty();Jv(r,(function(e,r){var u=eT(t,e,n);r=de(r);var s=i.ua(u);if(r instanceof U_)a.push(u);else{var c=Q_(r,s);null!=c&&(a.push(u),o.set(u,c))}}));var u=new ip(a);return new O_(o,u,i.fieldTransforms)}function W_(e,t,n,r,i,a){var o=e.fa(1,t,n),u=[Z_(t,r,n)],s=[i];if(a.length%2!=0)throw new tv(ev.INVALID_ARGUMENT,"Function ".concat(t,"() needs to be called with an even number of arguments that alternate between field names and values."));for(var c=0;c<a.length;c+=2)u.push(Z_(t,a[c])),s.push(a[c+1]);for(var l=[],h=Bp.empty(),f=u.length-1;f>=0;--f)if(!nT(l,u[f])){var d=u[f],v=s[f];v=de(v);var p=o.ua(d);if(v instanceof U_)l.push(d);else{var y=Q_(v,p);null!=y&&(l.push(d),h.set(d,y))}}var m=new ip(l);return new O_(h,m,o.fieldTransforms)}function H_(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return Q_(n,e.fa(r?4:3,t))}function Q_(e,t){if(J_(e=de(e)))return X_("Unsupported field value:",t,e),Y_(e,t);if(e instanceof C_)return function(e,t){if(!P_(t.na))throw t.aa("".concat(e._methodName,"() can only be used with update() and set()"));if(!t.path)throw t.aa("".concat(e._methodName,"() is not currently supported inside arrays"));var n=e._toFieldTransform(t);n&&t.fieldTransforms.push(n)}(e,t),null;if(void 0===e&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.settings.ra&&4!==t.na)throw t.aa("Nested arrays are not supported");return function(e,t){var n=[],r=0,i=!0,a=!1,o=void 0;try{for(var u,s=e[Symbol.iterator]();!(i=(u=s.next()).done);i=!0){var c=Q_(u.value,t.ca(r));null==c&&(c={nullValue:"NULL_VALUE"}),n.push(c),r++}}catch(e){a=!0,o=e}finally{try{i||null==s.return||s.return()}finally{if(a)throw o}}return{arrayValue:{values:n}}}(e,t)}return function(e,t){if(null===(e=de(e)))return{nullValue:"NULL_VALUE"};if("number"==typeof e)return Ny(t.It,e);if("boolean"==typeof e)return{booleanValue:e};if("string"==typeof e)return{stringValue:e};if(e instanceof Date){var n=yv.fromDate(e);return{timestampValue:Fm(t.It,n)}}if(e instanceof yv){var r=new yv(e.seconds,1e3*Math.floor(e.nanoseconds/1e3));return{timestampValue:Fm(t.It,r)}}if(e instanceof N_)return{geoPointValue:{latitude:e.latitude,longitude:e.longitude}};if(e instanceof A_)return{bytesValue:Vm(t.It,e._byteString)};if(e instanceof i_){var i=t.databaseId,a=e.firestore._databaseId;if(!a.isEqual(i))throw t.aa("Document reference is for database ".concat(a.projectId,"/").concat(a.database," but should be for database ").concat(i.projectId,"/").concat(i.database));return{referenceValue:qm(e.firestore._databaseId||t.databaseId,e._key.path)}}throw t.aa("Unsupported field value: ".concat(ZI(e)))}(e,t)}function Y_(e,t){var n={};return Xv(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):Jv(e,(function(e,r){var i=Q_(r,t.ia(e));null!=i&&(n[e]=i)})),{mapValue:{fields:n}}}function J_(e){return!("object"!=typeof e||null===e||e instanceof Array||e instanceof Date||e instanceof yv||e instanceof N_||e instanceof A_||e instanceof i_||e instanceof C_)}function X_(e,t,n){if(!J_(n)||("object"!=typeof(i=n)||null===i||Object.getPrototypeOf(i)!==Object.prototype&&null!==Object.getPrototypeOf(i))){var r=ZI(n);throw"an object"===r?t.aa(e+" a custom object"):t.aa(e+" "+r)}var i}function Z_(e,t,n){if((t=de(t))instanceof S_)return t._internalPath;if("string"==typeof t)return eT(e,t);throw tT("Field path arguments must be of type string or ",e,!1,void 0,n)}var $_=new RegExp("[~\\*/\\[\\]]");function eT(t,n,r){if(n.search($_)>=0)throw tT("Invalid field path (".concat(n,"). Paths must not contain '~', '*', '/', '[', or ']'"),t,!1,void 0,r);try{return e(kc)(S_,e(x)(n.split(".")))._internalPath}catch(e){throw tT("Invalid field path (".concat(n,"). Paths must not be empty, begin with '.', end with '.', or contain '..'"),t,!1,void 0,r)}}function tT(e,t,n,r,i){var a=r&&!r.isEmpty(),o=void 0!==i,u="Function ".concat(t,"() called with invalid data");n&&(u+=" (via `toFirestore()`)"),u+=". ";var s="";return(a||o)&&(s+=" (found",a&&(s+=" in field ".concat(r)),o&&(s+=" in document ".concat(i)),s+=")"),new tv(ev.INVALID_ARGUMENT,u+e+s)}function nT(e,t){return e.some((function(e){return e.isEqual(t)}))}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var rT=function(){"use strict";function t(n,r,i,a,o){e(s)(this,t),this._firestore=n,this._userDataWriter=r,this._key=i,this._document=a,this._converter=o}return e(c)(t,[{key:"id",get:function(){return this._key.path.lastSegment()}},{key:"ref",get:function(){return new i_(this._firestore,this._converter,this._key)}},{key:"exists",value:function(){return null!==this._document}},{key:"data",value:function(){if(this._document){if(this._converter){var e=new iT(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}},{key:"get",value:function(e){if(this._document){var t=this._document.data.field(aT("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}]),t}(),iT=function(t){"use strict";e(d)(r,t);var n=e(L)(r);function r(){return e(s)(this,r),n.apply(this,arguments)}return e(c)(r,[{key:"data",value:function(){return e(Qt)(e(Xt)(r.prototype),"data",this).call(this)}}]),r}(rT);function aT(e,t){return"string"==typeof t?eT(e,t):t instanceof S_?t._internalPath:t._delegate._internalPath}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var oT=function(){"use strict";function t(n,r){e(s)(this,t),this.hasPendingWrites=n,this.fromCache=r}return e(c)(t,[{key:"isEqual",value:function(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}]),t}(),uT=function(t){"use strict";e(d)(r,t);var n=e(L)(r);function r(t,i,a,o,u,c){var l;return e(s)(this,r),(l=n.call(this,t,i,a,o,c))._firestore=t,l._firestoreImpl=t,l.metadata=u,e(wc)(l)}return e(c)(r,[{key:"exists",value:function(){return e(Qt)(e(Xt)(r.prototype),"exists",this).call(this)}},{key:"data",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this._document){if(this._converter){var t=new sT(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}},{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this._document){var n=this._document.data.field(aT("DocumentSnapshot.get",e));if(null!==n)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}}]),r}(rT),sT=function(t){"use strict";e(d)(r,t);var n=e(L)(r);function r(){return e(s)(this,r),n.apply(this,arguments)}return e(c)(r,[{key:"data",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e(Qt)(e(Xt)(r.prototype),"data",this).call(this,t)}}]),r}(uT),cT=function(){"use strict";function t(n,r,i,a){e(s)(this,t),this._firestore=n,this._userDataWriter=r,this._snapshot=a,this.metadata=new oT(a.hasPendingWrites,a.fromCache),this.query=i}return e(c)(t,[{key:"docs",get:function(){var e=[];return this.forEach((function(t){return e.push(t)})),e}},{key:"size",get:function(){return this._snapshot.docs.size}},{key:"empty",get:function(){return 0===this.size}},{key:"forEach",value:function(e,t){var n=this;this._snapshot.docs.forEach((function(r){e.call(t,new sT(n._firestore,n._userDataWriter,r.key,r,new oT(n._snapshot.mutatedKeys.has(r.key),n._snapshot.fromCache),n.query.converter))}))}},{key:"docChanges",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new tv(ev.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(e,t){if(e._snapshot.oldDocs.isEmpty()){var n=0;return e._snapshot.docChanges.map((function(t){return{type:"added",doc:new sT(e._firestore,e._userDataWriter,t.doc.key,t.doc,new oT(e._snapshot.mutatedKeys.has(t.doc.key),e._snapshot.fromCache),e.query.converter),oldIndex:-1,newIndex:n++}}))}var r=e._snapshot.oldDocs;return e._snapshot.docChanges.filter((function(e){return t||3!==e.type})).map((function(t){var n=new sT(e._firestore,e._userDataWriter,t.doc.key,t.doc,new oT(e._snapshot.mutatedKeys.has(t.doc.key),e._snapshot.fromCache),e.query.converter),i=-1,a=-1;return 0!==t.type&&(i=r.indexOf(t.doc.key),r=r.delete(t.doc.key)),1!==t.type&&(a=(r=r.add(t.doc)).indexOf(t.doc.key)),{type:lT(t.type),doc:n,oldIndex:i,newIndex:a}}))}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}]),t}();function lT(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Xd()}}function hT(e,t){return e instanceof uT&&t instanceof uT?e._firestore===t._firestore&&e._key.isEqual(t._key)&&(null===e._document?null===t._document:e._document.isEqual(t._document))&&e._converter===t._converter:e instanceof cT&&t instanceof cT&&e._firestore===t._firestore&&h_(e.query,t.query)&&e.metadata.isEqual(t.metadata)&&e._snapshot.isEqual(t._snapshot)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fT(e){if("L"===e.limitType&&0===e.explicitOrderBy.length)throw new tv(ev.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var dT=function t(){"use strict";e(s)(this,t)};function vT(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var i=!0,a=!1,o=void 0;try{for(var u,s=n[Symbol.iterator]();!(i=(u=s.next()).done);i=!0){var c=u.value;e=c._apply(e)}}catch(e){a=!0,o=e}finally{try{i||null==s.return||s.return()}finally{if(a)throw o}}return e}var pT=function(t){"use strict";e(d)(r,t);var n=e(L)(r);function r(t,i,a){var o;return e(s)(this,r),(o=n.call(this)).wa=t,o.ma=i,o.ga=a,o.type="where",e(wc)(o)}return e(c)(r,[{key:"_apply",value:function(e){var t,n,r,i=F_(e.firestore),a=function(e,t,n,r,i,a,o){var u;if(i.isKeyField()){if("array-contains"===a||"array-contains-any"===a)throw new tv(ev.INVALID_ARGUMENT,"Invalid Query. You can't perform '".concat(a,"' queries on documentId()."));if("in"===a||"not-in"===a){AT(o,a);var s=[],c=!0,l=!1,h=void 0;try{for(var f,d=o[Symbol.iterator]();!(c=(f=d.next()).done);c=!0){var v=f.value;s.push(ST(r,e,v))}}catch(e){l=!0,h=e}finally{try{c||null==d.return||d.return()}finally{if(l)throw h}}u={arrayValue:{values:s}}}else u=ST(r,e,o)}else"in"!==a&&"not-in"!==a&&"array-contains-any"!==a||AT(o,a),u=H_(n,"where",o,"in"===a||"not-in"===a);var p=Xp.create(i,a,u);return function(e,t){if(t.dt()){var n=yy(e);if(null!==n&&!n.isEqual(t.field))throw new tv(ev.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '".concat(n.toString(),"' and '").concat(t.field.toString(),"'"));var r=py(e);null!==r&&CT(e,t.field,r)}var i=function(e,t){var n=!0,r=!1,i=void 0;try{for(var a,o=e.filters[Symbol.iterator]();!(n=(a=o.next()).done);n=!0){var u=a.value;if(t.indexOf(u.op)>=0)return u.op}}catch(e){r=!0,i=e}finally{try{n||null==o.return||o.return()}finally{if(r)throw i}}return null}(e,function(e){switch(e){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}(t.op));if(null!==i)throw i===t.op?new tv(ev.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '".concat(t.op.toString(),"' filter.")):new tv(ev.INVALID_ARGUMENT,"Invalid query. You cannot use '".concat(t.op.toString(),"' filters with '").concat(i.toString(),"' filters."))}(e,p),p}(e._query,0,i,e.firestore._databaseId,this.wa,this.ma,this.ga);return new a_(e.firestore,e.converter,(t=e._query,n=a,r=t.filters.concat([n]),new hy(t.path,t.collectionGroup,t.explicitOrderBy.slice(),r,t.limit,t.limitType,t.startAt,t.endAt)))}}]),r}(dT);function yT(e,t,n){var r=t,i=aT("where",e);return new pT(i,r,n)}var mT=function(t){"use strict";e(d)(r,t);var n=e(L)(r);function r(t,i){var a;return e(s)(this,r),(a=n.call(this)).wa=t,a.ya=i,a.type="orderBy",e(wc)(a)}return e(c)(r,[{key:"_apply",value:function(e){var t,n,r,i=function(e,t,n){if(null!==e.startAt)throw new tv(ev.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==e.endAt)throw new tv(ev.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r=new uy(t,n);return function(e,t){if(null===py(e)){var n=yy(e);null!==n&&CT(e,n,t.field)}}(e,r),r}(e._query,this.wa,this.ya);return new a_(e.firestore,e.converter,(t=e._query,n=i,r=t.explicitOrderBy.concat([n]),new hy(t.path,t.collectionGroup,r,t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)))}}]),r}(dT);function gT(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc",n=t,r=aT("orderBy",e);return new mT(r,n)}var kT=function(t){"use strict";e(d)(r,t);var n=e(L)(r);function r(t,i,a){var o;return e(s)(this,r),(o=n.call(this)).type=t,o.pa=i,o.Ia=a,e(wc)(o)}return e(c)(r,[{key:"_apply",value:function(e){return new a_(e.firestore,e.converter,wy(e._query,this.pa,this.Ia))}}]),r}(dT);var wT=function(t){"use strict";e(d)(r,t);var n=e(L)(r);function r(t,i,a){var o;return e(s)(this,r),(o=n.call(this)).type=t,o.Ta=i,o.Ea=a,e(wc)(o)}return e(c)(r,[{key:"_apply",value:function(e){var t,n,r=ET(e,this.type,this.Ta,this.Ea);return new a_(e.firestore,e.converter,(t=e._query,n=r,new hy(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,n,t.endAt)))}}]),r}(dT);function bT(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return new wT("startAt",t,!0)}function xT(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return new wT("startAfter",t,!1)}var IT=function(t){"use strict";e(d)(r,t);var n=e(L)(r);function r(t,i,a){var o;return e(s)(this,r),(o=n.call(this)).type=t,o.Ta=i,o.Ea=a,e(wc)(o)}return e(c)(r,[{key:"_apply",value:function(e){var t,n,r=ET(e,this.type,this.Ta,this.Ea);return new a_(e.firestore,e.converter,(t=e._query,n=r,new hy(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,n)))}}]),r}(dT);function _T(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return new IT("endBefore",t,!1)}function TT(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return new IT("endAt",t,!0)}function ET(t,n,r,i){if(r[0]=de(r[0]),r[0]instanceof rT)return function(e,t,n,r,i){if(!r)throw new tv(ev.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for ".concat(n,"()."));var a=[],o=!0,u=!1,s=void 0;try{for(var c,l=gy(e)[Symbol.iterator]();!(o=(c=l.next()).done);o=!0){var h=c.value;if(h.field.isKeyField())a.push(Ap(t,r.key));else{var f=r.data.field(h.field);if(hp(f))throw new tv(ev.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+h.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===f){var d=h.field.canonicalString();throw new tv(ev.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '".concat(d,"' (used as the orderBy) does not exist."))}a.push(f)}}}catch(e){u=!0,s=e}finally{try{o||null==l.return||l.return()}finally{if(u)throw s}}return new oy(a,i)}(t._query,t.firestore._databaseId,n,r[0]._document,i);var a=F_(t.firestore);return function(t,n,r,i,a,o){var u=t.explicitOrderBy;if(a.length>u.length)throw new tv(ev.INVALID_ARGUMENT,"Too many arguments provided to ".concat(i,"(). The number of arguments must be less than or equal to the number of orderBy() clauses"));for(var s=[],c=0;c<a.length;c++){var l=a[c];if(u[c].field.isKeyField()){if("string"!=typeof l)throw new tv(ev.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in ".concat(i,"(), but got a ").concat(void 0===l?"undefined":e(bc)(l)));if(!my(t)&&-1!==l.indexOf("/"))throw new tv(ev.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by documentId(), the value passed to ".concat(i,"() must be a plain document ID, but '").concat(l,"' contains a slash."));var h=t.path.child(kv.fromString(l));if(!xv.isDocumentKey(h))throw new tv(ev.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by documentId(), the value passed to ".concat(i,"() must result in a valid document path, but '").concat(h,"' is not because it contains an odd number of segments."));var f=new xv(h);s.push(Ap(n,f))}else{var d=H_(r,i,l);s.push(d)}}return new oy(s,o)}(t._query,t.firestore._databaseId,a,n,r,i)}function ST(e,t,n){if("string"==typeof(n=de(n))){if(""===n)throw new tv(ev.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!my(t)&&-1!==n.indexOf("/"))throw new tv(ev.INVALID_ARGUMENT,"Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '".concat(n,"' contains a '/' character."));var r=t.path.child(kv.fromString(n));if(!xv.isDocumentKey(r))throw new tv(ev.INVALID_ARGUMENT,"Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '".concat(r,"' is not because it has an odd number of segments (").concat(r.length,")."));return Ap(e,new xv(r))}if(n instanceof i_)return Ap(e,n._key);throw new tv(ev.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ".concat(ZI(n),"."))}function AT(e,t){if(!Array.isArray(e)||0===e.length)throw new tv(ev.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '".concat(t.toString(),"' filters."));if(e.length>10)throw new tv(ev.INVALID_ARGUMENT,"Invalid Query. '".concat(t.toString(),"' filters support a maximum of 10 elements in the value array."))}function CT(e,t,n){if(!n.isEqual(t))throw new tv(ev.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '".concat(t.toString(),"' and so you must also use '").concat(t.toString(),"' as your first argument to orderBy(), but your first orderBy() is on field '").concat(n.toString(),"' instead."))}
/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var NT={maxAttempts:5},DT=function(){"use strict";function t(){e(s)(this,t)}return e(c)(t,[{key:"convertValue",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none";switch(bp(e)){case 0:return null;case 1:return e.booleanValue;case 2:return cp(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(lp(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 10:return this.convertObject(e.mapValue,t);default:throw Xd()}}},{key:"convertObject",value:function(e,t){var n=this,r={};return Jv(e.fields,(function(e,i){r[e]=n.convertValue(i,t)})),r}},{key:"convertGeoPoint",value:function(e){return new N_(cp(e.latitude),cp(e.longitude))}},{key:"convertArray",value:function(e,t){var n=this;return(e.values||[]).map((function(e){return n.convertValue(e,t)}))}},{key:"convertServerTimestamp",value:function(e,t){switch(t){case"previous":var n=fp(e);return null==n?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(dp(e));default:return null}}},{key:"convertTimestamp",value:function(e){var t=sp(e);return new yv(t.seconds,t.nanos)}},{key:"convertDocumentKey",value:function(e,t){var n=kv.fromString(e);Zd(sg(n));var r=new pp(n.get(1),n.get(3)),i=new xv(n.popFirst(5));return r.isEqual(t)||Qd("Document ".concat(i," contains a document reference within a different database (").concat(r.projectId,"/").concat(r.database,") which is not supported. It will be treated as a reference in the current database (").concat(t.projectId,"/").concat(t.database,") instead.")),i}}]),t}();
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function RT(e,t,n){return e?n&&(n.merge||n.mergeFields)?e.toFirestore(t,n):e.toFirestore(t):t}var OT=function(t){"use strict";e(d)(r,t);var n=e(L)(r);function r(t){var i;return e(s)(this,r),(i=n.call(this)).firestore=t,e(wc)(i)}return e(c)(r,[{key:"convertBytes",value:function(e){return new A_(e)}},{key:"convertReference",value:function(e){var t=this.convertDocumentKey(e,this.firestore._databaseId);return new i_(this.firestore,null,t)}}]),r}(DT),PT=function(){"use strict";function t(n,r){e(s)(this,t),this._firestore=n,this._commitHandler=r,this._mutations=[],this._committed=!1,this._dataReader=F_(n)}return e(c)(t,[{key:"set",value:function(e,t,n){this._verifyNotCommitted();var r=LT(e,this._firestore),i=RT(r.converter,t,n),a=V_(this._dataReader,"WriteBatch.set",r._key,i,null!==r.converter,n);return this._mutations.push(a.toMutation(r._key,zy.none())),this}},{key:"update",value:function(e,t,n){for(var r=arguments.length,i=new Array(r>3?r-3:0),a=3;a<r;a++)i[a-3]=arguments[a];this._verifyNotCommitted();var o,u=LT(e,this._firestore);return o="string"==typeof(t=de(t))||t instanceof S_?W_(this._dataReader,"WriteBatch.update",u._key,t,n,i):z_(this._dataReader,"WriteBatch.update",u._key,t),this._mutations.push(o.toMutation(u._key,zy.exists(!0))),this}},{key:"delete",value:function(e){this._verifyNotCommitted();var t=LT(e,this._firestore);return this._mutations=this._mutations.concat(new om(t._key,zy.none())),this}},{key:"commit",value:function(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}},{key:"_verifyNotCommitted",value:function(){if(this._committed)throw new tv(ev.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}]),t}();
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function LT(e,t){if((e=de(e)).firestore!==t)throw new tv(ev.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function MT(e){e=$I(e,i_);var t=$I(e.firestore,p_);return zI(y_(t),e._key).then((function(n){return YT(t,e,n)}))}var FT=function(t){"use strict";e(d)(r,t);var n=e(L)(r);function r(t){var i;return e(s)(this,r),(i=n.call(this)).firestore=t,e(wc)(i)}return e(c)(r,[{key:"convertBytes",value:function(e){return new A_(e)}},{key:"convertReference",value:function(e){var t=this.convertDocumentKey(e,this.firestore._databaseId);return new i_(this.firestore,null,t)}}]),r}(DT);function VT(t){t=$I(t,i_);var n,r,i,a=$I(t.firestore,p_),o=y_(a),u=new FT(a);return(n=o,r=t._key,i=new nv,n.asyncQueue.enqueueAndForget(e(ve)(e(ye).mark((function t(){return e(ye).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=function(){var t=e(ve)(e(ye).mark((function t(n,r,i){var a,o;return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,function(e,t){var n=$d(e);return n.persistence.runTransaction("read document","readonly",(function(e){return n.localDocuments.getDocument(e,t)}))}(n,r);case 3:(a=e.sent).isFoundDocument()?i.resolve(a):a.isNoDocument()?i.resolve(null):i.reject(new tv(ev.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(0),o=tx(e.t0,"Failed to get document '".concat(r," from cache")),i.reject(o);case 11:case"end":return e.stop()}}),t,null,[[0,7]])})));return function(e,n,r){return t.apply(this,arguments)}}(),t.next=3,BI(n);case 3:return t.t1=t.sent,t.t2=r,t.t3=i,t.abrupt("return",(0,t.t0)(t.t1,t.t2,t.t3));case 7:case"end":return t.stop()}}),t)})))),i.promise).then((function(e){return new uT(a,u,t._key,e,new oT(null!==e&&e.hasLocalMutations,!0),t.converter)}))}function UT(e){e=$I(e,i_);var t=$I(e.firestore,p_);return zI(y_(t),e._key,{source:"server"}).then((function(n){return YT(t,e,n)}))}function BT(e){e=$I(e,a_);var t=$I(e.firestore,p_),n=y_(t),r=new FT(t);return fT(e._query),WI(n,e._query).then((function(n){return new cT(t,r,e,n)}))}function qT(t){t=$I(t,a_);var n,r,i,a=$I(t.firestore,p_),o=y_(a),u=new FT(a);return(n=o,r=t._query,i=new nv,n.asyncQueue.enqueueAndForget(e(ve)(e(ye).mark((function t(){return e(ye).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=function(){var t=e(ve)(e(ye).mark((function t(n,r,i){var a,o,u,s,c;return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Pw(n,r,!0);case 3:a=e.sent,o=new bx(r,a.Hi),u=o.ju(a.documents),s=o.applyChanges(u,!1),i.resolve(s.snapshot),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(0),c=tx(e.t0,"Failed to execute query '".concat(r," against cache")),i.reject(c);case 14:case"end":return e.stop()}}),t,null,[[0,10]])})));return function(e,n,r){return t.apply(this,arguments)}}(),t.next=3,BI(n);case 3:return t.t1=t.sent,t.t2=r,t.t3=i,t.abrupt("return",(0,t.t0)(t.t1,t.t2,t.t3));case 7:case"end":return t.stop()}}),t)})))),i.promise).then((function(e){return new cT(a,u,t,e)}))}function jT(e){e=$I(e,a_);var t=$I(e.firestore,p_),n=y_(t),r=new FT(t);return WI(n,e._query,{source:"server"}).then((function(n){return new cT(t,r,e,n)}))}function GT(e,t,n){e=$I(e,i_);var r=$I(e.firestore,p_),i=RT(e.converter,t,n);return QT(r,[V_(F_(r),"setDoc",e._key,i,null!==e.converter,n).toMutation(e._key,zy.none())])}function KT(e,t,n){for(var r=arguments.length,i=new Array(r>3?r-3:0),a=3;a<r;a++)i[a-3]=arguments[a];e=$I(e,i_);var o=$I(e.firestore,p_),u=F_(o);return QT(o,[("string"==typeof(t=de(t))||t instanceof S_?W_(u,"updateDoc",e._key,t,n,i):z_(u,"updateDoc",e._key,t)).toMutation(e._key,zy.exists(!0))])}function zT(e,t){var n=$I(e.firestore,p_),r=c_(e),i=RT(e.converter,t);return QT(n,[V_(F_(e.firestore),"addDoc",r._key,i,null!==e.converter,{}).toMutation(r._key,zy.exists(!1))]).then((function(){return r}))}function WT(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];var a,o,u;t=de(t);var s={includeMetadataChanges:!1},c=0;"object"!=typeof r[c]||d_(r[c])||(s=r[c],c++);var l,h,f,d={includeMetadataChanges:s.includeMetadataChanges};if(d_(r[c])){var v=r[c];r[c]=null===(a=v.next)||void 0===a?void 0:a.bind(v),r[c+1]=null===(o=v.error)||void 0===o?void 0:o.bind(v),r[c+2]=null===(u=v.complete)||void 0===u?void 0:u.bind(v)}if(t instanceof i_)h=$I(t.firestore,p_),f=dy(t._key.path),l={next:function(e){r[c]&&r[c](YT(h,t,e))},error:r[c+1],complete:r[c+2]};else{var p=$I(t,a_);h=$I(p.firestore,p_),f=p._query;var y=new FT(h);l={next:function(e){r[c]&&r[c](new cT(h,y,p,e))},error:r[c+1],complete:r[c+2]},fT(t._query)}return function(t,n,r,i){var a=new EI(i),o=new vx(n,a,r);return t.asyncQueue.enqueueAndForget(e(ve)(e(ye).mark((function n(){return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=ux,e.next=3,GI(t);case 3:return e.t1=e.sent,e.t2=o,e.abrupt("return",(0,e.t0)(e.t1,e.t2));case 6:case"end":return e.stop()}}),n)})))),function(){a.Rc(),t.asyncQueue.enqueueAndForget(e(ve)(e(ye).mark((function n(){return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=cx,e.next=3,GI(t);case 3:return e.t1=e.sent,e.t2=o,e.abrupt("return",(0,e.t0)(e.t1,e.t2));case 6:case"end":return e.stop()}}),n)}))))}}(y_(h),f,d,l)}function HT(t,n){return r=y_(t=$I(t,p_)),i=d_(n)?n:{next:n},a=new EI(i),r.asyncQueue.enqueueAndForget(e(ve)(e(ye).mark((function t(){return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=function(e,t){$d(e).Ru.add(t),t.next()},e.next=3,GI(r);case 3:return e.t1=e.sent,e.t2=a,e.abrupt("return",(0,e.t0)(e.t1,e.t2));case 6:case"end":return e.stop()}}),t)})))),function(){a.Rc(),r.asyncQueue.enqueueAndForget(e(ve)(e(ye).mark((function t(){return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=function(e,t){$d(e).Ru.delete(t)},e.next=3,GI(r);case 3:return e.t1=e.sent,e.t2=a,e.abrupt("return",(0,e.t0)(e.t1,e.t2));case 6:case"end":return e.stop()}}),t)}))))};var r,i,a}function QT(t,n){return r=y_(t),i=n,a=new nv,r.asyncQueue.enqueueAndForget(e(ve)(e(ye).mark((function t(){return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=Dx,e.next=3,jI(r);case 3:return e.t1=e.sent,e.t2=i,e.t3=a,e.abrupt("return",(0,e.t0)(e.t1,e.t2,e.t3));case 7:case"end":return e.stop()}}),t)})))),a.promise;var r,i,a}function YT(e,t,n){var r=n.docs.get(t._key),i=new FT(e);return new uT(e,i,t._key,r,new oT(n.hasPendingWrites,n.fromCache),t.converter)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var JT=function(t){"use strict";e(d)(r,t);var n=e(L)(r);function r(t,i){var a;return e(s)(this,r),(a=n.call(this,t,i))._firestore=t,e(wc)(a)}return e(c)(r,[{key:"get",value:function(t){var n=this,i=LT(t,this._firestore),a=new FT(this._firestore);return e(Qt)(e(Xt)(r.prototype),"get",this).call(this,t).then((function(e){return new uT(n._firestore,a,i._key,e._document,new oT(!1,!1),i.converter)}))}}]),r}(function(){"use strict";function t(n,r){e(s)(this,t),this._firestore=n,this._transaction=r,this._dataReader=F_(n)}return e(c)(t,[{key:"get",value:function(e){var t=this,n=LT(e,this._firestore),r=new OT(this._firestore);return this._transaction.lookup([n._key]).then((function(e){if(!e||1!==e.length)return Xd();var i=e[0];if(i.isFoundDocument())return new rT(t._firestore,r,i.key,i,n.converter);if(i.isNoDocument())return new rT(t._firestore,r,n._key,null,n.converter);throw Xd()}))}},{key:"set",value:function(e,t,n){var r=LT(e,this._firestore),i=RT(r.converter,t,n),a=V_(this._dataReader,"Transaction.set",r._key,i,null!==r.converter,n);return this._transaction.set(r._key,a),this}},{key:"update",value:function(e,t,n){for(var r=arguments.length,i=new Array(r>3?r-3:0),a=3;a<r;a++)i[a-3]=arguments[a];var o,u=LT(e,this._firestore);return o="string"==typeof(t=de(t))||t instanceof S_?W_(this._dataReader,"Transaction.update",u._key,t,n,i):z_(this._dataReader,"Transaction.update",u._key,t),this._transaction.update(u._key,o),this}},{key:"delete",value:function(e){var t=LT(e,this._firestore);return this._transaction.delete(t._key),this}}]),t}());function XT(t,n,r){t=$I(t,p_);var i=Object.assign(Object.assign({},NT),r);return function(e){if(e.maxAttempts<1)throw new tv(ev.INVALID_ARGUMENT,"Max attempts must be at least 1")}(i),function(t,n,r){var i=new nv;return t.asyncQueue.enqueueAndForget(e(ve)(e(ye).mark((function a(){var o;return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,FI(t).then((function(e){return e.datastore}));case 2:o=e.sent,new CI(t.asyncQueue,o,r,n,i).run();case 4:case"end":return e.stop()}}),a)})))),i.promise}(y_(t),(function(e){return n(new JT(t,e))}),i)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ZT(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return new j_("arrayUnion",t)}function $T(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return new G_("arrayRemove",t)}!function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];Kd=mt,lt(new ge("firestore",(function(e,n){var r=n.instanceIdentifier,i=n.options,a=e.getProvider("app").getImmediate(),o=new p_(new ov(e.getProvider("auth-internal")),new lv(e.getProvider("app-check-internal")),function(e,t){if(!Object.prototype.hasOwnProperty.apply(e.options,["projectId"]))throw new tv(ev.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new pp(e.options.projectId,t)}(a,r),a);return i=Object.assign({useFetchStreams:t},i),o._setSettings(i),o}),"PUBLIC").setMultipleInstances(!0)),It(jd,"3.5.0",e),It(jd,"3.5.0","esm2017")}();
/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function eE(e,t){if(void 0===t)return{merge:!1};if(void 0!==t.mergeFields&&void 0!==t.merge)throw new tv("invalid-argument","Invalid options passed to function ".concat(e,"(): You cannot ")+'specify both "merge" and "mergeFields".');return t}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tE(){if("undefined"==typeof Uint8Array)throw new tv("unimplemented","Uint8Arrays are not available in this environment.")}function nE(){if("undefined"==typeof atob)throw new tv("unimplemented","Blobs are unavailable in Firestore in this environment.")}var rE=function(){"use strict";function t(n){e(s)(this,t),this._delegate=n}return e(c)(t,[{key:"toBase64",value:function(){return nE(),this._delegate.toBase64()}},{key:"toUint8Array",value:function(){return tE(),this._delegate.toUint8Array()}},{key:"isEqual",value:function(e){return this._delegate.isEqual(e._delegate)}},{key:"toString",value:function(){return"Blob(base64: "+this.toBase64()+")"}}],[{key:"fromBase64String",value:function(e){return nE(),new t(A_.fromBase64String(e))}},{key:"fromUint8Array",value:function(e){return tE(),new t(A_.fromUint8Array(e))}}]),t}();
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iE(e){return function(e,t){if("object"!=typeof e||null===e)return!1;var n=e,r=!0,i=!1,a=void 0;try{for(var o,u=t[Symbol.iterator]();!(r=(o=u.next()).done);r=!0){var s=o.value;if(s in n&&"function"==typeof n[s])return!0}}catch(e){i=!0,a=e}finally{try{r||null==u.return||u.return()}finally{if(i)throw a}}return!1}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(e,["next","error","complete"])}var aE=function(){"use strict";function t(){e(s)(this,t)}return e(c)(t,[{key:"enableIndexedDbPersistence",value:function(e,t){return g_(e._delegate,{forceOwnership:t})}},{key:"enableMultiTabIndexedDbPersistence",value:function(e){return k_(e._delegate)}},{key:"clearIndexedDbPersistence",value:function(e){return b_(e._delegate)}}]),t}(),oE=function(){"use strict";function t(n,r,i){var a=this;e(s)(this,t),this._delegate=r,this._persistenceProvider=i,this.INTERNAL={delete:function(){return a.terminate()}},n instanceof pp||(this._appCompat=n)}return e(c)(t,[{key:"_databaseId",get:function(){return this._delegate._databaseId}},{key:"settings",value:function(e){var t=this._delegate._getSettings();e.merge||t.host===e.host||Yd("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&delete(e=Object.assign(Object.assign({},t),e)).merge,this._delegate._setSettings(e)}},{key:"useEmulator",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};r_(this._delegate,e,t,n)}},{key:"enableNetwork",value:function(){return x_(this._delegate)}},{key:"disableNetwork",value:function(){return I_(this._delegate)}},{key:"enablePersistence",value:function(e){var t=!1,n=!1;return e&&YI("synchronizeTabs",t=!!e.synchronizeTabs,"experimentalForceOwningTab",n=!!e.experimentalForceOwningTab),t?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,n)}},{key:"clearPersistence",value:function(){return this._persistenceProvider.clearIndexedDbPersistence(this)}},{key:"terminate",value:function(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}},{key:"waitForPendingWrites",value:function(){return t=this._delegate,n=y_(t=$I(t,p_)),r=new nv,n.asyncQueue.enqueueAndForget(e(ve)(e(ye).mark((function t(){return e(ye).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=jx,e.next=3,jI(n);case 3:return e.t1=e.sent,e.t2=r,e.abrupt("return",(0,e.t0)(e.t1,e.t2));case 6:case"end":return e.stop()}}),t)})))),r.promise;var t,n,r}},{key:"onSnapshotsInSync",value:function(e){return HT(this._delegate,e)}},{key:"app",get:function(){if(!this._appCompat)throw new tv("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}},{key:"collection",value:function(e){try{return new wE(this,u_(this._delegate,e))}catch(e){throw fE(e,"collection()","Firestore.collection()")}}},{key:"doc",value:function(e){try{return new hE(this,c_(this._delegate,e))}catch(e){throw fE(e,"doc()","Firestore.doc()")}}},{key:"collectionGroup",value:function(e){try{return new mE(this,s_(this._delegate,e))}catch(e){throw fE(e,"collectionGroup()","Firestore.collectionGroup()")}}},{key:"runTransaction",value:function(e){var t=this;return XT(this._delegate,(function(n){return e(new sE(t,n))}))}},{key:"batch",value:function(){var e=this;return y_(this._delegate),new cE(new PT(this._delegate,(function(t){return QT(e._delegate,t)})))}},{key:"loadBundle",value:function(e){return __(this._delegate,e)}},{key:"namedQuery",value:function(e){var t=this;return T_(this._delegate,e).then((function(e){return e?new mE(t,e):null}))}}]),t}(),uE=function(t){"use strict";e(d)(r,t);var n=e(L)(r);function r(t){var i;return e(s)(this,r),(i=n.call(this)).firestore=t,i}return e(c)(r,[{key:"convertBytes",value:function(e){return new rE(new A_(e))}},{key:"convertReference",value:function(e){var t=this.convertDocumentKey(e,this.firestore._databaseId);return hE.forKey(t,this.firestore,null)}}]),r}(DT);var sE=function(){"use strict";function t(n,r){e(s)(this,t),this._firestore=n,this._delegate=r,this._userDataWriter=new uE(n)}return e(c)(t,[{key:"get",value:function(e){var t=this,n=bE(e);return this._delegate.get(n).then((function(e){return new pE(t._firestore,new uT(t._firestore._delegate,t._userDataWriter,e._key,e._document,e.metadata,n.converter))}))}},{key:"set",value:function(e,t,n){var r=bE(e);return n?(eE("Transaction.set",n),this._delegate.set(r,t,n)):this._delegate.set(r,t),this}},{key:"update",value:function(t,n,r){for(var i=arguments.length,a=new Array(i>3?i-3:0),o=3;o<i;o++)a[o-3]=arguments[o];var u,s=bE(t);return 2===arguments.length?this._delegate.update(s,n):(u=this._delegate).update.apply(u,[s,n,r].concat(e(x)(a))),this}},{key:"delete",value:function(e){var t=bE(e);return this._delegate.delete(t),this}}]),t}(),cE=function(){"use strict";function t(n){e(s)(this,t),this._delegate=n}return e(c)(t,[{key:"set",value:function(e,t,n){var r=bE(e);return n?(eE("WriteBatch.set",n),this._delegate.set(r,t,n)):this._delegate.set(r,t),this}},{key:"update",value:function(t,n,r){for(var i=arguments.length,a=new Array(i>3?i-3:0),o=3;o<i;o++)a[o-3]=arguments[o];var u,s=bE(t);return 2===arguments.length?this._delegate.update(s,n):(u=this._delegate).update.apply(u,[s,n,r].concat(e(x)(a))),this}},{key:"delete",value:function(e){var t=bE(e);return this._delegate.delete(t),this}},{key:"commit",value:function(){return this._delegate.commit()}}]),t}(),lE=function(){"use strict";function t(n,r,i){e(s)(this,t),this._firestore=n,this._userDataWriter=r,this._delegate=i}return e(c)(t,[{key:"fromFirestore",value:function(e,t){var n=new sT(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new yE(this._firestore,n),null!=t?t:{})}},{key:"toFirestore",value:function(e,t){return t?this._delegate.toFirestore(e,t):this._delegate.toFirestore(e)}}],[{key:"getInstance",value:function(e,n){var r=t.INSTANCES,i=r.get(e);i||(i=new WeakMap,r.set(e,i));var a=i.get(n);return a||(a=new t(e,new uE(e),n),i.set(n,a)),a}}]),t}();lE.INSTANCES=new WeakMap;var hE=function(){"use strict";function t(n,r){e(s)(this,t),this.firestore=n,this._delegate=r,this._userDataWriter=new uE(n)}return e(c)(t,[{key:"id",get:function(){return this._delegate.id}},{key:"parent",get:function(){return new wE(this.firestore,this._delegate.parent)}},{key:"path",get:function(){return this._delegate.path}},{key:"collection",value:function(e){try{return new wE(this.firestore,u_(this._delegate,e))}catch(e){throw fE(e,"collection()","DocumentReference.collection()")}}},{key:"isEqual",value:function(e){return(e=de(e))instanceof i_&&l_(this._delegate,e)}},{key:"set",value:function(e,t){t=eE("DocumentReference.set",t);try{return t?GT(this._delegate,e,t):GT(this._delegate,e)}catch(e){throw fE(e,"setDoc()","DocumentReference.set()")}}},{key:"update",value:function(t,n){for(var r=arguments.length,i=new Array(r>2?r-2:0),a=2;a<r;a++)i[a-2]=arguments[a];try{return 1===arguments.length?KT(this._delegate,t):KT.apply(void 0,[this._delegate,t,n].concat(e(x)(i)))}catch(e){throw fE(e,"updateDoc()","DocumentReference.update()")}}},{key:"delete",value:function(){return QT($I((e=this._delegate).firestore,p_),[new om(e._key,zy.none())]);var e}},{key:"onSnapshot",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=this,i=dE(t),a=vE(t,(function(e){return new pE(r.firestore,new uT(r.firestore._delegate,r._userDataWriter,e._key,e._document,e.metadata,r._delegate.converter))}));return WT(this._delegate,i,a)}},{key:"get",value:function(e){var t=this;return("cache"===(null==e?void 0:e.source)?VT(this._delegate):"server"===(null==e?void 0:e.source)?UT(this._delegate):MT(this._delegate)).then((function(e){return new pE(t.firestore,new uT(t.firestore._delegate,t._userDataWriter,e._key,e._document,e.metadata,t._delegate.converter))}))}},{key:"withConverter",value:function(e){return new t(this.firestore,e?this._delegate.withConverter(lE.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}],[{key:"forPath",value:function(e,n,r){if(e.length%2!=0)throw new tv("invalid-argument","Invalid document reference. Document references must have an even number of segments, but "+"".concat(e.canonicalString()," has ").concat(e.length));return new t(n,new i_(n._delegate,r,new xv(e)))}},{key:"forKey",value:function(e,n,r){return new t(n,new i_(n._delegate,r,e))}}]),t}();function fE(e,t,n){return e.message=e.message.replace(t,n),e}function dE(e){var t=!0,n=!1,r=void 0;try{for(var i,a=e[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){var o=i.value;if("object"==typeof o&&!iE(o))return o}}catch(e){n=!0,r=e}finally{try{t||null==a.return||a.return()}finally{if(n)throw r}}return{}}function vE(e,t){var n,r,i;return{next:function(e){i.next&&i.next(t(e))},error:null===(n=(i=iE(e[0])?e[0]:iE(e[1])?e[1]:"function"==typeof e[0]?{next:e[0],error:e[1],complete:e[2]}:{next:e[1],error:e[2],complete:e[3]}).error)||void 0===n?void 0:n.bind(i),complete:null===(r=i.complete)||void 0===r?void 0:r.bind(i)}}var pE=function(){"use strict";function t(n,r){e(s)(this,t),this._firestore=n,this._delegate=r}return e(c)(t,[{key:"ref",get:function(){return new hE(this._firestore,this._delegate.ref)}},{key:"id",get:function(){return this._delegate.id}},{key:"metadata",get:function(){return this._delegate.metadata}},{key:"exists",get:function(){return this._delegate.exists()}},{key:"data",value:function(e){return this._delegate.data(e)}},{key:"get",value:function(e,t){return this._delegate.get(e,t)}},{key:"isEqual",value:function(e){return hT(this._delegate,e._delegate)}}]),t}(),yE=function(t){"use strict";e(d)(r,t);var n=e(L)(r);function r(){return e(s)(this,r),n.apply(this,arguments)}return e(c)(r,[{key:"data",value:function(e){var t=this._delegate.data(e);return void 0!==t||Xd(),t}}]),r}(pE),mE=function(){"use strict";function t(n,r){e(s)(this,t),this.firestore=n,this._delegate=r,this._userDataWriter=new uE(n)}return e(c)(t,[{key:"where",value:function(e,n,r){try{return new t(this.firestore,vT(this._delegate,yT(e,n,r)))}catch(e){throw fE(e,/(orderBy|where)\(\)/,"Query.$1()")}}},{key:"orderBy",value:function(e,n){try{return new t(this.firestore,vT(this._delegate,gT(e,n)))}catch(e){throw fE(e,/(orderBy|where)\(\)/,"Query.$1()")}}},{key:"limit",value:function(e){try{return new t(this.firestore,vT(this._delegate,(e_("limit",n=e),new kT("limit",n,"F"))))}catch(e){throw fE(e,"limit()","Query.limit()")}var n}},{key:"limitToLast",value:function(e){try{return new t(this.firestore,vT(this._delegate,(e_("limitToLast",n=e),new kT("limitToLast",n,"L"))))}catch(e){throw fE(e,"limitToLast()","Query.limitToLast()")}var n}},{key:"startAt",value:function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];try{return new t(this.firestore,vT(this._delegate,bT.apply(void 0,e(x)(r))))}catch(e){throw fE(e,"startAt()","Query.startAt()")}}},{key:"startAfter",value:function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];try{return new t(this.firestore,vT(this._delegate,xT.apply(void 0,e(x)(r))))}catch(e){throw fE(e,"startAfter()","Query.startAfter()")}}},{key:"endBefore",value:function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];try{return new t(this.firestore,vT(this._delegate,_T.apply(void 0,e(x)(r))))}catch(e){throw fE(e,"endBefore()","Query.endBefore()")}}},{key:"endAt",value:function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];try{return new t(this.firestore,vT(this._delegate,TT.apply(void 0,e(x)(r))))}catch(e){throw fE(e,"endAt()","Query.endAt()")}}},{key:"isEqual",value:function(e){return h_(this._delegate,e._delegate)}},{key:"get",value:function(e){var t=this;return("cache"===(null==e?void 0:e.source)?qT(this._delegate):"server"===(null==e?void 0:e.source)?jT(this._delegate):BT(this._delegate)).then((function(e){return new kE(t.firestore,new cT(t.firestore._delegate,t._userDataWriter,t._delegate,e._snapshot))}))}},{key:"onSnapshot",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=this,i=dE(t),a=vE(t,(function(e){return new kE(r.firestore,new cT(r.firestore._delegate,r._userDataWriter,r._delegate,e._snapshot))}));return WT(this._delegate,i,a)}},{key:"withConverter",value:function(e){return new t(this.firestore,e?this._delegate.withConverter(lE.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}]),t}(),gE=function(){"use strict";function t(n,r){e(s)(this,t),this._firestore=n,this._delegate=r}return e(c)(t,[{key:"type",get:function(){return this._delegate.type}},{key:"doc",get:function(){return new yE(this._firestore,this._delegate.doc)}},{key:"oldIndex",get:function(){return this._delegate.oldIndex}},{key:"newIndex",get:function(){return this._delegate.newIndex}}]),t}(),kE=function(){"use strict";function t(n,r){e(s)(this,t),this._firestore=n,this._delegate=r}return e(c)(t,[{key:"query",get:function(){return new mE(this._firestore,this._delegate.query)}},{key:"metadata",get:function(){return this._delegate.metadata}},{key:"size",get:function(){return this._delegate.size}},{key:"empty",get:function(){return this._delegate.empty}},{key:"docs",get:function(){var e=this;return this._delegate.docs.map((function(t){return new yE(e._firestore,t)}))}},{key:"docChanges",value:function(e){var t=this;return this._delegate.docChanges(e).map((function(e){return new gE(t._firestore,e)}))}},{key:"forEach",value:function(e,t){var n=this;this._delegate.forEach((function(r){e.call(t,new yE(n._firestore,r))}))}},{key:"isEqual",value:function(e){return hT(this._delegate,e._delegate)}}]),t}(),wE=function(t){"use strict";e(d)(r,t);var n=e(L)(r);function r(t,i){var a;return e(s)(this,r),(a=n.call(this,t,i)).firestore=t,a._delegate=i,a}return e(c)(r,[{key:"id",get:function(){return this._delegate.id}},{key:"path",get:function(){return this._delegate.path}},{key:"parent",get:function(){var e=this._delegate.parent;return e?new hE(this.firestore,e):null}},{key:"doc",value:function(e){try{return new hE(this.firestore,void 0===e?c_(this._delegate):c_(this._delegate,e))}catch(e){throw fE(e,"doc()","CollectionReference.doc()")}}},{key:"add",value:function(e){var t=this;return zT(this._delegate,e).then((function(e){return new hE(t.firestore,e)}))}},{key:"isEqual",value:function(e){return l_(this._delegate,e._delegate)}},{key:"withConverter",value:function(e){return new r(this.firestore,e?this._delegate.withConverter(lE.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}]),r}(mE);function bE(e){return $I(e,i_)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var xE=function(){"use strict";function t(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];e(s)(this,t),this._delegate=e(kc)(S_,e(x)(r))}return e(c)(t,[{key:"isEqual",value:function(e){return(e=de(e))instanceof S_&&this._delegate._internalPath.isEqual(e._internalPath)}}],[{key:"documentId",value:function(){return new t(bv.keyField().canonicalString())}}]),t}(),IE=function(){"use strict";function t(n){e(s)(this,t),this._delegate=n}return e(c)(t,[{key:"isEqual",value:function(e){return this._delegate.isEqual(e._delegate)}}],[{key:"serverTimestamp",value:function(){var e=new q_("serverTimestamp");return e._methodName="FieldValue.serverTimestamp",new t(e)}},{key:"delete",value:function(){var e=new U_("deleteField");return e._methodName="FieldValue.delete",new t(e)}},{key:"arrayUnion",value:function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];var a=ZT.apply(void 0,e(x)(r));return a._methodName="FieldValue.arrayUnion",new t(a)}},{key:"arrayRemove",value:function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];var a=$T.apply(void 0,e(x)(r));return a._methodName="FieldValue.arrayRemove",new t(a)}},{key:"increment",value:function(e){var n=new K_("increment",e);return n._methodName="FieldValue.increment",new t(n)}}]),t}(),_E={Firestore:oE,GeoPoint:N_,Timestamp:yv,Blob:rE,Transaction:sE,WriteBatch:cE,DocumentReference:hE,DocumentSnapshot:pE,Query:mE,QueryDocumentSnapshot:yE,QuerySnapshot:kE,CollectionReference:wE,FieldPath:xE,FieldValue:IE,setLogLevel:function(e){var t;t=e,zd.setLogLevel(t)},CACHE_SIZE_UNLIMITED:-1};
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function TE(){if(Ht.auth().currentUser)Ht.auth().signOut();else{var e=document.getElementById("email").value,t=document.getElementById("password").value;if(e.length<4)return void alert("Please enter an email address.");if(t.length<4)return void alert("Please enter a password.");Ht.auth().signInWithEmailAndPassword(e,t).catch((function(e){var t=e.code,n=e.message;"auth/wrong-password"===t?alert("Wrong password."):alert(n),console.log(e),document.getElementById("quickstart-sign-in").disabled=!1}))}document.getElementById("quickstart-sign-in").disabled=!0}function EE(){var e=document.getElementById("email").value,t=document.getElementById("password").value;e.length<4?alert("Please enter an email address."):t.length<4?alert("Please enter a password."):Ht.auth().createUserWithEmailAndPassword(e,t).then((function(e){console.log(e),null!=e&&e.user.sendEmailVerification()})).catch((function(e){var t=e.code,n=e.message;"auth/weak-password"==t?alert("The password is too weak."):alert(n),console.log(e)}))}function SE(){Ht.auth().currentUser.sendEmailVerification().then((function(){console.log("firebase.auth().currentUser"),console.log(Ht.auth().currentUser),alert("Email Verification Sent!")}))}function AE(){var e=document.getElementById("email").value;Ht.auth().sendPasswordResetEmail(e).then((function(){alert("Password Reset Email Sent!")})).catch((function(e){var t=e.code,n=e.message;("auth/invalid-email"==t||"auth/user-not-found"==t)&&alert(n),console.log(e)}))}!
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function(e){var t;t=function(e,t){return new oE(e,t,new aE)},e.INTERNAL.registerComponent(new ge("firestore-compat",(function(e){var n=e.getProvider("app-compat").getImmediate(),r=e.getProvider("firestore").getImmediate();return t(n,r)}),"PUBLIC").setServiceProps(Object.assign({},_E))),e.registerVersion("@firebase/firestore-compat","0.1.25")}(Ht),Ht.initializeApp(u),console.log(Ht),window.onload=function(){Ht.auth().onAuthStateChanged((function(e){if(document.getElementById("quickstart-verify-email").disabled=!0,e){e.displayName,e.email;var t=e.emailVerified;e.photoURL,e.isAnonymous,e.uid,e.providerData,document.getElementById("quickstart-sign-in-status").textContent="Signed in",document.getElementById("quickstart-sign-in").textContent="Sign out",document.getElementById("quickstart-account-details").textContent=JSON.stringify(e,null,"  "),t||(document.getElementById("quickstart-verify-email").disabled=!1)}else document.getElementById("quickstart-sign-in-status").textContent="Signed out",document.getElementById("quickstart-sign-in").textContent="Sign in",document.getElementById("quickstart-account-details").textContent="null";document.getElementById("quickstart-sign-in").disabled=!1})),document.getElementById("quickstart-sign-in").addEventListener("click",TE,!1),document.getElementById("quickstart-sign-up").addEventListener("click",EE,!1),document.getElementById("quickstart-verify-email").addEventListener("click",SE,!1),document.getElementById("quickstart-password-reset").addEventListener("click",AE,!1)}}();
//# sourceMappingURL=index.720d80c1.js.map
